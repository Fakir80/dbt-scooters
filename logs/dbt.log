[0m11:04:02.356911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010ABC222120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010ABB2DE8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010ABB2DE600>]}


============================== 11:04:02.419917 | 9da2e87a-5434-44d2-8653-190dde384209 ==============================
[0m11:04:02.419917 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:04:02.421922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt init', 'send_anonymous_usage_stats': 'True'}
[0m11:04:02.802035 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse dict {'dir': WindowsPath('C:/Users/–ö–∏—Ä–∏–ª–ª/.dbt')}
[0m11:04:02.804035 [info ] [MainThread]: Creating dbt configuration folder at 
[0m11:04:35.722112 [debug] [MainThread]: Starter project path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\include\starter_project
[0m11:04:35.738888 [info ] [MainThread]: 
Your new dbt project "dbt_example" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m11:04:35.738888 [info ] [MainThread]: Setting up your profile.
[0m13:52:05.296074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C316FF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C35077230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C35075310>]}


============================== 13:52:05.302902 | 1797bbf4-1a27-4fdf-baf8-6ddf26e5af10 ==============================
[0m13:52:05.302902 [info ] [MainThread]: Running with dbt=1.8.8
[0m13:52:05.303902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt init dbt_scooters', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:05.351345 [debug] [MainThread]: Starter project path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\include\starter_project
[0m13:52:05.370357 [info ] [MainThread]: 
Your new dbt project "dbt_scooters" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m13:52:05.372349 [info ] [MainThread]: Setting up your profile.
[0m13:52:19.887444 [error] [MainThread]: Encountered an error:
list index out of range
[0m13:52:19.894453 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\cli\main.py", line 470, in init
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\task\init.py", line 347, in run
    self.setup_profile(profile_name)
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\task\init.py", line 262, in setup_profile
    adapter = self.ask_for_adapter_choice()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\task\init.py", line 244, in ask_for_adapter_choice
    return available_adapters[numeric_choice - 1]
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
IndexError: list index out of range

[0m13:52:19.897449 [debug] [MainThread]: Command `dbt init` failed at 13:52:19.897449 after 14.81 seconds
[0m13:52:19.898451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C316FF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C35C403B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C35DDDC70>]}
[0m13:52:19.899450 [debug] [MainThread]: Flushing usage events
[0m13:52:36.509231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78A558B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7B8D9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7B8DB530>]}


============================== 13:52:36.513199 | 6b5932c2-a5a4-4b90-9665-2b92e0a42070 ==============================
[0m13:52:36.513199 [info ] [MainThread]: Running with dbt=1.8.8
[0m13:52:36.514396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt init dbt_scooters', 'send_anonymous_usage_stats': 'True'}
[0m13:52:36.542436 [info ] [MainThread]: A project called dbt_scooters already exists here.
[0m13:52:36.544444 [debug] [MainThread]: Command `dbt init` succeeded at 13:52:36.543420 after 0.14 seconds
[0m13:52:36.544444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78A558B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7CEDE1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7C9E1400>]}
[0m13:52:36.544444 [debug] [MainThread]: Flushing usage events
[0m13:57:20.326411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283694F05C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028368555910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002836C80B140>]}


============================== 13:57:20.331441 | cf7e9a90-ba58-485d-8038-a260a8e17681 ==============================
[0m13:57:20.331441 [info ] [MainThread]: Running with dbt=1.8.8
[0m13:57:20.332411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt init dbt_scooters', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:20.366986 [debug] [MainThread]: Starter project path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\include\starter_project
[0m13:57:20.385971 [info ] [MainThread]: 
Your new dbt project "dbt_scooters" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m13:57:20.386969 [info ] [MainThread]: Setting up your profile.
[0m14:00:38.164711 [info ] [MainThread]: Profile dbt_scooters written to C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m14:00:38.165738 [debug] [MainThread]: Command `dbt init` succeeded at 14:00:38.165738 after 197.96 seconds
[0m14:00:38.166744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002836C7CE930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002836CCA66F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002836B11DDC0>]}
[0m14:00:38.166744 [debug] [MainThread]: Flushing usage events
[0m14:07:27.602164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55E897C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55902570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55BAFE60>]}


============================== 14:07:27.607198 | 78ce7fe7-202c-48d3-8566-e8ec45270dac ==============================
[0m14:07:27.607198 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:07:27.607198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init dbt_scooters', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:27.641778 [debug] [MainThread]: Starter project path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\include\starter_project
[0m14:07:27.660555 [info ] [MainThread]: 
Your new dbt project "dbt_scooters" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m14:07:27.660555 [info ] [MainThread]: Setting up your profile.
[0m14:10:08.368522 [info ] [MainThread]: Profile dbt_scooters written to C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m14:10:08.370107 [debug] [MainThread]: Command `dbt init` succeeded at 14:10:08.370107 after 160.96 seconds
[0m14:10:08.370107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55BE01A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55BE0CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55A05DF0>]}
[0m14:10:08.371105 [debug] [MainThread]: Flushing usage events
[0m14:06:25.280447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119F1507BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119F1705D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119F0B65CD0>]}


============================== 14:06:25.292455 | 8bd29f6d-ecbd-4961-bb80-15509b7a103c ==============================
[0m14:06:25.292455 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:06:25.294456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'log_path': 'logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:25.384597 [info ] [MainThread]: dbt version: 1.8.8
[0m14:06:25.386638 [info ] [MainThread]: python version: 3.12.4
[0m14:06:25.388639 [info ] [MainThread]: python path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\python.exe
[0m14:06:25.390597 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m14:06:25.616436 [info ] [MainThread]: Using profiles dir at C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt
[0m14:06:25.617392 [info ] [MainThread]: Using profiles.yml file at C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt\profiles.yml
[0m14:06:25.619394 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml
[0m14:06:25.624451 [info ] [MainThread]: adapter type: postgres
[0m14:06:25.625444 [info ] [MainThread]: adapter version: 1.8.2
[0m14:06:25.627407 [info ] [MainThread]: Configuration:
[0m14:06:25.628403 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:06:25.630408 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:06:25.631405 [info ] [MainThread]: Required dependencies:
[0m14:06:25.633409 [debug] [MainThread]: Executing "git --help"
[0m14:06:25.706545 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:06:25.707545 [debug] [MainThread]: STDERR: "b''"
[0m14:06:25.708552 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:06:25.710563 [info ] [MainThread]: Connection:
[0m14:06:25.712566 [info ] [MainThread]:   host: dpg-cstl32lumphs73fqdrj0-a.oregon-postgres.render.com
[0m14:06:25.713573 [info ] [MainThread]:   port: 5432
[0m14:06:25.715564 [info ] [MainThread]:   user: admin
[0m14:06:25.716562 [info ] [MainThread]:   database: dev_oovf
[0m14:06:25.718563 [info ] [MainThread]:   schema: dbt
[0m14:06:25.720594 [info ] [MainThread]:   connect_timeout: 10
[0m14:06:25.721582 [info ] [MainThread]:   role: None
[0m14:06:25.723583 [info ] [MainThread]:   search_path: None
[0m14:06:25.724587 [info ] [MainThread]:   keepalives_idle: 0
[0m14:06:25.725584 [info ] [MainThread]:   sslmode: None
[0m14:06:25.726587 [info ] [MainThread]:   sslcert: None
[0m14:06:25.727590 [info ] [MainThread]:   sslkey: None
[0m14:06:25.729593 [info ] [MainThread]:   sslrootcert: None
[0m14:06:25.731610 [info ] [MainThread]:   application_name: dbt
[0m14:06:25.733606 [info ] [MainThread]:   retries: 1
[0m14:06:25.735603 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:06:25.737604 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:06:26.717455 [debug] [MainThread]: Using postgres connection "debug"
[0m14:06:26.718421 [debug] [MainThread]: On debug: select 1 as id
[0m14:06:26.718421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:27.667587 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "dpg-cstl32lumphs73fqdrj0-a.oregon-postgres.render.com" (35.227.164.209), port 5432 failed: SSL connection has been closed unexpectedly

[0m14:06:28.444921 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:06:28.445922 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:06:28.445922 [debug] [MainThread]: On debug: No close available on handle
[0m14:06:28.446922 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:06:28.447923 [info ] [MainThread]: [31m2 checks failed:[0m
[0m14:06:28.449434 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml> not found

[0m14:06:28.451443 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "dpg-cstl32lumphs73fqdrj0-a.oregon-postgres.render.com" (35.227.164.209), port 5432 failed: SSL connection has been closed unexpectedly
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:06:28.453443 [debug] [MainThread]: Command `dbt debug` failed at 14:06:28.453443 after 3.61 seconds
[0m14:06:28.454441 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:06:28.455443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119F149AF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119EF51F5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119F09BD610>]}
[0m14:06:28.456442 [debug] [MainThread]: Flushing usage events
[0m14:16:57.604435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C81EC4D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C816914C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C8441DD30>]}


============================== 14:16:57.609961 | 8beaa279-1c05-4f87-bf9a-96aa32e339ac ==============================
[0m14:16:57.609961 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:16:57.610962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:16:57.637036 [info ] [MainThread]: dbt version: 1.8.8
[0m14:16:57.638057 [info ] [MainThread]: python version: 3.12.4
[0m14:16:57.639051 [info ] [MainThread]: python path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\python.exe
[0m14:16:57.640052 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m14:16:57.765191 [info ] [MainThread]: Using profiles dir at C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt
[0m14:16:57.766186 [info ] [MainThread]: Using profiles.yml file at C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt\profiles.yml
[0m14:16:57.767191 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml
[0m14:16:57.769205 [info ] [MainThread]: adapter type: postgres
[0m14:16:57.770198 [info ] [MainThread]: adapter version: 1.8.2
[0m14:16:57.771204 [info ] [MainThread]: Configuration:
[0m14:16:57.772202 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:16:57.773201 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:16:57.774201 [info ] [MainThread]: Required dependencies:
[0m14:16:57.775208 [debug] [MainThread]: Executing "git --help"
[0m14:16:57.828278 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:16:57.829791 [debug] [MainThread]: STDERR: "b''"
[0m14:16:57.830803 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:16:57.831797 [info ] [MainThread]: Connection:
[0m14:16:57.832803 [info ] [MainThread]:   host: dpg-cu4f49rtq21c73cqam00-a.oregon-postgres.render.com
[0m14:16:57.833806 [info ] [MainThread]:   port: 5432
[0m14:16:57.834808 [info ] [MainThread]:   user: admin
[0m14:16:57.835807 [info ] [MainThread]:   database: dev_3lcu
[0m14:16:57.837324 [info ] [MainThread]:   schema: dbt
[0m14:16:57.838336 [info ] [MainThread]:   connect_timeout: 10
[0m14:16:57.840338 [info ] [MainThread]:   role: None
[0m14:16:57.841341 [info ] [MainThread]:   search_path: None
[0m14:16:57.842345 [info ] [MainThread]:   keepalives_idle: 0
[0m14:16:57.843341 [info ] [MainThread]:   sslmode: None
[0m14:16:57.844339 [info ] [MainThread]:   sslcert: None
[0m14:16:57.845346 [info ] [MainThread]:   sslkey: None
[0m14:16:57.846344 [info ] [MainThread]:   sslrootcert: None
[0m14:16:57.847355 [info ] [MainThread]:   application_name: dbt
[0m14:16:57.848360 [info ] [MainThread]:   retries: 1
[0m14:16:57.849354 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:16:57.851362 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:16:57.983018 [debug] [MainThread]: Using postgres connection "debug"
[0m14:16:57.984019 [debug] [MainThread]: On debug: select 1 as id
[0m14:16:57.984019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:01.726035 [debug] [MainThread]: SQL status: SELECT 1 in 3.741 seconds
[0m14:17:01.727035 [debug] [MainThread]: On debug: Close
[0m14:17:01.728069 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:17:01.729032 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:17:01.730036 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml> not found

[0m14:17:01.732034 [debug] [MainThread]: Command `dbt debug` failed at 14:17:01.731036 after 4.44 seconds
[0m14:17:01.732034 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:17:01.733071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C8441DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C84BBF500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C839E4D40>]}
[0m14:17:01.734034 [debug] [MainThread]: Flushing usage events
[0m16:50:57.531694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990A452000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990C6585C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990C659190>]}


============================== 16:50:57.538706 | 20fdb56c-b56b-4f9b-b172-9784803d7d2e ==============================
[0m16:50:57.538706 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:50:57.539704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s trips_stat', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:50:57.541739 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:50:57.543703 [debug] [MainThread]: Command `dbt run` failed at 16:50:57.543703 after 0.36 seconds
[0m16:50:57.544706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990CE5FA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990A452000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990CCED460>]}
[0m16:50:57.545706 [debug] [MainThread]: Flushing usage events
[0m17:23:11.143983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C1F87D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C1F87F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C1F87500>]}


============================== 17:23:11.151054 | 7ae652cd-8b06-49fb-9ac9-52c9dd338b07 ==============================
[0m17:23:11.151054 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:23:11.152008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:23:11.153011 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m17:23:11.155008 [debug] [MainThread]: Command `dbt seed` failed at 17:23:11.155008 after 0.35 seconds
[0m17:23:11.156013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C216C5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C2145EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C23B4740>]}
[0m17:23:11.157425 [debug] [MainThread]: Flushing usage events
[0m22:31:50.720835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293134C5FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029316AA6CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029313625A60>]}


============================== 22:31:50.730845 | ea7bb894-dacf-4e9c-9513-b072bff12f0a ==============================
[0m22:31:50.730845 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:31:50.731850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\pythonProject1\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:31:51.088874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293171B4B60>]}
[0m22:31:51.179005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029314AA6B10>]}
[0m22:31:51.183014 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:31:51.547293 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:31:51.760987 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m22:31:51.761986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293166F17C0>]}
[0m22:31:54.535006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293186541A0>]}
[0m22:31:54.814695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029317006CC0>]}
[0m22:31:54.816697 [info ] [MainThread]: Found 19 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 437 macros
[0m22:31:54.828695 [info ] [MainThread]: 
[0m22:31:54.830701 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:31:54.839700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m22:31:54.856085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m22:31:55.126900 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m22:31:55.127899 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m22:31:55.128908 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m22:31:55.128908 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m22:31:55.129907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:55.130903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:58.057976 [debug] [ThreadPool]: SQL status: SELECT 21 in 2.927 seconds
[0m22:31:58.059939 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m22:31:58.245780 [debug] [ThreadPool]: SQL status: SELECT 21 in 3.116 seconds
[0m22:31:58.247281 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m22:31:58.251848 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_dbt'
[0m22:31:58.257887 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m22:31:58.258852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_finance'
[0m22:31:58.258852 [debug] [ThreadPool]: On list_dev_3lcu_dbt: BEGIN
[0m22:31:58.260899 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m22:31:58.261890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:58.262852 [debug] [ThreadPool]: On list_dev_3lcu_finance: BEGIN
[0m22:31:58.262852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:01.031073 [debug] [ThreadPool]: SQL status: BEGIN in 2.769 seconds
[0m22:32:01.032067 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m22:32:01.033054 [debug] [ThreadPool]: On list_dev_3lcu_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_dbt"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m22:32:01.374993 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.342 seconds
[0m22:32:01.376988 [debug] [ThreadPool]: On list_dev_3lcu_dbt: ROLLBACK
[0m22:32:01.714123 [debug] [ThreadPool]: On list_dev_3lcu_dbt: Close
[0m22:32:02.261241 [debug] [ThreadPool]: SQL status: BEGIN in 3.998 seconds
[0m22:32:02.262241 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m22:32:02.262241 [debug] [ThreadPool]: On list_dev_3lcu_finance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_finance"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m22:32:02.649914 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.387 seconds
[0m22:32:02.651953 [debug] [ThreadPool]: On list_dev_3lcu_finance: ROLLBACK
[0m22:32:03.013025 [debug] [ThreadPool]: On list_dev_3lcu_finance: Close
[0m22:32:03.019971 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:03.019971 [debug] [MainThread]: On master: BEGIN
[0m22:32:03.020971 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:32:06.772165 [debug] [MainThread]: SQL status: BEGIN in 3.751 seconds
[0m22:32:06.773118 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:06.773118 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:32:07.239755 [debug] [MainThread]: SQL status: SELECT 4 in 0.465 seconds
[0m22:32:07.241757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293186D2A80>]}
[0m22:32:07.242754 [debug] [MainThread]: On master: ROLLBACK
[0m22:32:07.579668 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:07.579668 [debug] [MainThread]: On master: BEGIN
[0m22:32:08.257861 [debug] [MainThread]: SQL status: BEGIN in 0.677 seconds
[0m22:32:08.258814 [debug] [MainThread]: On master: COMMIT
[0m22:32:08.258814 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:08.259814 [debug] [MainThread]: On master: COMMIT
[0m22:32:08.608727 [debug] [MainThread]: SQL status: COMMIT in 0.349 seconds
[0m22:32:08.609721 [debug] [MainThread]: On master: Close
[0m22:32:08.610685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:32:08.611680 [info ] [MainThread]: 
[0m22:32:08.619680 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.add_first_name_sex
[0m22:32:08.620690 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m22:32:08.620690 [debug] [Thread-3 (]: Began running node seed.dbt_scooters.event_types
[0m22:32:08.621697 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.scooters
[0m22:32:08.622688 [info ] [Thread-1 (]: 1 of 51 START seed file dbt.add_first_name_sex ................................. [RUN]
[0m22:32:08.623687 [info ] [Thread-2 (]: 2 of 51 START seed file dbt.age_groups ......................................... [RUN]
[0m22:32:08.624690 [info ] [Thread-3 (]: 3 of 51 START seed file dbt.event_types ........................................ [RUN]
[0m22:32:08.625688 [info ] [Thread-4 (]: 4 of 51 START seed file dbt.scooters ........................................... [RUN]
[0m22:32:08.625688 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.dbt_scooters.add_first_name_sex'
[0m22:32:08.626694 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.dbt_scooters.age_groups'
[0m22:32:08.627725 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.dbt_scooters.event_types'
[0m22:32:08.628687 [debug] [Thread-4 (]: Acquiring new postgres connection 'seed.dbt_scooters.scooters'
[0m22:32:08.628687 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.add_first_name_sex
[0m22:32:08.629725 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m22:32:08.629725 [debug] [Thread-3 (]: Began compiling node seed.dbt_scooters.event_types
[0m22:32:08.630730 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.scooters
[0m22:32:08.630730 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.add_first_name_sex
[0m22:32:08.631687 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m22:32:08.631687 [debug] [Thread-3 (]: Began executing node seed.dbt_scooters.event_types
[0m22:32:08.632689 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.scooters
[0m22:32:08.667211 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:08.671728 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:08.679730 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:08.680739 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: BEGIN
[0m22:32:08.684739 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:08.685737 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m22:32:08.685737 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: BEGIN
[0m22:32:08.686737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:32:08.686737 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: BEGIN
[0m22:32:08.687735 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:32:08.688739 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:32:08.689738 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:32:11.392783 [debug] [Thread-1 (]: SQL status: BEGIN in 2.706 seconds
[0m22:32:11.393741 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:11.393741 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */
truncate table "dev_3lcu"."dbt"."add_first_name_sex"
[0m22:32:11.467794 [debug] [Thread-3 (]: SQL status: BEGIN in 2.779 seconds
[0m22:32:11.468343 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:11.468343 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_3lcu"."dbt"."event_types"
[0m22:32:11.469891 [debug] [Thread-2 (]: SQL status: BEGIN in 2.782 seconds
[0m22:32:11.469891 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:11.470941 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_3lcu"."dbt"."age_groups"
[0m22:32:11.492897 [debug] [Thread-4 (]: SQL status: BEGIN in 2.803 seconds
[0m22:32:11.493900 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:11.493900 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_3lcu"."dbt"."scooters"
[0m22:32:11.737836 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.343 seconds
[0m22:32:11.753836 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:11.754838 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: 
          insert into "dev_3lcu"."dbt"."add_first_name_sex" ("first_name", "sex") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m22:32:11.814703 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.346 seconds
[0m22:32:11.817696 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:11.817696 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_3lcu"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m22:32:11.834660 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.363 seconds
[0m22:32:11.837699 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:11.838698 [debug] [Thread-4 (]: SQL status: TRUNCATE TABLE in 0.344 seconds
[0m22:32:11.838698 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_3lcu"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m22:32:11.842697 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:11.843696 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_3lcu"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m22:32:12.096055 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.341 seconds
[0m22:32:12.102020 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.add_first_name_sex"
[0m22:32:12.127039 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:12.128039 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  comment on table "dev_3lcu"."dbt"."add_first_name_sex" is $dbt_comment_literal_block$additional name_sex glossary$dbt_comment_literal_block$;

  
[0m22:32:12.157081 [debug] [Thread-3 (]: SQL status: INSERT 0 4 in 0.339 seconds
[0m22:32:12.158079 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m22:32:12.161080 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:12.162079 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  comment on table "dev_3lcu"."dbt"."event_types" is $dbt_comment_literal_block$Table provides a mapping between unique event type identifiers (`type_id`) and their descriptive names (`type`). It is essential for converting numerical codes from user activity logs into readable descriptions for analysis of user interactions with application features.

The table is crucial for analytics and reporting, allowing for the decoding of event identifiers in user activity datasets. By joining with event logs, it facilitates intuitive reporting and dashboarding of user interactions. The mapping enables effective segmentation and analysis of user activities, such as:

- **start_search**: Represents the initiation of a search process by a user.
- **book_scooter**: Indicates that a user has booked a scooter.
- **release_scooter**: Signifies that a user has released a previously booked scooter.
- **cancel_search**: Denotes the cancellation of a search process by a user.$dbt_comment_literal_block$;

  
[0m22:32:12.185709 [debug] [Thread-4 (]: SQL status: INSERT 0 10 in 0.341 seconds
[0m22:32:12.186710 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m22:32:12.189705 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:12.189705 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  comment on table "dev_3lcu"."dbt"."scooters" is $dbt_comment_literal_block$Scooter models information and park statistics by model. Includes information about the manufacturing company. Data received from the service team and uploaded by Mark. Data is current as of summer 2023.
$dbt_comment_literal_block$;

  
[0m22:32:12.191712 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.348 seconds
[0m22:32:12.192712 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m22:32:12.194713 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:12.195712 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  comment on table "dev_3lcu"."dbt"."age_groups" is $dbt_comment_literal_block$Age groups to split users for analysis$dbt_comment_literal_block$;

  
[0m22:32:12.465970 [debug] [Thread-1 (]: SQL status: COMMENT in 0.338 seconds
[0m22:32:12.488953 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:12.488953 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'add_first_name_sex'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:12.498965 [debug] [Thread-3 (]: SQL status: COMMENT in 0.336 seconds
[0m22:32:12.502002 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:12.503000 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'event_types'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:12.526958 [debug] [Thread-4 (]: SQL status: COMMENT in 0.337 seconds
[0m22:32:12.530959 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:12.531962 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'scooters'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:12.531962 [debug] [Thread-2 (]: SQL status: COMMENT in 0.336 seconds
[0m22:32:12.534959 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:12.535959 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'age_groups'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:12.843711 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.353 seconds
[0m22:32:12.847711 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:12.848712 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."add_first_name_sex".first_name is $dbt_comment_literal_block$First name of user$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."add_first_name_sex".sex is $dbt_comment_literal_block$user gender$dbt_comment_literal_block$;
  

  
[0m22:32:12.936943 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.404 seconds
[0m22:32:12.938908 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:12.939945 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".company is $dbt_comment_literal_block$Scooter company model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".model is $dbt_comment_literal_block$Scooter model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".hardware_id is $dbt_comment_literal_block$scooter model id$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".scooters is $dbt_comment_literal_block$Count of scooters$dbt_comment_literal_block$;
  

  
[0m22:32:13.040692 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.537 seconds
[0m22:32:13.040692 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.505 seconds
[0m22:32:13.042741 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:13.045734 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:13.045734 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."event_types".type_id is $dbt_comment_literal_block$An integer serving as a unique identifier for each event type. It is used in user event tables as a foreign key to link events to their descriptions
$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."event_types".type is $dbt_comment_literal_block$A string describing the event type, enhancing the interpretability of event data by providing a human-readable label
$dbt_comment_literal_block$;
  

  
[0m22:32:13.046730 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".group is $dbt_comment_literal_block$Age group name for report$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".age_start is $dbt_comment_literal_block$Start age of group$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".age_end is $dbt_comment_literal_block$End age of group$dbt_comment_literal_block$;
  

  
[0m22:32:13.187112 [debug] [Thread-1 (]: SQL status: COMMENT in 0.338 seconds
[0m22:32:13.189068 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m22:32:13.190075 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:13.190075 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m22:32:13.275324 [debug] [Thread-4 (]: SQL status: COMMENT in 0.335 seconds
[0m22:32:13.276325 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m22:32:13.277328 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:13.277328 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m22:32:13.463047 [debug] [Thread-3 (]: SQL status: COMMENT in 0.415 seconds
[0m22:32:13.465044 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m22:32:13.465044 [debug] [Thread-2 (]: SQL status: COMMENT in 0.418 seconds
[0m22:32:13.466042 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:13.467049 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m22:32:13.468042 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m22:32:13.469011 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:13.469011 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m22:32:13.530028 [debug] [Thread-1 (]: SQL status: COMMIT in 0.339 seconds
[0m22:32:13.532029 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: Close
[0m22:32:13.534031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319297230>]}
[0m22:32:13.535029 [info ] [Thread-1 (]: 1 of 51 OK loaded seed file dbt.add_first_name_sex ............................. [[32mINSERT 5[0m in 4.91s]
[0m22:32:13.536034 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.add_first_name_sex
[0m22:32:13.537034 [debug] [Thread-1 (]: Began running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m22:32:13.538030 [info ] [Thread-1 (]: 5 of 51 START test every_event_has_user ........................................ [RUN]
[0m22:32:13.538030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.add_first_name_sex, now test.dbt_scooters.every_event_has_user.7eea25f36c)
[0m22:32:13.539032 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m22:32:13.550047 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m22:32:13.551051 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m22:32:13.569566 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m22:32:13.571573 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m22:32:13.571573 [debug] [Thread-1 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: BEGIN
[0m22:32:13.572575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:13.613613 [debug] [Thread-4 (]: SQL status: COMMIT in 0.336 seconds
[0m22:32:13.615611 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: Close
[0m22:32:13.616611 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293191587D0>]}
[0m22:32:13.616611 [info ] [Thread-4 (]: 4 of 51 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 4.99s]
[0m22:32:13.618612 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.scooters
[0m22:32:13.618612 [debug] [Thread-4 (]: Began running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m22:32:13.619615 [info ] [Thread-4 (]: 6 of 51 START test every_trip_has_user ......................................... [RUN]
[0m22:32:13.620623 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now test.dbt_scooters.every_trip_has_user.6bc71135e2)
[0m22:32:13.621623 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m22:32:13.627626 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m22:32:13.629626 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m22:32:13.631631 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m22:32:13.632631 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m22:32:13.633639 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: BEGIN
[0m22:32:13.634639 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:14.011943 [debug] [Thread-3 (]: SQL status: COMMIT in 0.542 seconds
[0m22:32:14.012943 [debug] [Thread-2 (]: SQL status: COMMIT in 0.542 seconds
[0m22:32:14.013982 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: Close
[0m22:32:14.014983 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m22:32:14.015940 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931915B050>]}
[0m22:32:14.015940 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931926FDA0>]}
[0m22:32:14.016993 [info ] [Thread-3 (]: 3 of 51 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 5.39s]
[0m22:32:14.017944 [info ] [Thread-2 (]: 2 of 51 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 5.39s]
[0m22:32:14.019943 [debug] [Thread-3 (]: Finished running node seed.dbt_scooters.event_types
[0m22:32:14.020942 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m22:32:14.021942 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:32:14.022943 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m22:32:14.023940 [info ] [Thread-3 (]: 7 of 51 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m22:32:14.024946 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m22:32:14.023940 [info ] [Thread-2 (]: 8 of 51 START test source_not_null_scooters_raw_events_type_id ................. [RUN]
[0m22:32:14.025950 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:32:14.026948 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7)
[0m22:32:14.031979 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:32:14.032942 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m22:32:14.042981 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m22:32:14.043982 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:32:14.046939 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:32:14.047945 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m22:32:14.049949 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m22:32:14.050953 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:32:14.051951 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m22:32:14.051951 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:14.052955 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m22:32:14.053953 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: BEGIN
[0m22:32:14.053953 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:16.351767 [debug] [Thread-4 (]: SQL status: BEGIN in 2.718 seconds
[0m22:32:16.352766 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m22:32:16.353768 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_user.6bc71135e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:32:16.369773 [debug] [Thread-1 (]: SQL status: BEGIN in 2.797 seconds
[0m22:32:16.369773 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m22:32:16.369773 [debug] [Thread-1 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_user.7eea25f36c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:32:16.935691 [debug] [Thread-2 (]: SQL status: BEGIN in 2.882 seconds
[0m22:32:16.936692 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m22:32:16.937692 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from "dev_3lcu"."scooters_raw"."events"
where type_id is null



      
    ) dbt_internal_test
[0m22:32:16.937692 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.584 seconds
[0m22:32:16.941701 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: ROLLBACK
[0m22:32:16.966705 [debug] [Thread-3 (]: SQL status: BEGIN in 2.915 seconds
[0m22:32:16.967710 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:32:16.967710 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m22:32:17.342020 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: Close
[0m22:32:17.344023 [info ] [Thread-4 (]: 6 of 51 PASS every_trip_has_user ............................................... [[32mPASS[0m in 3.72s]
[0m22:32:17.345025 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m22:32:17.345025 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m22:32:17.346028 [info ] [Thread-4 (]: 9 of 51 START test source_not_null_scooters_raw_events_user_id ................. [RUN]
[0m22:32:17.347021 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_user.6bc71135e2, now test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b)
[0m22:32:17.348022 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m22:32:17.352026 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m22:32:17.353028 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m22:32:17.356029 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m22:32:17.358028 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m22:32:17.358028 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: BEGIN
[0m22:32:17.359027 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:17.370038 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.401 seconds
[0m22:32:17.372037 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m22:32:17.741857 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m22:32:17.742859 [info ] [Thread-3 (]: 7 of 51 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 3.72s]
[0m22:32:17.743861 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:32:17.744862 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m22:32:17.745859 [info ] [Thread-3 (]: 10 of 51 START test source_not_null_scooters_raw_trips_id ...................... [RUN]
[0m22:32:17.745859 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d)
[0m22:32:17.746865 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m22:32:17.750866 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m22:32:17.753870 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m22:32:17.756867 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m22:32:17.757867 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m22:32:17.758873 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: BEGIN
[0m22:32:17.758873 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:18.142707 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.771 seconds
[0m22:32:18.144712 [debug] [Thread-1 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: ROLLBACK
[0m22:32:18.251804 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.313 seconds
[0m22:32:18.253811 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: ROLLBACK
[0m22:32:18.485002 [debug] [Thread-1 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: Close
[0m22:32:18.486004 [info ] [Thread-1 (]: 5 of 51 PASS every_event_has_user .............................................. [[32mPASS[0m in 4.95s]
[0m22:32:18.487004 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m22:32:18.488011 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m22:32:18.489012 [info ] [Thread-1 (]: 11 of 51 START test source_not_null_scooters_raw_trips_scooter_hw_id ........... [RUN]
[0m22:32:18.490003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_user.7eea25f36c, now test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f)
[0m22:32:18.490003 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m22:32:18.495050 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m22:32:18.496005 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m22:32:18.499008 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m22:32:18.501042 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m22:32:18.501042 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: BEGIN
[0m22:32:18.502047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:18.595612 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: Close
[0m22:32:18.596615 [info ] [Thread-2 (]: 8 of 51 PASS source_not_null_scooters_raw_events_type_id ....................... [[32mPASS[0m in 4.57s]
[0m22:32:18.597613 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m22:32:18.598653 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m22:32:18.599653 [info ] [Thread-2 (]: 12 of 51 START test source_not_null_scooters_raw_trips_user_id ................. [RUN]
[0m22:32:18.600615 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7, now test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62)
[0m22:32:18.601647 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m22:32:18.605609 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m22:32:18.607612 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m22:32:18.609647 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m22:32:18.611614 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m22:32:18.611614 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: BEGIN
[0m22:32:18.612611 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:20.949709 [debug] [Thread-4 (]: SQL status: BEGIN in 3.590 seconds
[0m22:32:20.949709 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m22:32:20.950720 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."events"
where user_id is null



      
    ) dbt_internal_test
[0m22:32:21.211931 [debug] [Thread-1 (]: SQL status: BEGIN in 2.710 seconds
[0m22:32:21.211931 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m22:32:21.212934 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select scooter_hw_id
from "dev_3lcu"."scooters_raw"."trips"
where scooter_hw_id is null



      
    ) dbt_internal_test
[0m22:32:21.337006 [debug] [Thread-2 (]: SQL status: BEGIN in 2.725 seconds
[0m22:32:21.338006 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m22:32:21.339008 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."trips"
where user_id is null



      
    ) dbt_internal_test
[0m22:32:21.390067 [debug] [Thread-3 (]: SQL status: BEGIN in 3.631 seconds
[0m22:32:21.391065 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m22:32:21.391065 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."trips"
where id is null



      
    ) dbt_internal_test
[0m22:32:21.540690 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.590 seconds
[0m22:32:21.542691 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: ROLLBACK
[0m22:32:21.654765 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.442 seconds
[0m22:32:21.656764 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: ROLLBACK
[0m22:32:21.839911 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.448 seconds
[0m22:32:21.841913 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: ROLLBACK
[0m22:32:21.841913 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.503 seconds
[0m22:32:21.843908 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: ROLLBACK
[0m22:32:21.933977 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: Close
[0m22:32:21.934982 [info ] [Thread-4 (]: 9 of 51 PASS source_not_null_scooters_raw_events_user_id ....................... [[32mPASS[0m in 4.59s]
[0m22:32:21.936981 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m22:32:21.936981 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m22:32:21.937983 [info ] [Thread-4 (]: 13 of 51 START test source_not_null_scooters_raw_users_id ...................... [RUN]
[0m22:32:21.938980 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b, now test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d)
[0m22:32:21.938980 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m22:32:21.943984 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m22:32:21.944985 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m22:32:21.949996 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m22:32:21.952002 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m22:32:21.952002 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: BEGIN
[0m22:32:21.952996 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:21.996040 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: Close
[0m22:32:21.997046 [info ] [Thread-1 (]: 11 of 51 PASS source_not_null_scooters_raw_trips_scooter_hw_id ................. [[32mPASS[0m in 3.51s]
[0m22:32:21.999050 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m22:32:22.000059 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:32:22.000059 [info ] [Thread-1 (]: 14 of 51 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m22:32:22.001061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m22:32:22.002058 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:32:22.063619 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:32:22.064618 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:32:22.067616 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:32:22.068615 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:32:22.069622 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m22:32:22.069622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:22.182736 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: Close
[0m22:32:22.183738 [info ] [Thread-2 (]: 12 of 51 PASS source_not_null_scooters_raw_trips_user_id ....................... [[32mPASS[0m in 3.58s]
[0m22:32:22.184737 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m22:32:22.185741 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m22:32:22.186733 [info ] [Thread-2 (]: 15 of 51 START test source_unique_scooters_raw_trips_id ........................ [RUN]
[0m22:32:22.187737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62, now test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4)
[0m22:32:22.187737 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m22:32:22.194743 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m22:32:22.195744 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m22:32:22.198745 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m22:32:22.200760 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m22:32:22.200760 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: BEGIN
[0m22:32:22.201748 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:22.203752 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: Close
[0m22:32:22.204749 [info ] [Thread-3 (]: 10 of 51 PASS source_not_null_scooters_raw_trips_id ............................ [[32mPASS[0m in 4.46s]
[0m22:32:22.205751 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m22:32:22.206752 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m22:32:22.207750 [info ] [Thread-3 (]: 16 of 51 START test source_unique_scooters_raw_users_id ........................ [RUN]
[0m22:32:22.207750 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d, now test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf)
[0m22:32:22.208751 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m22:32:22.212755 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m22:32:22.213754 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m22:32:22.216753 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m22:32:22.218763 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m22:32:22.219755 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: BEGIN
[0m22:32:22.219755 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:24.802925 [debug] [Thread-1 (]: SQL status: BEGIN in 2.733 seconds
[0m22:32:24.803931 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:32:24.803931 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sex
from "dev_3lcu"."scooters_raw"."users"
where sex is null



      
    ) dbt_internal_test
[0m22:32:24.810934 [debug] [Thread-4 (]: SQL status: BEGIN in 2.858 seconds
[0m22:32:24.811937 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m22:32:24.811937 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."users"
where id is null



      
    ) dbt_internal_test
[0m22:32:25.172018 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.367 seconds
[0m22:32:25.174019 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m22:32:25.178021 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.365 seconds
[0m22:32:25.180536 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: ROLLBACK
[0m22:32:25.301604 [debug] [Thread-2 (]: SQL status: BEGIN in 3.100 seconds
[0m22:32:25.301604 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m22:32:25.302606 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."trips"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:32:25.582172 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: Close
[0m22:32:25.583175 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m22:32:25.583175 [info ] [Thread-4 (]: 13 of 51 PASS source_not_null_scooters_raw_users_id ............................ [[32mPASS[0m in 3.64s]
[0m22:32:25.584172 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m22:32:25.586175 [debug] [Thread-4 (]: Began running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m22:32:25.585176 [warn ] [Thread-1 (]: 14 of 51 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 3.58s]
[0m22:32:25.588178 [info ] [Thread-4 (]: 17 of 51 START test accepted_values_add_first_name_sex_sex__M__F ............... [RUN]
[0m22:32:25.588178 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:32:25.589686 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d, now test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199)
[0m22:32:25.590697 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m22:32:25.592699 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m22:32:25.592699 [info ] [Thread-1 (]: 18 of 51 START test unique_not_null_add_first_name_sex_first_name .............. [RUN]
[0m22:32:25.597693 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m22:32:25.597693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f)
[0m22:32:25.598697 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m22:32:25.603694 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m22:32:25.604698 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m22:32:25.606699 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m22:32:25.607698 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m22:32:25.611693 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m22:32:25.611693 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m22:32:25.612696 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: BEGIN
[0m22:32:25.613696 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:25.614697 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m22:32:25.614697 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: BEGIN
[0m22:32:25.615698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:25.835792 [debug] [Thread-3 (]: SQL status: BEGIN in 3.616 seconds
[0m22:32:25.836796 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m22:32:25.837806 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."users"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:32:26.237781 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.400 seconds
[0m22:32:26.239775 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: ROLLBACK
[0m22:32:26.578803 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: Close
[0m22:32:26.580924 [info ] [Thread-3 (]: 16 of 51 PASS source_unique_scooters_raw_users_id .............................. [[32mPASS[0m in 4.37s]
[0m22:32:26.581923 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m22:32:26.582925 [debug] [Thread-3 (]: Began running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m22:32:26.583922 [info ] [Thread-3 (]: 19 of 51 START test every_trip_has_scooter_id .................................. [RUN]
[0m22:32:26.583922 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf, now test.dbt_scooters.every_trip_has_scooter_id.e0b845a190)
[0m22:32:26.584965 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m22:32:26.589962 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m22:32:26.591924 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m22:32:26.594961 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m22:32:26.596924 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m22:32:26.596924 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: BEGIN
[0m22:32:26.597959 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:26.646924 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.344 seconds
[0m22:32:26.649930 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: ROLLBACK
[0m22:32:26.986250 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: Close
[0m22:32:26.988218 [info ] [Thread-2 (]: 15 of 51 PASS source_unique_scooters_raw_trips_id .............................. [[32mPASS[0m in 4.80s]
[0m22:32:26.989763 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m22:32:26.990772 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m22:32:26.991771 [info ] [Thread-2 (]: 20 of 51 START test unique_key_scooters_company__model__hardware_id ............ [RUN]
[0m22:32:26.992772 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4, now test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e)
[0m22:32:26.993772 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m22:32:26.999772 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m22:32:27.001782 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m22:32:27.004785 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m22:32:27.007785 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m22:32:27.007785 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: BEGIN
[0m22:32:27.008780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:28.325890 [debug] [Thread-4 (]: SQL status: BEGIN in 2.712 seconds
[0m22:32:28.326891 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m22:32:28.327889 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."dbt"."add_first_name_sex"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m22:32:28.331903 [debug] [Thread-1 (]: SQL status: BEGIN in 2.716 seconds
[0m22:32:28.332911 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m22:32:28.333905 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "first_name"
from
    "dev_3lcu"."dbt"."add_first_name_sex"
group by
    1
having
    count(*) > 1 or "first_name" is null


      
    ) dbt_internal_test
[0m22:32:28.668630 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.339 seconds
[0m22:32:28.671629 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: ROLLBACK
[0m22:32:28.672636 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.338 seconds
[0m22:32:28.675633 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: ROLLBACK
[0m22:32:29.012939 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: Close
[0m22:32:29.013943 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: Close
[0m22:32:29.014944 [info ] [Thread-4 (]: 17 of 51 PASS accepted_values_add_first_name_sex_sex__M__F ..................... [[32mPASS[0m in 3.43s]
[0m22:32:29.016940 [info ] [Thread-1 (]: 18 of 51 PASS unique_not_null_add_first_name_sex_first_name .................... [[32mPASS[0m in 3.42s]
[0m22:32:29.018941 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m22:32:29.020953 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m22:32:29.021952 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m22:32:29.022949 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m22:32:29.023949 [info ] [Thread-4 (]: 21 of 51 START test unique_not_null_scooters_hardware_id ....................... [RUN]
[0m22:32:29.024952 [info ] [Thread-1 (]: 22 of 51 START test unique_not_null_scooters_model ............................. [RUN]
[0m22:32:29.025950 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199, now test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d)
[0m22:32:29.026951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f, now test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc)
[0m22:32:29.027949 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m22:32:29.028952 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m22:32:29.037960 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m22:32:29.043974 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m22:32:29.045971 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m22:32:29.047971 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m22:32:29.050979 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m22:32:29.054977 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m22:32:29.057978 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m22:32:29.058980 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m22:32:29.058980 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: BEGIN
[0m22:32:29.060991 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: BEGIN
[0m22:32:29.061996 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:29.062991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:29.671875 [debug] [Thread-2 (]: SQL status: BEGIN in 2.662 seconds
[0m22:32:29.671875 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m22:32:29.672875 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "company"::text ||
    
        "model"::text ||
    
        "hardware_id"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m22:32:30.032776 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.359 seconds
[0m22:32:30.035770 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: ROLLBACK
[0m22:32:30.372517 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: Close
[0m22:32:30.374516 [info ] [Thread-2 (]: 20 of 51 PASS unique_key_scooters_company__model__hardware_id .................. [[32mPASS[0m in 3.38s]
[0m22:32:30.375516 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m22:32:30.376517 [debug] [Thread-2 (]: Began running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m22:32:30.377516 [info ] [Thread-2 (]: 23 of 51 START test every_event_has_type ....................................... [RUN]
[0m22:32:30.379524 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e, now test.dbt_scooters.every_event_has_type.1e5fc977eb)
[0m22:32:30.380520 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m22:32:30.392541 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m22:32:30.394546 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m22:32:30.399548 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m22:32:30.402546 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m22:32:30.403552 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: BEGIN
[0m22:32:30.403552 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:30.467543 [debug] [Thread-3 (]: SQL status: BEGIN in 3.869 seconds
[0m22:32:30.468549 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m22:32:30.469572 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select scooter_hw_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where scooter_hw_id is not null
),

parent as (
    select hardware_id as to_field
    from "dev_3lcu"."dbt"."scooters"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:32:31.038756 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.568 seconds
[0m22:32:31.041763 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: ROLLBACK
[0m22:32:31.383612 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: Close
[0m22:32:31.384610 [info ] [Thread-3 (]: 19 of 51 PASS every_trip_has_scooter_id ........................................ [[32mPASS[0m in 4.80s]
[0m22:32:31.386116 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m22:32:31.387125 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m22:32:31.388128 [info ] [Thread-3 (]: 24 of 51 START test unique_not_null_event_types_type ........................... [RUN]
[0m22:32:31.388128 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_scooter_id.e0b845a190, now test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1)
[0m22:32:31.389635 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m22:32:31.394644 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m22:32:31.396650 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m22:32:31.399647 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m22:32:31.401659 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m22:32:31.402661 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: BEGIN
[0m22:32:31.402661 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:31.756787 [debug] [Thread-4 (]: SQL status: BEGIN in 2.695 seconds
[0m22:32:31.758792 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m22:32:31.759787 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "hardware_id"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "hardware_id" is null


      
    ) dbt_internal_test
[0m22:32:31.806940 [debug] [Thread-1 (]: SQL status: BEGIN in 2.744 seconds
[0m22:32:31.807942 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m22:32:31.808942 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "model"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "model" is null


      
    ) dbt_internal_test
[0m22:32:32.100787 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.341 seconds
[0m22:32:32.103785 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: ROLLBACK
[0m22:32:32.147815 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.338 seconds
[0m22:32:32.150826 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: ROLLBACK
[0m22:32:32.452796 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: Close
[0m22:32:32.455799 [info ] [Thread-4 (]: 21 of 51 PASS unique_not_null_scooters_hardware_id ............................. [[32mPASS[0m in 3.43s]
[0m22:32:32.459796 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m22:32:32.461811 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m22:32:32.463809 [info ] [Thread-4 (]: 25 of 51 START test unique_not_null_event_types_type_id ........................ [RUN]
[0m22:32:32.465806 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d, now test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85)
[0m22:32:32.467809 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m22:32:32.477806 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m22:32:32.480827 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m22:32:32.485832 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m22:32:32.487335 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m22:32:32.488347 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: BEGIN
[0m22:32:32.489856 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:32.525901 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: Close
[0m22:32:32.527903 [info ] [Thread-1 (]: 22 of 51 PASS unique_not_null_scooters_model ................................... [[32mPASS[0m in 3.50s]
[0m22:32:32.530919 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m22:32:32.532914 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m22:32:32.533911 [info ] [Thread-1 (]: 26 of 51 START test unique_not_null_age_groups_age_end ......................... [RUN]
[0m22:32:32.535915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc, now test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac)
[0m22:32:32.536914 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m22:32:32.547923 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m22:32:32.550926 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m22:32:32.554927 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m22:32:32.557928 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m22:32:32.559940 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: BEGIN
[0m22:32:32.560939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:33.141745 [debug] [Thread-2 (]: SQL status: BEGIN in 2.737 seconds
[0m22:32:33.142781 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m22:32:33.143782 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_type.1e5fc977eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where type_id is not null
),

parent as (
    select type_id as to_field
    from "dev_3lcu"."dbt"."event_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:32:34.153778 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.009 seconds
[0m22:32:34.156783 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: ROLLBACK
[0m22:32:34.237859 [debug] [Thread-3 (]: SQL status: BEGIN in 2.835 seconds
[0m22:32:34.238860 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m22:32:34.239871 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type" is null


      
    ) dbt_internal_test
[0m22:32:34.546701 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: Close
[0m22:32:34.547702 [info ] [Thread-2 (]: 23 of 51 PASS every_event_has_type ............................................. [[32mPASS[0m in 4.17s]
[0m22:32:34.549707 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m22:32:34.549707 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m22:32:34.550718 [info ] [Thread-2 (]: 27 of 51 START test unique_not_null_age_groups_age_start ....................... [RUN]
[0m22:32:34.551720 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_type.1e5fc977eb, now test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b)
[0m22:32:34.552716 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m22:32:34.558721 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m22:32:34.559719 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m22:32:34.562725 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m22:32:34.564726 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m22:32:34.564726 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: BEGIN
[0m22:32:34.565731 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:34.598269 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.358 seconds
[0m22:32:34.600798 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: ROLLBACK
[0m22:32:34.941632 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: Close
[0m22:32:34.943634 [info ] [Thread-3 (]: 24 of 51 PASS unique_not_null_event_types_type ................................. [[32mPASS[0m in 3.55s]
[0m22:32:34.944637 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m22:32:34.945640 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m22:32:34.945640 [info ] [Thread-3 (]: 28 of 51 START test unique_not_null_age_groups_group ........................... [RUN]
[0m22:32:34.947637 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1, now test.dbt_scooters.unique_not_null_age_groups_group.39342291f1)
[0m22:32:34.947637 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m22:32:34.954655 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m22:32:34.956650 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m22:32:34.959648 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m22:32:34.961666 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m22:32:34.962665 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: BEGIN
[0m22:32:34.962665 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:35.268581 [debug] [Thread-4 (]: SQL status: BEGIN in 2.779 seconds
[0m22:32:35.269562 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m22:32:35.270568 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type_id"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type_id" is null


      
    ) dbt_internal_test
[0m22:32:35.614706 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.344 seconds
[0m22:32:35.617671 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: ROLLBACK
[0m22:32:35.956668 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: Close
[0m22:32:35.957669 [info ] [Thread-4 (]: 25 of 51 PASS unique_not_null_event_types_type_id .............................. [[32mPASS[0m in 3.49s]
[0m22:32:35.959709 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m22:32:35.960670 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_clean
[0m22:32:35.961704 [info ] [Thread-4 (]: 29 of 51 START sql incremental model dbt.events_clean .......................... [RUN]
[0m22:32:35.962670 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85, now model.dbt_scooters.events_clean)
[0m22:32:35.963710 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_clean
[0m22:32:35.968695 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m22:32:35.970665 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_clean
[0m22:32:36.036804 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:36.037802 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp223236008807"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at

from
    "dev_3lcu"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."events_clean")
    

  );
  
  
[0m22:32:36.038803 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:36.202988 [debug] [Thread-1 (]: SQL status: BEGIN in 3.642 seconds
[0m22:32:36.203987 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m22:32:36.203987 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_end"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_end" is null


      
    ) dbt_internal_test
[0m22:32:36.546813 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.342 seconds
[0m22:32:36.548794 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: ROLLBACK
[0m22:32:36.884690 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: Close
[0m22:32:36.885691 [info ] [Thread-1 (]: 26 of 51 PASS unique_not_null_age_groups_age_end ............................... [[32mPASS[0m in 4.35s]
[0m22:32:36.886692 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m22:32:36.887698 [debug] [Thread-1 (]: Began running node model.dbt_scooters.first_name_sex
[0m22:32:36.888691 [info ] [Thread-1 (]: 30 of 51 START sql table model dbt.first_name_sex .............................. [RUN]
[0m22:32:36.889691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac, now model.dbt_scooters.first_name_sex)
[0m22:32:36.889691 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.first_name_sex
[0m22:32:36.893274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.first_name_sex"
[0m22:32:36.895279 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.first_name_sex
[0m22:32:36.911874 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.first_name_sex"
[0m22:32:36.914844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:36.915848 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: BEGIN
[0m22:32:36.916843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:37.326662 [debug] [Thread-2 (]: SQL status: BEGIN in 2.761 seconds
[0m22:32:37.327666 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m22:32:37.327666 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_start"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_start" is null


      
    ) dbt_internal_test
[0m22:32:37.666883 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.338 seconds
[0m22:32:37.669895 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: ROLLBACK
[0m22:32:37.699940 [debug] [Thread-3 (]: SQL status: BEGIN in 2.737 seconds
[0m22:32:37.700951 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m22:32:37.700951 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "group"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "group" is null


      
    ) dbt_internal_test
[0m22:32:38.009779 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: Close
[0m22:32:38.010784 [info ] [Thread-2 (]: 27 of 51 PASS unique_not_null_age_groups_age_start ............................. [[32mPASS[0m in 3.46s]
[0m22:32:38.012792 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m22:32:38.012792 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_concurrency
[0m22:32:38.013789 [info ] [Thread-2 (]: 31 of 51 START sql incremental model dbt.trips_concurrency ..................... [RUN]
[0m22:32:38.014783 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b, now model.dbt_scooters.trips_concurrency)
[0m22:32:38.015785 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m22:32:38.021792 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m22:32:38.022793 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m22:32:38.027798 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:38.028796 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp223238025793"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_3lcu"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_3lcu"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now()  as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m22:32:38.029797 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:38.066826 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.365 seconds
[0m22:32:38.068826 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: ROLLBACK
[0m22:32:38.408729 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: Close
[0m22:32:38.409731 [info ] [Thread-3 (]: 28 of 51 PASS unique_not_null_age_groups_group ................................. [[32mPASS[0m in 3.46s]
[0m22:32:38.412740 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m22:32:38.413744 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_geom
[0m22:32:38.414739 [info ] [Thread-3 (]: 32 of 51 START sql view model dbt.trips_geom ................................... [RUN]
[0m22:32:38.415743 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_group.39342291f1, now model.dbt_scooters.trips_geom)
[0m22:32:38.415743 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_geom
[0m22:32:38.419739 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m22:32:38.421749 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_geom
[0m22:32:38.444769 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m22:32:38.445773 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:38.446771 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m22:32:38.447772 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:39.638845 [debug] [Thread-4 (]: SQL status: SELECT 0 in 3.600 seconds
[0m22:32:39.642852 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:39.642852 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: BEGIN
[0m22:32:39.982612 [debug] [Thread-4 (]: SQL status: BEGIN in 0.339 seconds
[0m22:32:39.983613 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:39.983613 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp223236008807'
        
      order by ordinal_position

  
[0m22:32:40.215794 [debug] [Thread-1 (]: SQL status: BEGIN in 3.299 seconds
[0m22:32:40.216795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:40.216795 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

  
    

  create  table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp"
  
  
    as
  
  (
    select distinct first_name, sex
from "dev_3lcu"."scooters_raw"."users"
Where sex is not null
  );
  
[0m22:32:40.336889 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.352 seconds
[0m22:32:40.339896 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:40.340895 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:40.564555 [debug] [Thread-1 (]: SQL status: SELECT 387 in 0.347 seconds
[0m22:32:40.572561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:40.572561 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex" rename to "first_name_sex__dbt_backup"
[0m22:32:40.680646 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.339 seconds
[0m22:32:40.694653 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:40.695647 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp223236008807'
        
      order by ordinal_position

  
[0m22:32:40.941870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.368 seconds
[0m22:32:40.944876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:40.945871 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp" rename to "first_name_sex"
[0m22:32:41.035948 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.340 seconds
[0m22:32:41.040957 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:41.041955 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:41.334702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.388 seconds
[0m22:32:41.342708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:41.342708 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

    
  
  comment on table "dev_3lcu"."dbt"."first_name_sex" is $dbt_comment_literal_block$Unique name_sex glossary$dbt_comment_literal_block$;

  
[0m22:32:41.535855 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.494 seconds
[0m22:32:41.545859 [debug] [Thread-4 (]: 
    In "dev_3lcu"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:41.562873 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m22:32:41.564873 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:41.564873 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        
            delete from "dev_3lcu"."dbt"."events_clean"
            using "events_clean__dbt_tmp223236008807"
            where (
                
                    "events_clean__dbt_tmp223236008807".user_id = "dev_3lcu"."dbt"."events_clean".user_id
                    and 
                
                    "events_clean__dbt_tmp223236008807".timestamp = "dev_3lcu"."dbt"."events_clean".timestamp
                    and 
                
                    "events_clean__dbt_tmp223236008807".type_id = "dev_3lcu"."dbt"."events_clean".type_id
                    
                
                
            );
        
    

    insert into "dev_3lcu"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp223236008807"
    )
  
[0m22:32:41.686957 [debug] [Thread-1 (]: SQL status: COMMENT in 0.343 seconds
[0m22:32:41.687958 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m22:32:41.688955 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:41.688955 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m22:32:41.917638 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.352 seconds
[0m22:32:41.919638 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:41.920650 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_clean" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m22:32:42.034797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.345 seconds
[0m22:32:42.041838 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."first_name_sex__dbt_backup"
[0m22:32:42.047835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:42.047835 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
drop table if exists "dev_3lcu"."dbt"."first_name_sex__dbt_backup" cascade
[0m22:32:42.218852 [debug] [Thread-3 (]: SQL status: BEGIN in 3.771 seconds
[0m22:32:42.219894 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:42.219894 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_3lcu"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m22:32:42.264899 [debug] [Thread-4 (]: SQL status: COMMENT in 0.344 seconds
[0m22:32:42.266888 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: COMMIT
[0m22:32:42.267852 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:42.267852 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: COMMIT
[0m22:32:42.362757 [debug] [Thread-2 (]: SQL status: SELECT 0 in 4.333 seconds
[0m22:32:42.365758 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:42.366757 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m22:32:42.398308 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.350 seconds
[0m22:32:42.399881 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: Close
[0m22:32:42.400889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293187392E0>]}
[0m22:32:42.401890 [info ] [Thread-1 (]: 30 of 51 OK created sql table model dbt.first_name_sex ......................... [[32mSELECT 387[0m in 5.51s]
[0m22:32:42.402890 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.first_name_sex
[0m22:32:42.403893 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m22:32:42.403893 [info ] [Thread-1 (]: 33 of 51 START sql view model dbt.trips_prep ................................... [RUN]
[0m22:32:42.404890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.first_name_sex, now model.dbt_scooters.trips_prep)
[0m22:32:42.405932 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m22:32:42.408894 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m22:32:42.409937 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m22:32:42.414894 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m22:32:42.415927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:42.416935 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m22:32:42.416935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:42.558765 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.338 seconds
[0m22:32:42.561804 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:42.562809 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m22:32:42.620691 [debug] [Thread-4 (]: SQL status: COMMIT in 0.353 seconds
[0m22:32:42.622697 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: Close
[0m22:32:42.623689 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931968BFB0>]}
[0m22:32:42.623689 [info ] [Thread-4 (]: 29 of 51 OK created sql incremental model dbt.events_clean ..................... [[32mINSERT 0 0[0m in 6.66s]
[0m22:32:42.625651 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_clean
[0m22:32:42.625651 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies
[0m22:32:42.626688 [info ] [Thread-4 (]: 34 of 51 START sql table model dbt.companies ................................... [RUN]
[0m22:32:42.627688 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.companies)
[0m22:32:42.628670 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies
[0m22:32:42.631686 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m22:32:42.632689 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies
[0m22:32:42.636646 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m22:32:42.638646 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:42.639647 [debug] [Thread-4 (]: On model.dbt_scooters.companies: BEGIN
[0m22:32:42.639647 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:42.701955 [debug] [Thread-2 (]: SQL status: BEGIN in 0.334 seconds
[0m22:32:42.701955 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:42.702952 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp223238025793'
        
      order by ordinal_position

  
[0m22:32:42.898387 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.335 seconds
[0m22:32:42.902002 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:42.903001 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m22:32:43.056862 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.353 seconds
[0m22:32:43.059858 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:43.060857 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:43.243862 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.341 seconds
[0m22:32:43.247851 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:43.248805 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_geom" is $dbt_comment_literal_block$Trips prepared for geometry analysis$dbt_comment_literal_block$;

  
[0m22:32:43.408018 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.346 seconds
[0m22:32:43.411617 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:43.412578 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp223238025793'
        
      order by ordinal_position

  
[0m22:32:43.602210 [debug] [Thread-3 (]: SQL status: COMMENT in 0.353 seconds
[0m22:32:43.603211 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m22:32:43.604251 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:43.604251 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m22:32:43.761737 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.349 seconds
[0m22:32:43.764744 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:43.765744 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:43.945902 [debug] [Thread-3 (]: SQL status: COMMIT in 0.341 seconds
[0m22:32:43.948855 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_geom__dbt_backup"
[0m22:32:43.951895 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:43.952899 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_3lcu"."dbt"."trips_geom__dbt_backup" cascade
[0m22:32:44.123632 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.357 seconds
[0m22:32:44.125630 [debug] [Thread-2 (]: 
    In "dev_3lcu"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:44.131628 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m22:32:44.133630 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:44.134590 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_3lcu"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp223238025793"
    )


  
[0m22:32:44.290840 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.338 seconds
[0m22:32:44.292842 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: Close
[0m22:32:44.293841 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029318766E10>]}
[0m22:32:44.294884 [info ] [Thread-3 (]: 32 of 51 OK created sql view model dbt.trips_geom .............................. [[32mCREATE VIEW[0m in 5.88s]
[0m22:32:44.295847 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_geom
[0m22:32:44.296888 [debug] [Thread-3 (]: Began running node model.dbt_scooters.users_full
[0m22:32:44.296888 [info ] [Thread-3 (]: 35 of 51 START sql table model dbt.users_full .................................. [RUN]
[0m22:32:44.298399 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.users_full)
[0m22:32:44.298399 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.users_full
[0m22:32:44.302966 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.users_full"
[0m22:32:44.304967 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.users_full
[0m22:32:44.308970 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.users_full"
[0m22:32:44.309964 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:44.310964 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: BEGIN
[0m22:32:44.310964 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:44.534757 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.400 seconds
[0m22:32:44.536757 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:44.536757 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_concurrency" is $dbt_comment_literal_block$Number of simultaneous rides in time$dbt_comment_literal_block$;

  
[0m22:32:44.900231 [debug] [Thread-2 (]: SQL status: COMMENT in 0.362 seconds
[0m22:32:44.902231 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m22:32:44.902231 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:44.903220 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m22:32:45.202858 [debug] [Thread-1 (]: SQL status: BEGIN in 2.785 seconds
[0m22:32:45.203860 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:45.203860 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_3lcu"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select
    id,
    user_id,
    scooter_hw_id,
    started_at,
    finished_at,
    start_lat,
    start_lon,
    finish_lat,
    finish_lon,
    distance as distance_m,
    cast(price as decimal(20, 2)) / 100 as price_rub,
    extract(epoch from (finished_at - started_at)) as duration_s,
    finished_at <> started_at and price = 0 as is_free,
    
    date(started_at at time zone 'Europe/Moscow')
 as "date"
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m22:32:45.239861 [debug] [Thread-2 (]: SQL status: COMMIT in 0.337 seconds
[0m22:32:45.242860 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: Close
[0m22:32:45.243858 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293189D0B60>]}
[0m22:32:45.245861 [info ] [Thread-2 (]: 31 of 51 OK created sql incremental model dbt.trips_concurrency ................ [[32mINSERT 0 0[0m in 7.23s]
[0m22:32:45.246863 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m22:32:45.247862 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_full
[0m22:32:45.248862 [info ] [Thread-2 (]: 36 of 51 START sql view model dbt.events_full .................................. [RUN]
[0m22:32:45.249863 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.events_full)
[0m22:32:45.249863 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_full
[0m22:32:45.253859 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m22:32:45.254861 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_full
[0m22:32:45.258862 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m22:32:45.260863 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:45.261863 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: BEGIN
[0m22:32:45.261863 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:45.467775 [debug] [Thread-4 (]: SQL status: BEGIN in 2.827 seconds
[0m22:32:45.467775 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:45.468742 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_3lcu"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
  );
  
[0m22:32:45.550897 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.346 seconds
[0m22:32:45.554898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:45.555901 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m22:32:45.813090 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.344 seconds
[0m22:32:45.817084 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:45.818095 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies" rename to "companies__dbt_backup"
[0m22:32:45.891697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.335 seconds
[0m22:32:45.895657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:45.895657 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m22:32:46.163652 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.345 seconds
[0m22:32:46.168649 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:46.169649 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies__dbt_tmp" rename to "companies"
[0m22:32:46.230818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.334 seconds
[0m22:32:46.232765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:46.233765 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_prep" is $dbt_comment_literal_block$Trips prepared for analysis$dbt_comment_literal_block$;

  
[0m22:32:46.506456 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m22:32:46.508452 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:46.509957 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies" is $dbt_comment_literal_block$Scooter statistics by company$dbt_comment_literal_block$;

  
[0m22:32:46.571577 [debug] [Thread-1 (]: SQL status: COMMENT in 0.337 seconds
[0m22:32:46.573578 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m22:32:46.573578 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:46.574577 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m22:32:46.847560 [debug] [Thread-4 (]: SQL status: COMMENT in 0.337 seconds
[0m22:32:46.848559 [debug] [Thread-4 (]: On model.dbt_scooters.companies: COMMIT
[0m22:32:46.849561 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:46.850525 [debug] [Thread-4 (]: On model.dbt_scooters.companies: COMMIT
[0m22:32:46.909718 [debug] [Thread-1 (]: SQL status: COMMIT in 0.335 seconds
[0m22:32:46.912726 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_prep__dbt_backup"
[0m22:32:46.913726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:46.914725 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_3lcu"."dbt"."trips_prep__dbt_backup" cascade
[0m22:32:47.009914 [debug] [Thread-3 (]: SQL status: BEGIN in 2.699 seconds
[0m22:32:47.010959 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:47.011924 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

  
    

  create  table "dev_3lcu"."dbt"."users_full__dbt_tmp"
  
  
    as
  
  (
    select
   u.id, u.first_name ,u.last_name ,u.phone ,
   COALESCE(u.sex, fns.sex, afns.sex) as sex2,
   u.birth_date
from "dev_3lcu"."scooters_raw"."users" u
left join "dev_3lcu"."dbt"."first_name_sex" fns on u.first_name = fns.first_name
left join "dev_3lcu"."dbt"."add_first_name_sex" afns on u.first_name =afns.first_name
  );
  
[0m22:32:47.190571 [debug] [Thread-4 (]: SQL status: COMMIT in 0.340 seconds
[0m22:32:47.193567 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."companies__dbt_backup"
[0m22:32:47.194530 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:47.194530 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_3lcu"."dbt"."companies__dbt_backup" cascade
[0m22:32:47.251737 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.336 seconds
[0m22:32:47.252738 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m22:32:47.253737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319179DC0>]}
[0m22:32:47.254738 [info ] [Thread-1 (]: 33 of 51 OK created sql view model dbt.trips_prep .............................. [[32mCREATE VIEW[0m in 4.85s]
[0m22:32:47.255740 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m22:32:47.256779 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m22:32:47.257738 [info ] [Thread-1 (]: 37 of 51 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m22:32:47.258739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.parking_finish_stat)
[0m22:32:47.258739 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m22:32:47.261777 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m22:32:47.263765 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m22:32:47.267785 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m22:32:47.269771 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:32:47.269771 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m22:32:47.270740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:47.361603 [debug] [Thread-3 (]: SQL status: SELECT 2000 in 0.350 seconds
[0m22:32:47.365598 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:47.366558 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full" rename to "users_full__dbt_backup"
[0m22:32:47.536937 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.342 seconds
[0m22:32:47.539928 [debug] [Thread-4 (]: On model.dbt_scooters.companies: Close
[0m22:32:47.540927 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319179B20>]}
[0m22:32:47.540927 [info ] [Thread-4 (]: 34 of 51 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 4.91s]
[0m22:32:47.542887 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies
[0m22:32:47.542887 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_start_stat
[0m22:32:47.543925 [info ] [Thread-4 (]: 38 of 51 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m22:32:47.544889 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.parking_start_stat)
[0m22:32:47.545889 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m22:32:47.548890 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m22:32:47.550886 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m22:32:47.555914 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m22:32:47.556926 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:32:47.557886 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m22:32:47.557886 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:47.705146 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m22:32:47.708106 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:47.709615 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full__dbt_tmp" rename to "users_full"
[0m22:32:47.994664 [debug] [Thread-2 (]: SQL status: BEGIN in 2.733 seconds
[0m22:32:47.995661 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:47.995661 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_3lcu"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select * from
"dev_3lcu"."dbt"."events_clean" as e
left join "dev_3lcu"."dbt"."event_types" as t
using (type_id)
  );
[0m22:32:48.049876 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.340 seconds
[0m22:32:48.051876 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:48.052873 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

    
  
  comment on table "dev_3lcu"."dbt"."users_full" is $dbt_comment_literal_block$Users enriched with sex$dbt_comment_literal_block$;

  
[0m22:32:48.349649 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.353 seconds
[0m22:32:48.353638 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:48.354637 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m22:32:48.391650 [debug] [Thread-3 (]: SQL status: COMMENT in 0.339 seconds
[0m22:32:48.393640 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: COMMIT
[0m22:32:48.394640 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:48.394640 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: COMMIT
[0m22:32:48.691532 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.336 seconds
[0m22:32:48.697487 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:48.698487 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m22:32:48.735640 [debug] [Thread-3 (]: SQL status: COMMIT in 0.340 seconds
[0m22:32:48.738641 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."users_full__dbt_backup"
[0m22:32:48.739681 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:48.739681 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
drop table if exists "dev_3lcu"."dbt"."users_full__dbt_backup" cascade
[0m22:32:49.035707 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m22:32:49.037701 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:49.038699 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

    
  
  comment on view "dev_3lcu"."dbt"."events_full" is $dbt_comment_literal_block$User events enriched with meaningful types$dbt_comment_literal_block$;

  
[0m22:32:49.083716 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.343 seconds
[0m22:32:49.085725 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: Close
[0m22:32:49.086701 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293189F0200>]}
[0m22:32:49.087704 [info ] [Thread-3 (]: 35 of 51 OK created sql table model dbt.users_full ............................. [[32mSELECT 2000[0m in 4.79s]
[0m22:32:49.088718 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.users_full
[0m22:32:49.089704 [debug] [Thread-3 (]: Began running node model.dbt_scooters.revenue_daily
[0m22:32:49.089704 [info ] [Thread-3 (]: 39 of 51 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m22:32:49.090741 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.users_full, now model.dbt_scooters.revenue_daily)
[0m22:32:49.091745 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m22:32:49.095740 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m22:32:49.097704 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.revenue_daily
[0m22:32:49.101735 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:49.102736 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp223249099738"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_3lcu"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m22:32:49.102736 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:49.374757 [debug] [Thread-2 (]: SQL status: COMMENT in 0.336 seconds
[0m22:32:49.376789 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: COMMIT
[0m22:32:49.376789 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:49.377757 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: COMMIT
[0m22:32:49.718836 [debug] [Thread-2 (]: SQL status: COMMIT in 0.340 seconds
[0m22:32:49.721873 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."events_full__dbt_backup"
[0m22:32:49.722833 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:49.722833 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_3lcu"."dbt"."events_full__dbt_backup" cascade
[0m22:32:50.060949 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.337 seconds
[0m22:32:50.062955 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: Close
[0m22:32:50.063911 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931972F8F0>]}
[0m22:32:50.064951 [info ] [Thread-2 (]: 36 of 51 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 4.81s]
[0m22:32:50.065912 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_full
[0m22:32:50.066915 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat
[0m22:32:50.067912 [info ] [Thread-2 (]: 40 of 51 START sql table model dbt.trips_stat .................................. [RUN]
[0m22:32:50.068913 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_stat)
[0m22:32:50.068913 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat
[0m22:32:50.071952 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m22:32:50.073908 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat
[0m22:32:50.077947 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m22:32:50.078913 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:32:50.079946 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m22:32:50.079946 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:50.227798 [debug] [Thread-1 (]: SQL status: BEGIN in 2.957 seconds
[0m22:32:50.228763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:32:50.228763 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m22:32:51.335845 [debug] [Thread-4 (]: SQL status: BEGIN in 3.778 seconds
[0m22:32:51.336843 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:32:51.336843 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m22:32:53.835702 [debug] [Thread-2 (]: SQL status: BEGIN in 3.755 seconds
[0m22:32:53.835702 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:32:53.836654 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count(*) as trips,
    count(distinct user_id) as users,
    avg(duration_s) / 60 as avg_duration_min,
    sum(distance_m) / 1000 as sum_distance_km,
    sum(price_rub) as revenue_rub,
    count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from
    "dev_3lcu"."dbt"."trips_prep"
  );
  
[0m22:32:55.268524 [debug] [Thread-3 (]: SQL status: SELECT 3 in 6.166 seconds
[0m22:32:55.272537 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:55.272537 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m22:32:55.642872 [debug] [Thread-3 (]: SQL status: BEGIN in 0.369 seconds
[0m22:32:55.642872 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:55.643910 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp223249099738'
        
      order by ordinal_position

  
[0m22:32:56.535585 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.891 seconds
[0m22:32:56.539577 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:56.540581 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m22:32:57.049561 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.508 seconds
[0m22:32:57.053609 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:57.053609 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp223249099738'
        
      order by ordinal_position

  
[0m22:32:57.537953 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.483 seconds
[0m22:32:57.541547 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:57.542505 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m22:32:57.938613 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.395 seconds
[0m22:32:57.940643 [debug] [Thread-3 (]: 
    In "dev_3lcu"."finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:57.941643 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m22:32:57.942646 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:57.943612 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        
            delete from "dev_3lcu"."finance"."revenue_daily"
            using "revenue_daily__dbt_tmp223249099738"
            where (
                
                    "revenue_daily__dbt_tmp223249099738".date = "dev_3lcu"."finance"."revenue_daily".date
                    
                
                
            );
        
    

    insert into "dev_3lcu"."finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp223249099738"
    )
  
[0m22:32:58.334000 [debug] [Thread-3 (]: SQL status: INSERT 0 3 in 0.390 seconds
[0m22:32:58.341592 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:58.342588 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_3lcu".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'finance'
        and table_name = 'revenue_daily'
  
[0m22:32:58.740634 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.397 seconds
[0m22:32:58.741633 [debug] [Thread-3 (]: On "dev_3lcu"."finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m22:32:58.742643 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:58.743633 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  comment on table "dev_3lcu"."finance"."revenue_daily" is $dbt_comment_literal_block$Summary daily revenue$dbt_comment_literal_block$;

  
[0m22:32:59.136999 [debug] [Thread-3 (]: SQL status: COMMENT in 0.394 seconds
[0m22:32:59.139538 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m22:32:59.139538 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:59.140578 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m22:32:59.540670 [debug] [Thread-3 (]: SQL status: COMMIT in 0.400 seconds
[0m22:32:59.541665 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: Close
[0m22:32:59.542673 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319765160>]}
[0m22:32:59.543622 [info ] [Thread-3 (]: 39 of 51 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 3[0m in 10.45s]
[0m22:32:59.544665 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.revenue_daily
[0m22:32:59.545666 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m22:32:59.546625 [info ] [Thread-3 (]: 41 of 51 START sql table model dbt.trips_stat_daily ............................ [RUN]
[0m22:32:59.547622 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_stat_daily)
[0m22:32:59.548629 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m22:32:59.551663 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m22:32:59.552621 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m22:32:59.556668 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m22:32:59.557625 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:32:59.558628 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m22:32:59.558628 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:02.238682 [debug] [Thread-2 (]: SQL status: SELECT 1 in 8.402 seconds
[0m22:33:02.242717 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:33:02.243721 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m22:33:02.633660 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.390 seconds
[0m22:33:02.637659 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:33:02.637659 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m22:33:03.036561 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.398 seconds
[0m22:33:03.038562 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:33:03.039558 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat" is $dbt_comment_literal_block$Overall trips statistics$dbt_comment_literal_block$;

  
[0m22:33:03.155678 [debug] [Thread-3 (]: SQL status: BEGIN in 3.597 seconds
[0m22:33:03.156679 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:03.157680 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    count(*) as trips,
    max(price_rub) as max_price_rub,
    avg(distance_m) / 1000 as avg_distance_km,
    avg(price_rub)/avg(duration_s) * 60 as avg_price_rub_per_min
from
    "dev_3lcu"."dbt"."trips_prep"
group by
    1
order by
    1
  );
  
[0m22:33:03.433903 [debug] [Thread-2 (]: SQL status: COMMENT in 0.394 seconds
[0m22:33:03.434904 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m22:33:03.435904 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:33:03.435904 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m22:33:03.838710 [debug] [Thread-2 (]: SQL status: COMMIT in 0.402 seconds
[0m22:33:03.840715 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat__dbt_backup"
[0m22:33:03.842715 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:33:03.842715 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat__dbt_backup" cascade
[0m22:33:04.244491 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.401 seconds
[0m22:33:04.246494 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: Close
[0m22:33:04.247495 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029318736FF0>]}
[0m22:33:04.248497 [info ] [Thread-2 (]: 40 of 51 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 14.18s]
[0m22:33:04.249498 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat
[0m22:33:04.250504 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_users
[0m22:33:04.250504 [info ] [Thread-2 (]: 42 of 51 START sql incremental model dbt.trips_users ........................... [RUN]
[0m22:33:04.251507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_users)
[0m22:33:04.252508 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_users
[0m22:33:04.256503 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m22:33:04.257507 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_users
[0m22:33:04.261514 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:04.262511 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp223304259506"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep" as t
left join
    "dev_3lcu"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_3lcu"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m22:33:04.262511 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:10.237210 [debug] [Thread-2 (]: SQL status: SELECT 0 in 5.974 seconds
[0m22:33:10.240731 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:10.240731 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: BEGIN
[0m22:33:10.638319 [debug] [Thread-2 (]: SQL status: BEGIN in 0.397 seconds
[0m22:33:10.639831 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:10.639831 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp223304259506'
        
      order by ordinal_position

  
[0m22:33:11.936380 [debug] [Thread-2 (]: SQL status: SELECT 17 in 1.295 seconds
[0m22:33:11.939970 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:11.941020 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:33:12.641858 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.700 seconds
[0m22:33:12.645863 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:12.646858 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp223304259506'
        
      order by ordinal_position

  
[0m22:33:13.332493 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.685 seconds
[0m22:33:13.338051 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:13.339559 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:33:14.042287 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.702 seconds
[0m22:33:14.050895 [debug] [Thread-2 (]: 
    In "dev_3lcu"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:33:14.053063 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m22:33:14.055601 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:14.058028 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_3lcu"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp223304259506"
    )


  
[0m22:33:14.465793 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.406 seconds
[0m22:33:14.468945 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:14.469941 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_users" is $dbt_comment_literal_block$Prepared trips enriched with users data$dbt_comment_literal_block$;

  
[0m22:33:14.833924 [debug] [Thread-2 (]: SQL status: COMMENT in 0.364 seconds
[0m22:33:14.837475 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:14.837475 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m22:33:15.244919 [debug] [Thread-3 (]: SQL status: SELECT 91 in 12.087 seconds
[0m22:33:15.250536 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:15.252537 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m22:33:15.635594 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.382 seconds
[0m22:33:15.642031 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:15.643416 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m22:33:16.064553 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.420 seconds
[0m22:33:16.089552 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:16.090560 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    create  index if not exists
  "cd40d69f91be17b7427948c8179e5a5c"
  on "dev_3lcu"."dbt"."trips_stat_daily" 
  (date)
  
[0m22:33:16.552525 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.461 seconds
[0m22:33:16.558529 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:16.559531 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat_daily" is $dbt_comment_literal_block$Overall trips statistics per day$dbt_comment_literal_block$;

  
[0m22:33:16.934090 [debug] [Thread-3 (]: SQL status: COMMENT in 0.373 seconds
[0m22:33:16.943408 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:16.945408 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_stat_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:33:17.877231 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.931 seconds
[0m22:33:17.881508 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:17.882511 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."trips_stat_daily".date is $dbt_comment_literal_block$Trips date$dbt_comment_literal_block$;
  

  
[0m22:33:18.315855 [debug] [Thread-3 (]: SQL status: COMMENT in 0.433 seconds
[0m22:33:18.318485 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m22:33:18.319505 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:18.320786 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m22:33:18.666320 [debug] [Thread-3 (]: SQL status: COMMIT in 0.345 seconds
[0m22:33:18.674672 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup"
[0m22:33:18.676672 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:18.677673 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m22:33:19.064466 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.386 seconds
[0m22:33:19.068469 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m22:33:19.070468 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293192384A0>]}
[0m22:33:19.071468 [info ] [Thread-3 (]: 41 of 51 OK created sql table model dbt.trips_stat_daily ....................... [[32mSELECT 91[0m in 19.52s]
[0m22:33:19.074474 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m22:33:19.075464 [debug] [Thread-3 (]: Began running node model.dbt_scooters.companies_trips
[0m22:33:19.076474 [info ] [Thread-3 (]: 43 of 51 START sql table model dbt.companies_trips ............................. [RUN]
[0m22:33:19.078466 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.companies_trips)
[0m22:33:19.079466 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.companies_trips
[0m22:33:19.085467 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m22:33:19.087466 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.companies_trips
[0m22:33:19.094465 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m22:33:19.097468 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:19.098472 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m22:33:19.099469 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:22.432792 [debug] [Thread-3 (]: SQL status: BEGIN in 3.332 seconds
[0m22:33:22.433794 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:22.434793 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_3lcu"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_3lcu"."dbt"."trips_prep" as t
        join "dev_3lcu"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_3lcu"."dbt"."companies" as c
        using (company)
  );
  
[0m22:33:26.842530 [debug] [Thread-3 (]: SQL status: SELECT 6 in 4.407 seconds
[0m22:33:26.845526 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:26.847071 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m22:33:27.141797 [debug] [Thread-2 (]: SQL status: ANALYZE in 12.303 seconds
[0m22:33:27.143797 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m22:33:27.143797 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:27.144796 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m22:33:27.236433 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.389 seconds
[0m22:33:27.239433 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:27.240439 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m22:33:27.539743 [debug] [Thread-2 (]: SQL status: COMMIT in 0.395 seconds
[0m22:33:27.540742 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:27.541741 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m22:33:27.634419 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.394 seconds
[0m22:33:27.637450 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:27.637450 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies_trips" is $dbt_comment_literal_block$Trip statistics by company$dbt_comment_literal_block$;

  
[0m22:33:27.931652 [debug] [Thread-2 (]: SQL status: COMMIT in 0.390 seconds
[0m22:33:27.933649 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:27.933649 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m22:33:28.035817 [debug] [Thread-3 (]: SQL status: COMMENT in 0.397 seconds
[0m22:33:28.039823 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:28.040783 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'companies_trips'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:33:28.343526 [debug] [Thread-2 (]: SQL status: VACUUM in 0.409 seconds
[0m22:33:28.345566 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: Close
[0m22:33:28.346529 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319755640>]}
[0m22:33:28.347530 [info ] [Thread-2 (]: 42 of 51 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 24.10s]
[0m22:33:28.349072 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_users
[0m22:33:28.349072 [debug] [Thread-2 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m22:33:28.350119 [info ] [Thread-2 (]: 44 of 51 START test events_full_is_complete .................................... [RUN]
[0m22:33:28.351113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now test.dbt_scooters.events_full_is_complete)
[0m22:33:28.352113 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m22:33:28.358082 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m22:33:28.359590 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m22:33:28.362599 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.events_full_is_complete"
[0m22:33:28.364600 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m22:33:28.364600 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: BEGIN
[0m22:33:28.365600 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:28.735692 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.694 seconds
[0m22:33:28.738661 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:28.739692 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."companies_trips".company is $dbt_comment_literal_block$Scooters manufacturing company$dbt_comment_literal_block$;
  

  
[0m22:33:29.147808 [debug] [Thread-3 (]: SQL status: COMMENT in 0.408 seconds
[0m22:33:29.151372 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m22:33:29.152397 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:29.153396 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m22:33:29.535617 [debug] [Thread-3 (]: SQL status: COMMIT in 0.381 seconds
[0m22:33:29.538601 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."companies_trips__dbt_backup"
[0m22:33:29.539616 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:29.540578 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_3lcu"."dbt"."companies_trips__dbt_backup" cascade
[0m22:33:29.887643 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.347 seconds
[0m22:33:29.889639 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: Close
[0m22:33:29.890642 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931975C290>]}
[0m22:33:29.891639 [info ] [Thread-3 (]: 43 of 51 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 10.81s]
[0m22:33:29.892636 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.companies_trips
[0m22:33:29.893641 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m22:33:29.894632 [info ] [Thread-3 (]: 45 of 51 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m22:33:29.895614 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_age_daily)
[0m22:33:29.896640 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m22:33:29.899600 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m22:33:29.901605 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m22:33:29.907638 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m22:33:29.910615 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:29.911620 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m22:33:29.912619 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:30.637684 [debug] [Thread-1 (]: SQL status: SELECT 464 in 40.408 seconds
[0m22:33:30.641696 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:33:30.642699 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m22:33:31.035632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.393 seconds
[0m22:33:31.039627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:33:31.039627 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m22:33:31.337493 [debug] [Thread-2 (]: SQL status: BEGIN in 2.972 seconds
[0m22:33:31.338450 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m22:33:31.338450 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.events_full_is_complete"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with source_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_clean"
),
target_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_full"
)
select
    'Row count mismatch' as error_message,
    source_cte.row_count as source_count,
    target_cte.row_count as target_count
from
    source_cte,
    target_cte
where
    source_cte.row_count != target_cte.row_count
      
    ) dbt_internal_test
[0m22:33:31.435416 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.394 seconds
[0m22:33:31.437416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:33:31.438416 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_finish_stat" is $dbt_comment_literal_block$Trip finish parking statistics by 10 m hexagons$dbt_comment_literal_block$;

  
[0m22:33:31.834593 [debug] [Thread-1 (]: SQL status: COMMENT in 0.396 seconds
[0m22:33:31.836591 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m22:33:31.836591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:33:31.837591 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m22:33:32.235683 [debug] [Thread-1 (]: SQL status: COMMIT in 0.398 seconds
[0m22:33:32.238682 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup"
[0m22:33:32.239689 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:33:32.240689 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m22:33:32.635641 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.394 seconds
[0m22:33:32.637641 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m22:33:32.638641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293191780B0>]}
[0m22:33:32.639642 [info ] [Thread-1 (]: 37 of 51 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 45.38s]
[0m22:33:32.640649 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m22:33:32.641652 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_group
[0m22:33:32.641652 [info ] [Thread-1 (]: 46 of 51 START sql table model dbt.trips_age_group ............................. [RUN]
[0m22:33:32.643653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_finish_stat, now model.dbt_scooters.trips_age_group)
[0m22:33:32.643653 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m22:33:32.647649 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m22:33:32.648649 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_group
[0m22:33:32.653690 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m22:33:32.655269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:32.656268 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m22:33:32.656268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:32.835576 [debug] [Thread-3 (]: SQL status: BEGIN in 2.923 seconds
[0m22:33:32.835576 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:32.836576 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    Select "date",
       age,
       count(*) as trips,
       sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m22:33:33.047550 [debug] [Thread-4 (]: SQL status: SELECT 142 in 41.710 seconds
[0m22:33:33.052543 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:33:33.053534 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m22:33:33.394378 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.340 seconds
[0m22:33:33.399379 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:33:33.401383 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m22:33:33.834610 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.433 seconds
[0m22:33:33.839612 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:33:33.840602 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_start_stat" is $dbt_comment_literal_block$Trip start parking statistics by 500 m hexagons$dbt_comment_literal_block$;

  
[0m22:33:34.035585 [debug] [Thread-2 (]: SQL status: SELECT 1 in 2.696 seconds
[0m22:33:34.038582 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: ROLLBACK
[0m22:33:34.183378 [debug] [Thread-4 (]: SQL status: COMMENT in 0.342 seconds
[0m22:33:34.186371 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m22:33:34.186371 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:33:34.187371 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m22:33:34.434361 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: Close
[0m22:33:34.435360 [info ] [Thread-2 (]: 44 of 51 PASS events_full_is_complete .......................................... [[32mPASS[0m in 6.08s]
[0m22:33:34.437362 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m22:33:34.438361 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:33:34.438361 [info ] [Thread-2 (]: 47 of 51 START test unique_companies_trips_company ............................. [RUN]
[0m22:33:34.439359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.events_full_is_complete, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m22:33:34.440397 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:33:34.445392 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:33:34.447396 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:33:34.452361 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:33:34.455364 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:33:34.456363 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m22:33:34.456363 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:34.642551 [debug] [Thread-3 (]: SQL status: SELECT 7049 in 1.806 seconds
[0m22:33:34.643556 [debug] [Thread-4 (]: SQL status: COMMIT in 0.455 seconds
[0m22:33:34.648558 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:34.653552 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_start_stat__dbt_backup"
[0m22:33:34.654552 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m22:33:34.656555 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:33:34.657063 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_start_stat__dbt_backup" cascade
[0m22:33:34.994395 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m22:33:34.998401 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:34.999400 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.341 seconds
[0m22:33:35.000367 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m22:33:35.004395 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: Close
[0m22:33:35.005361 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931971D790>]}
[0m22:33:35.006362 [info ] [Thread-4 (]: 38 of 51 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 47.46s]
[0m22:33:35.008396 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m22:33:35.009398 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_stat
[0m22:33:35.010395 [info ] [Thread-4 (]: 48 of 51 START sql table model dbt.events_stat ................................. [RUN]
[0m22:33:35.011368 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now model.dbt_scooters.events_stat)
[0m22:33:35.012399 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_stat
[0m22:33:35.016362 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m22:33:35.019368 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_stat
[0m22:33:35.024367 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m22:33:35.025369 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:35.026368 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: BEGIN
[0m22:33:35.027369 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:33:35.342378 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m22:33:35.345410 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:35.346381 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily" is $dbt_comment_literal_block$Daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m22:33:35.656658 [debug] [Thread-1 (]: SQL status: BEGIN in 3.000 seconds
[0m22:33:35.657648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:35.658623 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users" as tu
    cross join "dev_3lcu"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m22:33:35.684698 [debug] [Thread-3 (]: SQL status: COMMENT in 0.338 seconds
[0m22:33:35.686733 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m22:33:35.687733 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:35.688700 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m22:33:36.027703 [debug] [Thread-3 (]: SQL status: COMMIT in 0.339 seconds
[0m22:33:36.031710 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily__dbt_backup"
[0m22:33:36.032711 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:36.034715 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily__dbt_backup" cascade
[0m22:33:36.375872 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.340 seconds
[0m22:33:36.377870 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m22:33:36.379378 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319178920>]}
[0m22:33:36.380389 [info ] [Thread-3 (]: 45 of 51 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 6.48s]
[0m22:33:36.381386 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m22:33:36.383397 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m22:33:36.384392 [info ] [Thread-3 (]: 49 of 51 START test unique_key_trips_age_daily_date__age ....................... [RUN]
[0m22:33:36.385390 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be)
[0m22:33:36.386422 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m22:33:36.392420 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m22:33:36.393421 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m22:33:36.396425 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m22:33:36.398421 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m22:33:36.400389 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: BEGIN
[0m22:33:36.401394 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:37.972950 [debug] [Thread-4 (]: SQL status: BEGIN in 2.946 seconds
[0m22:33:37.973943 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:37.974912 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
       count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from "dev_3lcu"."dbt"."events_full"
  );
  
[0m22:33:38.273371 [debug] [Thread-2 (]: SQL status: BEGIN in 3.817 seconds
[0m22:33:38.274369 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:33:38.274369 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



      
    ) dbt_internal_test
[0m22:33:38.617720 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.342 seconds
[0m22:33:38.620747 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m22:33:39.041538 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m22:33:39.043529 [info ] [Thread-2 (]: 47 of 51 PASS unique_companies_trips_company ................................... [[32mPASS[0m in 4.60s]
[0m22:33:39.044491 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:33:39.045495 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m22:33:39.045495 [info ] [Thread-2 (]: 50 of 51 START test unique_trips_age_daily_date_text_age_text .................. [RUN]
[0m22:33:39.046530 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0, now test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e)
[0m22:33:39.047535 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m22:33:39.053498 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m22:33:39.055501 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m22:33:39.060497 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m22:33:39.061497 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m22:33:39.062500 [debug] [Thread-2 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: BEGIN
[0m22:33:39.062500 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:39.536291 [debug] [Thread-3 (]: SQL status: BEGIN in 3.135 seconds
[0m22:33:39.536291 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m22:33:39.537291 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "date"::text ||
    
        "age"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m22:33:40.251773 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.714 seconds
[0m22:33:40.253767 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: ROLLBACK
[0m22:33:40.634447 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: Close
[0m22:33:40.635509 [info ] [Thread-3 (]: 49 of 51 PASS unique_key_trips_age_daily_date__age ............................. [[32mPASS[0m in 4.25s]
[0m22:33:40.636486 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m22:33:41.741760 [debug] [Thread-4 (]: SQL status: SELECT 1 in 3.766 seconds
[0m22:33:41.744760 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:41.745759 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m22:33:42.134344 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.388 seconds
[0m22:33:42.138343 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:42.139340 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m22:33:42.532678 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.393 seconds
[0m22:33:42.535677 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:42.536675 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_stat" is $dbt_comment_literal_block$Overall user events statistics$dbt_comment_literal_block$;

  
[0m22:33:42.884504 [debug] [Thread-4 (]: SQL status: COMMENT in 0.347 seconds
[0m22:33:42.886495 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m22:33:42.886495 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:42.887499 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m22:33:42.891502 [debug] [Thread-2 (]: SQL status: BEGIN in 3.828 seconds
[0m22:33:42.891502 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m22:33:42.892503 [debug] [Thread-2 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date::text || age::text as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."trips_age_daily"
where date::text || age::text is not null
group by date::text || age::text
having count(*) > 1



      
    ) dbt_internal_test
[0m22:33:43.365402 [debug] [Thread-4 (]: SQL status: COMMIT in 0.478 seconds
[0m22:33:43.369915 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."events_stat__dbt_backup"
[0m22:33:43.370921 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:43.370921 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_3lcu"."dbt"."events_stat__dbt_backup" cascade
[0m22:33:43.738706 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.846 seconds
[0m22:33:43.740712 [debug] [Thread-2 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: ROLLBACK
[0m22:33:43.747711 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.376 seconds
[0m22:33:43.748712 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: Close
[0m22:33:43.750729 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931971E930>]}
[0m22:33:43.751724 [info ] [Thread-4 (]: 48 of 51 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 8.74s]
[0m22:33:43.753721 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_stat
[0m22:33:44.078229 [debug] [Thread-2 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: Close
[0m22:33:44.079737 [info ] [Thread-2 (]: 50 of 51 PASS unique_trips_age_daily_date_text_age_text ........................ [[32mPASS[0m in 5.03s]
[0m22:33:44.080749 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m22:33:44.081750 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m22:33:44.083750 [info ] [Thread-3 (]: 51 of 51 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m22:33:44.084750 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be, now model.dbt_scooters.trips_age_daily_stat)
[0m22:33:44.085749 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m22:33:44.088749 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:44.090749 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m22:33:44.094747 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:44.095749 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:44.096749 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m22:33:44.097750 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:48.137345 [debug] [Thread-3 (]: SQL status: BEGIN in 4.040 seconds
[0m22:33:48.138342 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:48.138342 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m22:33:48.835493 [debug] [Thread-3 (]: SQL status: SELECT 83 in 0.696 seconds
[0m22:33:48.839492 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:48.840451 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m22:33:49.235681 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.395 seconds
[0m22:33:49.238684 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:49.239725 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m22:33:49.342526 [debug] [Thread-1 (]: SQL status: SELECT 7 in 13.683 seconds
[0m22:33:49.345574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:49.346564 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m22:33:49.578474 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m22:33:49.580073 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:49.581073 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily_stat" is $dbt_comment_literal_block$Aggregation of daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m22:33:49.684236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m22:33:49.688269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:49.688269 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m22:33:49.918405 [debug] [Thread-3 (]: SQL status: COMMENT in 0.336 seconds
[0m22:33:49.920400 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m22:33:49.921436 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:49.922435 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m22:33:50.030663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.341 seconds
[0m22:33:50.032663 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:50.033666 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_group" is $dbt_comment_literal_block$Overall trips statistics by user age group$dbt_comment_literal_block$;

  
[0m22:33:50.263582 [debug] [Thread-3 (]: SQL status: COMMIT in 0.341 seconds
[0m22:33:50.267542 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup"
[0m22:33:50.268535 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:50.268535 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m22:33:50.372366 [debug] [Thread-1 (]: SQL status: COMMENT in 0.337 seconds
[0m22:33:50.373366 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m22:33:50.374366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:50.374366 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m22:33:50.609633 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.340 seconds
[0m22:33:50.611673 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m22:33:50.612668 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319179730>]}
[0m22:33:50.613628 [info ] [Thread-3 (]: 51 of 51 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 6.53s]
[0m22:33:50.614628 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m22:33:50.713453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.338 seconds
[0m22:33:50.720412 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_group__dbt_backup"
[0m22:33:50.721413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:50.721413 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_group__dbt_backup" cascade
[0m22:33:51.068615 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.346 seconds
[0m22:33:51.069660 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: Close
[0m22:33:51.070660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319824F80>]}
[0m22:33:52.009655 [info ] [Thread-1 (]: 46 of 51 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 18.43s]
[0m22:33:52.010654 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_group
[0m22:33:52.012657 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:52.013661 [debug] [MainThread]: On master: BEGIN
[0m22:33:52.013661 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:33:54.791479 [debug] [MainThread]: SQL status: BEGIN in 2.777 seconds
[0m22:33:54.792463 [debug] [MainThread]: On master: COMMIT
[0m22:33:54.792463 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:54.793462 [debug] [MainThread]: On master: COMMIT
[0m22:33:55.151525 [debug] [MainThread]: SQL status: COMMIT in 0.358 seconds
[0m22:33:55.151525 [info ] [MainThread]: 
[0m22:33:55.152524 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:33:55.155559 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m22:33:55.160558 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m22:33:55.161527 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:55.162522 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m22:33:55.505713 [debug] [MainThread]: SQL status: GRANT in 0.343 seconds
[0m22:33:55.507716 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mGRANT[0m in 0.35s]
[0m22:33:55.507716 [info ] [MainThread]: 
[0m22:33:55.508717 [debug] [MainThread]: On master: Close
[0m22:33:55.509730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:33:55.510731 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m22:33:55.510731 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m22:33:55.511732 [debug] [MainThread]: Connection 'list_dev_3lcu_dbt' was properly closed.
[0m22:33:55.511732 [debug] [MainThread]: Connection 'list_dev_3lcu_finance' was properly closed.
[0m22:33:55.512732 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m22:33:55.512732 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e' was properly closed.
[0m22:33:55.513730 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m22:33:55.513730 [debug] [MainThread]: Connection 'model.dbt_scooters.events_stat' was properly closed.
[0m22:33:55.514731 [info ] [MainThread]: 
[0m22:33:55.515727 [info ] [MainThread]: Finished running 4 seeds, 28 data tests, 12 table models, 4 incremental models, 3 view models, 1 project hook in 0 hours 2 minutes and 0.69 seconds (120.69s).
[0m22:33:55.527760 [debug] [MainThread]: Command end result
[0m22:33:55.663425 [info ] [MainThread]: 
[0m22:33:55.664387 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m22:33:55.665386 [info ] [MainThread]: 
[0m22:33:55.667392 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models\properties.yml)[0m
[0m22:33:55.668388 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m22:33:55.670393 [info ] [MainThread]: 
[0m22:33:55.671392 [info ] [MainThread]:   compiled code at target\compiled\dbt_scooters\models\properties.yml\source_not_null_scooters_raw_users_sex.sql
[0m22:33:55.672388 [info ] [MainThread]: 
[0m22:33:55.673387 [info ] [MainThread]: Done. PASS=50 WARN=1 ERROR=0 SKIP=0 TOTAL=51
[0m22:33:55.675389 [debug] [MainThread]: Command `dbt build` succeeded at 22:33:55.675389 after 125.72 seconds
[0m22:33:55.675389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029316DEC3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931641A360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029316419340>]}
[0m22:33:55.676388 [debug] [MainThread]: Flushing usage events
[0m10:44:04.532300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077C255C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077B6ACEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077E811DC0>]}


============================== 10:44:04.541325 | 2e7f7a10-1ebf-44ba-86ba-a51899df3d6d ==============================
[0m10:44:04.541325 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:44:04.542298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:44:04.876367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e7f7a10-1ebf-44ba-86ba-a51899df3d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077E0955E0>]}
[0m10:44:04.947534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e7f7a10-1ebf-44ba-86ba-a51899df3d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077F20EA20>]}
[0m10:44:04.949535 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:44:05.240381 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:44:05.242385 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:44:05.242385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2e7f7a10-1ebf-44ba-86ba-a51899df3d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077F1EF350>]}
[0m10:44:07.508362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e7f7a10-1ebf-44ba-86ba-a51899df3d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077F70DCD0>]}
[0m10:44:07.740548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e7f7a10-1ebf-44ba-86ba-a51899df3d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077F728C50>]}
[0m10:44:07.741547 [info ] [MainThread]: Found 19 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 437 macros
[0m10:44:07.741547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7f7a10-1ebf-44ba-86ba-a51899df3d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077F8A4C80>]}
[0m10:44:07.746579 [info ] [MainThread]: 
[0m10:44:07.747541 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:44:07.753539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_dbt'
[0m10:44:07.766547 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_finance'
[0m10:44:08.012248 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m10:44:08.013248 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m10:44:08.013248 [debug] [ThreadPool]: On list_dev_3lcu_dbt: BEGIN
[0m10:44:08.014247 [debug] [ThreadPool]: On list_dev_3lcu_finance: BEGIN
[0m10:44:08.014247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:08.015249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:10.859410 [debug] [ThreadPool]: SQL status: BEGIN in 2.844 seconds
[0m10:44:10.859410 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m10:44:10.860410 [debug] [ThreadPool]: On list_dev_3lcu_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_dbt"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m10:44:10.860410 [debug] [ThreadPool]: SQL status: BEGIN in 2.846 seconds
[0m10:44:10.861433 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m10:44:10.861433 [debug] [ThreadPool]: On list_dev_3lcu_finance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_finance"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m10:44:11.199508 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.339 seconds
[0m10:44:11.201461 [debug] [ThreadPool]: On list_dev_3lcu_dbt: ROLLBACK
[0m10:44:11.208690 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.346 seconds
[0m10:44:11.210641 [debug] [ThreadPool]: On list_dev_3lcu_finance: ROLLBACK
[0m10:44:11.537351 [debug] [ThreadPool]: On list_dev_3lcu_dbt: Close
[0m10:44:11.545316 [debug] [ThreadPool]: On list_dev_3lcu_finance: Close
[0m10:44:11.552337 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:11.552337 [debug] [MainThread]: On master: BEGIN
[0m10:44:11.553307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:14.567239 [debug] [MainThread]: SQL status: BEGIN in 3.014 seconds
[0m10:44:14.568237 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:14.568237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:44:15.110128 [debug] [MainThread]: SQL status: SELECT 4 in 0.541 seconds
[0m10:44:15.112154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7f7a10-1ebf-44ba-86ba-a51899df3d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077F1EF3B0>]}
[0m10:44:15.112154 [debug] [MainThread]: On master: ROLLBACK
[0m10:44:15.451205 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:15.452197 [debug] [MainThread]: On master: BEGIN
[0m10:44:16.146315 [debug] [MainThread]: SQL status: BEGIN in 0.694 seconds
[0m10:44:16.146315 [debug] [MainThread]: On master: COMMIT
[0m10:44:16.147277 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:16.147277 [debug] [MainThread]: On master: COMMIT
[0m10:44:16.484626 [debug] [MainThread]: SQL status: COMMIT in 0.337 seconds
[0m10:44:16.485580 [debug] [MainThread]: On master: Close
[0m10:44:16.486605 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:44:16.486605 [info ] [MainThread]: 
[0m10:44:16.493582 [debug] [Thread-1 (]: Began running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m10:44:16.494617 [debug] [Thread-2 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m10:44:16.495581 [debug] [Thread-3 (]: Began running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m10:44:16.495581 [debug] [Thread-4 (]: Began running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m10:44:16.496582 [info ] [Thread-1 (]: 1 of 28 START test accepted_values_add_first_name_sex_sex__M__F ................ [RUN]
[0m10:44:16.496582 [info ] [Thread-2 (]: 2 of 28 START test events_full_is_complete ..................................... [RUN]
[0m10:44:16.497582 [info ] [Thread-3 (]: 3 of 28 START test every_event_has_type ........................................ [RUN]
[0m10:44:16.498581 [info ] [Thread-4 (]: 4 of 28 START test every_event_has_user ........................................ [RUN]
[0m10:44:16.499582 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199'
[0m10:44:16.500581 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_scooters.events_full_is_complete'
[0m10:44:16.500581 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_scooters.every_event_has_type.1e5fc977eb'
[0m10:44:16.501608 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_scooters.every_event_has_user.7eea25f36c'
[0m10:44:16.501608 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m10:44:16.502580 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m10:44:16.503585 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m10:44:16.504583 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m10:44:16.512781 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m10:44:16.516254 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m10:44:16.522315 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m10:44:16.527270 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m10:44:16.530270 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m10:44:16.531271 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m10:44:16.546311 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m10:44:16.547317 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m10:44:16.548272 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m10:44:16.550272 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.events_full_is_complete"
[0m10:44:16.553297 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m10:44:16.556298 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m10:44:16.557270 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m10:44:16.558272 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m10:44:16.559272 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: BEGIN
[0m10:44:16.560272 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m10:44:16.560272 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: BEGIN
[0m10:44:16.561271 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m10:44:16.561271 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:44:16.562305 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: BEGIN
[0m10:44:16.562305 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:44:16.563273 [debug] [Thread-3 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: BEGIN
[0m10:44:16.564271 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:44:16.564271 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:44:19.296511 [debug] [Thread-2 (]: SQL status: BEGIN in 2.734 seconds
[0m10:44:19.296511 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m10:44:19.297512 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.events_full_is_complete"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with source_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_clean"
),
target_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_full"
)
select
    'Row count mismatch' as error_message,
    source_cte.row_count as source_count,
    target_cte.row_count as target_count
from
    source_cte,
    target_cte
where
    source_cte.row_count != target_cte.row_count
      
    ) dbt_internal_test
[0m10:44:19.366378 [debug] [Thread-1 (]: SQL status: BEGIN in 2.805 seconds
[0m10:44:19.367365 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m10:44:19.367365 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."dbt"."add_first_name_sex"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m10:44:19.711357 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.343 seconds
[0m10:44:19.714868 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: ROLLBACK
[0m10:44:19.824636 [debug] [Thread-3 (]: SQL status: BEGIN in 3.260 seconds
[0m10:44:19.824636 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m10:44:19.825596 [debug] [Thread-3 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_type.1e5fc977eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where type_id is not null
),

parent as (
    select type_id as to_field
    from "dev_3lcu"."dbt"."event_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:44:20.110327 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: Close
[0m10:44:20.111332 [info ] [Thread-1 (]: 1 of 28 PASS accepted_values_add_first_name_sex_sex__M__F ...................... [[32mPASS[0m in 3.61s]
[0m10:44:20.113328 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m10:44:20.113328 [debug] [Thread-1 (]: Began running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m10:44:20.114334 [info ] [Thread-1 (]: 5 of 28 START test every_trip_has_scooter_id ................................... [RUN]
[0m10:44:20.115360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199, now test.dbt_scooters.every_trip_has_scooter_id.e0b845a190)
[0m10:44:20.115360 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m10:44:20.120365 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m10:44:20.123367 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m10:44:20.126386 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m10:44:20.128367 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m10:44:20.129367 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: BEGIN
[0m10:44:20.129367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:21.418988 [debug] [Thread-2 (]: SQL status: SELECT 1 in 2.121 seconds
[0m10:44:21.420985 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: ROLLBACK
[0m10:44:21.719813 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.893 seconds
[0m10:44:21.720814 [debug] [Thread-3 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: ROLLBACK
[0m10:44:21.793417 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: Close
[0m10:44:21.794417 [info ] [Thread-2 (]: 2 of 28 PASS events_full_is_complete ........................................... [[32mPASS[0m in 5.29s]
[0m10:44:21.795417 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m10:44:21.796421 [debug] [Thread-2 (]: Began running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m10:44:21.797429 [info ] [Thread-2 (]: 6 of 28 START test every_trip_has_user ......................................... [RUN]
[0m10:44:21.797429 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.events_full_is_complete, now test.dbt_scooters.every_trip_has_user.6bc71135e2)
[0m10:44:21.798430 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m10:44:21.803433 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m10:44:21.804429 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m10:44:21.807442 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m10:44:21.809440 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m10:44:21.809440 [debug] [Thread-2 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: BEGIN
[0m10:44:21.810440 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:44:21.847204 [debug] [Thread-4 (]: SQL status: BEGIN in 5.283 seconds
[0m10:44:21.847204 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m10:44:21.848231 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_user.7eea25f36c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:44:22.057274 [debug] [Thread-3 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: Close
[0m10:44:22.059230 [info ] [Thread-3 (]: 3 of 28 PASS every_event_has_type .............................................. [[32mPASS[0m in 5.56s]
[0m10:44:22.060229 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m10:44:22.061231 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m10:44:22.061231 [info ] [Thread-3 (]: 7 of 28 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m10:44:22.062264 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_type.1e5fc977eb, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m10:44:22.063235 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m10:44:22.067264 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m10:44:22.069230 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m10:44:22.071266 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m10:44:22.072229 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m10:44:22.073230 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m10:44:22.073230 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:44:23.021963 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.173 seconds
[0m10:44:23.023959 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: ROLLBACK
[0m10:44:23.362533 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: Close
[0m10:44:23.364535 [info ] [Thread-4 (]: 4 of 28 PASS every_event_has_user .............................................. [[32mPASS[0m in 6.86s]
[0m10:44:23.365532 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m10:44:23.366537 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m10:44:23.367533 [info ] [Thread-4 (]: 8 of 28 START test source_not_null_scooters_raw_events_type_id ................. [RUN]
[0m10:44:23.369535 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_user.7eea25f36c, now test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7)
[0m10:44:23.370533 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m10:44:23.380531 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m10:44:23.382538 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m10:44:23.386544 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m10:44:23.388543 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m10:44:23.389545 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: BEGIN
[0m10:44:23.390541 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:44:24.056101 [debug] [Thread-1 (]: SQL status: BEGIN in 3.926 seconds
[0m10:44:24.056101 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m10:44:24.057139 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select scooter_hw_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where scooter_hw_id is not null
),

parent as (
    select hardware_id as to_field
    from "dev_3lcu"."dbt"."scooters"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:44:24.524814 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.467 seconds
[0m10:44:24.527328 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: ROLLBACK
[0m10:44:24.620342 [debug] [Thread-2 (]: SQL status: BEGIN in 2.810 seconds
[0m10:44:24.621341 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m10:44:24.622344 [debug] [Thread-2 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_user.6bc71135e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:44:24.848170 [debug] [Thread-3 (]: SQL status: BEGIN in 2.775 seconds
[0m10:44:24.849164 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m10:44:24.849164 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m10:44:24.865168 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: Close
[0m10:44:24.867125 [info ] [Thread-1 (]: 5 of 28 PASS every_trip_has_scooter_id ......................................... [[32mPASS[0m in 4.75s]
[0m10:44:24.868125 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m10:44:24.869129 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m10:44:24.869129 [info ] [Thread-1 (]: 9 of 28 START test source_not_null_scooters_raw_events_user_id ................. [RUN]
[0m10:44:24.870159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_scooter_id.e0b845a190, now test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b)
[0m10:44:24.871127 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m10:44:24.876125 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m10:44:24.877133 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m10:44:24.880131 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m10:44:24.882131 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m10:44:24.882131 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: BEGIN
[0m10:44:24.883133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:25.120328 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.497 seconds
[0m10:44:25.121329 [debug] [Thread-2 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: ROLLBACK
[0m10:44:25.257310 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.407 seconds
[0m10:44:25.259305 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m10:44:25.461535 [debug] [Thread-2 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: Close
[0m10:44:25.462534 [info ] [Thread-2 (]: 6 of 28 PASS every_trip_has_user ............................................... [[32mPASS[0m in 3.67s]
[0m10:44:25.464538 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m10:44:25.465536 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m10:44:25.466545 [info ] [Thread-2 (]: 10 of 28 START test source_not_null_scooters_raw_trips_id ...................... [RUN]
[0m10:44:25.467545 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_user.6bc71135e2, now test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d)
[0m10:44:25.468552 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m10:44:25.473548 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m10:44:25.475549 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m10:44:25.479548 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m10:44:25.481545 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m10:44:25.481545 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: BEGIN
[0m10:44:25.482550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:44:25.597201 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m10:44:25.598157 [info ] [Thread-3 (]: 7 of 28 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 3.54s]
[0m10:44:25.600187 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m10:44:25.601161 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m10:44:25.602160 [info ] [Thread-3 (]: 11 of 28 START test source_not_null_scooters_raw_trips_scooter_hw_id ........... [RUN]
[0m10:44:25.603158 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f)
[0m10:44:25.603158 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m10:44:25.607194 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m10:44:25.609197 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m10:44:25.611193 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m10:44:25.613205 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m10:44:25.614157 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: BEGIN
[0m10:44:25.615160 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:44:26.329338 [debug] [Thread-4 (]: SQL status: BEGIN in 2.939 seconds
[0m10:44:26.330379 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m10:44:26.330379 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from "dev_3lcu"."scooters_raw"."events"
where type_id is null



      
    ) dbt_internal_test
[0m10:44:27.102214 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.771 seconds
[0m10:44:27.104206 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: ROLLBACK
[0m10:44:27.438348 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: Close
[0m10:44:27.439350 [info ] [Thread-4 (]: 8 of 28 PASS source_not_null_scooters_raw_events_type_id ....................... [[32mPASS[0m in 4.07s]
[0m10:44:27.440350 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m10:44:27.441354 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m10:44:27.442351 [info ] [Thread-4 (]: 12 of 28 START test source_not_null_scooters_raw_trips_user_id ................. [RUN]
[0m10:44:27.444354 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7, now test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62)
[0m10:44:27.444354 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m10:44:27.450348 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m10:44:27.452357 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m10:44:27.455356 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m10:44:27.457352 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m10:44:27.458348 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: BEGIN
[0m10:44:27.458348 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:44:28.429839 [debug] [Thread-2 (]: SQL status: BEGIN in 2.947 seconds
[0m10:44:28.429839 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m10:44:28.430841 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."trips"
where id is null



      
    ) dbt_internal_test
[0m10:44:28.778350 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.347 seconds
[0m10:44:28.780296 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: ROLLBACK
[0m10:44:28.997314 [debug] [Thread-1 (]: SQL status: BEGIN in 4.114 seconds
[0m10:44:28.997314 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m10:44:28.998354 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."events"
where user_id is null



      
    ) dbt_internal_test
[0m10:44:29.118510 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: Close
[0m10:44:29.120466 [info ] [Thread-2 (]: 10 of 28 PASS source_not_null_scooters_raw_trips_id ............................ [[32mPASS[0m in 3.65s]
[0m10:44:29.121468 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m10:44:29.121468 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m10:44:29.122469 [info ] [Thread-2 (]: 13 of 28 START test source_not_null_scooters_raw_users_id ...................... [RUN]
[0m10:44:29.123464 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d, now test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d)
[0m10:44:29.124466 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m10:44:29.127975 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m10:44:29.129982 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m10:44:29.131985 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m10:44:29.133983 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m10:44:29.134983 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: BEGIN
[0m10:44:29.134983 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:44:29.390539 [debug] [Thread-3 (]: SQL status: BEGIN in 3.776 seconds
[0m10:44:29.391496 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m10:44:29.392497 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select scooter_hw_id
from "dev_3lcu"."scooters_raw"."trips"
where scooter_hw_id is null



      
    ) dbt_internal_test
[0m10:44:29.711303 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.712 seconds
[0m10:44:29.712303 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: ROLLBACK
[0m10:44:29.744514 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.352 seconds
[0m10:44:29.746502 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: ROLLBACK
[0m10:44:30.049296 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: Close
[0m10:44:30.051287 [info ] [Thread-1 (]: 9 of 28 PASS source_not_null_scooters_raw_events_user_id ....................... [[32mPASS[0m in 5.18s]
[0m10:44:30.052253 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m10:44:30.053255 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m10:44:30.053255 [info ] [Thread-1 (]: 14 of 28 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m10:44:30.054253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m10:44:30.055250 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m10:44:30.060278 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m10:44:30.061252 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m10:44:30.064282 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m10:44:30.065254 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m10:44:30.066252 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m10:44:30.066252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:30.085248 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: Close
[0m10:44:30.086254 [info ] [Thread-3 (]: 11 of 28 PASS source_not_null_scooters_raw_trips_scooter_hw_id ................. [[32mPASS[0m in 4.48s]
[0m10:44:30.087251 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m10:44:30.088255 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m10:44:30.089250 [info ] [Thread-3 (]: 15 of 28 START test source_unique_scooters_raw_trips_id ........................ [RUN]
[0m10:44:30.090252 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f, now test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4)
[0m10:44:30.090252 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m10:44:30.096285 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m10:44:30.098249 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m10:44:30.100289 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m10:44:30.101275 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m10:44:30.101275 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: BEGIN
[0m10:44:30.102252 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:44:30.157462 [debug] [Thread-4 (]: SQL status: BEGIN in 2.699 seconds
[0m10:44:30.158463 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m10:44:30.158463 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."trips"
where user_id is null



      
    ) dbt_internal_test
[0m10:44:30.511316 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.352 seconds
[0m10:44:30.513308 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: ROLLBACK
[0m10:44:30.851267 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: Close
[0m10:44:30.852261 [info ] [Thread-4 (]: 12 of 28 PASS source_not_null_scooters_raw_trips_user_id ....................... [[32mPASS[0m in 3.41s]
[0m10:44:30.853259 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m10:44:30.854262 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m10:44:30.855261 [info ] [Thread-4 (]: 16 of 28 START test source_unique_scooters_raw_users_id ........................ [RUN]
[0m10:44:30.856263 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62, now test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf)
[0m10:44:30.857263 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m10:44:30.862259 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m10:44:30.863259 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m10:44:30.865261 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m10:44:30.867267 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m10:44:30.867267 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: BEGIN
[0m10:44:30.868267 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:44:31.853287 [debug] [Thread-2 (]: SQL status: BEGIN in 2.718 seconds
[0m10:44:31.853287 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m10:44:31.854327 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."users"
where id is null



      
    ) dbt_internal_test
[0m10:44:32.191364 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.337 seconds
[0m10:44:32.193305 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: ROLLBACK
[0m10:44:32.530492 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: Close
[0m10:44:32.531443 [info ] [Thread-2 (]: 13 of 28 PASS source_not_null_scooters_raw_users_id ............................ [[32mPASS[0m in 3.41s]
[0m10:44:32.533446 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m10:44:32.533955 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m10:44:32.534971 [info ] [Thread-2 (]: 17 of 28 START test unique_companies_trips_company ............................. [RUN]
[0m10:44:32.534971 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m10:44:32.536486 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m10:44:32.540499 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m10:44:32.543511 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m10:44:32.545492 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m10:44:32.547499 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m10:44:32.547499 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m10:44:32.548504 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:44:32.759307 [debug] [Thread-1 (]: SQL status: BEGIN in 2.692 seconds
[0m10:44:32.759307 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m10:44:32.760347 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sex
from "dev_3lcu"."scooters_raw"."users"
where sex is null



      
    ) dbt_internal_test
[0m10:44:32.803360 [debug] [Thread-3 (]: SQL status: BEGIN in 2.701 seconds
[0m10:44:32.804346 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m10:44:32.804346 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."trips"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:44:33.098292 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.338 seconds
[0m10:44:33.100254 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m10:44:33.510543 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m10:44:33.511542 [warn ] [Thread-1 (]: 14 of 28 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 3.46s]
[0m10:44:33.512587 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m10:44:33.513546 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m10:44:33.514546 [info ] [Thread-1 (]: 18 of 28 START test unique_key_scooters_company__model__hardware_id ............ [RUN]
[0m10:44:33.515542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e)
[0m10:44:33.516580 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m10:44:33.521570 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m10:44:33.526543 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m10:44:33.528570 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m10:44:33.530545 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m10:44:33.531580 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: BEGIN
[0m10:44:33.531580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:33.612293 [debug] [Thread-4 (]: SQL status: BEGIN in 2.745 seconds
[0m10:44:33.613294 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m10:44:33.614294 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."users"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:44:34.110394 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.496 seconds
[0m10:44:34.112382 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: ROLLBACK
[0m10:44:34.411333 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.606 seconds
[0m10:44:34.413334 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: ROLLBACK
[0m10:44:34.448362 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: Close
[0m10:44:34.449360 [info ] [Thread-4 (]: 16 of 28 PASS source_unique_scooters_raw_users_id .............................. [[32mPASS[0m in 3.59s]
[0m10:44:34.450360 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m10:44:34.451367 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m10:44:34.452362 [info ] [Thread-4 (]: 19 of 28 START test unique_key_trips_age_daily_date__age ....................... [RUN]
[0m10:44:34.452362 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf, now test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be)
[0m10:44:34.453362 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m10:44:34.457358 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m10:44:34.458376 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m10:44:34.460359 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m10:44:34.462361 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m10:44:34.462361 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: BEGIN
[0m10:44:34.463360 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:44:34.748334 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: Close
[0m10:44:34.749338 [info ] [Thread-3 (]: 15 of 28 PASS source_unique_scooters_raw_trips_id .............................. [[32mPASS[0m in 4.66s]
[0m10:44:34.750337 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m10:44:34.751338 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m10:44:34.752341 [info ] [Thread-3 (]: 20 of 28 START test unique_not_null_add_first_name_sex_first_name .............. [RUN]
[0m10:44:34.753341 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4, now test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f)
[0m10:44:34.753341 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m10:44:34.757336 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m10:44:34.758336 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m10:44:34.760336 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m10:44:34.762339 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m10:44:34.762339 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: BEGIN
[0m10:44:34.763338 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:44:35.331074 [debug] [Thread-2 (]: SQL status: BEGIN in 2.783 seconds
[0m10:44:35.332072 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m10:44:35.333074 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



      
    ) dbt_internal_test
[0m10:44:35.670051 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.336 seconds
[0m10:44:35.672054 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m10:44:36.008505 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m10:44:36.009504 [info ] [Thread-2 (]: 17 of 28 PASS unique_companies_trips_company ................................... [[32mPASS[0m in 3.47s]
[0m10:44:36.010502 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m10:44:36.011512 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m10:44:36.012504 [info ] [Thread-2 (]: 21 of 28 START test unique_not_null_age_groups_age_end ......................... [RUN]
[0m10:44:36.012504 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0, now test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac)
[0m10:44:36.013507 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m10:44:36.017512 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m10:44:36.019514 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m10:44:36.021513 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m10:44:36.023512 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m10:44:36.023512 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: BEGIN
[0m10:44:36.024512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:44:37.138278 [debug] [Thread-1 (]: SQL status: BEGIN in 3.607 seconds
[0m10:44:37.139760 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m10:44:37.139760 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "company"::text ||
    
        "model"::text ||
    
        "hardware_id"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m10:44:37.209326 [debug] [Thread-4 (]: SQL status: BEGIN in 2.746 seconds
[0m10:44:37.209326 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m10:44:37.210363 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "date"::text ||
    
        "age"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m10:44:37.450399 [debug] [Thread-3 (]: SQL status: BEGIN in 2.688 seconds
[0m10:44:37.451353 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m10:44:37.452361 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "first_name"
from
    "dev_3lcu"."dbt"."add_first_name_sex"
group by
    1
having
    count(*) > 1 or "first_name" is null


      
    ) dbt_internal_test
[0m10:44:37.479400 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.339 seconds
[0m10:44:37.481352 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: ROLLBACK
[0m10:44:37.565200 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.354 seconds
[0m10:44:37.567241 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: ROLLBACK
[0m10:44:37.789553 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.337 seconds
[0m10:44:37.791592 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: ROLLBACK
[0m10:44:37.820601 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: Close
[0m10:44:37.822554 [info ] [Thread-1 (]: 18 of 28 PASS unique_key_scooters_company__model__hardware_id .................. [[32mPASS[0m in 4.31s]
[0m10:44:37.823554 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m10:44:37.823554 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m10:44:37.824558 [info ] [Thread-1 (]: 22 of 28 START test unique_not_null_age_groups_age_start ....................... [RUN]
[0m10:44:37.825552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e, now test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b)
[0m10:44:37.826554 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m10:44:37.832561 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m10:44:37.833556 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m10:44:37.835557 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m10:44:37.837557 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m10:44:37.837557 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: BEGIN
[0m10:44:37.838558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:37.916108 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: Close
[0m10:44:37.917107 [info ] [Thread-4 (]: 19 of 28 PASS unique_key_trips_age_daily_date__age ............................. [[32mPASS[0m in 3.46s]
[0m10:44:37.918107 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m10:44:37.919106 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m10:44:37.920106 [info ] [Thread-4 (]: 23 of 28 START test unique_not_null_age_groups_group ........................... [RUN]
[0m10:44:37.920106 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be, now test.dbt_scooters.unique_not_null_age_groups_group.39342291f1)
[0m10:44:37.921108 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m10:44:37.927104 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m10:44:37.929107 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m10:44:37.932104 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m10:44:37.934111 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m10:44:37.935112 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: BEGIN
[0m10:44:37.936109 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:44:38.128465 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: Close
[0m10:44:38.129415 [info ] [Thread-3 (]: 20 of 28 PASS unique_not_null_add_first_name_sex_first_name .................... [[32mPASS[0m in 3.38s]
[0m10:44:38.131416 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m10:44:38.132421 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m10:44:38.133416 [info ] [Thread-3 (]: 24 of 28 START test unique_not_null_event_types_type ........................... [RUN]
[0m10:44:38.135414 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f, now test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1)
[0m10:44:38.135414 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m10:44:38.139961 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m10:44:38.140968 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m10:44:38.144004 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m10:44:38.144972 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m10:44:38.144972 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: BEGIN
[0m10:44:38.146508 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:44:38.738276 [debug] [Thread-2 (]: SQL status: BEGIN in 2.714 seconds
[0m10:44:38.739274 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m10:44:38.739274 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_end"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_end" is null


      
    ) dbt_internal_test
[0m10:44:39.092074 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.352 seconds
[0m10:44:39.094075 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: ROLLBACK
[0m10:44:39.432210 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: Close
[0m10:44:39.433214 [info ] [Thread-2 (]: 21 of 28 PASS unique_not_null_age_groups_age_end ............................... [[32mPASS[0m in 3.42s]
[0m10:44:39.434215 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m10:44:39.435211 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m10:44:39.436217 [info ] [Thread-2 (]: 25 of 28 START test unique_not_null_event_types_type_id ........................ [RUN]
[0m10:44:39.437215 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac, now test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85)
[0m10:44:39.437215 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m10:44:39.441726 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m10:44:39.443731 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m10:44:39.444730 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m10:44:39.447246 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m10:44:39.447246 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: BEGIN
[0m10:44:39.448246 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:44:40.526463 [debug] [Thread-1 (]: SQL status: BEGIN in 2.688 seconds
[0m10:44:40.527467 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m10:44:40.527467 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_start"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_start" is null


      
    ) dbt_internal_test
[0m10:44:40.836234 [debug] [Thread-4 (]: SQL status: BEGIN in 2.901 seconds
[0m10:44:40.837242 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m10:44:40.837242 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "group"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "group" is null


      
    ) dbt_internal_test
[0m10:44:40.866264 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.338 seconds
[0m10:44:40.868267 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: ROLLBACK
[0m10:44:40.959353 [debug] [Thread-3 (]: SQL status: BEGIN in 2.813 seconds
[0m10:44:40.960354 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m10:44:40.960354 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type" is null


      
    ) dbt_internal_test
[0m10:44:41.193515 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.355 seconds
[0m10:44:41.195516 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: ROLLBACK
[0m10:44:41.208525 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: Close
[0m10:44:41.209535 [info ] [Thread-1 (]: 22 of 28 PASS unique_not_null_age_groups_age_start ............................. [[32mPASS[0m in 3.38s]
[0m10:44:41.211532 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m10:44:41.211532 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m10:44:41.212529 [info ] [Thread-1 (]: 26 of 28 START test unique_not_null_scooters_hardware_id ....................... [RUN]
[0m10:44:41.213531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b, now test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d)
[0m10:44:41.214530 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m10:44:41.217531 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m10:44:41.219535 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m10:44:41.221535 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m10:44:41.222531 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m10:44:41.223532 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: BEGIN
[0m10:44:41.224542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:41.317115 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.356 seconds
[0m10:44:41.319114 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: ROLLBACK
[0m10:44:41.567294 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: Close
[0m10:44:41.569296 [info ] [Thread-4 (]: 23 of 28 PASS unique_not_null_age_groups_group ................................. [[32mPASS[0m in 3.65s]
[0m10:44:41.570306 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m10:44:41.571318 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m10:44:41.572295 [info ] [Thread-4 (]: 27 of 28 START test unique_not_null_scooters_model ............................. [RUN]
[0m10:44:41.573299 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_group.39342291f1, now test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc)
[0m10:44:41.574297 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m10:44:41.577301 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m10:44:41.579305 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m10:44:41.581301 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m10:44:41.582304 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m10:44:41.583304 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: BEGIN
[0m10:44:41.583304 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:44:41.674379 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: Close
[0m10:44:41.675382 [info ] [Thread-3 (]: 24 of 28 PASS unique_not_null_event_types_type ................................. [[32mPASS[0m in 3.54s]
[0m10:44:41.676401 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m10:44:41.677409 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m10:44:41.678414 [info ] [Thread-3 (]: 28 of 28 START test unique_trips_age_daily_date_text_age_text .................. [RUN]
[0m10:44:41.678414 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1, now test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e)
[0m10:44:41.679413 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m10:44:41.684408 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m10:44:41.686412 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m10:44:41.742993 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m10:44:41.745008 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m10:44:41.745008 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: BEGIN
[0m10:44:41.745008 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:44:43.096486 [debug] [Thread-2 (]: SQL status: BEGIN in 3.649 seconds
[0m10:44:43.097441 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m10:44:43.098445 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type_id"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type_id" is null


      
    ) dbt_internal_test
[0m10:44:43.457445 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.359 seconds
[0m10:44:43.459393 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: ROLLBACK
[0m10:44:43.817450 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: Close
[0m10:44:43.818450 [info ] [Thread-2 (]: 25 of 28 PASS unique_not_null_event_types_type_id .............................. [[32mPASS[0m in 4.38s]
[0m10:44:43.819448 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m10:44:44.305154 [debug] [Thread-4 (]: SQL status: BEGIN in 2.721 seconds
[0m10:44:44.306157 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m10:44:44.306157 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "model"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "model" is null


      
    ) dbt_internal_test
[0m10:44:44.490095 [debug] [Thread-3 (]: SQL status: BEGIN in 2.744 seconds
[0m10:44:44.490095 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m10:44:44.491098 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date::text || age::text as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."trips_age_daily"
where date::text || age::text is not null
group by date::text || age::text
having count(*) > 1



      
    ) dbt_internal_test
[0m10:44:44.652923 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.346 seconds
[0m10:44:44.654955 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: ROLLBACK
[0m10:44:44.841056 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.349 seconds
[0m10:44:44.843089 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: ROLLBACK
[0m10:44:44.867254 [debug] [Thread-1 (]: SQL status: BEGIN in 3.643 seconds
[0m10:44:44.868249 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m10:44:44.868249 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "hardware_id"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "hardware_id" is null


      
    ) dbt_internal_test
[0m10:44:45.002453 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: Close
[0m10:44:45.003453 [info ] [Thread-4 (]: 27 of 28 PASS unique_not_null_scooters_model ................................... [[32mPASS[0m in 3.43s]
[0m10:44:45.004451 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m10:44:45.177420 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: Close
[0m10:44:45.178407 [info ] [Thread-3 (]: 28 of 28 PASS unique_trips_age_daily_date_text_age_text ........................ [[32mPASS[0m in 3.50s]
[0m10:44:45.180377 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m10:44:45.212414 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.344 seconds
[0m10:44:45.214373 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: ROLLBACK
[0m10:44:45.558510 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: Close
[0m10:44:45.560464 [info ] [Thread-1 (]: 26 of 28 PASS unique_not_null_scooters_hardware_id ............................. [[32mPASS[0m in 4.35s]
[0m10:44:45.561464 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m10:44:45.563463 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:45.564466 [debug] [MainThread]: On master: BEGIN
[0m10:44:45.564466 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:44:48.310204 [debug] [MainThread]: SQL status: BEGIN in 2.746 seconds
[0m10:44:48.311189 [debug] [MainThread]: On master: COMMIT
[0m10:44:48.311189 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:48.311189 [debug] [MainThread]: On master: COMMIT
[0m10:44:48.662318 [debug] [MainThread]: SQL status: COMMIT in 0.350 seconds
[0m10:44:48.663319 [info ] [MainThread]: 
[0m10:44:48.664319 [info ] [MainThread]: Running 1 on-run-end hook
[0m10:44:48.666321 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m10:44:48.671319 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m10:44:48.672320 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:48.672320 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m10:44:49.010396 [debug] [MainThread]: SQL status: GRANT in 0.337 seconds
[0m10:44:49.011397 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mGRANT[0m in 0.34s]
[0m10:44:49.012396 [info ] [MainThread]: 
[0m10:44:49.013405 [debug] [MainThread]: On master: Close
[0m10:44:49.014401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:49.014401 [debug] [MainThread]: Connection 'list_dev_3lcu_dbt' was properly closed.
[0m10:44:49.015397 [debug] [MainThread]: Connection 'list_dev_3lcu_finance' was properly closed.
[0m10:44:49.015397 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d' was properly closed.
[0m10:44:49.015397 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85' was properly closed.
[0m10:44:49.016396 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e' was properly closed.
[0m10:44:49.017405 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc' was properly closed.
[0m10:44:49.017405 [info ] [MainThread]: 
[0m10:44:49.018398 [info ] [MainThread]: Finished running 28 data tests, 1 project hook in 0 hours 0 minutes and 41.27 seconds (41.27s).
[0m10:44:49.023395 [debug] [MainThread]: Command end result
[0m10:44:49.067050 [info ] [MainThread]: 
[0m10:44:49.068050 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m10:44:49.069096 [info ] [MainThread]: 
[0m10:44:49.070051 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models\properties.yml)[0m
[0m10:44:49.071054 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m10:44:49.072055 [info ] [MainThread]: 
[0m10:44:49.073055 [info ] [MainThread]:   compiled code at target\compiled\dbt_scooters\models\properties.yml\source_not_null_scooters_raw_users_sex.sql
[0m10:44:49.074054 [info ] [MainThread]: 
[0m10:44:49.075054 [info ] [MainThread]: Done. PASS=27 WARN=1 ERROR=0 SKIP=0 TOTAL=28
[0m10:44:49.077060 [debug] [MainThread]: Command `dbt test` succeeded at 10:44:49.076052 after 44.84 seconds
[0m10:44:49.077060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077EE98140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077EDCF560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077AB81880>]}
[0m10:44:49.078099 [debug] [MainThread]: Flushing usage events
[0m10:45:03.097354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E712D03AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E713478B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E712D00A10>]}


============================== 10:45:03.102353 | d159cb8a-8159-41d5-91f9-0166b05c3e0f ==============================
[0m10:45:03.102353 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:45:03.103320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:45:03.356259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7136BA570>]}
[0m10:45:03.424415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7132AC3B0>]}
[0m10:45:03.426415 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:45:03.684089 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:45:03.929424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:45:03.930423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:45:04.013423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E713910E00>]}
[0m10:45:04.224023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E713930DA0>]}
[0m10:45:04.225027 [info ] [MainThread]: Found 19 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 437 macros
[0m10:45:04.232023 [info ] [MainThread]: 
[0m10:45:04.233024 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:45:04.239029 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m10:45:04.254056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m10:45:04.353193 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m10:45:04.353193 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m10:45:04.354159 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m10:45:04.355155 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m10:45:04.355155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:04.356164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:07.090335 [debug] [ThreadPool]: SQL status: SELECT 23 in 2.735 seconds
[0m10:45:07.092341 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m10:45:07.106339 [debug] [ThreadPool]: SQL status: SELECT 23 in 2.751 seconds
[0m10:45:07.109348 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m10:45:07.113344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_finance'
[0m10:45:07.119351 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m10:45:07.119351 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_dbt'
[0m10:45:07.120350 [debug] [ThreadPool]: On list_dev_3lcu_finance: BEGIN
[0m10:45:07.122351 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m10:45:07.122351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:07.123352 [debug] [ThreadPool]: On list_dev_3lcu_dbt: BEGIN
[0m10:45:07.124352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:09.887328 [debug] [ThreadPool]: SQL status: BEGIN in 2.763 seconds
[0m10:45:09.888331 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m10:45:09.888331 [debug] [ThreadPool]: On list_dev_3lcu_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_dbt"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m10:45:09.950334 [debug] [ThreadPool]: SQL status: BEGIN in 2.827 seconds
[0m10:45:09.951335 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m10:45:09.951335 [debug] [ThreadPool]: On list_dev_3lcu_finance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_finance"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m10:45:10.232426 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.343 seconds
[0m10:45:10.234425 [debug] [ThreadPool]: On list_dev_3lcu_dbt: ROLLBACK
[0m10:45:10.296027 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.344 seconds
[0m10:45:10.298013 [debug] [ThreadPool]: On list_dev_3lcu_finance: ROLLBACK
[0m10:45:10.569124 [debug] [ThreadPool]: On list_dev_3lcu_dbt: Close
[0m10:45:10.635256 [debug] [ThreadPool]: On list_dev_3lcu_finance: Close
[0m10:45:10.641254 [debug] [MainThread]: Using postgres connection "master"
[0m10:45:10.642254 [debug] [MainThread]: On master: BEGIN
[0m10:45:10.642254 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:45:13.322091 [debug] [MainThread]: SQL status: BEGIN in 2.680 seconds
[0m10:45:13.323114 [debug] [MainThread]: Using postgres connection "master"
[0m10:45:13.323114 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:45:14.211961 [debug] [MainThread]: SQL status: SELECT 4 in 0.888 seconds
[0m10:45:14.213997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7110FDD00>]}
[0m10:45:14.213997 [debug] [MainThread]: On master: ROLLBACK
[0m10:45:14.551982 [debug] [MainThread]: Using postgres connection "master"
[0m10:45:14.552982 [debug] [MainThread]: On master: BEGIN
[0m10:45:15.230168 [debug] [MainThread]: SQL status: BEGIN in 0.677 seconds
[0m10:45:15.230168 [debug] [MainThread]: On master: COMMIT
[0m10:45:15.231129 [debug] [MainThread]: Using postgres connection "master"
[0m10:45:15.231129 [debug] [MainThread]: On master: COMMIT
[0m10:45:15.571272 [debug] [MainThread]: SQL status: COMMIT in 0.339 seconds
[0m10:45:15.572316 [debug] [MainThread]: On master: Close
[0m10:45:15.572316 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:45:15.573276 [info ] [MainThread]: 
[0m10:45:15.579308 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.add_first_name_sex
[0m10:45:15.580274 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m10:45:15.580274 [debug] [Thread-3 (]: Began running node seed.dbt_scooters.event_types
[0m10:45:15.580274 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.scooters
[0m10:45:15.581277 [info ] [Thread-1 (]: 1 of 51 START seed file dbt.add_first_name_sex ................................. [RUN]
[0m10:45:15.582278 [info ] [Thread-2 (]: 2 of 51 START seed file dbt.age_groups ......................................... [RUN]
[0m10:45:15.583276 [info ] [Thread-3 (]: 3 of 51 START seed file dbt.event_types ........................................ [RUN]
[0m10:45:15.584311 [info ] [Thread-4 (]: 4 of 51 START seed file dbt.scooters ........................................... [RUN]
[0m10:45:15.585309 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.dbt_scooters.add_first_name_sex'
[0m10:45:15.586316 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.dbt_scooters.age_groups'
[0m10:45:15.587322 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.dbt_scooters.event_types'
[0m10:45:15.588317 [debug] [Thread-4 (]: Acquiring new postgres connection 'seed.dbt_scooters.scooters'
[0m10:45:15.589321 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.add_first_name_sex
[0m10:45:15.589321 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m10:45:15.590316 [debug] [Thread-3 (]: Began compiling node seed.dbt_scooters.event_types
[0m10:45:15.590316 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.scooters
[0m10:45:15.591321 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.add_first_name_sex
[0m10:45:15.591321 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m10:45:15.592351 [debug] [Thread-3 (]: Began executing node seed.dbt_scooters.event_types
[0m10:45:15.592351 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.scooters
[0m10:45:15.624357 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m10:45:15.629361 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:45:15.631321 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:45:15.634322 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: BEGIN
[0m10:45:15.638358 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:45:15.638358 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m10:45:15.639356 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: BEGIN
[0m10:45:15.639356 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:45:15.640357 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: BEGIN
[0m10:45:15.640357 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:45:15.641356 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:45:15.642325 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:45:18.313063 [debug] [Thread-2 (]: SQL status: BEGIN in 2.672 seconds
[0m10:45:18.314065 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:45:18.314065 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_3lcu"."dbt"."age_groups"
[0m10:45:18.317107 [debug] [Thread-3 (]: SQL status: BEGIN in 2.676 seconds
[0m10:45:18.318062 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:45:18.318062 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_3lcu"."dbt"."event_types"
[0m10:45:18.653192 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.338 seconds
[0m10:45:18.669224 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:45:18.670189 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.351 seconds
[0m10:45:18.670189 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_3lcu"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m10:45:18.672223 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:45:18.673224 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_3lcu"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m10:45:19.006338 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.333 seconds
[0m10:45:19.011335 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m10:45:19.012335 [debug] [Thread-3 (]: SQL status: INSERT 0 4 in 0.338 seconds
[0m10:45:19.014339 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m10:45:19.034342 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:45:19.035342 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  comment on table "dev_3lcu"."dbt"."age_groups" is $dbt_comment_literal_block$Age groups to split users for analysis$dbt_comment_literal_block$;

  
[0m10:45:19.037376 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:45:19.037376 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  comment on table "dev_3lcu"."dbt"."event_types" is $dbt_comment_literal_block$Table provides a mapping between unique event type identifiers (`type_id`) and their descriptive names (`type`). It is essential for converting numerical codes from user activity logs into readable descriptions for analysis of user interactions with application features.

The table is crucial for analytics and reporting, allowing for the decoding of event identifiers in user activity datasets. By joining with event logs, it facilitates intuitive reporting and dashboarding of user interactions. The mapping enables effective segmentation and analysis of user activities, such as:

- **start_search**: Represents the initiation of a search process by a user.
- **book_scooter**: Indicates that a user has booked a scooter.
- **release_scooter**: Signifies that a user has released a previously booked scooter.
- **cancel_search**: Denotes the cancellation of a search process by a user.$dbt_comment_literal_block$;

  
[0m10:45:19.238216 [debug] [Thread-4 (]: SQL status: BEGIN in 3.596 seconds
[0m10:45:19.239171 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:45:19.239171 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_3lcu"."dbt"."scooters"
[0m10:45:19.240172 [debug] [Thread-1 (]: SQL status: BEGIN in 3.600 seconds
[0m10:45:19.241170 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m10:45:19.241170 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */
truncate table "dev_3lcu"."dbt"."add_first_name_sex"
[0m10:45:19.369406 [debug] [Thread-2 (]: SQL status: COMMENT in 0.333 seconds
[0m10:45:19.386420 [debug] [Thread-3 (]: SQL status: COMMENT in 0.348 seconds
[0m10:45:19.393919 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:45:19.396454 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:45:19.397488 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'age_groups'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:45:19.398465 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'event_types'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:45:19.581318 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.340 seconds
[0m10:45:19.584305 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m10:45:19.584305 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: 
          insert into "dev_3lcu"."dbt"."add_first_name_sex" ("first_name", "sex") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m10:45:19.587323 [debug] [Thread-4 (]: SQL status: TRUNCATE TABLE in 0.347 seconds
[0m10:45:19.591891 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:45:19.591891 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_3lcu"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m10:45:19.813087 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.414 seconds
[0m10:45:19.813087 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.415 seconds
[0m10:45:19.817122 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:45:19.819109 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:45:19.820127 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".group is $dbt_comment_literal_block$Age group name for report$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".age_start is $dbt_comment_literal_block$Start age of group$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".age_end is $dbt_comment_literal_block$End age of group$dbt_comment_literal_block$;
  

  
[0m10:45:19.820127 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."event_types".type_id is $dbt_comment_literal_block$An integer serving as a unique identifier for each event type. It is used in user event tables as a foreign key to link events to their descriptions
$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."event_types".type is $dbt_comment_literal_block$A string describing the event type, enhancing the interpretability of event data by providing a human-readable label
$dbt_comment_literal_block$;
  

  
[0m10:45:19.923311 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.338 seconds
[0m10:45:19.924311 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.add_first_name_sex"
[0m10:45:19.928346 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m10:45:19.929314 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  comment on table "dev_3lcu"."dbt"."add_first_name_sex" is $dbt_comment_literal_block$additional name_sex glossary$dbt_comment_literal_block$;

  
[0m10:45:19.933355 [debug] [Thread-4 (]: SQL status: INSERT 0 10 in 0.341 seconds
[0m10:45:19.934315 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m10:45:19.937316 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:45:19.937316 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  comment on table "dev_3lcu"."dbt"."scooters" is $dbt_comment_literal_block$Scooter models information and park statistics by model. Includes information about the manufacturing company. Data received from the service team and uploaded by Mark. Data is current as of summer 2023.
$dbt_comment_literal_block$;

  
[0m10:45:20.154435 [debug] [Thread-2 (]: SQL status: COMMENT in 0.333 seconds
[0m10:45:20.155402 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m10:45:20.156434 [debug] [Thread-3 (]: SQL status: COMMENT in 0.335 seconds
[0m10:45:20.156434 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:45:20.158434 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m10:45:20.158434 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m10:45:20.159435 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:45:20.159435 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m10:45:20.266330 [debug] [Thread-1 (]: SQL status: COMMENT in 0.337 seconds
[0m10:45:20.269319 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m10:45:20.270317 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'add_first_name_sex'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:45:20.279329 [debug] [Thread-4 (]: SQL status: COMMENT in 0.341 seconds
[0m10:45:20.282320 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:45:20.282320 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'scooters'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:45:20.493993 [debug] [Thread-2 (]: SQL status: COMMIT in 0.334 seconds
[0m10:45:20.495949 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m10:45:20.496983 [debug] [Thread-3 (]: SQL status: COMMIT in 0.337 seconds
[0m10:45:20.497952 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: Close
[0m10:45:20.498949 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E711098E90>]}
[0m10:45:20.500949 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71546C380>]}
[0m10:45:20.499984 [info ] [Thread-2 (]: 2 of 51 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 4.91s]
[0m10:45:20.502988 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m10:45:20.501948 [info ] [Thread-3 (]: 3 of 51 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 4.91s]
[0m10:45:20.503949 [debug] [Thread-2 (]: Began running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m10:45:20.504948 [debug] [Thread-3 (]: Finished running node seed.dbt_scooters.event_types
[0m10:45:20.507462 [debug] [Thread-3 (]: Began running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m10:45:20.506454 [info ] [Thread-2 (]: 5 of 51 START test every_event_has_user ........................................ [RUN]
[0m10:45:20.508490 [info ] [Thread-3 (]: 6 of 51 START test every_trip_has_user ......................................... [RUN]
[0m10:45:20.508490 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now test.dbt_scooters.every_event_has_user.7eea25f36c)
[0m10:45:20.509487 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now test.dbt_scooters.every_trip_has_user.6bc71135e2)
[0m10:45:20.510462 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m10:45:20.510462 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m10:45:20.529048 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m10:45:20.534011 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m10:45:20.536012 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m10:45:20.537021 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m10:45:20.556021 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m10:45:20.559018 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m10:45:20.561017 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m10:45:20.561017 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m10:45:20.562017 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: BEGIN
[0m10:45:20.562017 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: BEGIN
[0m10:45:20.563017 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:20.563017 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:20.625242 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.354 seconds
[0m10:45:20.627289 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m10:45:20.627289 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."add_first_name_sex".first_name is $dbt_comment_literal_block$First name of user$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."add_first_name_sex".sex is $dbt_comment_literal_block$user gender$dbt_comment_literal_block$;
  

  
[0m10:45:20.718369 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.435 seconds
[0m10:45:20.720370 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:45:20.720370 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".company is $dbt_comment_literal_block$Scooter company model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".model is $dbt_comment_literal_block$Scooter model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".hardware_id is $dbt_comment_literal_block$scooter model id$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".scooters is $dbt_comment_literal_block$Count of scooters$dbt_comment_literal_block$;
  

  
[0m10:45:20.963196 [debug] [Thread-1 (]: SQL status: COMMENT in 0.335 seconds
[0m10:45:20.964196 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m10:45:20.965194 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m10:45:20.965194 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m10:45:21.063376 [debug] [Thread-4 (]: SQL status: COMMENT in 0.342 seconds
[0m10:45:21.064377 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m10:45:21.065377 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:45:21.065377 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m10:45:21.303440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.337 seconds
[0m10:45:21.304435 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: Close
[0m10:45:21.304435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71597D700>]}
[0m10:45:21.305942 [info ] [Thread-1 (]: 1 of 51 OK loaded seed file dbt.add_first_name_sex ............................. [[32mINSERT 5[0m in 5.72s]
[0m10:45:21.306948 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.add_first_name_sex
[0m10:45:21.307971 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m10:45:21.308950 [info ] [Thread-1 (]: 7 of 51 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m10:45:21.308950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.add_first_name_sex, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m10:45:21.309951 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m10:45:21.318980 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m10:45:21.319955 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m10:45:21.322977 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m10:45:21.323950 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m10:45:21.324951 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m10:45:21.324951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:21.408117 [debug] [Thread-4 (]: SQL status: COMMIT in 0.342 seconds
[0m10:45:21.409121 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: Close
[0m10:45:21.410121 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715502EA0>]}
[0m10:45:21.410121 [info ] [Thread-4 (]: 4 of 51 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 5.82s]
[0m10:45:21.412118 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.scooters
[0m10:45:21.413120 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m10:45:21.414118 [info ] [Thread-4 (]: 8 of 51 START test source_not_null_scooters_raw_events_type_id ................. [RUN]
[0m10:45:21.415116 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7)
[0m10:45:21.416119 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m10:45:21.422129 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m10:45:21.423130 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m10:45:21.425127 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m10:45:21.426132 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m10:45:21.427131 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: BEGIN
[0m10:45:21.428132 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:23.244064 [debug] [Thread-3 (]: SQL status: BEGIN in 2.680 seconds
[0m10:45:23.244064 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m10:45:23.245066 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_user.6bc71135e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:45:23.323355 [debug] [Thread-2 (]: SQL status: BEGIN in 2.760 seconds
[0m10:45:23.324336 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m10:45:23.324336 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_user.7eea25f36c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:45:23.714476 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.469 seconds
[0m10:45:23.717991 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: ROLLBACK
[0m10:45:24.108430 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: Close
[0m10:45:24.109425 [info ] [Thread-3 (]: 6 of 51 PASS every_trip_has_user ............................................... [[32mPASS[0m in 3.60s]
[0m10:45:24.110424 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m10:45:24.111428 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m10:45:24.112425 [debug] [Thread-1 (]: SQL status: BEGIN in 2.787 seconds
[0m10:45:24.113428 [info ] [Thread-3 (]: 9 of 51 START test source_not_null_scooters_raw_events_user_id ................. [RUN]
[0m10:45:24.113428 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m10:45:24.114428 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_user.6bc71135e2, now test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b)
[0m10:45:24.115425 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m10:45:24.115425 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m10:45:24.119460 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m10:45:24.121424 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m10:45:24.123427 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m10:45:24.124475 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m10:45:24.124475 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: BEGIN
[0m10:45:24.126008 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:24.708449 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.592 seconds
[0m10:45:24.710437 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m10:45:25.109206 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.784 seconds
[0m10:45:25.110206 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: ROLLBACK
[0m10:45:25.137261 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m10:45:25.138239 [info ] [Thread-1 (]: 7 of 51 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 3.83s]
[0m10:45:25.140208 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m10:45:25.141220 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m10:45:25.141220 [info ] [Thread-1 (]: 10 of 51 START test source_not_null_scooters_raw_trips_id ...................... [RUN]
[0m10:45:25.142209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d)
[0m10:45:25.143208 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m10:45:25.146206 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m10:45:25.147211 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m10:45:25.149212 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m10:45:25.151212 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m10:45:25.151212 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: BEGIN
[0m10:45:25.152212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:25.351027 [debug] [Thread-4 (]: SQL status: BEGIN in 3.924 seconds
[0m10:45:25.351986 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m10:45:25.351986 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from "dev_3lcu"."scooters_raw"."events"
where type_id is null



      
    ) dbt_internal_test
[0m10:45:25.447198 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: Close
[0m10:45:25.449201 [info ] [Thread-2 (]: 5 of 51 PASS every_event_has_user .............................................. [[32mPASS[0m in 4.94s]
[0m10:45:25.450198 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m10:45:25.451202 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m10:45:25.451202 [info ] [Thread-2 (]: 11 of 51 START test source_not_null_scooters_raw_trips_scooter_hw_id ........... [RUN]
[0m10:45:25.452200 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_user.7eea25f36c, now test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f)
[0m10:45:25.453203 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m10:45:25.456200 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m10:45:25.458200 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m10:45:25.460200 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m10:45:25.461200 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m10:45:25.461200 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: BEGIN
[0m10:45:25.462200 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:26.120238 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.767 seconds
[0m10:45:26.121238 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: ROLLBACK
[0m10:45:26.469076 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: Close
[0m10:45:26.470071 [info ] [Thread-4 (]: 8 of 51 PASS source_not_null_scooters_raw_events_type_id ....................... [[32mPASS[0m in 5.05s]
[0m10:45:26.471077 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m10:45:26.472093 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m10:45:26.473076 [info ] [Thread-4 (]: 12 of 51 START test source_not_null_scooters_raw_trips_user_id ................. [RUN]
[0m10:45:26.473076 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7, now test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62)
[0m10:45:26.474079 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m10:45:26.479076 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m10:45:26.480076 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m10:45:26.482076 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m10:45:26.483083 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m10:45:26.484078 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: BEGIN
[0m10:45:26.484078 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:27.034130 [debug] [Thread-3 (]: SQL status: BEGIN in 2.908 seconds
[0m10:45:27.035081 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m10:45:27.036082 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."events"
where user_id is null



      
    ) dbt_internal_test
[0m10:45:27.615275 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.579 seconds
[0m10:45:27.617314 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: ROLLBACK
[0m10:45:27.949079 [debug] [Thread-1 (]: SQL status: BEGIN in 2.797 seconds
[0m10:45:27.949079 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m10:45:27.950081 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."trips"
where id is null



      
    ) dbt_internal_test
[0m10:45:27.958081 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: Close
[0m10:45:27.959079 [info ] [Thread-3 (]: 9 of 51 PASS source_not_null_scooters_raw_events_user_id ....................... [[32mPASS[0m in 3.84s]
[0m10:45:27.960079 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m10:45:27.961120 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m10:45:27.962079 [info ] [Thread-3 (]: 13 of 51 START test source_not_null_scooters_raw_users_id ...................... [RUN]
[0m10:45:27.962079 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b, now test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d)
[0m10:45:27.963081 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m10:45:27.966079 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m10:45:27.968086 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m10:45:27.970085 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m10:45:27.972087 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m10:45:27.973087 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: BEGIN
[0m10:45:27.973087 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:28.311968 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.362 seconds
[0m10:45:28.313968 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: ROLLBACK
[0m10:45:28.654045 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: Close
[0m10:45:28.656002 [info ] [Thread-1 (]: 10 of 51 PASS source_not_null_scooters_raw_trips_id ............................ [[32mPASS[0m in 3.51s]
[0m10:45:28.657001 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m10:45:28.658003 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m10:45:28.658003 [info ] [Thread-1 (]: 14 of 51 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m10:45:28.659040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m10:45:28.660002 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m10:45:28.663999 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m10:45:28.664999 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m10:45:28.668007 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m10:45:28.669007 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m10:45:28.670007 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m10:45:28.670007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:29.080263 [debug] [Thread-2 (]: SQL status: BEGIN in 3.618 seconds
[0m10:45:29.081226 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m10:45:29.082226 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select scooter_hw_id
from "dev_3lcu"."scooters_raw"."trips"
where scooter_hw_id is null



      
    ) dbt_internal_test
[0m10:45:29.171959 [debug] [Thread-4 (]: SQL status: BEGIN in 2.687 seconds
[0m10:45:29.171959 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m10:45:29.172960 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."trips"
where user_id is null



      
    ) dbt_internal_test
[0m10:45:29.442031 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.359 seconds
[0m10:45:29.444031 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: ROLLBACK
[0m10:45:29.517238 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.344 seconds
[0m10:45:29.519243 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: ROLLBACK
[0m10:45:29.795283 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: Close
[0m10:45:29.797282 [info ] [Thread-2 (]: 11 of 51 PASS source_not_null_scooters_raw_trips_scooter_hw_id ................. [[32mPASS[0m in 4.34s]
[0m10:45:29.799284 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m10:45:29.800285 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m10:45:29.801279 [info ] [Thread-2 (]: 15 of 51 START test source_unique_scooters_raw_trips_id ........................ [RUN]
[0m10:45:29.802282 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f, now test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4)
[0m10:45:29.803280 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m10:45:29.809291 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m10:45:29.811291 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m10:45:29.813294 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m10:45:29.815291 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m10:45:29.815291 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: BEGIN
[0m10:45:29.816298 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:29.873303 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: Close
[0m10:45:29.874307 [info ] [Thread-4 (]: 12 of 51 PASS source_not_null_scooters_raw_trips_user_id ....................... [[32mPASS[0m in 3.40s]
[0m10:45:29.875298 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m10:45:29.876307 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m10:45:29.877309 [info ] [Thread-4 (]: 16 of 51 START test source_unique_scooters_raw_users_id ........................ [RUN]
[0m10:45:29.878307 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62, now test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf)
[0m10:45:29.878307 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m10:45:29.882341 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m10:45:29.884310 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m10:45:29.886348 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m10:45:29.887351 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m10:45:29.888315 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: BEGIN
[0m10:45:29.888315 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:31.382137 [debug] [Thread-1 (]: SQL status: BEGIN in 2.712 seconds
[0m10:45:31.383143 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m10:45:31.383143 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sex
from "dev_3lcu"."scooters_raw"."users"
where sex is null



      
    ) dbt_internal_test
[0m10:45:31.539346 [debug] [Thread-3 (]: SQL status: BEGIN in 3.566 seconds
[0m10:45:31.540346 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m10:45:31.541346 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."users"
where id is null



      
    ) dbt_internal_test
[0m10:45:31.725965 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.342 seconds
[0m10:45:31.728013 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m10:45:31.883197 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.340 seconds
[0m10:45:31.884198 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: ROLLBACK
[0m10:45:32.069194 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m10:45:32.071193 [warn ] [Thread-1 (]: 14 of 51 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 3.41s]
[0m10:45:32.072197 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m10:45:32.073197 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m10:45:32.074194 [info ] [Thread-1 (]: 17 of 51 START test unique_not_null_age_groups_age_end ......................... [RUN]
[0m10:45:32.075195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac)
[0m10:45:32.076196 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m10:45:32.083194 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m10:45:32.085193 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m10:45:32.088194 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m10:45:32.090195 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m10:45:32.091195 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: BEGIN
[0m10:45:32.091195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:32.225940 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: Close
[0m10:45:32.226893 [info ] [Thread-3 (]: 13 of 51 PASS source_not_null_scooters_raw_users_id ............................ [[32mPASS[0m in 4.26s]
[0m10:45:32.228894 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m10:45:32.229894 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m10:45:32.230895 [info ] [Thread-3 (]: 18 of 51 START test unique_not_null_age_groups_age_start ....................... [RUN]
[0m10:45:32.231893 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d, now test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b)
[0m10:45:32.231893 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m10:45:32.237935 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m10:45:32.238930 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m10:45:32.240934 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m10:45:32.242891 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m10:45:32.242891 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: BEGIN
[0m10:45:32.243897 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:32.459350 [debug] [Thread-2 (]: SQL status: BEGIN in 2.643 seconds
[0m10:45:32.459350 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m10:45:32.460349 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."trips"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:45:32.534974 [debug] [Thread-4 (]: SQL status: BEGIN in 2.646 seconds
[0m10:45:32.535922 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m10:45:32.535922 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."users"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:45:32.912839 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.376 seconds
[0m10:45:32.914807 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: ROLLBACK
[0m10:45:33.315960 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: Close
[0m10:45:33.316972 [info ] [Thread-4 (]: 16 of 51 PASS source_unique_scooters_raw_users_id .............................. [[32mPASS[0m in 3.44s]
[0m10:45:33.317971 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m10:45:33.318974 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m10:45:33.318974 [info ] [Thread-4 (]: 19 of 51 START test unique_not_null_age_groups_group ........................... [RUN]
[0m10:45:33.320008 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf, now test.dbt_scooters.unique_not_null_age_groups_group.39342291f1)
[0m10:45:33.321009 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m10:45:33.325007 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m10:45:33.326006 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m10:45:33.328002 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m10:45:33.329971 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m10:45:33.329971 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: BEGIN
[0m10:45:33.331002 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:33.517428 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.056 seconds
[0m10:45:33.518431 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: ROLLBACK
[0m10:45:33.907337 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: Close
[0m10:45:33.908299 [info ] [Thread-2 (]: 15 of 51 PASS source_unique_scooters_raw_trips_id .............................. [[32mPASS[0m in 4.11s]
[0m10:45:33.909362 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m10:45:33.911303 [debug] [Thread-2 (]: Began running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m10:45:33.911303 [info ] [Thread-2 (]: 20 of 51 START test every_event_has_type ....................................... [RUN]
[0m10:45:33.912339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4, now test.dbt_scooters.every_event_has_type.1e5fc977eb)
[0m10:45:33.913491 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m10:45:33.920011 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m10:45:33.921012 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m10:45:33.923011 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m10:45:33.924011 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m10:45:33.925010 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: BEGIN
[0m10:45:33.925010 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:34.949319 [debug] [Thread-1 (]: SQL status: BEGIN in 2.857 seconds
[0m10:45:34.949319 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m10:45:34.950319 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_end"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_end" is null


      
    ) dbt_internal_test
[0m10:45:35.026340 [debug] [Thread-3 (]: SQL status: BEGIN in 2.783 seconds
[0m10:45:35.027343 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m10:45:35.027343 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_start"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_start" is null


      
    ) dbt_internal_test
[0m10:45:35.309010 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.358 seconds
[0m10:45:35.312010 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: ROLLBACK
[0m10:45:35.384068 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.356 seconds
[0m10:45:35.386070 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: ROLLBACK
[0m10:45:35.666294 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: Close
[0m10:45:35.668306 [info ] [Thread-1 (]: 17 of 51 PASS unique_not_null_age_groups_age_end ............................... [[32mPASS[0m in 3.59s]
[0m10:45:35.669294 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m10:45:35.670298 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m10:45:35.671298 [info ] [Thread-1 (]: 21 of 51 START test unique_not_null_event_types_type ........................... [RUN]
[0m10:45:35.672299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac, now test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1)
[0m10:45:35.672299 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m10:45:35.676305 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m10:45:35.677308 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m10:45:35.679308 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m10:45:35.681308 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m10:45:35.681308 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: BEGIN
[0m10:45:35.682309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:35.728364 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: Close
[0m10:45:35.729378 [info ] [Thread-3 (]: 18 of 51 PASS unique_not_null_age_groups_age_start ............................. [[32mPASS[0m in 3.50s]
[0m10:45:35.730382 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m10:45:35.731366 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m10:45:35.732367 [info ] [Thread-3 (]: 22 of 51 START test unique_not_null_event_types_type_id ........................ [RUN]
[0m10:45:35.732367 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b, now test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85)
[0m10:45:35.733368 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m10:45:35.736371 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m10:45:35.738371 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m10:45:35.740374 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m10:45:35.741372 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m10:45:35.741372 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: BEGIN
[0m10:45:35.742372 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:36.098133 [debug] [Thread-4 (]: SQL status: BEGIN in 2.768 seconds
[0m10:45:36.099138 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m10:45:36.100134 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "group"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "group" is null


      
    ) dbt_internal_test
[0m10:45:36.452925 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.352 seconds
[0m10:45:36.455927 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: ROLLBACK
[0m10:45:36.624192 [debug] [Thread-2 (]: SQL status: BEGIN in 2.699 seconds
[0m10:45:36.625207 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m10:45:36.626216 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_type.1e5fc977eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where type_id is not null
),

parent as (
    select type_id as to_field
    from "dev_3lcu"."dbt"."event_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:45:36.809904 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: Close
[0m10:45:36.810907 [info ] [Thread-4 (]: 19 of 51 PASS unique_not_null_age_groups_group ................................. [[32mPASS[0m in 3.49s]
[0m10:45:36.812907 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m10:45:36.812907 [debug] [Thread-4 (]: Began running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m10:45:36.813907 [info ] [Thread-4 (]: 23 of 51 START test accepted_values_add_first_name_sex_sex__M__F ............... [RUN]
[0m10:45:36.814905 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_group.39342291f1, now test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199)
[0m10:45:36.815420 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m10:45:36.818426 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m10:45:36.820429 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m10:45:36.822425 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m10:45:36.823448 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m10:45:36.823448 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: BEGIN
[0m10:45:36.824426 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:37.816742 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.190 seconds
[0m10:45:37.819782 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: ROLLBACK
[0m10:45:38.156343 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: Close
[0m10:45:38.157343 [info ] [Thread-2 (]: 20 of 51 PASS every_event_has_type ............................................. [[32mPASS[0m in 4.25s]
[0m10:45:38.158342 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m10:45:38.159378 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m10:45:38.160345 [info ] [Thread-2 (]: 24 of 51 START test unique_not_null_add_first_name_sex_first_name .............. [RUN]
[0m10:45:38.161344 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_type.1e5fc977eb, now test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f)
[0m10:45:38.161344 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m10:45:38.168379 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m10:45:38.169344 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m10:45:38.224923 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m10:45:38.226434 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m10:45:38.227446 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: BEGIN
[0m10:45:38.227446 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:38.627070 [debug] [Thread-3 (]: SQL status: BEGIN in 2.885 seconds
[0m10:45:38.628069 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m10:45:38.628069 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type_id"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type_id" is null


      
    ) dbt_internal_test
[0m10:45:38.745159 [debug] [Thread-1 (]: SQL status: BEGIN in 3.063 seconds
[0m10:45:38.746164 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m10:45:38.746164 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type" is null


      
    ) dbt_internal_test
[0m10:45:38.968284 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.339 seconds
[0m10:45:38.970284 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: ROLLBACK
[0m10:45:39.095029 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.348 seconds
[0m10:45:39.097052 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: ROLLBACK
[0m10:45:39.311039 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: Close
[0m10:45:39.311992 [info ] [Thread-3 (]: 22 of 51 PASS unique_not_null_event_types_type_id .............................. [[32mPASS[0m in 3.58s]
[0m10:45:39.313036 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m10:45:39.314001 [debug] [Thread-3 (]: Began running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m10:45:39.314992 [info ] [Thread-3 (]: 25 of 51 START test every_trip_has_scooter_id .................................. [RUN]
[0m10:45:39.315995 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85, now test.dbt_scooters.every_trip_has_scooter_id.e0b845a190)
[0m10:45:39.315995 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m10:45:39.321503 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m10:45:39.322503 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m10:45:39.324508 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m10:45:39.327029 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m10:45:39.327029 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: BEGIN
[0m10:45:39.328029 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:39.438287 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: Close
[0m10:45:39.439284 [info ] [Thread-1 (]: 21 of 51 PASS unique_not_null_event_types_type ................................. [[32mPASS[0m in 3.77s]
[0m10:45:39.440238 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m10:45:39.441242 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m10:45:39.442240 [info ] [Thread-1 (]: 26 of 51 START test unique_key_scooters_company__model__hardware_id ............ [RUN]
[0m10:45:39.443238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1, now test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e)
[0m10:45:39.443238 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m10:45:39.450267 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m10:45:39.451268 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m10:45:39.453237 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m10:45:39.455242 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m10:45:39.456242 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: BEGIN
[0m10:45:39.456242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:40.419877 [debug] [Thread-4 (]: SQL status: BEGIN in 3.595 seconds
[0m10:45:40.419877 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m10:45:40.419877 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."dbt"."add_first_name_sex"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m10:45:40.765248 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.344 seconds
[0m10:45:40.767250 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: ROLLBACK
[0m10:45:40.934095 [debug] [Thread-2 (]: SQL status: BEGIN in 2.706 seconds
[0m10:45:40.935095 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m10:45:40.935095 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "first_name"
from
    "dev_3lcu"."dbt"."add_first_name_sex"
group by
    1
having
    count(*) > 1 or "first_name" is null


      
    ) dbt_internal_test
[0m10:45:41.117297 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: Close
[0m10:45:41.118300 [info ] [Thread-4 (]: 23 of 51 PASS accepted_values_add_first_name_sex_sex__M__F ..................... [[32mPASS[0m in 4.30s]
[0m10:45:41.119298 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m10:45:41.120299 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m10:45:41.120299 [info ] [Thread-4 (]: 27 of 51 START test unique_not_null_scooters_hardware_id ....................... [RUN]
[0m10:45:41.121299 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199, now test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d)
[0m10:45:41.122809 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m10:45:41.126332 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m10:45:41.127343 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m10:45:41.129342 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m10:45:41.130342 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m10:45:41.131343 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: BEGIN
[0m10:45:41.131343 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:41.273170 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.337 seconds
[0m10:45:41.275170 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: ROLLBACK
[0m10:45:41.616107 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: Close
[0m10:45:41.617126 [info ] [Thread-2 (]: 24 of 51 PASS unique_not_null_add_first_name_sex_first_name .................... [[32mPASS[0m in 3.46s]
[0m10:45:41.618156 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m10:45:41.619115 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m10:45:41.620115 [info ] [Thread-2 (]: 28 of 51 START test unique_not_null_scooters_model ............................. [RUN]
[0m10:45:41.621110 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f, now test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc)
[0m10:45:41.621110 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m10:45:41.624621 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m10:45:41.626126 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m10:45:41.628135 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m10:45:41.629135 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m10:45:41.630135 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: BEGIN
[0m10:45:41.630135 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:42.060241 [debug] [Thread-3 (]: SQL status: BEGIN in 2.733 seconds
[0m10:45:42.061192 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m10:45:42.062242 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select scooter_hw_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where scooter_hw_id is not null
),

parent as (
    select hardware_id as to_field
    from "dev_3lcu"."dbt"."scooters"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:45:42.126336 [debug] [Thread-1 (]: SQL status: BEGIN in 2.670 seconds
[0m10:45:42.127346 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m10:45:42.127346 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "company"::text ||
    
        "model"::text ||
    
        "hardware_id"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m10:45:42.522912 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.395 seconds
[0m10:45:42.523912 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: ROLLBACK
[0m10:45:42.657231 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.595 seconds
[0m10:45:42.659236 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: ROLLBACK
[0m10:45:42.868234 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: Close
[0m10:45:42.869216 [info ] [Thread-1 (]: 26 of 51 PASS unique_key_scooters_company__model__hardware_id .................. [[32mPASS[0m in 3.43s]
[0m10:45:42.871178 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m10:45:42.871178 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m10:45:42.872214 [info ] [Thread-1 (]: 29 of 51 START sql incremental model dbt.events_clean .......................... [RUN]
[0m10:45:42.873177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e, now model.dbt_scooters.events_clean)
[0m10:45:42.873177 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m10:45:42.881212 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m10:45:42.882180 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m10:45:42.939345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:42.940346 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp104542919179"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at

from
    "dev_3lcu"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."events_clean")
    

  );
  
  
[0m10:45:42.941347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:43.008957 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: Close
[0m10:45:43.010961 [info ] [Thread-3 (]: 25 of 51 PASS every_trip_has_scooter_id ........................................ [[32mPASS[0m in 3.69s]
[0m10:45:43.011960 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m10:45:43.012960 [debug] [Thread-3 (]: Began running node model.dbt_scooters.first_name_sex
[0m10:45:43.012960 [info ] [Thread-3 (]: 30 of 51 START sql table model dbt.first_name_sex .............................. [RUN]
[0m10:45:43.013958 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_scooter_id.e0b845a190, now model.dbt_scooters.first_name_sex)
[0m10:45:43.014960 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.first_name_sex
[0m10:45:43.016964 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.first_name_sex"
[0m10:45:43.019963 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.first_name_sex
[0m10:45:43.032479 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.first_name_sex"
[0m10:45:43.034479 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m10:45:43.034479 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: BEGIN
[0m10:45:43.035987 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:43.882295 [debug] [Thread-4 (]: SQL status: BEGIN in 2.750 seconds
[0m10:45:43.882295 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m10:45:43.883297 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "hardware_id"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "hardware_id" is null


      
    ) dbt_internal_test
[0m10:45:44.230535 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.347 seconds
[0m10:45:44.232493 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: ROLLBACK
[0m10:45:44.357972 [debug] [Thread-2 (]: SQL status: BEGIN in 2.728 seconds
[0m10:45:44.358966 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m10:45:44.358966 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "model"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "model" is null


      
    ) dbt_internal_test
[0m10:45:44.579016 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: Close
[0m10:45:44.580024 [info ] [Thread-4 (]: 27 of 51 PASS unique_not_null_scooters_hardware_id ............................. [[32mPASS[0m in 3.46s]
[0m10:45:44.581022 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m10:45:44.582021 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_concurrency
[0m10:45:44.583024 [info ] [Thread-4 (]: 31 of 51 START sql incremental model dbt.trips_concurrency ..................... [RUN]
[0m10:45:44.584024 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d, now model.dbt_scooters.trips_concurrency)
[0m10:45:44.584024 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m10:45:44.588022 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m10:45:44.590026 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m10:45:44.594022 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:44.594022 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp104544592022"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_3lcu"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_3lcu"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now()  as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m10:45:44.595039 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:44.709248 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.350 seconds
[0m10:45:44.711229 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: ROLLBACK
[0m10:45:45.055126 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: Close
[0m10:45:45.057127 [info ] [Thread-2 (]: 28 of 51 PASS unique_not_null_scooters_model ................................... [[32mPASS[0m in 3.44s]
[0m10:45:45.058135 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m10:45:45.059133 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_geom
[0m10:45:45.060134 [info ] [Thread-2 (]: 32 of 51 START sql view model dbt.trips_geom ................................... [RUN]
[0m10:45:45.062131 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc, now model.dbt_scooters.trips_geom)
[0m10:45:45.062131 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_geom
[0m10:45:45.066165 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m10:45:45.067129 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_geom
[0m10:45:45.085127 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m10:45:45.087132 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:45:45.088128 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m10:45:45.088128 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:46.415158 [debug] [Thread-1 (]: SQL status: SELECT 0 in 3.475 seconds
[0m10:45:46.418206 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:46.419207 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m10:45:46.743258 [debug] [Thread-3 (]: SQL status: BEGIN in 3.708 seconds
[0m10:45:46.744250 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m10:45:46.744250 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

  
    

  create  table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp"
  
  
    as
  
  (
    select distinct first_name, sex
from "dev_3lcu"."scooters_raw"."users"
Where sex is not null
  );
  
[0m10:45:46.756257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.337 seconds
[0m10:45:46.757251 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:46.757251 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp104542919179'
        
      order by ordinal_position

  
[0m10:45:47.092406 [debug] [Thread-3 (]: SQL status: SELECT 387 in 0.347 seconds
[0m10:45:47.101924 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m10:45:47.102933 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex" rename to "first_name_sex__dbt_backup"
[0m10:45:47.108962 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.351 seconds
[0m10:45:47.111949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:47.112949 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:45:47.443848 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.340 seconds
[0m10:45:47.446881 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m10:45:47.446881 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp" rename to "first_name_sex"
[0m10:45:47.509881 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.396 seconds
[0m10:45:47.521882 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:47.522881 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp104542919179'
        
      order by ordinal_position

  
[0m10:45:47.808885 [debug] [Thread-2 (]: SQL status: BEGIN in 2.720 seconds
[0m10:45:47.808885 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:45:47.809887 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.362 seconds
[0m10:45:47.809887 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_3lcu"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m10:45:47.816890 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m10:45:47.817891 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

    
  
  comment on table "dev_3lcu"."dbt"."first_name_sex" is $dbt_comment_literal_block$Unique name_sex glossary$dbt_comment_literal_block$;

  
[0m10:45:48.013044 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.490 seconds
[0m10:45:48.017030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:48.017997 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:45:48.209996 [debug] [Thread-3 (]: SQL status: COMMENT in 0.391 seconds
[0m10:45:48.212033 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m10:45:48.212033 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m10:45:48.213031 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m10:45:48.218045 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.400 seconds
[0m10:45:48.220996 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:45:48.221997 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m10:45:48.413042 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.394 seconds
[0m10:45:48.422040 [debug] [Thread-1 (]: 
    In "dev_3lcu"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:45:48.437174 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m10:45:48.440134 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:48.441179 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        
            delete from "dev_3lcu"."dbt"."events_clean"
            using "events_clean__dbt_tmp104542919179"
            where (
                
                    "events_clean__dbt_tmp104542919179".user_id = "dev_3lcu"."dbt"."events_clean".user_id
                    and 
                
                    "events_clean__dbt_tmp104542919179".timestamp = "dev_3lcu"."dbt"."events_clean".timestamp
                    and 
                
                    "events_clean__dbt_tmp104542919179".type_id = "dev_3lcu"."dbt"."events_clean".type_id
                    
                
                
            );
        
    

    insert into "dev_3lcu"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp104542919179"
    )
  
[0m10:45:48.606994 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.385 seconds
[0m10:45:48.609944 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:45:48.610944 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m10:45:48.709183 [debug] [Thread-3 (]: SQL status: COMMIT in 0.496 seconds
[0m10:45:48.716212 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."first_name_sex__dbt_backup"
[0m10:45:48.720212 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m10:45:48.721219 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
drop table if exists "dev_3lcu"."dbt"."first_name_sex__dbt_backup" cascade
[0m10:45:48.809998 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.368 seconds
[0m10:45:48.812030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:48.812030 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_clean" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m10:45:48.915180 [debug] [Thread-4 (]: SQL status: SELECT 0 in 4.319 seconds
[0m10:45:48.918190 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:48.918190 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m10:45:48.944215 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.333 seconds
[0m10:45:48.946254 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:45:48.946254 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_geom" is $dbt_comment_literal_block$Trips prepared for geometry analysis$dbt_comment_literal_block$;

  
[0m10:45:49.080063 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.359 seconds
[0m10:45:49.082009 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: Close
[0m10:45:49.083006 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71546C230>]}
[0m10:45:49.084008 [info ] [Thread-3 (]: 30 of 51 OK created sql table model dbt.first_name_sex ......................... [[32mSELECT 387[0m in 6.07s]
[0m10:45:49.086011 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.first_name_sex
[0m10:45:49.087006 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_prep
[0m10:45:49.088007 [info ] [Thread-3 (]: 33 of 51 START sql view model dbt.trips_prep ................................... [RUN]
[0m10:45:49.088007 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.first_name_sex, now model.dbt_scooters.trips_prep)
[0m10:45:49.089008 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_prep
[0m10:45:49.094006 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m10:45:49.096006 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_prep
[0m10:45:49.101013 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m10:45:49.103014 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:45:49.104015 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m10:45:49.105012 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:49.152100 [debug] [Thread-1 (]: SQL status: COMMENT in 0.339 seconds
[0m10:45:49.154091 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:45:49.154091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:49.155091 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:45:49.259962 [debug] [Thread-4 (]: SQL status: BEGIN in 0.341 seconds
[0m10:45:49.260914 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:49.261915 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp104544592022'
        
      order by ordinal_position

  
[0m10:45:49.279911 [debug] [Thread-2 (]: SQL status: COMMENT in 0.333 seconds
[0m10:45:49.280952 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m10:45:49.281948 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:45:49.281948 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m10:45:49.494250 [debug] [Thread-1 (]: SQL status: COMMIT in 0.339 seconds
[0m10:45:49.495244 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m10:45:49.496255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715958B00>]}
[0m10:45:49.497253 [info ] [Thread-1 (]: 29 of 51 OK created sql incremental model dbt.events_clean ..................... [[32mINSERT 0 0[0m in 6.62s]
[0m10:45:49.498250 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m10:45:49.499250 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m10:45:49.500253 [info ] [Thread-1 (]: 34 of 51 START sql table model dbt.companies ................................... [RUN]
[0m10:45:49.501253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.companies)
[0m10:45:49.501253 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m10:45:49.505251 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m10:45:49.506280 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m10:45:49.509278 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m10:45:49.510264 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:45:49.511252 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m10:45:49.511252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:49.610984 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.349 seconds
[0m10:45:49.613930 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:49.614930 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:45:49.615927 [debug] [Thread-2 (]: SQL status: COMMIT in 0.333 seconds
[0m10:45:49.617962 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_geom__dbt_backup"
[0m10:45:49.620960 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:45:49.621927 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_3lcu"."dbt"."trips_geom__dbt_backup" cascade
[0m10:45:49.958048 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.336 seconds
[0m10:45:49.960040 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: Close
[0m10:45:49.961042 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.345 seconds
[0m10:45:49.964005 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:49.965009 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715155940>]}
[0m10:45:49.965009 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp104544592022'
        
      order by ordinal_position

  
[0m10:45:49.966007 [info ] [Thread-2 (]: 32 of 51 OK created sql view model dbt.trips_geom .............................. [[32mCREATE VIEW[0m in 4.90s]
[0m10:45:49.967002 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_geom
[0m10:45:49.968036 [debug] [Thread-2 (]: Began running node model.dbt_scooters.users_full
[0m10:45:49.969034 [info ] [Thread-2 (]: 35 of 51 START sql table model dbt.users_full .................................. [RUN]
[0m10:45:49.970005 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.users_full)
[0m10:45:49.971004 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.users_full
[0m10:45:49.974034 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.users_full"
[0m10:45:49.975002 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.users_full
[0m10:45:49.978030 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.users_full"
[0m10:45:49.979003 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m10:45:49.980002 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: BEGIN
[0m10:45:49.981006 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:50.319051 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.352 seconds
[0m10:45:50.323054 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:50.323054 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:45:50.685948 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.362 seconds
[0m10:45:50.687982 [debug] [Thread-4 (]: 
    In "dev_3lcu"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:45:50.692982 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m10:45:50.694947 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:50.694947 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_3lcu"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp104544592022"
    )


  
[0m10:45:51.103909 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.408 seconds
[0m10:45:51.106924 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:51.107918 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_concurrency" is $dbt_comment_literal_block$Number of simultaneous rides in time$dbt_comment_literal_block$;

  
[0m10:45:51.473148 [debug] [Thread-4 (]: SQL status: COMMENT in 0.364 seconds
[0m10:45:51.474150 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m10:45:51.475150 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:51.475150 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m10:45:51.784987 [debug] [Thread-3 (]: SQL status: BEGIN in 2.680 seconds
[0m10:45:51.785992 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:45:51.785992 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_3lcu"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select
    id,
    user_id,
    scooter_hw_id,
    started_at,
    finished_at,
    start_lat,
    start_lon,
    finish_lat,
    finish_lon,
    distance as distance_m,
    cast(price as decimal(20, 2)) / 100 as price_rub,
    extract(epoch from (finished_at - started_at)) as duration_s,
    finished_at <> started_at and price = 0 as is_free,
    
    date(started_at at time zone 'Europe/Moscow')
 as "date"
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m10:45:51.932199 [debug] [Thread-4 (]: SQL status: COMMIT in 0.456 seconds
[0m10:45:51.933204 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: Close
[0m10:45:51.934203 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71544AD50>]}
[0m10:45:51.935204 [info ] [Thread-4 (]: 31 of 51 OK created sql incremental model dbt.trips_concurrency ................ [[32mINSERT 0 0[0m in 7.35s]
[0m10:45:51.936200 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m10:45:51.937204 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_full
[0m10:45:51.938201 [info ] [Thread-4 (]: 36 of 51 START sql view model dbt.events_full .................................. [RUN]
[0m10:45:51.938201 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.events_full)
[0m10:45:51.939714 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_full
[0m10:45:51.942726 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m10:45:51.944727 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_full
[0m10:45:51.948247 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m10:45:51.950261 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:45:51.950261 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: BEGIN
[0m10:45:51.951248 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:52.144417 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.358 seconds
[0m10:45:52.148939 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:45:52.149940 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m10:45:52.362085 [debug] [Thread-1 (]: SQL status: BEGIN in 2.850 seconds
[0m10:45:52.363087 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:45:52.364083 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_3lcu"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
  );
  
[0m10:45:52.486222 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.336 seconds
[0m10:45:52.490222 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:45:52.490222 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m10:45:52.747932 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.384 seconds
[0m10:45:52.751930 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:45:52.751930 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies" rename to "companies__dbt_backup"
[0m10:45:52.840486 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.350 seconds
[0m10:45:52.842493 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:45:52.842493 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_prep" is $dbt_comment_literal_block$Trips prepared for analysis$dbt_comment_literal_block$;

  
[0m10:45:53.107185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.355 seconds
[0m10:45:53.110187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:45:53.111188 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies__dbt_tmp" rename to "companies"
[0m10:45:53.187264 [debug] [Thread-3 (]: SQL status: COMMENT in 0.344 seconds
[0m10:45:53.189265 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m10:45:53.190269 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:45:53.190269 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m10:45:53.456965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.345 seconds
[0m10:45:53.458966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:45:53.458966 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies" is $dbt_comment_literal_block$Scooter statistics by company$dbt_comment_literal_block$;

  
[0m10:45:53.534995 [debug] [Thread-3 (]: SQL status: COMMIT in 0.344 seconds
[0m10:45:53.540009 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_prep__dbt_backup"
[0m10:45:53.541006 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:45:53.541533 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_3lcu"."dbt"."trips_prep__dbt_backup" cascade
[0m10:45:53.581066 [debug] [Thread-2 (]: SQL status: BEGIN in 3.600 seconds
[0m10:45:53.582066 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m10:45:53.582066 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

  
    

  create  table "dev_3lcu"."dbt"."users_full__dbt_tmp"
  
  
    as
  
  (
    select
   u.id, u.first_name ,u.last_name ,u.phone ,
   COALESCE(u.sex, fns.sex, afns.sex) as sex2,
   u.birth_date
from "dev_3lcu"."scooters_raw"."users" u
left join "dev_3lcu"."dbt"."first_name_sex" fns on u.first_name = fns.first_name
left join "dev_3lcu"."dbt"."add_first_name_sex" afns on u.first_name =afns.first_name
  );
  
[0m10:45:53.808293 [debug] [Thread-1 (]: SQL status: COMMENT in 0.348 seconds
[0m10:45:53.810279 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m10:45:53.810279 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:45:53.811286 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m10:45:53.909893 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.368 seconds
[0m10:45:53.911876 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: Close
[0m10:45:53.912852 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715A49B80>]}
[0m10:45:53.913850 [info ] [Thread-3 (]: 33 of 51 OK created sql view model dbt.trips_prep .............................. [[32mCREATE VIEW[0m in 4.82s]
[0m10:45:53.914849 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_prep
[0m10:45:53.914849 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m10:45:53.915848 [info ] [Thread-3 (]: 37 of 51 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m10:45:53.916892 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.parking_finish_stat)
[0m10:45:53.916892 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m10:45:53.920854 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m10:45:53.921854 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m10:45:53.925861 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m10:45:53.927871 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:45:53.927871 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m10:45:53.928868 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:54.112887 [debug] [Thread-2 (]: SQL status: SELECT 2000 in 0.529 seconds
[0m10:45:54.116892 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m10:45:54.116892 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full" rename to "users_full__dbt_backup"
[0m10:45:54.161096 [debug] [Thread-1 (]: SQL status: COMMIT in 0.350 seconds
[0m10:45:54.163128 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."companies__dbt_backup"
[0m10:45:54.164135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:45:54.165095 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_3lcu"."dbt"."companies__dbt_backup" cascade
[0m10:45:54.454208 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m10:45:54.457212 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m10:45:54.458213 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full__dbt_tmp" rename to "users_full"
[0m10:45:54.509242 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.344 seconds
[0m10:45:54.513246 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m10:45:54.514222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715ABAEA0>]}
[0m10:45:54.515212 [info ] [Thread-1 (]: 34 of 51 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 5.01s]
[0m10:45:54.516213 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m10:45:54.516213 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_start_stat
[0m10:45:54.517243 [info ] [Thread-1 (]: 38 of 51 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m10:45:54.518212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.parking_start_stat)
[0m10:45:54.519215 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m10:45:54.521241 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m10:45:54.523216 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m10:45:54.526240 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m10:45:54.527216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:45:54.528214 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m10:45:54.528214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:54.694042 [debug] [Thread-4 (]: SQL status: BEGIN in 2.742 seconds
[0m10:45:54.694042 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:45:54.695042 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_3lcu"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select * from
"dev_3lcu"."dbt"."events_clean" as e
left join "dev_3lcu"."dbt"."event_types" as t
using (type_id)
  );
[0m10:45:55.039131 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.344 seconds
[0m10:45:55.043604 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:45:55.044610 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m10:45:55.132213 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.674 seconds
[0m10:45:55.135163 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m10:45:55.136166 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

    
  
  comment on table "dev_3lcu"."dbt"."users_full" is $dbt_comment_literal_block$Users enriched with sex$dbt_comment_literal_block$;

  
[0m10:45:55.384059 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.339 seconds
[0m10:45:55.387010 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:45:55.388009 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m10:45:55.567027 [debug] [Thread-2 (]: SQL status: COMMENT in 0.431 seconds
[0m10:45:55.569025 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: COMMIT
[0m10:45:55.570025 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m10:45:55.570025 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: COMMIT
[0m10:45:55.727236 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.339 seconds
[0m10:45:55.729190 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:45:55.730190 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

    
  
  comment on view "dev_3lcu"."dbt"."events_full" is $dbt_comment_literal_block$User events enriched with meaningful types$dbt_comment_literal_block$;

  
[0m10:45:56.069037 [debug] [Thread-2 (]: SQL status: COMMIT in 0.498 seconds
[0m10:45:56.071039 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."users_full__dbt_backup"
[0m10:45:56.072037 [debug] [Thread-4 (]: SQL status: COMMENT in 0.342 seconds
[0m10:45:56.073039 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m10:45:56.075040 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m10:45:56.075040 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
drop table if exists "dev_3lcu"."dbt"."users_full__dbt_backup" cascade
[0m10:45:56.076054 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:45:56.076054 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m10:45:56.417301 [debug] [Thread-4 (]: SQL status: COMMIT in 0.340 seconds
[0m10:45:56.420296 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."events_full__dbt_backup"
[0m10:45:56.421256 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:45:56.421256 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_3lcu"."dbt"."events_full__dbt_backup" cascade
[0m10:45:56.448424 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.372 seconds
[0m10:45:56.450377 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: Close
[0m10:45:56.451379 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71599B380>]}
[0m10:45:56.452384 [info ] [Thread-2 (]: 35 of 51 OK created sql table model dbt.users_full ............................. [[32mSELECT 2000[0m in 6.48s]
[0m10:45:56.453377 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.users_full
[0m10:45:56.454381 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m10:45:56.455888 [info ] [Thread-2 (]: 39 of 51 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m10:45:56.456896 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.users_full, now model.dbt_scooters.revenue_daily)
[0m10:45:56.456896 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m10:45:56.460937 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m10:45:56.461897 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m10:45:56.465935 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:45:56.466898 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp104556463894"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_3lcu"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m10:45:56.466898 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:56.603021 [debug] [Thread-3 (]: SQL status: BEGIN in 2.675 seconds
[0m10:45:56.604022 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:45:56.604022 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m10:45:56.772182 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.350 seconds
[0m10:45:56.774184 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: Close
[0m10:45:56.775185 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715A5DE20>]}
[0m10:45:56.775185 [info ] [Thread-4 (]: 36 of 51 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 4.84s]
[0m10:45:56.776190 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_full
[0m10:45:56.777198 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat
[0m10:45:56.778193 [info ] [Thread-4 (]: 40 of 51 START sql table model dbt.trips_stat .................................. [RUN]
[0m10:45:56.779196 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_stat)
[0m10:45:56.779196 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat
[0m10:45:56.782193 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m10:45:56.783193 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat
[0m10:45:56.786197 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m10:45:56.788205 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:45:56.789202 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m10:45:56.789202 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:57.620932 [debug] [Thread-1 (]: SQL status: BEGIN in 3.093 seconds
[0m10:45:57.621929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:45:57.622930 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m10:46:00.192123 [debug] [Thread-4 (]: SQL status: BEGIN in 3.403 seconds
[0m10:46:00.193093 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:46:00.194114 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count(*) as trips,
    count(distinct user_id) as users,
    avg(duration_s) / 60 as avg_duration_min,
    sum(distance_m) / 1000 as sum_distance_km,
    sum(price_rub) as revenue_rub,
    count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from
    "dev_3lcu"."dbt"."trips_prep"
  );
  
[0m10:46:03.137963 [debug] [Thread-2 (]: SQL status: SELECT 3 in 6.671 seconds
[0m10:46:03.143006 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:03.143006 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m10:46:03.518087 [debug] [Thread-2 (]: SQL status: BEGIN in 0.374 seconds
[0m10:46:03.518087 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:03.519084 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp104556463894'
        
      order by ordinal_position

  
[0m10:46:04.213290 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.694 seconds
[0m10:46:04.217243 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:04.217243 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m10:46:04.808204 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.590 seconds
[0m10:46:04.811207 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:04.812206 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp104556463894'
        
      order by ordinal_position

  
[0m10:46:05.308119 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.495 seconds
[0m10:46:05.311111 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:05.311111 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m10:46:05.809097 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.497 seconds
[0m10:46:05.811093 [debug] [Thread-2 (]: 
    In "dev_3lcu"."finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:46:05.812061 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m10:46:05.814058 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:05.814058 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        
            delete from "dev_3lcu"."finance"."revenue_daily"
            using "revenue_daily__dbt_tmp104556463894"
            where (
                
                    "revenue_daily__dbt_tmp104556463894".date = "dev_3lcu"."finance"."revenue_daily".date
                    
                
                
            );
        
    

    insert into "dev_3lcu"."finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp104556463894"
    )
  
[0m10:46:06.266834 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.452 seconds
[0m10:46:06.271829 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:06.272789 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_3lcu".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'finance'
        and table_name = 'revenue_daily'
  
[0m10:46:07.112251 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.840 seconds
[0m10:46:07.114290 [debug] [Thread-2 (]: On "dev_3lcu"."finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m10:46:07.115250 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:07.116290 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  comment on table "dev_3lcu"."finance"."revenue_daily" is $dbt_comment_literal_block$Summary daily revenue$dbt_comment_literal_block$;

  
[0m10:46:07.507991 [debug] [Thread-2 (]: SQL status: COMMENT in 0.391 seconds
[0m10:46:07.509985 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m10:46:07.509985 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:07.510944 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m10:46:07.909883 [debug] [Thread-2 (]: SQL status: COMMIT in 0.398 seconds
[0m10:46:07.910876 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m10:46:07.911903 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715968DA0>]}
[0m10:46:07.911903 [info ] [Thread-2 (]: 39 of 51 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 3[0m in 11.46s]
[0m10:46:07.912909 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m10:46:07.913927 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m10:46:07.914919 [info ] [Thread-2 (]: 41 of 51 START sql table model dbt.trips_stat_daily ............................ [RUN]
[0m10:46:07.915875 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_stat_daily)
[0m10:46:07.915875 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m10:46:07.918914 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m10:46:07.920875 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m10:46:07.923874 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m10:46:07.925876 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:07.925876 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m10:46:07.926883 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:46:08.716134 [debug] [Thread-4 (]: SQL status: SELECT 1 in 8.522 seconds
[0m10:46:08.720090 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:46:08.721089 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m10:46:09.114183 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.392 seconds
[0m10:46:09.117183 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:46:09.117183 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m10:46:09.508172 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.390 seconds
[0m10:46:09.510129 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:46:09.511129 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat" is $dbt_comment_literal_block$Overall trips statistics$dbt_comment_literal_block$;

  
[0m10:46:09.919077 [debug] [Thread-4 (]: SQL status: COMMENT in 0.408 seconds
[0m10:46:09.921083 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m10:46:09.922083 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:46:09.923085 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m10:46:10.311870 [debug] [Thread-4 (]: SQL status: COMMIT in 0.388 seconds
[0m10:46:10.314874 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat__dbt_backup"
[0m10:46:10.315872 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:46:10.315872 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat__dbt_backup" cascade
[0m10:46:10.721228 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.405 seconds
[0m10:46:10.724231 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: Close
[0m10:46:10.725246 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715A2F950>]}
[0m10:46:10.725246 [info ] [Thread-4 (]: 40 of 51 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 13.95s]
[0m10:46:10.726252 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat
[0m10:46:10.727254 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m10:46:10.728250 [info ] [Thread-4 (]: 42 of 51 START sql incremental model dbt.trips_users ........................... [RUN]
[0m10:46:10.729253 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_users)
[0m10:46:10.729253 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m10:46:10.733253 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m10:46:10.734253 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m10:46:10.741770 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:10.741770 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp104610736768"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep" as t
left join
    "dev_3lcu"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_3lcu"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m10:46:10.742766 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:46:11.107887 [debug] [Thread-2 (]: SQL status: BEGIN in 3.181 seconds
[0m10:46:11.108887 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:11.108887 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    count(*) as trips,
    max(price_rub) as max_price_rub,
    avg(distance_m) / 1000 as avg_distance_km,
    avg(price_rub)/avg(duration_s) * 60 as avg_price_rub_per_min
from
    "dev_3lcu"."dbt"."trips_prep"
group by
    1
order by
    1
  );
  
[0m10:46:17.311009 [debug] [Thread-4 (]: SQL status: SELECT 0 in 6.568 seconds
[0m10:46:17.313967 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:17.314967 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m10:46:17.717035 [debug] [Thread-4 (]: SQL status: BEGIN in 0.402 seconds
[0m10:46:17.717992 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:17.717992 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp104610736768'
        
      order by ordinal_position

  
[0m10:46:18.512802 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.794 seconds
[0m10:46:18.516802 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:18.516802 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:46:19.211117 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.694 seconds
[0m10:46:19.215075 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:19.216090 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp104610736768'
        
      order by ordinal_position

  
[0m10:46:19.712141 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.495 seconds
[0m10:46:19.716141 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:19.716141 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:46:19.909189 [debug] [Thread-2 (]: SQL status: SELECT 91 in 8.800 seconds
[0m10:46:19.912192 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:19.913200 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m10:46:20.217788 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.500 seconds
[0m10:46:20.220778 [debug] [Thread-4 (]: 
    In "dev_3lcu"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:46:20.221779 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m10:46:20.222783 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:20.223779 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_3lcu"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp104610736768"
    )


  
[0m10:46:20.251779 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m10:46:20.254780 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:20.254780 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m10:46:20.608870 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.385 seconds
[0m10:46:20.608870 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.353 seconds
[0m10:46:20.610873 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:20.619870 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:20.620870 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_users" is $dbt_comment_literal_block$Prepared trips enriched with users data$dbt_comment_literal_block$;

  
[0m10:46:20.621871 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    create  index if not exists
  "2db8ee0d4dbc6739c4a8902aff929d81"
  on "dev_3lcu"."dbt"."trips_stat_daily" 
  (date)
  
[0m10:46:21.007976 [debug] [Thread-4 (]: SQL status: COMMENT in 0.386 seconds
[0m10:46:21.009965 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:21.009965 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m10:46:21.109986 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.487 seconds
[0m10:46:21.111986 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:21.111986 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat_daily" is $dbt_comment_literal_block$Overall trips statistics per day$dbt_comment_literal_block$;

  
[0m10:46:21.509093 [debug] [Thread-2 (]: SQL status: COMMENT in 0.396 seconds
[0m10:46:21.513095 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:21.513095 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_stat_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:46:22.415164 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.901 seconds
[0m10:46:22.417164 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:22.417164 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."trips_stat_daily".date is $dbt_comment_literal_block$Trips date$dbt_comment_literal_block$;
  

  
[0m10:46:22.809849 [debug] [Thread-2 (]: SQL status: COMMENT in 0.392 seconds
[0m10:46:22.811851 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m10:46:22.811851 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:22.812849 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m10:46:23.208974 [debug] [Thread-2 (]: SQL status: COMMIT in 0.396 seconds
[0m10:46:23.211977 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup"
[0m10:46:23.212977 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:23.212977 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m10:46:23.617125 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.403 seconds
[0m10:46:23.618127 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m10:46:23.619125 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7153D6BA0>]}
[0m10:46:23.620127 [info ] [Thread-2 (]: 41 of 51 OK created sql table model dbt.trips_stat_daily ....................... [[32mSELECT 91[0m in 15.70s]
[0m10:46:23.621128 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m10:46:23.622126 [debug] [Thread-2 (]: Began running node model.dbt_scooters.companies_trips
[0m10:46:23.623126 [info ] [Thread-2 (]: 43 of 51 START sql table model dbt.companies_trips ............................. [RUN]
[0m10:46:23.624129 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.companies_trips)
[0m10:46:23.624129 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.companies_trips
[0m10:46:23.627126 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m10:46:23.629125 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.companies_trips
[0m10:46:23.633129 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m10:46:23.635127 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:23.635127 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m10:46:23.636124 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:46:27.011029 [debug] [Thread-2 (]: SQL status: BEGIN in 3.375 seconds
[0m10:46:27.012072 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:27.013031 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_3lcu"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_3lcu"."dbt"."trips_prep" as t
        join "dev_3lcu"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_3lcu"."dbt"."companies" as c
        using (company)
  );
  
[0m10:46:30.407895 [debug] [Thread-2 (]: SQL status: SELECT 6 in 3.395 seconds
[0m10:46:30.412849 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:30.413849 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m10:46:30.808120 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.394 seconds
[0m10:46:30.811152 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:30.811152 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m10:46:31.207821 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.396 seconds
[0m10:46:31.209842 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:31.210809 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies_trips" is $dbt_comment_literal_block$Trip statistics by company$dbt_comment_literal_block$;

  
[0m10:46:31.606798 [debug] [Thread-2 (]: SQL status: COMMENT in 0.395 seconds
[0m10:46:31.609797 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:31.609797 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'companies_trips'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:46:32.315175 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.704 seconds
[0m10:46:32.317174 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:32.318178 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."companies_trips".company is $dbt_comment_literal_block$Scooters manufacturing company$dbt_comment_literal_block$;
  

  
[0m10:46:32.708190 [debug] [Thread-2 (]: SQL status: COMMENT in 0.390 seconds
[0m10:46:32.710179 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m10:46:32.711147 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:32.711147 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m10:46:33.108820 [debug] [Thread-2 (]: SQL status: COMMIT in 0.397 seconds
[0m10:46:33.111813 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."companies_trips__dbt_backup"
[0m10:46:33.111813 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:33.112813 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_3lcu"."dbt"."companies_trips__dbt_backup" cascade
[0m10:46:33.510055 [debug] [Thread-3 (]: SQL status: SELECT 464 in 36.905 seconds
[0m10:46:33.511040 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.398 seconds
[0m10:46:33.514045 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:46:33.514045 [debug] [Thread-4 (]: SQL status: ANALYZE in 12.504 seconds
[0m10:46:33.516044 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: Close
[0m10:46:33.516044 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m10:46:33.517041 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m10:46:33.519009 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7153D52B0>]}
[0m10:46:33.519009 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:33.520010 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m10:46:33.520010 [info ] [Thread-2 (]: 43 of 51 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 9.89s]
[0m10:46:33.522030 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.companies_trips
[0m10:46:33.522030 [debug] [Thread-2 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m10:46:33.523042 [info ] [Thread-2 (]: 44 of 51 START test events_full_is_complete .................................... [RUN]
[0m10:46:33.524054 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now test.dbt_scooters.events_full_is_complete)
[0m10:46:33.524054 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m10:46:33.527041 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m10:46:33.529009 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m10:46:33.531041 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.events_full_is_complete"
[0m10:46:33.532010 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m10:46:33.533008 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: BEGIN
[0m10:46:33.533008 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:46:33.853062 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.335 seconds
[0m10:46:33.856094 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:46:33.857062 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m10:46:33.860064 [debug] [Thread-4 (]: SQL status: COMMIT in 0.338 seconds
[0m10:46:33.860064 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:33.861064 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m10:46:34.207765 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.350 seconds
[0m10:46:34.209808 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:46:34.210808 [debug] [Thread-4 (]: SQL status: COMMIT in 0.349 seconds
[0m10:46:34.210808 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_finish_stat" is $dbt_comment_literal_block$Trip finish parking statistics by 10 m hexagons$dbt_comment_literal_block$;

  
[0m10:46:34.211806 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:34.212805 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m10:46:34.608970 [debug] [Thread-3 (]: SQL status: COMMENT in 0.397 seconds
[0m10:46:34.610917 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m10:46:34.611917 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:46:34.611917 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m10:46:34.612919 [debug] [Thread-4 (]: SQL status: VACUUM in 0.399 seconds
[0m10:46:34.614916 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m10:46:34.615948 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7151579B0>]}
[0m10:46:34.615948 [info ] [Thread-4 (]: 42 of 51 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 23.89s]
[0m10:46:34.617924 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m10:46:34.617924 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m10:46:34.618923 [info ] [Thread-4 (]: 45 of 51 START test unique_companies_trips_company ............................. [RUN]
[0m10:46:34.619916 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m10:46:34.620963 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m10:46:34.624918 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m10:46:34.626960 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m10:46:34.629953 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m10:46:34.631917 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m10:46:34.631917 [debug] [Thread-4 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m10:46:34.632956 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:46:35.012908 [debug] [Thread-3 (]: SQL status: COMMIT in 0.399 seconds
[0m10:46:35.015954 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup"
[0m10:46:35.016948 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:46:35.016948 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m10:46:35.408866 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.391 seconds
[0m10:46:35.410820 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m10:46:35.411819 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7159A0530>]}
[0m10:46:35.412821 [info ] [Thread-3 (]: 37 of 51 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 41.49s]
[0m10:46:35.413820 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m10:46:35.414818 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m10:46:35.415818 [info ] [Thread-3 (]: 46 of 51 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m10:46:35.416819 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_finish_stat, now model.dbt_scooters.trips_age_daily)
[0m10:46:35.416819 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m10:46:35.421862 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m10:46:35.423820 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m10:46:35.426859 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m10:46:35.428821 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:46:35.429882 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m10:46:35.430858 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:46:36.607025 [debug] [Thread-2 (]: SQL status: BEGIN in 3.074 seconds
[0m10:46:36.608019 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m10:46:36.608983 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.events_full_is_complete"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with source_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_clean"
),
target_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_full"
)
select
    'Row count mismatch' as error_message,
    source_cte.row_count as source_count,
    target_cte.row_count as target_count
from
    source_cte,
    target_cte
where
    source_cte.row_count != target_cte.row_count
      
    ) dbt_internal_test
[0m10:46:37.614068 [debug] [Thread-4 (]: SQL status: BEGIN in 2.982 seconds
[0m10:46:37.615025 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m10:46:37.616026 [debug] [Thread-4 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



      
    ) dbt_internal_test
[0m10:46:38.239924 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.624 seconds
[0m10:46:38.242921 [debug] [Thread-4 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m10:46:38.512011 [debug] [Thread-3 (]: SQL status: BEGIN in 3.081 seconds
[0m10:46:38.513012 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:46:38.513012 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    Select "date",
       age,
       count(*) as trips,
       sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m10:46:38.608848 [debug] [Thread-4 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m10:46:38.610799 [info ] [Thread-4 (]: 45 of 51 PASS unique_companies_trips_company ................................... [[32mPASS[0m in 3.99s]
[0m10:46:38.611805 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m10:46:38.611805 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_group
[0m10:46:38.612804 [info ] [Thread-4 (]: 47 of 51 START sql table model dbt.trips_age_group ............................. [RUN]
[0m10:46:38.613800 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0, now model.dbt_scooters.trips_age_group)
[0m10:46:38.613800 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m10:46:38.616834 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m10:46:38.617843 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_age_group
[0m10:46:38.621834 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m10:46:38.622803 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:46:38.623803 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m10:46:38.623803 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:46:40.308976 [debug] [Thread-2 (]: SQL status: SELECT 1 in 3.699 seconds
[0m10:46:40.309978 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: ROLLBACK
[0m10:46:40.708093 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: Close
[0m10:46:40.709093 [info ] [Thread-2 (]: 44 of 51 PASS events_full_is_complete .......................................... [[32mPASS[0m in 7.19s]
[0m10:46:40.710093 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m10:46:40.711097 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_stat
[0m10:46:40.712094 [info ] [Thread-2 (]: 48 of 51 START sql table model dbt.events_stat ................................. [RUN]
[0m10:46:40.713095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.events_full_is_complete, now model.dbt_scooters.events_stat)
[0m10:46:40.713095 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_stat
[0m10:46:40.716098 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m10:46:40.722122 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_stat
[0m10:46:40.728121 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m10:46:40.732145 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:46:40.733122 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: BEGIN
[0m10:46:40.734134 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:46:40.806746 [debug] [Thread-3 (]: SQL status: SELECT 7049 in 2.293 seconds
[0m10:46:40.810702 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:46:40.811736 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m10:46:41.208213 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.396 seconds
[0m10:46:41.211213 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:46:41.211213 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m10:46:41.424836 [debug] [Thread-1 (]: SQL status: SELECT 142 in 43.802 seconds
[0m10:46:41.428865 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:46:41.428865 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m10:46:41.547085 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.336 seconds
[0m10:46:41.549039 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:46:41.550039 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily" is $dbt_comment_literal_block$Daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m10:46:41.551041 [debug] [Thread-4 (]: SQL status: BEGIN in 2.927 seconds
[0m10:46:41.552044 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:46:41.553043 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users" as tu
    cross join "dev_3lcu"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m10:46:41.774139 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.345 seconds
[0m10:46:41.778124 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:46:41.778124 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m10:46:41.885694 [debug] [Thread-3 (]: SQL status: COMMENT in 0.335 seconds
[0m10:46:41.887729 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m10:46:41.887729 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:46:41.888731 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m10:46:42.121793 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.343 seconds
[0m10:46:42.123779 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:46:42.124791 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_start_stat" is $dbt_comment_literal_block$Trip start parking statistics by 500 m hexagons$dbt_comment_literal_block$;

  
[0m10:46:42.232009 [debug] [Thread-3 (]: SQL status: COMMIT in 0.343 seconds
[0m10:46:42.234958 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily__dbt_backup"
[0m10:46:42.235959 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:46:42.235959 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily__dbt_backup" cascade
[0m10:46:42.550864 [debug] [Thread-1 (]: SQL status: COMMENT in 0.426 seconds
[0m10:46:42.552820 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m10:46:42.553820 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:46:42.553820 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m10:46:42.614057 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.377 seconds
[0m10:46:42.615027 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m10:46:42.616058 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715AF3680>]}
[0m10:46:42.617026 [info ] [Thread-3 (]: 46 of 51 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 7.20s]
[0m10:46:42.618025 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m10:46:42.619024 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m10:46:42.620033 [info ] [Thread-3 (]: 49 of 51 START test unique_key_trips_age_daily_date__age ....................... [RUN]
[0m10:46:42.621026 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be)
[0m10:46:42.622026 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m10:46:42.628032 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m10:46:42.630050 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m10:46:42.632058 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m10:46:42.633031 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m10:46:42.634032 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: BEGIN
[0m10:46:42.634032 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:46:42.976851 [debug] [Thread-1 (]: SQL status: COMMIT in 0.422 seconds
[0m10:46:42.978855 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_start_stat__dbt_backup"
[0m10:46:42.979850 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:46:42.979850 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_start_stat__dbt_backup" cascade
[0m10:46:43.610109 [debug] [Thread-2 (]: SQL status: BEGIN in 2.876 seconds
[0m10:46:43.611107 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:46:43.613111 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
       count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from "dev_3lcu"."dbt"."events_full"
  );
  
[0m10:46:43.624125 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.643 seconds
[0m10:46:43.627131 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: Close
[0m10:46:43.629119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715AFD730>]}
[0m10:46:43.630122 [info ] [Thread-1 (]: 38 of 51 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 49.11s]
[0m10:46:43.632116 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m10:46:43.634121 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m10:46:43.635119 [info ] [Thread-1 (]: 50 of 51 START test unique_trips_age_daily_date_text_age_text .................. [RUN]
[0m10:46:43.638129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e)
[0m10:46:43.639131 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m10:46:43.647140 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m10:46:43.654140 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m10:46:43.659147 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m10:46:43.661152 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m10:46:43.663150 [debug] [Thread-1 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: BEGIN
[0m10:46:43.664147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:46:46.408151 [debug] [Thread-3 (]: SQL status: BEGIN in 3.774 seconds
[0m10:46:46.409142 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m10:46:46.410105 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "date"::text ||
    
        "age"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m10:46:46.709077 [debug] [Thread-1 (]: SQL status: BEGIN in 3.045 seconds
[0m10:46:46.710030 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m10:46:46.711031 [debug] [Thread-1 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date::text || age::text as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."trips_age_daily"
where date::text || age::text is not null
group by date::text || age::text
having count(*) > 1



      
    ) dbt_internal_test
[0m10:46:47.017227 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.607 seconds
[0m10:46:47.019175 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: ROLLBACK
[0m10:46:47.311845 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.601 seconds
[0m10:46:47.313833 [debug] [Thread-1 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: ROLLBACK
[0m10:46:47.408474 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: Close
[0m10:46:47.409475 [info ] [Thread-3 (]: 49 of 51 PASS unique_key_trips_age_daily_date__age ............................. [[32mPASS[0m in 4.79s]
[0m10:46:47.410477 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m10:46:47.711698 [debug] [Thread-1 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: Close
[0m10:46:47.712691 [info ] [Thread-1 (]: 50 of 51 PASS unique_trips_age_daily_date_text_age_text ........................ [[32mPASS[0m in 4.07s]
[0m10:46:47.713691 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m10:46:47.714694 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m10:46:47.715691 [info ] [Thread-3 (]: 51 of 51 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m10:46:47.716694 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be, now model.dbt_scooters.trips_age_daily_stat)
[0m10:46:47.717659 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m10:46:47.720684 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:47.721650 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m10:46:47.724650 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:47.726156 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:47.727165 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m10:46:47.727165 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:46:48.613501 [debug] [Thread-2 (]: SQL status: SELECT 1 in 4.999 seconds
[0m10:46:48.616014 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:46:48.617058 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m10:46:49.009208 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.391 seconds
[0m10:46:49.012207 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:46:49.012207 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m10:46:49.408862 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.396 seconds
[0m10:46:49.411241 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:46:49.412204 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_stat" is $dbt_comment_literal_block$Overall user events statistics$dbt_comment_literal_block$;

  
[0m10:46:49.808054 [debug] [Thread-2 (]: SQL status: COMMENT in 0.396 seconds
[0m10:46:49.809612 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: COMMIT
[0m10:46:49.810614 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:46:49.810614 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: COMMIT
[0m10:46:50.207783 [debug] [Thread-2 (]: SQL status: COMMIT in 0.397 seconds
[0m10:46:50.211295 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."events_stat__dbt_backup"
[0m10:46:50.212297 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:46:50.213296 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_3lcu"."dbt"."events_stat__dbt_backup" cascade
[0m10:46:50.708676 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.495 seconds
[0m10:46:50.710252 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: Close
[0m10:46:50.711288 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7153D63C0>]}
[0m10:46:50.712253 [info ] [Thread-2 (]: 48 of 51 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 10.00s]
[0m10:46:50.713254 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_stat
[0m10:46:50.933846 [debug] [Thread-3 (]: SQL status: BEGIN in 3.206 seconds
[0m10:46:50.934848 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:50.934848 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m10:46:51.794640 [debug] [Thread-3 (]: SQL status: SELECT 83 in 0.859 seconds
[0m10:46:51.797640 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:51.798640 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m10:46:52.245078 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.446 seconds
[0m10:46:52.248078 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:52.248078 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m10:46:52.610065 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.361 seconds
[0m10:46:52.614578 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:52.614578 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily_stat" is $dbt_comment_literal_block$Aggregation of daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m10:46:53.030801 [debug] [Thread-3 (]: SQL status: COMMENT in 0.415 seconds
[0m10:46:53.032794 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m10:46:53.032794 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:53.033767 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m10:46:53.410971 [debug] [Thread-3 (]: SQL status: COMMIT in 0.377 seconds
[0m10:46:53.413512 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup"
[0m10:46:53.414515 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:53.414515 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m10:46:53.910921 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.496 seconds
[0m10:46:53.911916 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m10:46:53.913462 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715B37410>]}
[0m10:46:53.914470 [info ] [Thread-3 (]: 51 of 51 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 6.20s]
[0m10:46:53.916015 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m10:46:55.742753 [debug] [Thread-4 (]: SQL status: SELECT 7 in 14.190 seconds
[0m10:46:55.745718 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:46:55.746717 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m10:46:56.093893 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.346 seconds
[0m10:46:56.096894 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:46:56.096894 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m10:46:56.610063 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.512 seconds
[0m10:46:56.611064 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:46:56.612063 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_group" is $dbt_comment_literal_block$Overall trips statistics by user age group$dbt_comment_literal_block$;

  
[0m10:46:57.170098 [debug] [Thread-4 (]: SQL status: COMMENT in 0.558 seconds
[0m10:46:57.172056 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m10:46:57.172056 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:46:57.173056 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m10:46:57.548100 [debug] [Thread-4 (]: SQL status: COMMIT in 0.375 seconds
[0m10:46:57.551056 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_group__dbt_backup"
[0m10:46:57.552057 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:46:57.552057 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_group__dbt_backup" cascade
[0m10:46:58.106660 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.554 seconds
[0m10:46:58.109663 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: Close
[0m10:46:58.110661 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715AF5E80>]}
[0m10:46:58.112664 [info ] [Thread-4 (]: 47 of 51 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 19.50s]
[0m10:46:58.113662 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_group
[0m10:46:58.115663 [debug] [MainThread]: Using postgres connection "master"
[0m10:46:58.116706 [debug] [MainThread]: On master: BEGIN
[0m10:46:58.117661 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:47:01.725663 [debug] [MainThread]: SQL status: BEGIN in 3.608 seconds
[0m10:47:01.726669 [debug] [MainThread]: On master: COMMIT
[0m10:47:01.726669 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:01.726669 [debug] [MainThread]: On master: COMMIT
[0m10:47:02.061856 [debug] [MainThread]: SQL status: COMMIT in 0.335 seconds
[0m10:47:02.062843 [info ] [MainThread]: 
[0m10:47:02.063839 [info ] [MainThread]: Running 1 on-run-end hook
[0m10:47:02.065802 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m10:47:02.070826 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m10:47:02.071846 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:02.072810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m10:47:02.413810 [debug] [MainThread]: SQL status: GRANT in 0.341 seconds
[0m10:47:02.415803 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mGRANT[0m in 0.34s]
[0m10:47:02.415803 [info ] [MainThread]: 
[0m10:47:02.416811 [debug] [MainThread]: On master: Close
[0m10:47:02.417801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:02.417801 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m10:47:02.418766 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m10:47:02.418766 [debug] [MainThread]: Connection 'list_dev_3lcu_finance' was properly closed.
[0m10:47:02.419802 [debug] [MainThread]: Connection 'list_dev_3lcu_dbt' was properly closed.
[0m10:47:02.419802 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e' was properly closed.
[0m10:47:02.419802 [debug] [MainThread]: Connection 'model.dbt_scooters.events_stat' was properly closed.
[0m10:47:02.420765 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m10:47:02.420765 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m10:47:02.421767 [info ] [MainThread]: 
[0m10:47:02.421767 [info ] [MainThread]: Finished running 4 seeds, 28 data tests, 12 table models, 4 incremental models, 3 view models, 1 project hook in 0 hours 1 minutes and 58.19 seconds (118.19s).
[0m10:47:02.431349 [debug] [MainThread]: Command end result
[0m10:47:02.471909 [info ] [MainThread]: 
[0m10:47:02.472872 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m10:47:02.472872 [info ] [MainThread]: 
[0m10:47:02.473874 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models\properties.yml)[0m
[0m10:47:02.474871 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m10:47:02.475908 [info ] [MainThread]: 
[0m10:47:02.476911 [info ] [MainThread]:   compiled code at target\compiled\dbt_scooters\models\properties.yml\source_not_null_scooters_raw_users_sex.sql
[0m10:47:02.477875 [info ] [MainThread]: 
[0m10:47:02.478879 [info ] [MainThread]: Done. PASS=50 WARN=1 ERROR=0 SKIP=0 TOTAL=51
[0m10:47:02.479876 [debug] [MainThread]: Command `dbt build` succeeded at 10:47:02.479876 after 119.53 seconds
[0m10:47:02.480877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70FC1D040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7133DC7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7133AEF30>]}
[0m10:47:03.304057 [debug] [MainThread]: Flushing usage events
[0m14:15:48.530176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207056A1AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207083540E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207083556D0>]}


============================== 14:15:48.539364 | 4915162e-9833-4d2b-ad57-4a7a6bc0b251 ==============================
[0m14:15:48.539364 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:15:48.541325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:48.978701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020705EE9C10>]}
[0m14:15:49.091352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070863C440>]}
[0m14:15:49.092864 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:49.483112 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:15:49.874278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:15:49.875329 [debug] [MainThread]: Partial parsing: updated file: dbt_scooters://models\finance\properties.yml
[0m14:15:50.434564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709CC9F10>]}
[0m14:15:50.689397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207089B89B0>]}
[0m14:15:50.690403 [info ] [MainThread]: Found 19 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 437 macros
[0m14:15:50.691400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709C12A50>]}
[0m14:15:50.696433 [info ] [MainThread]: 
[0m14:15:50.697433 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:15:50.705510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m14:15:50.720522 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m14:15:50.892134 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m14:15:50.893142 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m14:15:50.894150 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m14:15:50.895173 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m14:15:50.896166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:50.897159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:53.828124 [debug] [ThreadPool]: SQL status: SELECT 23 in 2.930 seconds
[0m14:15:53.830164 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m14:15:53.998374 [debug] [ThreadPool]: SQL status: SELECT 23 in 3.101 seconds
[0m14:15:54.000415 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m14:15:54.002675 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_dbt'
[0m14:15:54.010261 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m14:15:54.011255 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_finance'
[0m14:15:54.011255 [debug] [ThreadPool]: On list_dev_3lcu_dbt: BEGIN
[0m14:15:54.013611 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m14:15:54.014654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:54.014654 [debug] [ThreadPool]: On list_dev_3lcu_finance: BEGIN
[0m14:15:54.015649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:56.705538 [debug] [ThreadPool]: SQL status: BEGIN in 2.690 seconds
[0m14:15:56.706538 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m14:15:56.706538 [debug] [ThreadPool]: On list_dev_3lcu_finance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_finance"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m14:15:57.045235 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.338 seconds
[0m14:15:57.047277 [debug] [ThreadPool]: On list_dev_3lcu_finance: ROLLBACK
[0m14:15:57.386489 [debug] [ThreadPool]: On list_dev_3lcu_finance: Close
[0m14:15:57.586549 [debug] [ThreadPool]: SQL status: BEGIN in 3.571 seconds
[0m14:15:57.586549 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m14:15:57.587553 [debug] [ThreadPool]: On list_dev_3lcu_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_dbt"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m14:15:57.938623 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.351 seconds
[0m14:15:57.940584 [debug] [ThreadPool]: On list_dev_3lcu_dbt: ROLLBACK
[0m14:15:58.281339 [debug] [ThreadPool]: On list_dev_3lcu_dbt: Close
[0m14:15:58.292447 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:58.293001 [debug] [MainThread]: On master: BEGIN
[0m14:15:58.293001 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:00.995545 [debug] [MainThread]: SQL status: BEGIN in 2.702 seconds
[0m14:16:00.996591 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:00.997590 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:16:01.462434 [debug] [MainThread]: SQL status: SELECT 4 in 0.465 seconds
[0m14:16:01.464538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709D930E0>]}
[0m14:16:01.465539 [debug] [MainThread]: On master: ROLLBACK
[0m14:16:01.800588 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:01.802135 [debug] [MainThread]: On master: BEGIN
[0m14:16:02.472216 [debug] [MainThread]: SQL status: BEGIN in 0.670 seconds
[0m14:16:02.473565 [debug] [MainThread]: On master: COMMIT
[0m14:16:02.474574 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:02.474574 [debug] [MainThread]: On master: COMMIT
[0m14:16:02.809977 [debug] [MainThread]: SQL status: COMMIT in 0.335 seconds
[0m14:16:02.810966 [debug] [MainThread]: On master: Close
[0m14:16:02.810966 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:02.812516 [info ] [MainThread]: 
[0m14:16:02.820570 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m14:16:02.820570 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_clean
[0m14:16:02.820570 [debug] [Thread-3 (]: Began running node model.dbt_scooters.first_name_sex
[0m14:16:02.822116 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_concurrency
[0m14:16:02.822116 [info ] [Thread-1 (]: 1 of 19 START sql table model dbt.companies .................................... [RUN]
[0m14:16:02.823142 [info ] [Thread-2 (]: 2 of 19 START sql incremental model dbt.events_clean ........................... [RUN]
[0m14:16:02.824124 [info ] [Thread-3 (]: 3 of 19 START sql table model dbt.first_name_sex ............................... [RUN]
[0m14:16:02.825125 [info ] [Thread-4 (]: 4 of 19 START sql incremental model dbt.trips_concurrency ...................... [RUN]
[0m14:16:02.826163 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_scooters.companies'
[0m14:16:02.827126 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.events_clean'
[0m14:16:02.828130 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.first_name_sex'
[0m14:16:02.829130 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m14:16:02.829130 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m14:16:02.830124 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_clean
[0m14:16:02.831123 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.first_name_sex
[0m14:16:02.832127 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m14:16:02.841264 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m14:16:02.849397 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m14:16:02.852395 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.first_name_sex"
[0m14:16:02.858516 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m14:16:02.860485 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m14:16:02.861487 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_clean
[0m14:16:02.879549 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.first_name_sex
[0m14:16:02.962086 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m14:16:02.965135 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:02.970135 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.first_name_sex"
[0m14:16:02.970135 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m14:16:02.971100 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp141602934219"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at

from
    "dev_3lcu"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."events_clean")
    

  );
  
  
[0m14:16:02.972616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:16:02.977199 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:02.978198 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:16:02.979198 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:16:02.979198 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m14:16:02.980198 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp141602975198"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_3lcu"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_3lcu"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now()  as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m14:16:02.981201 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: BEGIN
[0m14:16:02.982168 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:16:02.982168 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:16:02.983262 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:16:05.710111 [debug] [Thread-1 (]: SQL status: BEGIN in 2.728 seconds
[0m14:16:05.711067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:16:05.712099 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_3lcu"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
  );
  
[0m14:16:06.159565 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.446 seconds
[0m14:16:06.169119 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:16:06.170124 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies" rename to "companies__dbt_backup"
[0m14:16:06.482469 [debug] [Thread-2 (]: SQL status: SELECT 0 in 3.504 seconds
[0m14:16:06.501081 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:06.501081 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: BEGIN
[0m14:16:06.510745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.341 seconds
[0m14:16:06.517281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:16:06.517281 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies__dbt_tmp" rename to "companies"
[0m14:16:06.647825 [debug] [Thread-3 (]: SQL status: BEGIN in 3.665 seconds
[0m14:16:06.648827 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:16:06.649827 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

  
    

  create  table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp"
  
  
    as
  
  (
    select distinct first_name, sex
from "dev_3lcu"."scooters_raw"."users"
Where sex is not null
  );
  
[0m14:16:06.872445 [debug] [Thread-2 (]: SQL status: BEGIN in 0.371 seconds
[0m14:16:06.873938 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.355 seconds
[0m14:16:06.874935 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:06.909730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:16:06.910735 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp141602934219'
        
      order by ordinal_position

  
[0m14:16:06.910735 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies" is $dbt_comment_literal_block$Scooter statistics by company$dbt_comment_literal_block$;

  
[0m14:16:07.072807 [debug] [Thread-3 (]: SQL status: SELECT 387 in 0.423 seconds
[0m14:16:07.078344 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:16:07.078344 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex" rename to "first_name_sex__dbt_backup"
[0m14:16:07.363379 [debug] [Thread-1 (]: SQL status: COMMENT in 0.451 seconds
[0m14:16:07.365378 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m14:16:07.366375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:16:07.367379 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m14:16:07.460457 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.381 seconds
[0m14:16:07.465495 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:16:07.466495 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp" rename to "first_name_sex"
[0m14:16:07.656455 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.744 seconds
[0m14:16:07.663029 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:07.664570 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:16:07.755361 [debug] [Thread-1 (]: SQL status: COMMIT in 0.388 seconds
[0m14:16:07.762890 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."companies__dbt_backup"
[0m14:16:07.770478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:16:07.770478 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_3lcu"."dbt"."companies__dbt_backup" cascade
[0m14:16:07.852322 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.385 seconds
[0m14:16:07.855699 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:16:07.855699 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

    
  
  comment on table "dev_3lcu"."dbt"."first_name_sex" is $dbt_comment_literal_block$Unique name_sex glossary$dbt_comment_literal_block$;

  
[0m14:16:08.058346 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.393 seconds
[0m14:16:08.074386 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:08.075433 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp141602934219'
        
      order by ordinal_position

  
[0m14:16:08.153122 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.382 seconds
[0m14:16:08.156079 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m14:16:08.158080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020705EE8DD0>]}
[0m14:16:08.159080 [info ] [Thread-1 (]: 1 of 19 OK created sql table model dbt.companies ............................... [[32mSELECT 6[0m in 5.33s]
[0m14:16:08.161079 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m14:16:08.162113 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_geom
[0m14:16:08.162113 [info ] [Thread-1 (]: 5 of 19 START sql view model dbt.trips_geom .................................... [RUN]
[0m14:16:08.163621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.trips_geom)
[0m14:16:08.164623 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_geom
[0m14:16:08.167653 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m14:16:08.169660 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_geom
[0m14:16:08.191390 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m14:16:08.192930 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:16:08.192930 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m14:16:08.192930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:08.254388 [debug] [Thread-3 (]: SQL status: COMMENT in 0.397 seconds
[0m14:16:08.255437 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m14:16:08.256440 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:16:08.257451 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m14:16:08.358443 [debug] [Thread-4 (]: SQL status: SELECT 0 in 5.375 seconds
[0m14:16:08.361444 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:08.362443 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m14:16:08.417277 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.341 seconds
[0m14:16:08.421279 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:08.424292 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:16:08.600562 [debug] [Thread-3 (]: SQL status: COMMIT in 0.343 seconds
[0m14:16:08.603150 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."first_name_sex__dbt_backup"
[0m14:16:08.604150 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:16:08.605150 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
drop table if exists "dev_3lcu"."dbt"."first_name_sex__dbt_backup" cascade
[0m14:16:08.703772 [debug] [Thread-4 (]: SQL status: BEGIN in 0.341 seconds
[0m14:16:08.704774 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:08.705810 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp141602975198'
        
      order by ordinal_position

  
[0m14:16:08.766794 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.342 seconds
[0m14:16:08.779273 [debug] [Thread-2 (]: 
    In "dev_3lcu"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:16:08.802009 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m14:16:08.803023 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:08.804536 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        
            delete from "dev_3lcu"."dbt"."events_clean"
            using "events_clean__dbt_tmp141602934219"
            where (
                
                    "events_clean__dbt_tmp141602934219".user_id = "dev_3lcu"."dbt"."events_clean".user_id
                    and 
                
                    "events_clean__dbt_tmp141602934219".timestamp = "dev_3lcu"."dbt"."events_clean".timestamp
                    and 
                
                    "events_clean__dbt_tmp141602934219".type_id = "dev_3lcu"."dbt"."events_clean".type_id
                    
                
                
            );
        
    

    insert into "dev_3lcu"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp141602934219"
    )
  
[0m14:16:08.949097 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.343 seconds
[0m14:16:08.951097 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: Close
[0m14:16:08.952096 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070A600E00>]}
[0m14:16:08.953235 [info ] [Thread-3 (]: 3 of 19 OK created sql table model dbt.first_name_sex .......................... [[32mSELECT 387[0m in 6.12s]
[0m14:16:08.955272 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.first_name_sex
[0m14:16:08.956264 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_prep
[0m14:16:08.957228 [info ] [Thread-3 (]: 6 of 19 START sql view model dbt.trips_prep .................................... [RUN]
[0m14:16:08.958230 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.first_name_sex, now model.dbt_scooters.trips_prep)
[0m14:16:08.958230 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_prep
[0m14:16:08.964255 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m14:16:08.965264 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_prep
[0m14:16:08.970301 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m14:16:08.972269 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:16:08.972811 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m14:16:08.972811 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:16:09.049397 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.343 seconds
[0m14:16:09.053473 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:09.054505 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:16:09.146443 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.340 seconds
[0m14:16:09.148444 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:09.149442 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_clean" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m14:16:09.394162 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.339 seconds
[0m14:16:09.399157 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:09.399157 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp141602975198'
        
      order by ordinal_position

  
[0m14:16:09.488777 [debug] [Thread-2 (]: SQL status: COMMENT in 0.339 seconds
[0m14:16:09.490781 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m14:16:09.492290 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:09.492290 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m14:16:09.739468 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.339 seconds
[0m14:16:09.743023 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:09.744584 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:16:09.832458 [debug] [Thread-2 (]: SQL status: COMMIT in 0.339 seconds
[0m14:16:09.834608 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: Close
[0m14:16:09.835556 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070A6209B0>]}
[0m14:16:09.837559 [info ] [Thread-2 (]: 2 of 19 OK created sql incremental model dbt.events_clean ...................... [[32mINSERT 0 0[0m in 7.01s]
[0m14:16:09.838560 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_clean
[0m14:16:09.839570 [debug] [Thread-2 (]: Began running node model.dbt_scooters.users_full
[0m14:16:09.840558 [info ] [Thread-2 (]: 7 of 19 START sql table model dbt.users_full ................................... [RUN]
[0m14:16:09.842071 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.users_full)
[0m14:16:09.843117 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.users_full
[0m14:16:09.850088 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.users_full"
[0m14:16:09.853255 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.users_full
[0m14:16:09.858242 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.users_full"
[0m14:16:09.860243 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:16:09.862247 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: BEGIN
[0m14:16:09.862759 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:16:10.092216 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.347 seconds
[0m14:16:10.095259 [debug] [Thread-4 (]: 
    In "dev_3lcu"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:16:10.106287 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m14:16:10.108294 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:10.109288 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_3lcu"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp141602975198"
    )


  
[0m14:16:10.447372 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.337 seconds
[0m14:16:10.450378 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:10.451369 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_concurrency" is $dbt_comment_literal_block$Number of simultaneous rides in time$dbt_comment_literal_block$;

  
[0m14:16:10.796212 [debug] [Thread-4 (]: SQL status: COMMENT in 0.344 seconds
[0m14:16:10.801209 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m14:16:10.802733 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:10.804252 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m14:16:10.871404 [debug] [Thread-1 (]: SQL status: BEGIN in 2.678 seconds
[0m14:16:10.872918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:16:10.874428 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_3lcu"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m14:16:11.153378 [debug] [Thread-4 (]: SQL status: COMMIT in 0.347 seconds
[0m14:16:11.156410 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: Close
[0m14:16:11.157406 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070A643080>]}
[0m14:16:11.159406 [info ] [Thread-4 (]: 4 of 19 OK created sql incremental model dbt.trips_concurrency ................. [[32mINSERT 0 0[0m in 8.33s]
[0m14:16:11.160366 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m14:16:11.162367 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_full
[0m14:16:11.162876 [info ] [Thread-4 (]: 8 of 19 START sql view model dbt.events_full ................................... [RUN]
[0m14:16:11.164389 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.events_full)
[0m14:16:11.165408 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_full
[0m14:16:11.171403 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m14:16:11.172911 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_full
[0m14:16:11.181439 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m14:16:11.184463 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:16:11.186483 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: BEGIN
[0m14:16:11.187482 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:16:11.223142 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.348 seconds
[0m14:16:11.298364 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:16:11.299364 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m14:16:11.645462 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.345 seconds
[0m14:16:11.652994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:16:11.654546 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m14:16:11.707374 [debug] [Thread-3 (]: SQL status: BEGIN in 2.735 seconds
[0m14:16:11.709367 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:16:11.709367 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_3lcu"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select
    id,
    user_id,
    scooter_hw_id,
    started_at,
    finished_at,
    start_lat,
    start_lon,
    finish_lat,
    finish_lon,
    distance as distance_m,
    cast(price as decimal(20, 2)) / 100 as price_rub,
    extract(epoch from (finished_at - started_at)) as duration_s,
    finished_at <> started_at and price = 0 as is_free,
    
    date(started_at at time zone 'Europe/Moscow')
 as "date"
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m14:16:11.999336 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.344 seconds
[0m14:16:12.002339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:16:12.002339 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_geom" is $dbt_comment_literal_block$Trips prepared for geometry analysis$dbt_comment_literal_block$;

  
[0m14:16:12.062102 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.351 seconds
[0m14:16:12.066539 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:16:12.067539 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m14:16:12.342155 [debug] [Thread-1 (]: SQL status: COMMENT in 0.338 seconds
[0m14:16:12.345181 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m14:16:12.346184 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:16:12.347213 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m14:16:12.409062 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.341 seconds
[0m14:16:12.414085 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:16:12.415094 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m14:16:12.591341 [debug] [Thread-2 (]: SQL status: BEGIN in 2.728 seconds
[0m14:16:12.592851 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:16:12.592851 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

  
    

  create  table "dev_3lcu"."dbt"."users_full__dbt_tmp"
  
  
    as
  
  (
    select
   u.id, u.first_name ,u.last_name ,u.phone ,
   COALESCE(u.sex, fns.sex, afns.sex) as sex2,
   u.birth_date
from "dev_3lcu"."scooters_raw"."users" u
left join "dev_3lcu"."dbt"."first_name_sex" fns on u.first_name = fns.first_name
left join "dev_3lcu"."dbt"."add_first_name_sex" afns on u.first_name =afns.first_name
  );
  
[0m14:16:12.686461 [debug] [Thread-1 (]: SQL status: COMMIT in 0.339 seconds
[0m14:16:12.691460 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_geom__dbt_backup"
[0m14:16:12.696489 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:16:12.697490 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_3lcu"."dbt"."trips_geom__dbt_backup" cascade
[0m14:16:12.758360 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.343 seconds
[0m14:16:12.761360 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:16:12.762361 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_prep" is $dbt_comment_literal_block$Trips prepared for analysis$dbt_comment_literal_block$;

  
[0m14:16:12.953030 [debug] [Thread-2 (]: SQL status: SELECT 2000 in 0.359 seconds
[0m14:16:12.957624 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:16:12.958624 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full" rename to "users_full__dbt_backup"
[0m14:16:13.040298 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.342 seconds
[0m14:16:13.042870 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: Close
[0m14:16:13.042870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709D57830>]}
[0m14:16:13.044411 [info ] [Thread-1 (]: 5 of 19 OK created sql view model dbt.trips_geom ............................... [[32mCREATE VIEW[0m in 4.88s]
[0m14:16:13.046421 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_geom
[0m14:16:13.047446 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m14:16:13.048445 [info ] [Thread-1 (]: 9 of 19 START sql table model dbt.parking_finish_stat .......................... [RUN]
[0m14:16:13.049420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.parking_finish_stat)
[0m14:16:13.049420 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m14:16:13.055579 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m14:16:13.056606 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m14:16:13.062055 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m14:16:13.064104 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:16:13.065067 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m14:16:13.066103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:13.108276 [debug] [Thread-3 (]: SQL status: COMMENT in 0.345 seconds
[0m14:16:13.110309 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m14:16:13.111311 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:16:13.112309 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m14:16:13.296517 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m14:16:13.300510 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:16:13.302022 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full__dbt_tmp" rename to "users_full"
[0m14:16:13.454088 [debug] [Thread-3 (]: SQL status: COMMIT in 0.342 seconds
[0m14:16:13.458106 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_prep__dbt_backup"
[0m14:16:13.460134 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:16:13.461102 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_3lcu"."dbt"."trips_prep__dbt_backup" cascade
[0m14:16:13.652443 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.351 seconds
[0m14:16:13.656836 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:16:13.657846 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

    
  
  comment on table "dev_3lcu"."dbt"."users_full" is $dbt_comment_literal_block$Users enriched with sex$dbt_comment_literal_block$;

  
[0m14:16:13.823182 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.361 seconds
[0m14:16:13.826177 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: Close
[0m14:16:13.827178 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709C1DD60>]}
[0m14:16:13.829179 [info ] [Thread-3 (]: 6 of 19 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 4.87s]
[0m14:16:13.831179 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_prep
[0m14:16:13.832177 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_start_stat
[0m14:16:13.832686 [info ] [Thread-3 (]: 10 of 19 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m14:16:13.837207 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.parking_start_stat)
[0m14:16:13.838207 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m14:16:13.845254 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m14:16:13.848263 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m14:16:13.858319 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m14:16:13.862319 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:16:13.864351 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m14:16:13.865375 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:16:13.908484 [debug] [Thread-4 (]: SQL status: BEGIN in 2.721 seconds
[0m14:16:13.910481 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:16:13.911997 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_3lcu"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select * from
"dev_3lcu"."dbt"."events_clean" as e
left join "dev_3lcu"."dbt"."event_types" as t
using (type_id)
  );
[0m14:16:14.182918 [debug] [Thread-2 (]: SQL status: COMMENT in 0.523 seconds
[0m14:16:14.187450 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: COMMIT
[0m14:16:14.188450 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:16:14.190449 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: COMMIT
[0m14:16:14.312868 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.398 seconds
[0m14:16:14.324479 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:16:14.326470 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m14:16:14.532361 [debug] [Thread-2 (]: SQL status: COMMIT in 0.341 seconds
[0m14:16:14.538424 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."users_full__dbt_backup"
[0m14:16:14.540421 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:16:14.542421 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
drop table if exists "dev_3lcu"."dbt"."users_full__dbt_backup" cascade
[0m14:16:14.679140 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.350 seconds
[0m14:16:14.686167 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:16:14.687167 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m14:16:14.887135 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.343 seconds
[0m14:16:14.890144 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: Close
[0m14:16:14.891142 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709BFA1E0>]}
[0m14:16:14.892652 [info ] [Thread-2 (]: 7 of 19 OK created sql table model dbt.users_full .............................. [[32mSELECT 2000[0m in 5.05s]
[0m14:16:14.895182 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.users_full
[0m14:16:14.896182 [debug] [Thread-2 (]: Began running node model.dbt_scooters.companies_trips
[0m14:16:14.897191 [info ] [Thread-2 (]: 11 of 19 START sql table model dbt.companies_trips ............................. [RUN]
[0m14:16:14.899187 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.users_full, now model.dbt_scooters.companies_trips)
[0m14:16:14.900182 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.companies_trips
[0m14:16:14.907229 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m14:16:14.909227 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.companies_trips
[0m14:16:14.920833 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m14:16:14.925394 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:14.927387 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m14:16:14.928383 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:16:15.026214 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m14:16:15.030203 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:16:15.031204 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

    
  
  comment on view "dev_3lcu"."dbt"."events_full" is $dbt_comment_literal_block$User events enriched with meaningful types$dbt_comment_literal_block$;

  
[0m14:16:15.370412 [debug] [Thread-4 (]: SQL status: COMMENT in 0.339 seconds
[0m14:16:15.372953 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m14:16:15.372953 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:16:15.374503 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m14:16:15.715484 [debug] [Thread-4 (]: SQL status: COMMIT in 0.340 seconds
[0m14:16:15.719062 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."events_full__dbt_backup"
[0m14:16:15.720063 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:16:15.721060 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_3lcu"."dbt"."events_full__dbt_backup" cascade
[0m14:16:16.062392 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.340 seconds
[0m14:16:16.064405 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: Close
[0m14:16:16.065415 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709AED2E0>]}
[0m14:16:16.067418 [info ] [Thread-4 (]: 8 of 19 OK created sql view model dbt.events_full .............................. [[32mCREATE VIEW[0m in 4.90s]
[0m14:16:16.068418 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_full
[0m14:16:16.069416 [debug] [Thread-4 (]: Began running node model.dbt_scooters.revenue_daily
[0m14:16:16.070415 [info ] [Thread-4 (]: 12 of 19 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m14:16:16.071454 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.revenue_daily)
[0m14:16:16.072452 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m14:16:16.077795 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m14:16:16.078766 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.revenue_daily
[0m14:16:16.084349 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:16.085356 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp141616082339"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_3lcu"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m14:16:16.086359 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:16:16.589210 [debug] [Thread-3 (]: SQL status: BEGIN in 2.724 seconds
[0m14:16:16.590208 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:16:16.590208 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m14:16:16.712964 [debug] [Thread-1 (]: SQL status: BEGIN in 3.648 seconds
[0m14:16:16.714478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:16:16.716497 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m14:16:17.692932 [debug] [Thread-2 (]: SQL status: BEGIN in 2.765 seconds
[0m14:16:17.694441 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:17.694441 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_3lcu"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_3lcu"."dbt"."trips_prep" as t
        join "dev_3lcu"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_3lcu"."dbt"."companies" as c
        using (company)
  );
  
[0m14:16:20.859282 [debug] [Thread-2 (]: SQL status: SELECT 6 in 3.164 seconds
[0m14:16:20.864317 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:20.865329 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m14:16:21.254402 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.389 seconds
[0m14:16:21.260447 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:21.261957 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m14:16:21.655221 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.393 seconds
[0m14:16:21.658215 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:21.658215 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies_trips" is $dbt_comment_literal_block$Trip statistics by company$dbt_comment_literal_block$;

  
[0m14:16:22.060244 [debug] [Thread-2 (]: SQL status: COMMENT in 0.401 seconds
[0m14:16:22.069266 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:22.070266 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'companies_trips'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:16:23.060142 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.989 seconds
[0m14:16:23.064171 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:23.064171 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."companies_trips".company is $dbt_comment_literal_block$Scooters manufacturing company$dbt_comment_literal_block$;
  

  
[0m14:16:23.261160 [debug] [Thread-4 (]: SQL status: SELECT 3 in 7.174 seconds
[0m14:16:23.264179 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:23.265190 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m14:16:23.458469 [debug] [Thread-2 (]: SQL status: COMMENT in 0.393 seconds
[0m14:16:23.460469 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m14:16:23.460469 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:23.461980 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m14:16:23.603142 [debug] [Thread-4 (]: SQL status: BEGIN in 0.337 seconds
[0m14:16:23.604112 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:23.604112 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp141616082339'
        
      order by ordinal_position

  
[0m14:16:23.855297 [debug] [Thread-2 (]: SQL status: COMMIT in 0.393 seconds
[0m14:16:23.858292 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."companies_trips__dbt_backup"
[0m14:16:23.859298 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:23.860298 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_3lcu"."dbt"."companies_trips__dbt_backup" cascade
[0m14:16:24.165037 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.560 seconds
[0m14:16:24.171036 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:24.172038 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m14:16:24.261146 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.400 seconds
[0m14:16:24.264622 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: Close
[0m14:16:24.265623 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709D57200>]}
[0m14:16:24.266625 [info ] [Thread-2 (]: 11 of 19 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 9.37s]
[0m14:16:24.268625 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.companies_trips
[0m14:16:24.269624 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat
[0m14:16:24.270622 [info ] [Thread-2 (]: 13 of 19 START sql table model dbt.trips_stat .................................. [RUN]
[0m14:16:24.272133 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_stat)
[0m14:16:24.273144 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat
[0m14:16:24.277149 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m14:16:24.280145 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat
[0m14:16:24.286588 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m14:16:24.289592 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:16:24.290586 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m14:16:24.290586 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:16:24.656479 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.483 seconds
[0m14:16:24.661989 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:24.662997 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp141616082339'
        
      order by ordinal_position

  
[0m14:16:25.158070 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.494 seconds
[0m14:16:25.164087 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:25.166106 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m14:16:25.557236 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.390 seconds
[0m14:16:25.561236 [debug] [Thread-4 (]: 
    In "dev_3lcu"."finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:16:25.562743 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m14:16:25.565263 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:25.566266 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        
            delete from "dev_3lcu"."finance"."revenue_daily"
            using "revenue_daily__dbt_tmp141616082339"
            where (
                
                    "revenue_daily__dbt_tmp141616082339".date = "dev_3lcu"."finance"."revenue_daily".date
                    
                
                
            );
        
    

    insert into "dev_3lcu"."finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp141616082339"
    )
  
[0m14:16:25.953766 [debug] [Thread-4 (]: SQL status: INSERT 0 3 in 0.386 seconds
[0m14:16:25.960733 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:25.962282 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_3lcu".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'finance'
        and table_name = 'revenue_daily'
  
[0m14:16:26.358297 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.395 seconds
[0m14:16:26.360327 [debug] [Thread-4 (]: On "dev_3lcu"."finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m14:16:26.362327 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:26.362327 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  comment on table "dev_3lcu"."finance"."revenue_daily" is $dbt_comment_literal_block$Summary daily revenue$dbt_comment_literal_block$;

  
[0m14:16:26.751958 [debug] [Thread-4 (]: SQL status: COMMENT in 0.388 seconds
[0m14:16:26.756489 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:26.757486 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m14:16:27.252826 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.495 seconds
[0m14:16:27.256351 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:27.257349 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  
    
    
    comment on column "dev_3lcu"."finance"."revenue_daily".revenue_rub is $dbt_comment_literal_block$Daily revenue in rubles$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."finance"."revenue_daily".date is $dbt_comment_literal_block$Unique day$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."finance"."revenue_daily".updated_at is $dbt_comment_literal_block$When row was updated last time$dbt_comment_literal_block$;
  

  
[0m14:16:27.654054 [debug] [Thread-4 (]: SQL status: COMMENT in 0.396 seconds
[0m14:16:27.657048 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m14:16:27.658013 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:27.658013 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m14:16:28.055237 [debug] [Thread-4 (]: SQL status: COMMIT in 0.397 seconds
[0m14:16:28.057239 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: Close
[0m14:16:28.058238 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709C1DFD0>]}
[0m14:16:28.060241 [info ] [Thread-4 (]: 12 of 19 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 3[0m in 11.99s]
[0m14:16:28.062246 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.revenue_daily
[0m14:16:28.063285 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m14:16:28.064281 [info ] [Thread-4 (]: 14 of 19 START sql table model dbt.trips_stat_daily ............................ [RUN]
[0m14:16:28.066292 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_stat_daily)
[0m14:16:28.067292 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m14:16:28.075398 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m14:16:28.077398 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m14:16:28.084568 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m14:16:28.086598 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:28.087564 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m14:16:28.088564 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:16:28.832002 [debug] [Thread-2 (]: SQL status: BEGIN in 4.541 seconds
[0m14:16:28.834016 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:16:28.835011 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count(*) as trips,
    count(distinct user_id) as users,
    avg(duration_s) / 60 as avg_duration_min,
    sum(distance_m) / 1000 as sum_distance_km,
    sum(price_rub) as revenue_rub,
    count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from
    "dev_3lcu"."dbt"."trips_prep"
  );
  
[0m14:16:31.053318 [debug] [Thread-4 (]: SQL status: BEGIN in 2.966 seconds
[0m14:16:31.054316 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:31.055313 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    count(*) as trips,
    max(price_rub) as max_price_rub,
    avg(distance_m) / 1000 as avg_distance_km,
    avg(price_rub)/avg(duration_s) * 60 as avg_price_rub_per_min
from
    "dev_3lcu"."dbt"."trips_prep"
group by
    1
order by
    1
  );
  
[0m14:16:36.972098 [debug] [Thread-2 (]: SQL status: SELECT 1 in 8.137 seconds
[0m14:16:36.977332 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:16:36.978332 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m14:16:37.355226 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.376 seconds
[0m14:16:37.359225 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:16:37.359225 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m14:16:37.769008 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.409 seconds
[0m14:16:37.771988 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:16:37.773185 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat" is $dbt_comment_literal_block$Overall trips statistics$dbt_comment_literal_block$;

  
[0m14:16:38.234828 [debug] [Thread-2 (]: SQL status: COMMENT in 0.461 seconds
[0m14:16:38.236820 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m14:16:38.237819 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:16:38.238822 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m14:16:38.698986 [debug] [Thread-2 (]: SQL status: COMMIT in 0.460 seconds
[0m14:16:38.702497 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat__dbt_backup"
[0m14:16:38.704008 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:16:38.706021 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat__dbt_backup" cascade
[0m14:16:39.139303 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.432 seconds
[0m14:16:39.141327 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: Close
[0m14:16:39.142816 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207084B64B0>]}
[0m14:16:39.144328 [info ] [Thread-2 (]: 13 of 19 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 14.87s]
[0m14:16:39.146354 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat
[0m14:16:39.147337 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_users
[0m14:16:39.148337 [info ] [Thread-2 (]: 15 of 19 START sql incremental model dbt.trips_users ........................... [RUN]
[0m14:16:39.149343 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_users)
[0m14:16:39.151344 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_users
[0m14:16:39.159747 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m14:16:39.162256 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_users
[0m14:16:39.168305 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:39.170272 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp141639166275"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep" as t
left join
    "dev_3lcu"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_3lcu"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m14:16:39.171266 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:16:41.662862 [debug] [Thread-4 (]: SQL status: SELECT 91 in 10.607 seconds
[0m14:16:41.669391 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:41.671387 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m14:16:42.270375 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.599 seconds
[0m14:16:42.274737 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:42.275739 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m14:16:43.064338 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.788 seconds
[0m14:16:43.080389 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:43.081390 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    create  index if not exists
  "192c5b6405cbedd795703442d77858af"
  on "dev_3lcu"."dbt"."trips_stat_daily" 
  (date)
  
[0m14:16:43.555300 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.473 seconds
[0m14:16:43.557304 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:43.558303 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat_daily" is $dbt_comment_literal_block$Overall trips statistics per day$dbt_comment_literal_block$;

  
[0m14:16:43.952395 [debug] [Thread-4 (]: SQL status: COMMENT in 0.393 seconds
[0m14:16:43.956425 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:43.957423 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_stat_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:16:44.754031 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.796 seconds
[0m14:16:44.756041 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:44.757039 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."trips_stat_daily".date is $dbt_comment_literal_block$Trips date$dbt_comment_literal_block$;
  

  
[0m14:16:45.060227 [debug] [Thread-2 (]: SQL status: SELECT 0 in 5.889 seconds
[0m14:16:45.065418 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:45.066430 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: BEGIN
[0m14:16:45.160514 [debug] [Thread-4 (]: SQL status: COMMENT in 0.403 seconds
[0m14:16:45.163059 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m14:16:45.163059 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:45.164072 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m14:16:45.451944 [debug] [Thread-2 (]: SQL status: BEGIN in 0.385 seconds
[0m14:16:45.452952 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:45.452952 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp141639166275'
        
      order by ordinal_position

  
[0m14:16:45.552925 [debug] [Thread-4 (]: SQL status: COMMIT in 0.389 seconds
[0m14:16:45.556521 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup"
[0m14:16:45.557523 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:45.558482 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m14:16:45.971988 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.413 seconds
[0m14:16:45.974086 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m14:16:45.975134 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070A19E3C0>]}
[0m14:16:45.975134 [info ] [Thread-4 (]: 14 of 19 OK created sql table model dbt.trips_stat_daily ....................... [[32mSELECT 91[0m in 17.91s]
[0m14:16:45.977135 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m14:16:45.978105 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_stat
[0m14:16:45.979096 [info ] [Thread-4 (]: 16 of 19 START sql table model dbt.events_stat ................................. [RUN]
[0m14:16:45.980093 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.events_stat)
[0m14:16:45.980093 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_stat
[0m14:16:45.982676 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m14:16:45.984219 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_stat
[0m14:16:45.988267 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m14:16:45.989227 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:16:45.990258 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: BEGIN
[0m14:16:45.990258 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:16:46.457316 [debug] [Thread-2 (]: SQL status: SELECT 17 in 1.004 seconds
[0m14:16:46.461317 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:46.461317 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:16:47.065138 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.603 seconds
[0m14:16:47.069137 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:47.070136 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp141639166275'
        
      order by ordinal_position

  
[0m14:16:47.502150 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.431 seconds
[0m14:16:47.506175 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:47.506175 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:16:48.062077 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.556 seconds
[0m14:16:48.069506 [debug] [Thread-2 (]: 
    In "dev_3lcu"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:16:48.072088 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m14:16:48.074102 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:48.075130 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_3lcu"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp141639166275"
    )


  
[0m14:16:48.456019 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.380 seconds
[0m14:16:48.459019 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:48.459019 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_users" is $dbt_comment_literal_block$Prepared trips enriched with users data$dbt_comment_literal_block$;

  
[0m14:16:48.952003 [debug] [Thread-2 (]: SQL status: COMMENT in 0.492 seconds
[0m14:16:48.954257 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:48.955260 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m14:16:49.352476 [debug] [Thread-4 (]: SQL status: BEGIN in 3.362 seconds
[0m14:16:49.353989 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:16:49.355004 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
       count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from "dev_3lcu"."dbt"."events_full"
  );
  
[0m14:16:54.654095 [debug] [Thread-3 (]: SQL status: SELECT 142 in 38.063 seconds
[0m14:16:54.657144 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:16:54.658146 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m14:16:55.054130 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.395 seconds
[0m14:16:55.057169 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:16:55.058173 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m14:16:55.456017 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.397 seconds
[0m14:16:55.458049 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:16:55.458049 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_start_stat" is $dbt_comment_literal_block$Trip start parking statistics by 500 m hexagons$dbt_comment_literal_block$;

  
[0m14:16:55.757201 [debug] [Thread-4 (]: SQL status: SELECT 1 in 6.401 seconds
[0m14:16:55.760209 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:16:55.761209 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m14:16:55.805465 [debug] [Thread-3 (]: SQL status: COMMENT in 0.347 seconds
[0m14:16:55.807461 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m14:16:55.807461 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:16:55.808459 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m14:16:56.100272 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m14:16:56.102823 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:16:56.104369 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m14:16:56.151068 [debug] [Thread-3 (]: SQL status: COMMIT in 0.342 seconds
[0m14:16:56.155281 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_start_stat__dbt_backup"
[0m14:16:56.156282 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:16:56.157283 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_start_stat__dbt_backup" cascade
[0m14:16:56.453324 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.349 seconds
[0m14:16:56.456363 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:16:56.456363 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_stat" is $dbt_comment_literal_block$Overall user events statistics$dbt_comment_literal_block$;

  
[0m14:16:56.653151 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.495 seconds
[0m14:16:56.655158 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: Close
[0m14:16:56.656159 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070A623650>]}
[0m14:16:56.657164 [debug] [Thread-2 (]: SQL status: ANALYZE in 7.700 seconds
[0m14:16:56.659164 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m14:16:56.657164 [info ] [Thread-3 (]: 10 of 19 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 42.82s]
[0m14:16:56.659164 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:56.660194 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m14:16:56.661197 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m14:16:56.797287 [debug] [Thread-4 (]: SQL status: COMMENT in 0.340 seconds
[0m14:16:56.799267 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m14:16:56.799267 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:16:56.800267 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m14:16:57.050955 [debug] [Thread-2 (]: SQL status: COMMIT in 0.390 seconds
[0m14:16:57.052401 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:57.053411 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m14:16:57.157303 [debug] [Thread-4 (]: SQL status: COMMIT in 0.356 seconds
[0m14:16:57.160344 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."events_stat__dbt_backup"
[0m14:16:57.160344 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:16:57.161341 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_3lcu"."dbt"."events_stat__dbt_backup" cascade
[0m14:16:57.452284 [debug] [Thread-2 (]: SQL status: COMMIT in 0.399 seconds
[0m14:16:57.454332 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:57.454332 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m14:16:57.551612 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.390 seconds
[0m14:16:57.553166 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: Close
[0m14:16:57.554208 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020708673C50>]}
[0m14:16:57.555210 [info ] [Thread-4 (]: 16 of 19 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 11.58s]
[0m14:16:57.556210 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_stat
[0m14:16:57.792802 [debug] [Thread-2 (]: SQL status: VACUUM in 0.337 seconds
[0m14:16:57.794350 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: Close
[0m14:16:57.795402 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709C0BF50>]}
[0m14:16:57.796401 [info ] [Thread-2 (]: 15 of 19 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 18.65s]
[0m14:16:57.797401 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_users
[0m14:16:57.799363 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m14:16:57.799363 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_group
[0m14:16:57.800398 [info ] [Thread-3 (]: 17 of 19 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m14:16:57.801908 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now model.dbt_scooters.trips_age_daily)
[0m14:16:57.800398 [info ] [Thread-4 (]: 18 of 19 START sql table model dbt.trips_age_group ............................. [RUN]
[0m14:16:57.802923 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m14:16:57.803960 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now model.dbt_scooters.trips_age_group)
[0m14:16:57.806948 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m14:16:57.806948 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m14:16:57.809952 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m14:16:57.810953 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m14:16:57.815161 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m14:16:57.816161 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_age_group
[0m14:16:57.820161 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m14:16:57.821127 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:16:57.821127 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m14:16:57.822126 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:16:57.822126 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:16:57.823465 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m14:16:57.824464 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:17:00.052040 [debug] [Thread-1 (]: SQL status: SELECT 464 in 43.335 seconds
[0m14:17:00.056709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:17:00.056709 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m14:17:00.404171 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.347 seconds
[0m14:17:00.408180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:17:00.409182 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m14:17:00.730215 [debug] [Thread-3 (]: SQL status: BEGIN in 2.908 seconds
[0m14:17:00.731214 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:17:00.732215 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    Select "date",
       age,
       count(*) as trips,
       sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m14:17:00.755390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.345 seconds
[0m14:17:00.758391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:17:00.759394 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_finish_stat" is $dbt_comment_literal_block$Trip finish parking statistics by 10 m hexagons$dbt_comment_literal_block$;

  
[0m14:17:00.891895 [debug] [Thread-4 (]: SQL status: BEGIN in 3.068 seconds
[0m14:17:00.892944 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:17:00.892944 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users" as tu
    cross join "dev_3lcu"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m14:17:01.102881 [debug] [Thread-1 (]: SQL status: COMMENT in 0.344 seconds
[0m14:17:01.106396 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m14:17:01.106396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:17:01.107398 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m14:17:01.455208 [debug] [Thread-1 (]: SQL status: COMMIT in 0.347 seconds
[0m14:17:01.458159 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup"
[0m14:17:01.459159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:17:01.459159 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m14:17:01.855079 [debug] [Thread-3 (]: SQL status: SELECT 7049 in 1.123 seconds
[0m14:17:01.859085 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:17:01.860088 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.400 seconds
[0m14:17:01.860088 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m14:17:01.862596 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m14:17:01.864107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709C051F0>]}
[0m14:17:01.864107 [info ] [Thread-1 (]: 9 of 19 OK created sql table model dbt.parking_finish_stat ..................... [[32mSELECT 464[0m in 48.81s]
[0m14:17:01.866117 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m14:17:02.251906 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.389 seconds
[0m14:17:02.254930 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:17:02.256437 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m14:17:02.652701 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.396 seconds
[0m14:17:02.656723 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:17:02.656723 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily" is $dbt_comment_literal_block$Daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m14:17:03.052787 [debug] [Thread-3 (]: SQL status: COMMENT in 0.396 seconds
[0m14:17:03.055385 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m14:17:03.055385 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:17:03.055385 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m14:17:03.552529 [debug] [Thread-3 (]: SQL status: COMMIT in 0.496 seconds
[0m14:17:03.555042 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily__dbt_backup"
[0m14:17:03.556042 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:17:03.556042 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily__dbt_backup" cascade
[0m14:17:04.054022 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.497 seconds
[0m14:17:04.056075 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m14:17:04.056075 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070A58BD10>]}
[0m14:17:04.057629 [info ] [Thread-3 (]: 17 of 19 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 6.25s]
[0m14:17:04.058636 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m14:17:04.059679 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m14:17:04.060636 [info ] [Thread-2 (]: 19 of 19 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m14:17:04.060636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_daily_stat)
[0m14:17:04.062192 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m14:17:04.065243 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:04.067246 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m14:17:04.071252 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:04.072793 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:04.072793 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m14:17:04.074339 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:17:08.450470 [debug] [Thread-2 (]: SQL status: BEGIN in 4.377 seconds
[0m14:17:08.451976 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:08.451976 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m14:17:09.162166 [debug] [Thread-2 (]: SQL status: SELECT 83 in 0.709 seconds
[0m14:17:09.166188 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:09.166188 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m14:17:09.551844 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.384 seconds
[0m14:17:09.554894 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:09.555891 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m14:17:09.955991 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.400 seconds
[0m14:17:09.957988 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:09.958990 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily_stat" is $dbt_comment_literal_block$Aggregation of daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m14:17:10.372720 [debug] [Thread-2 (]: SQL status: COMMENT in 0.414 seconds
[0m14:17:10.374267 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m14:17:10.375317 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:10.375317 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m14:17:10.770114 [debug] [Thread-2 (]: SQL status: COMMIT in 0.394 seconds
[0m14:17:10.772659 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup"
[0m14:17:10.774212 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:10.774212 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m14:17:11.180282 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.406 seconds
[0m14:17:11.182878 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m14:17:11.183877 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709C13EF0>]}
[0m14:17:11.184887 [info ] [Thread-2 (]: 19 of 19 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 7.12s]
[0m14:17:11.185837 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m14:17:13.362991 [debug] [Thread-4 (]: SQL status: SELECT 7 in 12.469 seconds
[0m14:17:13.366990 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:17:13.366990 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m14:17:13.702539 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.335 seconds
[0m14:17:13.706137 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:17:13.707134 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m14:17:14.041028 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.334 seconds
[0m14:17:14.043479 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:17:14.044478 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_group" is $dbt_comment_literal_block$Overall trips statistics by user age group$dbt_comment_literal_block$;

  
[0m14:17:14.413011 [debug] [Thread-4 (]: SQL status: COMMENT in 0.367 seconds
[0m14:17:14.415052 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m14:17:14.415052 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:17:14.416063 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m14:17:14.900946 [debug] [Thread-4 (]: SQL status: COMMIT in 0.485 seconds
[0m14:17:14.904357 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_group__dbt_backup"
[0m14:17:14.905361 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:17:14.905361 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_group__dbt_backup" cascade
[0m14:17:15.259970 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.354 seconds
[0m14:17:15.262474 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: Close
[0m14:17:15.263989 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070A678050>]}
[0m14:17:15.263989 [info ] [Thread-4 (]: 18 of 19 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 17.46s]
[0m14:17:15.266035 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_group
[0m14:17:15.267998 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:15.269001 [debug] [MainThread]: On master: BEGIN
[0m14:17:15.269001 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:17.979312 [debug] [MainThread]: SQL status: BEGIN in 2.710 seconds
[0m14:17:17.980305 [debug] [MainThread]: On master: COMMIT
[0m14:17:17.980305 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:17.980305 [debug] [MainThread]: On master: COMMIT
[0m14:17:18.319300 [debug] [MainThread]: SQL status: COMMIT in 0.338 seconds
[0m14:17:18.319300 [info ] [MainThread]: 
[0m14:17:18.320300 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:17:18.322898 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m14:17:18.327899 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m14:17:18.328898 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:18.328898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m14:17:18.669207 [debug] [MainThread]: SQL status: GRANT in 0.339 seconds
[0m14:17:18.670208 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mGRANT[0m in 0.34s]
[0m14:17:18.671207 [info ] [MainThread]: 
[0m14:17:18.672213 [debug] [MainThread]: On master: Close
[0m14:17:18.673324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:18.673324 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m14:17:18.674357 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m14:17:18.674357 [debug] [MainThread]: Connection 'list_dev_3lcu_dbt' was properly closed.
[0m14:17:18.674357 [debug] [MainThread]: Connection 'list_dev_3lcu_finance' was properly closed.
[0m14:17:18.675356 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_finish_stat' was properly closed.
[0m14:17:18.675356 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m14:17:18.676356 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily' was properly closed.
[0m14:17:18.676356 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m14:17:18.677361 [info ] [MainThread]: 
[0m14:17:18.677361 [info ] [MainThread]: Finished running 12 table models, 4 incremental models, 3 view models, 1 project hook in 0 hours 1 minutes and 27.98 seconds (87.98s).
[0m14:17:18.681868 [debug] [MainThread]: Command end result
[0m14:17:18.726143 [info ] [MainThread]: 
[0m14:17:18.727148 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:18.728150 [info ] [MainThread]: 
[0m14:17:18.729146 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m14:17:18.731148 [debug] [MainThread]: Command `dbt run` succeeded at 14:17:18.731148 after 90.61 seconds
[0m14:17:18.732145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020707492A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709BA0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207089F2600>]}
[0m14:17:18.732651 [debug] [MainThread]: Flushing usage events
[0m14:20:10.288769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679784FDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016799F52150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016799F52690>]}


============================== 14:20:10.294301 | f115af9c-ca1f-4367-8a7f-d393f2642d22 ==============================
[0m14:20:10.294301 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:20:10.295301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:20:10.606624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679A90A7B0>]}
[0m14:20:10.691359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016799949DC0>]}
[0m14:20:10.693779 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:20:11.035665 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:20:11.378176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:20:11.379141 [debug] [MainThread]: Partial parsing: updated file: dbt_scooters://models\finance\properties.yml
[0m14:20:11.980659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679C077080>]}
[0m14:20:12.270273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679C2098E0>]}
[0m14:20:12.271274 [info ] [MainThread]: Found 19 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 437 macros
[0m14:20:12.279753 [info ] [MainThread]: 
[0m14:20:12.281264 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:20:12.291626 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m14:20:12.301789 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m14:20:12.442650 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m14:20:12.443832 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m14:20:12.444865 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m14:20:12.445827 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m14:20:12.446843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:12.446843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:16.075357 [debug] [ThreadPool]: SQL status: SELECT 23 in 3.629 seconds
[0m14:20:16.077359 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m14:20:16.096411 [debug] [ThreadPool]: SQL status: SELECT 23 in 3.649 seconds
[0m14:20:16.098412 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m14:20:16.101922 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_finance'
[0m14:20:16.108442 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m14:20:16.109444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_dbt'
[0m14:20:16.109444 [debug] [ThreadPool]: On list_dev_3lcu_finance: BEGIN
[0m14:20:16.111953 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m14:20:16.111953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:16.113463 [debug] [ThreadPool]: On list_dev_3lcu_dbt: BEGIN
[0m14:20:16.114471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:19.011972 [debug] [ThreadPool]: SQL status: BEGIN in 2.898 seconds
[0m14:20:19.013488 [debug] [ThreadPool]: SQL status: BEGIN in 2.900 seconds
[0m14:20:19.013488 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m14:20:19.014501 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m14:20:19.014501 [debug] [ThreadPool]: On list_dev_3lcu_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_dbt"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m14:20:19.015501 [debug] [ThreadPool]: On list_dev_3lcu_finance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_finance"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m14:20:19.388722 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.372 seconds
[0m14:20:19.388722 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.372 seconds
[0m14:20:19.390727 [debug] [ThreadPool]: On list_dev_3lcu_finance: ROLLBACK
[0m14:20:19.392611 [debug] [ThreadPool]: On list_dev_3lcu_dbt: ROLLBACK
[0m14:20:19.798649 [debug] [ThreadPool]: On list_dev_3lcu_finance: Close
[0m14:20:19.798649 [debug] [ThreadPool]: On list_dev_3lcu_dbt: Close
[0m14:20:19.810365 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:19.810365 [debug] [MainThread]: On master: BEGIN
[0m14:20:19.811362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:23.666289 [debug] [MainThread]: SQL status: BEGIN in 3.855 seconds
[0m14:20:23.667288 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:23.668287 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:20:24.213320 [debug] [MainThread]: SQL status: SELECT 4 in 0.544 seconds
[0m14:20:24.218515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679AA87710>]}
[0m14:20:24.219506 [debug] [MainThread]: On master: ROLLBACK
[0m14:20:24.555881 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:24.556893 [debug] [MainThread]: On master: BEGIN
[0m14:20:25.230595 [debug] [MainThread]: SQL status: BEGIN in 0.672 seconds
[0m14:20:25.231593 [debug] [MainThread]: On master: COMMIT
[0m14:20:25.232099 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:25.232099 [debug] [MainThread]: On master: COMMIT
[0m14:20:25.636715 [debug] [MainThread]: SQL status: COMMIT in 0.404 seconds
[0m14:20:25.637716 [debug] [MainThread]: On master: Close
[0m14:20:25.638712 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:20:25.639714 [info ] [MainThread]: 
[0m14:20:25.646253 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.add_first_name_sex
[0m14:20:25.646253 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m14:20:25.647248 [debug] [Thread-3 (]: Began running node seed.dbt_scooters.event_types
[0m14:20:25.648253 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.scooters
[0m14:20:25.648253 [info ] [Thread-1 (]: 1 of 51 START seed file dbt.add_first_name_sex ................................. [RUN]
[0m14:20:25.650260 [info ] [Thread-2 (]: 2 of 51 START seed file dbt.age_groups ......................................... [RUN]
[0m14:20:25.651770 [info ] [Thread-3 (]: 3 of 51 START seed file dbt.event_types ........................................ [RUN]
[0m14:20:25.653278 [info ] [Thread-4 (]: 4 of 51 START seed file dbt.scooters ........................................... [RUN]
[0m14:20:25.654294 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.dbt_scooters.add_first_name_sex'
[0m14:20:25.654294 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.dbt_scooters.age_groups'
[0m14:20:25.655287 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.dbt_scooters.event_types'
[0m14:20:25.656797 [debug] [Thread-4 (]: Acquiring new postgres connection 'seed.dbt_scooters.scooters'
[0m14:20:25.656797 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.add_first_name_sex
[0m14:20:25.657803 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m14:20:25.658807 [debug] [Thread-3 (]: Began compiling node seed.dbt_scooters.event_types
[0m14:20:25.658807 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.scooters
[0m14:20:25.659807 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.add_first_name_sex
[0m14:20:25.659807 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m14:20:25.661318 [debug] [Thread-3 (]: Began executing node seed.dbt_scooters.event_types
[0m14:20:25.662330 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.scooters
[0m14:20:25.704471 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m14:20:25.710467 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m14:20:25.720494 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m14:20:25.725516 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m14:20:25.726521 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: BEGIN
[0m14:20:25.727519 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m14:20:25.727519 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: BEGIN
[0m14:20:25.728520 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: BEGIN
[0m14:20:25.729519 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:20:25.730518 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:20:25.730518 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:20:25.732024 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:20:28.545314 [debug] [Thread-4 (]: SQL status: BEGIN in 2.814 seconds
[0m14:20:28.546317 [debug] [Thread-1 (]: SQL status: BEGIN in 2.816 seconds
[0m14:20:28.546317 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m14:20:28.547315 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m14:20:28.547315 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_3lcu"."dbt"."scooters"
[0m14:20:28.548314 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */
truncate table "dev_3lcu"."dbt"."add_first_name_sex"
[0m14:20:29.035423 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.486 seconds
[0m14:20:29.036425 [debug] [Thread-4 (]: SQL status: TRUNCATE TABLE in 0.487 seconds
[0m14:20:29.054468 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m14:20:29.058464 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m14:20:29.059468 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: 
          insert into "dev_3lcu"."dbt"."add_first_name_sex" ("first_name", "sex") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m14:20:29.059468 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_3lcu"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m14:20:29.531912 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.472 seconds
[0m14:20:29.531912 [debug] [Thread-4 (]: SQL status: INSERT 0 10 in 0.472 seconds
[0m14:20:29.539428 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.add_first_name_sex"
[0m14:20:29.540429 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m14:20:29.566012 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m14:20:29.568013 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m14:20:29.569009 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  comment on table "dev_3lcu"."dbt"."scooters" is $dbt_comment_literal_block$Scooter models information and park statistics by model. Includes information about the manufacturing company. Data received from the service team and uploaded by Mark. Data is current as of summer 2023.
$dbt_comment_literal_block$;

  
[0m14:20:29.569009 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  comment on table "dev_3lcu"."dbt"."add_first_name_sex" is $dbt_comment_literal_block$additional name_sex glossary$dbt_comment_literal_block$;

  
[0m14:20:29.788471 [debug] [Thread-2 (]: SQL status: BEGIN in 4.059 seconds
[0m14:20:29.789472 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m14:20:29.790478 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_3lcu"."dbt"."age_groups"
[0m14:20:30.040492 [debug] [Thread-1 (]: SQL status: COMMENT in 0.470 seconds
[0m14:20:30.040492 [debug] [Thread-4 (]: SQL status: COMMENT in 0.471 seconds
[0m14:20:30.041489 [debug] [Thread-3 (]: SQL status: BEGIN in 4.310 seconds
[0m14:20:30.065053 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m14:20:30.069057 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m14:20:30.070059 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m14:20:30.070059 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'add_first_name_sex'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:20:30.070059 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'scooters'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:20:30.071565 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_3lcu"."dbt"."event_types"
[0m14:20:30.345652 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.555 seconds
[0m14:20:30.349648 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m14:20:30.349648 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_3lcu"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m14:20:30.448462 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.376 seconds
[0m14:20:30.454488 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m14:20:30.454488 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".company is $dbt_comment_literal_block$Scooter company model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".model is $dbt_comment_literal_block$Scooter model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".hardware_id is $dbt_comment_literal_block$scooter model id$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".scooters is $dbt_comment_literal_block$Count of scooters$dbt_comment_literal_block$;
  

  
[0m14:20:30.480533 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.408 seconds
[0m14:20:30.482046 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m14:20:30.483556 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.410 seconds
[0m14:20:30.483556 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."add_first_name_sex".first_name is $dbt_comment_literal_block$First name of user$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."add_first_name_sex".sex is $dbt_comment_literal_block$user gender$dbt_comment_literal_block$;
  

  
[0m14:20:30.487563 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m14:20:30.488563 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_3lcu"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m14:20:30.739600 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.389 seconds
[0m14:20:30.740600 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m14:20:30.743615 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m14:20:30.743615 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  comment on table "dev_3lcu"."dbt"."age_groups" is $dbt_comment_literal_block$Age groups to split users for analysis$dbt_comment_literal_block$;

  
[0m14:20:30.789282 [debug] [Thread-4 (]: SQL status: COMMENT in 0.334 seconds
[0m14:20:30.791789 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m14:20:30.791789 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m14:20:30.791789 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m14:20:30.824358 [debug] [Thread-1 (]: SQL status: COMMENT in 0.336 seconds
[0m14:20:30.826360 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m14:20:30.827359 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m14:20:30.827359 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m14:20:30.831363 [debug] [Thread-3 (]: SQL status: INSERT 0 4 in 0.342 seconds
[0m14:20:30.831867 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m14:20:30.834383 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m14:20:30.835381 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  comment on table "dev_3lcu"."dbt"."event_types" is $dbt_comment_literal_block$Table provides a mapping between unique event type identifiers (`type_id`) and their descriptive names (`type`). It is essential for converting numerical codes from user activity logs into readable descriptions for analysis of user interactions with application features.

The table is crucial for analytics and reporting, allowing for the decoding of event identifiers in user activity datasets. By joining with event logs, it facilitates intuitive reporting and dashboarding of user interactions. The mapping enables effective segmentation and analysis of user activities, such as:

- **start_search**: Represents the initiation of a search process by a user.
- **book_scooter**: Indicates that a user has booked a scooter.
- **release_scooter**: Signifies that a user has released a previously booked scooter.
- **cancel_search**: Denotes the cancellation of a search process by a user.$dbt_comment_literal_block$;

  
[0m14:20:31.080419 [debug] [Thread-2 (]: SQL status: COMMENT in 0.336 seconds
[0m14:20:31.084445 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m14:20:31.084445 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'age_groups'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:20:31.131527 [debug] [Thread-4 (]: SQL status: COMMIT in 0.338 seconds
[0m14:20:31.133539 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: Close
[0m14:20:31.135550 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016799FC2090>]}
[0m14:20:31.136546 [info ] [Thread-4 (]: 4 of 51 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 5.48s]
[0m14:20:31.137546 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.scooters
[0m14:20:31.138552 [debug] [Thread-4 (]: Began running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m14:20:31.139550 [info ] [Thread-4 (]: 5 of 51 START test every_event_has_user ........................................ [RUN]
[0m14:20:31.140552 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now test.dbt_scooters.every_event_has_user.7eea25f36c)
[0m14:20:31.140552 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m14:20:31.158598 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m14:20:31.160600 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m14:20:31.179666 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m14:20:31.179666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.353 seconds
[0m14:20:31.181176 [debug] [Thread-3 (]: SQL status: COMMENT in 0.345 seconds
[0m14:20:31.182186 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: Close
[0m14:20:31.186191 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m14:20:31.187193 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m14:20:31.187193 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'event_types'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:20:31.188193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679AD88680>]}
[0m14:20:31.189192 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: BEGIN
[0m14:20:31.190192 [info ] [Thread-1 (]: 1 of 51 OK loaded seed file dbt.add_first_name_sex ............................. [[32mINSERT 5[0m in 5.53s]
[0m14:20:31.191199 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:31.191704 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.add_first_name_sex
[0m14:20:31.193216 [debug] [Thread-1 (]: Began running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m14:20:31.194231 [info ] [Thread-1 (]: 6 of 51 START test every_trip_has_user ......................................... [RUN]
[0m14:20:31.196235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.add_first_name_sex, now test.dbt_scooters.every_trip_has_user.6bc71135e2)
[0m14:20:31.196235 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m14:20:31.201730 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m14:20:31.203236 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m14:20:31.206252 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m14:20:31.207249 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m14:20:31.208249 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: BEGIN
[0m14:20:31.209244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:31.444251 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.359 seconds
[0m14:20:31.446253 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m14:20:31.447249 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".group is $dbt_comment_literal_block$Age group name for report$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".age_start is $dbt_comment_literal_block$Start age of group$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".age_end is $dbt_comment_literal_block$End age of group$dbt_comment_literal_block$;
  

  
[0m14:20:31.558460 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.369 seconds
[0m14:20:31.561464 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m14:20:31.561971 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."event_types".type_id is $dbt_comment_literal_block$An integer serving as a unique identifier for each event type. It is used in user event tables as a foreign key to link events to their descriptions
$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."event_types".type is $dbt_comment_literal_block$A string describing the event type, enhancing the interpretability of event data by providing a human-readable label
$dbt_comment_literal_block$;
  

  
[0m14:20:31.784477 [debug] [Thread-2 (]: SQL status: COMMENT in 0.337 seconds
[0m14:20:31.786481 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m14:20:31.787481 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m14:20:31.787481 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m14:20:31.921753 [debug] [Thread-3 (]: SQL status: COMMENT in 0.359 seconds
[0m14:20:31.923259 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m14:20:31.924267 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m14:20:31.924267 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m14:20:32.188293 [debug] [Thread-2 (]: SQL status: COMMIT in 0.400 seconds
[0m14:20:32.189304 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m14:20:32.191300 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CD748C0>]}
[0m14:20:32.191810 [info ] [Thread-2 (]: 2 of 51 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 6.54s]
[0m14:20:32.193318 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m14:20:32.194326 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m14:20:32.194326 [info ] [Thread-2 (]: 7 of 51 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m14:20:32.195331 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m14:20:32.196331 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m14:20:32.205349 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m14:20:32.207353 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m14:20:32.209350 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m14:20:32.210353 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m14:20:32.211354 [debug] [Thread-2 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m14:20:32.211859 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:32.269491 [debug] [Thread-3 (]: SQL status: COMMIT in 0.344 seconds
[0m14:20:32.270000 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: Close
[0m14:20:32.271504 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CD54980>]}
[0m14:20:32.272511 [info ] [Thread-3 (]: 3 of 51 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 6.62s]
[0m14:20:32.273520 [debug] [Thread-3 (]: Finished running node seed.dbt_scooters.event_types
[0m14:20:32.274521 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m14:20:32.274521 [info ] [Thread-3 (]: 8 of 51 START test source_not_null_scooters_raw_events_type_id ................. [RUN]
[0m14:20:32.275517 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7)
[0m14:20:32.276522 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m14:20:32.284546 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m14:20:32.286544 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m14:20:32.290541 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m14:20:32.292048 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m14:20:32.293554 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: BEGIN
[0m14:20:32.293554 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:33.974653 [debug] [Thread-1 (]: SQL status: BEGIN in 2.765 seconds
[0m14:20:33.974653 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m14:20:33.975655 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_user.6bc71135e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:20:33.994214 [debug] [Thread-4 (]: SQL status: BEGIN in 2.803 seconds
[0m14:20:33.994214 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m14:20:33.995217 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_user.7eea25f36c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:20:34.553650 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.577 seconds
[0m14:20:34.557660 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: ROLLBACK
[0m14:20:34.894502 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: Close
[0m14:20:34.896502 [info ] [Thread-1 (]: 6 of 51 PASS every_trip_has_user ............................................... [[32mPASS[0m in 3.70s]
[0m14:20:34.897502 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m14:20:34.898787 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m14:20:34.898787 [info ] [Thread-1 (]: 9 of 51 START test source_not_null_scooters_raw_events_user_id ................. [RUN]
[0m14:20:34.899831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_user.6bc71135e2, now test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b)
[0m14:20:34.901341 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m14:20:34.966387 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m14:20:34.968631 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m14:20:34.972150 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m14:20:34.974679 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m14:20:34.975677 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: BEGIN
[0m14:20:34.976678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:35.246679 [debug] [Thread-3 (]: SQL status: BEGIN in 2.953 seconds
[0m14:20:35.247681 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m14:20:35.248682 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from "dev_3lcu"."scooters_raw"."events"
where type_id is null



      
    ) dbt_internal_test
[0m14:20:35.249681 [debug] [Thread-2 (]: SQL status: BEGIN in 3.038 seconds
[0m14:20:35.251187 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m14:20:35.251187 [debug] [Thread-2 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m14:20:35.553553 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.558 seconds
[0m14:20:35.556558 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: ROLLBACK
[0m14:20:35.650252 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.398 seconds
[0m14:20:35.651770 [debug] [Thread-2 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m14:20:35.951138 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: Close
[0m14:20:35.952147 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.703 seconds
[0m14:20:35.954680 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: ROLLBACK
[0m14:20:35.955681 [info ] [Thread-4 (]: 5 of 51 PASS every_event_has_user .............................................. [[32mPASS[0m in 4.82s]
[0m14:20:35.957706 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m14:20:35.958679 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m14:20:35.959677 [info ] [Thread-4 (]: 10 of 51 START test source_not_null_scooters_raw_trips_id ...................... [RUN]
[0m14:20:35.959677 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_user.7eea25f36c, now test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d)
[0m14:20:35.961185 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m14:20:35.967200 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m14:20:35.968200 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m14:20:35.971201 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m14:20:35.973290 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m14:20:35.974796 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: BEGIN
[0m14:20:35.975813 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:35.997458 [debug] [Thread-2 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m14:20:35.999459 [info ] [Thread-2 (]: 7 of 51 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 3.80s]
[0m14:20:36.000466 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m14:20:36.001460 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m14:20:36.002542 [info ] [Thread-2 (]: 11 of 51 START test source_not_null_scooters_raw_trips_scooter_hw_id ........... [RUN]
[0m14:20:36.003543 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f)
[0m14:20:36.004544 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m14:20:36.010542 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m14:20:36.012752 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m14:20:36.015759 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m14:20:36.017762 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m14:20:36.018760 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: BEGIN
[0m14:20:36.018760 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:36.299581 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: Close
[0m14:20:36.302094 [info ] [Thread-3 (]: 8 of 51 PASS source_not_null_scooters_raw_events_type_id ....................... [[32mPASS[0m in 4.03s]
[0m14:20:36.304628 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m14:20:36.305626 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m14:20:36.306626 [info ] [Thread-3 (]: 12 of 51 START test source_not_null_scooters_raw_trips_user_id ................. [RUN]
[0m14:20:36.307634 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7, now test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62)
[0m14:20:36.308634 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m14:20:36.314703 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m14:20:36.316703 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m14:20:36.319702 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m14:20:36.322234 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m14:20:36.322234 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: BEGIN
[0m14:20:36.323754 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:37.661568 [debug] [Thread-1 (]: SQL status: BEGIN in 2.685 seconds
[0m14:20:37.662777 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m14:20:37.662777 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."events"
where user_id is null



      
    ) dbt_internal_test
[0m14:20:38.451428 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.787 seconds
[0m14:20:38.452544 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: ROLLBACK
[0m14:20:38.907234 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: Close
[0m14:20:38.907234 [debug] [Thread-4 (]: SQL status: BEGIN in 2.931 seconds
[0m14:20:38.908233 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m14:20:38.909269 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."trips"
where id is null



      
    ) dbt_internal_test
[0m14:20:38.909269 [info ] [Thread-1 (]: 9 of 51 PASS source_not_null_scooters_raw_events_user_id ....................... [[32mPASS[0m in 4.01s]
[0m14:20:38.911267 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m14:20:38.911267 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m14:20:38.911267 [info ] [Thread-1 (]: 13 of 51 START test source_not_null_scooters_raw_users_id ...................... [RUN]
[0m14:20:38.912720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b, now test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d)
[0m14:20:38.913755 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m14:20:38.917754 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m14:20:38.918720 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m14:20:38.921265 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m14:20:38.923279 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m14:20:38.923279 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: BEGIN
[0m14:20:38.924302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:39.045305 [debug] [Thread-2 (]: SQL status: BEGIN in 3.026 seconds
[0m14:20:39.045305 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m14:20:39.046305 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select scooter_hw_id
from "dev_3lcu"."scooters_raw"."trips"
where scooter_hw_id is null



      
    ) dbt_internal_test
[0m14:20:39.701865 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.792 seconds
[0m14:20:39.704422 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: ROLLBACK
[0m14:20:39.754473 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.707 seconds
[0m14:20:39.756472 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: ROLLBACK
[0m14:20:39.757473 [debug] [Thread-3 (]: SQL status: BEGIN in 3.433 seconds
[0m14:20:39.757473 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m14:20:39.758472 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."trips"
where user_id is null



      
    ) dbt_internal_test
[0m14:20:40.085207 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: Close
[0m14:20:40.086205 [info ] [Thread-4 (]: 10 of 51 PASS source_not_null_scooters_raw_trips_id ............................ [[32mPASS[0m in 4.13s]
[0m14:20:40.087205 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m14:20:40.088208 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m14:20:40.088208 [info ] [Thread-4 (]: 14 of 51 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m14:20:40.089209 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m14:20:40.090211 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m14:20:40.094226 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m14:20:40.096224 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m14:20:40.100227 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m14:20:40.101728 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m14:20:40.101728 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m14:20:40.103238 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:40.103238 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: Close
[0m14:20:40.105247 [info ] [Thread-2 (]: 11 of 51 PASS source_not_null_scooters_raw_trips_scooter_hw_id ................. [[32mPASS[0m in 4.10s]
[0m14:20:40.106252 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m14:20:40.106252 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m14:20:40.107249 [info ] [Thread-2 (]: 15 of 51 START test source_unique_scooters_raw_trips_id ........................ [RUN]
[0m14:20:40.108249 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f, now test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4)
[0m14:20:40.109248 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m14:20:40.115272 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m14:20:40.117277 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m14:20:40.120276 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m14:20:40.121781 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m14:20:40.121781 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: BEGIN
[0m14:20:40.121781 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:40.167393 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.409 seconds
[0m14:20:40.169391 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: ROLLBACK
[0m14:20:40.519629 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: Close
[0m14:20:40.521140 [info ] [Thread-3 (]: 12 of 51 PASS source_not_null_scooters_raw_trips_user_id ....................... [[32mPASS[0m in 4.21s]
[0m14:20:40.522150 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m14:20:40.522150 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m14:20:40.523664 [info ] [Thread-3 (]: 16 of 51 START test source_unique_scooters_raw_users_id ........................ [RUN]
[0m14:20:40.524680 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62, now test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf)
[0m14:20:40.525677 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m14:20:40.529672 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m14:20:40.529672 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m14:20:40.533189 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m14:20:40.534195 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m14:20:40.535199 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: BEGIN
[0m14:20:40.536200 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:41.783432 [debug] [Thread-1 (]: SQL status: BEGIN in 2.860 seconds
[0m14:20:41.784437 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m14:20:41.785437 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."users"
where id is null



      
    ) dbt_internal_test
[0m14:20:42.127543 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.342 seconds
[0m14:20:42.130543 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: ROLLBACK
[0m14:20:42.479536 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: Close
[0m14:20:42.479536 [info ] [Thread-1 (]: 13 of 51 PASS source_not_null_scooters_raw_users_id ............................ [[32mPASS[0m in 3.57s]
[0m14:20:42.481611 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m14:20:42.481611 [debug] [Thread-1 (]: Began running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m14:20:42.483158 [info ] [Thread-1 (]: 17 of 51 START test every_trip_has_scooter_id .................................. [RUN]
[0m14:20:42.484166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d, now test.dbt_scooters.every_trip_has_scooter_id.e0b845a190)
[0m14:20:42.484166 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m14:20:42.490167 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m14:20:42.491167 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m14:20:42.494537 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m14:20:42.496536 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m14:20:42.496536 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: BEGIN
[0m14:20:42.497538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:43.043321 [debug] [Thread-4 (]: SQL status: BEGIN in 2.940 seconds
[0m14:20:43.044331 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m14:20:43.044331 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sex
from "dev_3lcu"."scooters_raw"."users"
where sex is null



      
    ) dbt_internal_test
[0m14:20:43.091952 [debug] [Thread-2 (]: SQL status: BEGIN in 2.970 seconds
[0m14:20:43.093459 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m14:20:43.094469 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."trips"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:20:43.342019 [debug] [Thread-3 (]: SQL status: BEGIN in 2.806 seconds
[0m14:20:43.342019 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m14:20:43.343575 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."users"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:20:43.389122 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.344 seconds
[0m14:20:43.391159 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m14:20:43.748254 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m14:20:43.750250 [warn ] [Thread-4 (]: 14 of 51 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 3.66s]
[0m14:20:43.751253 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m14:20:43.752676 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m14:20:43.753709 [info ] [Thread-4 (]: 18 of 51 START test unique_key_scooters_company__model__hardware_id ............ [RUN]
[0m14:20:43.754677 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e)
[0m14:20:43.754677 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m14:20:43.761255 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m14:20:43.763266 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m14:20:43.765299 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m14:20:43.767265 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m14:20:43.768266 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: BEGIN
[0m14:20:43.768266 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:43.851958 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.507 seconds
[0m14:20:43.853508 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: ROLLBACK
[0m14:20:44.213640 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: Close
[0m14:20:44.214684 [info ] [Thread-3 (]: 16 of 51 PASS source_unique_scooters_raw_users_id .............................. [[32mPASS[0m in 3.69s]
[0m14:20:44.216651 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m14:20:44.217649 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m14:20:44.218650 [info ] [Thread-3 (]: 19 of 51 START test unique_not_null_scooters_hardware_id ....................... [RUN]
[0m14:20:44.219655 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf, now test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d)
[0m14:20:44.219655 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m14:20:44.225184 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m14:20:44.227184 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m14:20:44.229184 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m14:20:44.231185 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m14:20:44.232218 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: BEGIN
[0m14:20:44.232218 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:44.822536 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.727 seconds
[0m14:20:44.824584 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: ROLLBACK
[0m14:20:45.241224 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: Close
[0m14:20:45.242322 [info ] [Thread-2 (]: 15 of 51 PASS source_unique_scooters_raw_trips_id .............................. [[32mPASS[0m in 5.13s]
[0m14:20:45.244330 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m14:20:45.245328 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m14:20:45.245328 [info ] [Thread-2 (]: 20 of 51 START test unique_not_null_scooters_model ............................. [RUN]
[0m14:20:45.246328 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4, now test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc)
[0m14:20:45.247329 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m14:20:45.251843 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m14:20:45.253356 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m14:20:45.257371 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m14:20:45.259363 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m14:20:45.260365 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: BEGIN
[0m14:20:45.260365 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:45.816314 [debug] [Thread-1 (]: SQL status: BEGIN in 3.319 seconds
[0m14:20:45.817313 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m14:20:45.817313 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select scooter_hw_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where scooter_hw_id is not null
),

parent as (
    select hardware_id as to_field
    from "dev_3lcu"."dbt"."scooters"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:20:46.401458 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.583 seconds
[0m14:20:46.403834 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: ROLLBACK
[0m14:20:46.630290 [debug] [Thread-4 (]: SQL status: BEGIN in 2.862 seconds
[0m14:20:46.631329 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m14:20:46.631329 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "company"::text ||
    
        "model"::text ||
    
        "hardware_id"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m14:20:46.789759 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: Close
[0m14:20:46.792282 [info ] [Thread-1 (]: 17 of 51 PASS every_trip_has_scooter_id ........................................ [[32mPASS[0m in 4.31s]
[0m14:20:46.794277 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m14:20:46.794277 [debug] [Thread-1 (]: Began running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m14:20:46.795277 [info ] [Thread-1 (]: 21 of 51 START test accepted_values_add_first_name_sex_sex__M__F ............... [RUN]
[0m14:20:46.796276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_scooter_id.e0b845a190, now test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199)
[0m14:20:46.796276 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m14:20:46.801312 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m14:20:46.801852 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m14:20:46.805400 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m14:20:46.806400 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m14:20:46.807372 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: BEGIN
[0m14:20:46.808372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:47.047530 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.415 seconds
[0m14:20:47.049568 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: ROLLBACK
[0m14:20:47.395195 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: Close
[0m14:20:47.397199 [info ] [Thread-4 (]: 18 of 51 PASS unique_key_scooters_company__model__hardware_id .................. [[32mPASS[0m in 3.64s]
[0m14:20:47.399202 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m14:20:47.399202 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m14:20:47.400198 [info ] [Thread-4 (]: 22 of 51 START test unique_not_null_add_first_name_sex_first_name .............. [RUN]
[0m14:20:47.401199 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e, now test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f)
[0m14:20:47.402308 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m14:20:47.407314 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m14:20:47.408313 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m14:20:47.411822 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m14:20:47.413330 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m14:20:47.414340 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: BEGIN
[0m14:20:47.414340 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:48.249517 [debug] [Thread-2 (]: SQL status: BEGIN in 2.989 seconds
[0m14:20:48.250503 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m14:20:48.251500 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "model"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "model" is null


      
    ) dbt_internal_test
[0m14:20:48.491727 [debug] [Thread-3 (]: SQL status: BEGIN in 4.260 seconds
[0m14:20:48.493273 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m14:20:48.494322 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "hardware_id"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "hardware_id" is null


      
    ) dbt_internal_test
[0m14:20:48.635545 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.384 seconds
[0m14:20:48.638549 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: ROLLBACK
[0m14:20:48.855283 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.360 seconds
[0m14:20:48.858272 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: ROLLBACK
[0m14:20:49.224607 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: Close
[0m14:20:49.226607 [info ] [Thread-2 (]: 20 of 51 PASS unique_not_null_scooters_model ................................... [[32mPASS[0m in 3.98s]
[0m14:20:49.227565 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m14:20:49.228563 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m14:20:49.229564 [info ] [Thread-2 (]: 23 of 51 START test unique_not_null_age_groups_age_end ......................... [RUN]
[0m14:20:49.229564 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc, now test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac)
[0m14:20:49.231072 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m14:20:49.235602 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m14:20:49.237601 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m14:20:49.241110 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m14:20:49.243120 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m14:20:49.244128 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: BEGIN
[0m14:20:49.244128 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:49.260182 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: Close
[0m14:20:49.262229 [info ] [Thread-3 (]: 19 of 51 PASS unique_not_null_scooters_hardware_id ............................. [[32mPASS[0m in 5.04s]
[0m14:20:49.264232 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m14:20:49.265230 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m14:20:49.266231 [info ] [Thread-3 (]: 24 of 51 START test unique_not_null_age_groups_age_start ....................... [RUN]
[0m14:20:49.267229 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d, now test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b)
[0m14:20:49.268233 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m14:20:49.273344 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m14:20:49.275342 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m14:20:49.278339 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m14:20:49.280342 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m14:20:49.281855 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: BEGIN
[0m14:20:49.283367 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:49.675354 [debug] [Thread-1 (]: SQL status: BEGIN in 2.868 seconds
[0m14:20:49.676356 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m14:20:49.677305 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."dbt"."add_first_name_sex"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m14:20:50.026297 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.348 seconds
[0m14:20:50.028298 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: ROLLBACK
[0m14:20:50.373610 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: Close
[0m14:20:50.375612 [info ] [Thread-1 (]: 21 of 51 PASS accepted_values_add_first_name_sex_sex__M__F ..................... [[32mPASS[0m in 3.58s]
[0m14:20:50.377612 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m14:20:50.378609 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m14:20:50.379609 [info ] [Thread-1 (]: 25 of 51 START test unique_not_null_age_groups_group ........................... [RUN]
[0m14:20:50.379609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199, now test.dbt_scooters.unique_not_null_age_groups_group.39342291f1)
[0m14:20:50.381119 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m14:20:50.387659 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m14:20:50.389658 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m14:20:50.395198 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m14:20:50.398197 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m14:20:50.399196 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: BEGIN
[0m14:20:50.399196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:51.625284 [debug] [Thread-4 (]: SQL status: BEGIN in 4.210 seconds
[0m14:20:51.626290 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m14:20:51.626290 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "first_name"
from
    "dev_3lcu"."dbt"."add_first_name_sex"
group by
    1
having
    count(*) > 1 or "first_name" is null


      
    ) dbt_internal_test
[0m14:20:51.910404 [debug] [Thread-2 (]: SQL status: BEGIN in 2.666 seconds
[0m14:20:51.911403 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m14:20:51.911916 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_end"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_end" is null


      
    ) dbt_internal_test
[0m14:20:51.974292 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.347 seconds
[0m14:20:51.977291 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: ROLLBACK
[0m14:20:52.019500 [debug] [Thread-3 (]: SQL status: BEGIN in 2.737 seconds
[0m14:20:52.020500 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m14:20:52.021501 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_start"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_start" is null


      
    ) dbt_internal_test
[0m14:20:52.247444 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.335 seconds
[0m14:20:52.250444 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: ROLLBACK
[0m14:20:52.325369 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: Close
[0m14:20:52.327373 [info ] [Thread-4 (]: 22 of 51 PASS unique_not_null_add_first_name_sex_first_name .................... [[32mPASS[0m in 4.93s]
[0m14:20:52.328373 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m14:20:52.329373 [debug] [Thread-4 (]: Began running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m14:20:52.330372 [info ] [Thread-4 (]: 26 of 51 START test every_event_has_type ....................................... [RUN]
[0m14:20:52.331372 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f, now test.dbt_scooters.every_event_has_type.1e5fc977eb)
[0m14:20:52.331884 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m14:20:52.339408 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m14:20:52.340409 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m14:20:52.346449 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m14:20:52.347449 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m14:20:52.348450 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: BEGIN
[0m14:20:52.349449 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:52.365529 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.343 seconds
[0m14:20:52.367530 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: ROLLBACK
[0m14:20:52.587984 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: Close
[0m14:20:52.589986 [info ] [Thread-2 (]: 23 of 51 PASS unique_not_null_age_groups_age_end ............................... [[32mPASS[0m in 3.36s]
[0m14:20:52.591499 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m14:20:52.591499 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m14:20:52.592511 [info ] [Thread-2 (]: 27 of 51 START test unique_not_null_event_types_type ........................... [RUN]
[0m14:20:52.593509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac, now test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1)
[0m14:20:52.594512 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m14:20:52.598509 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m14:20:52.600511 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m14:20:52.603540 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m14:20:52.605555 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m14:20:52.606558 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: BEGIN
[0m14:20:52.607554 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:52.709339 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: Close
[0m14:20:52.711341 [info ] [Thread-3 (]: 24 of 51 PASS unique_not_null_age_groups_age_start ............................. [[32mPASS[0m in 3.44s]
[0m14:20:52.711853 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m14:20:52.713364 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m14:20:52.714377 [info ] [Thread-3 (]: 28 of 51 START test unique_not_null_event_types_type_id ........................ [RUN]
[0m14:20:52.715380 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b, now test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85)
[0m14:20:52.716379 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m14:20:52.721378 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m14:20:52.721888 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m14:20:52.725413 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m14:20:52.727414 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m14:20:52.727414 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: BEGIN
[0m14:20:52.728414 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:53.274306 [debug] [Thread-1 (]: SQL status: BEGIN in 2.874 seconds
[0m14:20:53.274306 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m14:20:53.275306 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "group"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "group" is null


      
    ) dbt_internal_test
[0m14:20:53.675521 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.399 seconds
[0m14:20:53.677521 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: ROLLBACK
[0m14:20:54.023581 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: Close
[0m14:20:54.024590 [info ] [Thread-1 (]: 25 of 51 PASS unique_not_null_age_groups_group ................................. [[32mPASS[0m in 3.64s]
[0m14:20:54.025591 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m14:20:54.026592 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m14:20:54.027591 [info ] [Thread-1 (]: 29 of 51 START sql incremental model dbt.events_clean .......................... [RUN]
[0m14:20:54.028590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_group.39342291f1, now model.dbt_scooters.events_clean)
[0m14:20:54.028590 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m14:20:54.033105 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m14:20:54.035116 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m14:20:54.087897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:20:54.088901 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp142054066334"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at

from
    "dev_3lcu"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."events_clean")
    

  );
  
  
[0m14:20:54.088901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:55.134415 [debug] [Thread-4 (]: SQL status: BEGIN in 2.785 seconds
[0m14:20:55.134415 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m14:20:55.135417 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_type.1e5fc977eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where type_id is not null
),

parent as (
    select type_id as to_field
    from "dev_3lcu"."dbt"."event_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:20:55.489914 [debug] [Thread-3 (]: SQL status: BEGIN in 2.761 seconds
[0m14:20:55.489914 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m14:20:55.489914 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type_id"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type_id" is null


      
    ) dbt_internal_test
[0m14:20:55.728124 [debug] [Thread-2 (]: SQL status: BEGIN in 3.121 seconds
[0m14:20:55.729127 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m14:20:55.729127 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type" is null


      
    ) dbt_internal_test
[0m14:20:55.863201 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.372 seconds
[0m14:20:55.865210 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: ROLLBACK
[0m14:20:56.160468 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.431 seconds
[0m14:20:56.161990 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: ROLLBACK
[0m14:20:56.257365 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: Close
[0m14:20:56.258321 [info ] [Thread-3 (]: 28 of 51 PASS unique_not_null_event_types_type_id .............................. [[32mPASS[0m in 3.54s]
[0m14:20:56.260324 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m14:20:56.260324 [debug] [Thread-3 (]: Began running node model.dbt_scooters.first_name_sex
[0m14:20:56.261321 [info ] [Thread-3 (]: 30 of 51 START sql table model dbt.first_name_sex .............................. [RUN]
[0m14:20:56.262584 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85, now model.dbt_scooters.first_name_sex)
[0m14:20:56.262584 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.first_name_sex
[0m14:20:56.265591 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.first_name_sex"
[0m14:20:56.267592 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.first_name_sex
[0m14:20:56.281108 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.first_name_sex"
[0m14:20:56.281621 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:20:56.283134 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: BEGIN
[0m14:20:56.283134 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:56.469523 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.334 seconds
[0m14:20:56.472067 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: ROLLBACK
[0m14:20:56.499413 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: Close
[0m14:20:56.500456 [info ] [Thread-2 (]: 27 of 51 PASS unique_not_null_event_types_type ................................. [[32mPASS[0m in 3.91s]
[0m14:20:56.501453 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m14:20:56.502552 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_concurrency
[0m14:20:56.503595 [info ] [Thread-2 (]: 31 of 51 START sql incremental model dbt.trips_concurrency ..................... [RUN]
[0m14:20:56.503595 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1, now model.dbt_scooters.trips_concurrency)
[0m14:20:56.504554 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m14:20:56.511145 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m14:20:56.512196 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m14:20:56.516190 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:20:56.517188 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp142056515189"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_3lcu"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_3lcu"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now()  as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m14:20:56.517188 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:56.856367 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: Close
[0m14:20:56.857348 [info ] [Thread-4 (]: 26 of 51 PASS every_event_has_type ............................................. [[32mPASS[0m in 4.53s]
[0m14:20:56.859349 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m14:20:56.859349 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_geom
[0m14:20:56.860341 [info ] [Thread-4 (]: 32 of 51 START sql view model dbt.trips_geom ................................... [RUN]
[0m14:20:56.861820 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_type.1e5fc977eb, now model.dbt_scooters.trips_geom)
[0m14:20:56.861820 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_geom
[0m14:20:56.865373 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m14:20:56.866338 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_geom
[0m14:20:56.886639 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m14:20:56.888602 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:20:56.888602 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m14:20:56.889642 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:58.281984 [debug] [Thread-1 (]: SQL status: SELECT 0 in 4.193 seconds
[0m14:20:58.286584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:20:58.287536 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m14:20:58.637690 [debug] [Thread-1 (]: SQL status: BEGIN in 0.350 seconds
[0m14:20:58.638639 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:20:58.639641 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp142054066334'
        
      order by ordinal_position

  
[0m14:20:59.037558 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.398 seconds
[0m14:20:59.041101 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:20:59.042144 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:20:59.214215 [debug] [Thread-3 (]: SQL status: BEGIN in 2.931 seconds
[0m14:20:59.215169 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:20:59.216169 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

  
    

  create  table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp"
  
  
    as
  
  (
    select distinct first_name, sex
from "dev_3lcu"."scooters_raw"."users"
Where sex is not null
  );
  
[0m14:20:59.439547 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.397 seconds
[0m14:20:59.454269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:20:59.455269 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp142054066334'
        
      order by ordinal_position

  
[0m14:20:59.649595 [debug] [Thread-4 (]: SQL status: BEGIN in 2.761 seconds
[0m14:20:59.651144 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:20:59.652153 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_3lcu"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m14:20:59.653152 [debug] [Thread-3 (]: SQL status: SELECT 387 in 0.436 seconds
[0m14:20:59.660151 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:20:59.660151 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex" rename to "first_name_sex__dbt_backup"
[0m14:20:59.866195 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.410 seconds
[0m14:20:59.870149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:20:59.870149 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:21:00.076341 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.415 seconds
[0m14:21:00.080383 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:21:00.080383 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp" rename to "first_name_sex"
[0m14:21:00.092184 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.440 seconds
[0m14:21:00.096179 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:21:00.097137 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m14:21:00.353295 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.483 seconds
[0m14:21:00.365266 [debug] [Thread-1 (]: 
    In "dev_3lcu"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:21:00.384314 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m14:21:00.385311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:21:00.386311 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        
            delete from "dev_3lcu"."dbt"."events_clean"
            using "events_clean__dbt_tmp142054066334"
            where (
                
                    "events_clean__dbt_tmp142054066334".user_id = "dev_3lcu"."dbt"."events_clean".user_id
                    and 
                
                    "events_clean__dbt_tmp142054066334".timestamp = "dev_3lcu"."dbt"."events_clean".timestamp
                    and 
                
                    "events_clean__dbt_tmp142054066334".type_id = "dev_3lcu"."dbt"."events_clean".type_id
                    
                
                
            );
        
    

    insert into "dev_3lcu"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp142054066334"
    )
  
[0m14:21:00.449268 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.352 seconds
[0m14:21:00.453553 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:21:00.453553 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.372 seconds
[0m14:21:00.454519 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m14:21:00.462026 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:21:00.463535 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

    
  
  comment on table "dev_3lcu"."dbt"."first_name_sex" is $dbt_comment_literal_block$Unique name_sex glossary$dbt_comment_literal_block$;

  
[0m14:21:00.770214 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.383 seconds
[0m14:21:00.771764 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:21:00.771764 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_clean" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m14:21:00.811817 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.349 seconds
[0m14:21:00.814391 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:21:00.815389 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_geom" is $dbt_comment_literal_block$Trips prepared for geometry analysis$dbt_comment_literal_block$;

  
[0m14:21:00.860435 [debug] [Thread-3 (]: SQL status: COMMENT in 0.396 seconds
[0m14:21:00.861924 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m14:21:00.861924 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:21:00.863436 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m14:21:01.058304 [debug] [Thread-2 (]: SQL status: SELECT 0 in 4.541 seconds
[0m14:21:01.062428 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:21:01.063444 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m14:21:01.171818 [debug] [Thread-4 (]: SQL status: COMMENT in 0.356 seconds
[0m14:21:01.174421 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m14:21:01.175424 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:21:01.176426 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m14:21:01.274570 [debug] [Thread-1 (]: SQL status: COMMENT in 0.502 seconds
[0m14:21:01.275565 [debug] [Thread-3 (]: SQL status: COMMIT in 0.412 seconds
[0m14:21:01.277563 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m14:21:01.284554 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."first_name_sex__dbt_backup"
[0m14:21:01.285559 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:21:01.291062 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:21:01.292073 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m14:21:01.292073 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
drop table if exists "dev_3lcu"."dbt"."first_name_sex__dbt_backup" cascade
[0m14:21:01.409513 [debug] [Thread-2 (]: SQL status: BEGIN in 0.346 seconds
[0m14:21:01.411023 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:21:01.411023 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp142056515189'
        
      order by ordinal_position

  
[0m14:21:01.530220 [debug] [Thread-4 (]: SQL status: COMMIT in 0.353 seconds
[0m14:21:01.533373 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_geom__dbt_backup"
[0m14:21:01.536379 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:21:01.537350 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_3lcu"."dbt"."trips_geom__dbt_backup" cascade
[0m14:21:01.689328 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.396 seconds
[0m14:21:01.690285 [debug] [Thread-1 (]: SQL status: COMMIT in 0.397 seconds
[0m14:21:01.692292 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: Close
[0m14:21:01.693342 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m14:21:01.694307 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679C07D400>]}
[0m14:21:01.694307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679C9FB470>]}
[0m14:21:01.695342 [info ] [Thread-3 (]: 30 of 51 OK created sql table model dbt.first_name_sex ......................... [[32mSELECT 387[0m in 5.43s]
[0m14:21:01.697302 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.first_name_sex
[0m14:21:01.696303 [info ] [Thread-1 (]: 29 of 51 OK created sql incremental model dbt.events_clean ..................... [[32mINSERT 0 0[0m in 7.67s]
[0m14:21:01.698303 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_prep
[0m14:21:01.699302 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m14:21:01.700300 [info ] [Thread-3 (]: 33 of 51 START sql view model dbt.trips_prep ................................... [RUN]
[0m14:21:01.701303 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m14:21:01.701303 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.first_name_sex, now model.dbt_scooters.trips_prep)
[0m14:21:01.702594 [info ] [Thread-1 (]: 34 of 51 START sql table model dbt.companies ................................... [RUN]
[0m14:21:01.703626 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_prep
[0m14:21:01.704595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.companies)
[0m14:21:01.708591 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m14:21:01.709593 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m14:21:01.712189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m14:21:01.713190 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_prep
[0m14:21:01.717198 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m14:21:01.718192 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m14:21:01.721730 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m14:21:01.723272 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:21:01.724281 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m14:21:01.725280 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:21:01.725280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:21:01.726279 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m14:21:01.727283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:01.761335 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.349 seconds
[0m14:21:01.764522 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:21:01.765526 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:21:01.922142 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.385 seconds
[0m14:21:01.926138 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: Close
[0m14:21:01.927100 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679C06E870>]}
[0m14:21:01.928136 [info ] [Thread-4 (]: 32 of 51 OK created sql view model dbt.trips_geom .............................. [[32mCREATE VIEW[0m in 5.07s]
[0m14:21:01.929102 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_geom
[0m14:21:01.930141 [debug] [Thread-4 (]: Began running node model.dbt_scooters.users_full
[0m14:21:01.931100 [info ] [Thread-4 (]: 35 of 51 START sql table model dbt.users_full .................................. [RUN]
[0m14:21:01.931610 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.users_full)
[0m14:21:01.933154 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.users_full
[0m14:21:01.937197 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.users_full"
[0m14:21:01.939163 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.users_full
[0m14:21:01.941743 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.users_full"
[0m14:21:01.944299 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:21:01.945300 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: BEGIN
[0m14:21:01.945300 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:21:02.108229 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.342 seconds
[0m14:21:02.111774 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:21:02.113282 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp142056515189'
        
      order by ordinal_position

  
[0m14:21:02.454360 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.341 seconds
[0m14:21:02.458301 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:21:02.459300 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:21:02.803207 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.344 seconds
[0m14:21:02.805146 [debug] [Thread-2 (]: 
    In "dev_3lcu"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:21:02.811651 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m14:21:02.813158 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:21:02.813158 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_3lcu"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp142056515189"
    )


  
[0m14:21:03.151420 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.337 seconds
[0m14:21:03.153519 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:21:03.154525 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_concurrency" is $dbt_comment_literal_block$Number of simultaneous rides in time$dbt_comment_literal_block$;

  
[0m14:21:03.548269 [debug] [Thread-2 (]: SQL status: COMMENT in 0.393 seconds
[0m14:21:03.550271 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m14:21:03.550271 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:21:03.551271 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m14:21:03.891692 [debug] [Thread-2 (]: SQL status: COMMIT in 0.341 seconds
[0m14:21:03.893242 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: Close
[0m14:21:03.894303 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CE7FB00>]}
[0m14:21:03.895313 [info ] [Thread-2 (]: 31 of 51 OK created sql incremental model dbt.trips_concurrency ................ [[32mINSERT 0 0[0m in 7.39s]
[0m14:21:03.896310 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m14:21:03.897352 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_full
[0m14:21:03.898312 [info ] [Thread-2 (]: 36 of 51 START sql view model dbt.events_full .................................. [RUN]
[0m14:21:03.899310 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.events_full)
[0m14:21:03.900319 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_full
[0m14:21:03.905371 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m14:21:03.906341 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_full
[0m14:21:03.911344 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m14:21:03.913404 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:21:03.913404 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: BEGIN
[0m14:21:03.914440 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:04.485390 [debug] [Thread-3 (]: SQL status: BEGIN in 2.760 seconds
[0m14:21:04.485390 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:21:04.486390 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_3lcu"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select
    id,
    user_id,
    scooter_hw_id,
    started_at,
    finished_at,
    start_lat,
    start_lon,
    finish_lat,
    finish_lon,
    distance as distance_m,
    cast(price as decimal(20, 2)) / 100 as price_rub,
    extract(epoch from (finished_at - started_at)) as duration_s,
    finished_at <> started_at and price = 0 as is_free,
    
    date(started_at at time zone 'Europe/Moscow')
 as "date"
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m14:21:04.783276 [debug] [Thread-4 (]: SQL status: BEGIN in 2.838 seconds
[0m14:21:04.784328 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:21:04.784328 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

  
    

  create  table "dev_3lcu"."dbt"."users_full__dbt_tmp"
  
  
    as
  
  (
    select
   u.id, u.first_name ,u.last_name ,u.phone ,
   COALESCE(u.sex, fns.sex, afns.sex) as sex2,
   u.birth_date
from "dev_3lcu"."scooters_raw"."users" u
left join "dev_3lcu"."dbt"."first_name_sex" fns on u.first_name = fns.first_name
left join "dev_3lcu"."dbt"."add_first_name_sex" afns on u.first_name =afns.first_name
  );
  
[0m14:21:04.853375 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.367 seconds
[0m14:21:04.857381 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:21:04.858381 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m14:21:05.154127 [debug] [Thread-4 (]: SQL status: SELECT 2000 in 0.368 seconds
[0m14:21:05.157168 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:21:05.158169 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full" rename to "users_full__dbt_backup"
[0m14:21:05.199847 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.341 seconds
[0m14:21:05.203446 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:21:05.204407 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m14:21:05.466162 [debug] [Thread-1 (]: SQL status: BEGIN in 3.739 seconds
[0m14:21:05.466162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:21:05.467168 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_3lcu"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
  );
  
[0m14:21:05.503332 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.345 seconds
[0m14:21:05.507388 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:21:05.507388 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full__dbt_tmp" rename to "users_full"
[0m14:21:05.546583 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.342 seconds
[0m14:21:05.548591 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:21:05.549543 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_prep" is $dbt_comment_literal_block$Trips prepared for analysis$dbt_comment_literal_block$;

  
[0m14:21:05.830288 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.363 seconds
[0m14:21:05.835695 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:21:05.836658 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies" rename to "companies__dbt_backup"
[0m14:21:05.851309 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.344 seconds
[0m14:21:05.853495 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:21:05.854486 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

    
  
  comment on table "dev_3lcu"."dbt"."users_full" is $dbt_comment_literal_block$Users enriched with sex$dbt_comment_literal_block$;

  
[0m14:21:05.891400 [debug] [Thread-3 (]: SQL status: COMMENT in 0.342 seconds
[0m14:21:05.893506 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m14:21:05.893506 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:21:05.894515 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m14:21:06.173230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.336 seconds
[0m14:21:06.177237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:21:06.177237 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies__dbt_tmp" rename to "companies"
[0m14:21:06.199226 [debug] [Thread-4 (]: SQL status: COMMENT in 0.344 seconds
[0m14:21:06.200224 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: COMMIT
[0m14:21:06.201236 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:21:06.201236 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: COMMIT
[0m14:21:06.237355 [debug] [Thread-3 (]: SQL status: COMMIT in 0.343 seconds
[0m14:21:06.240350 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_prep__dbt_backup"
[0m14:21:06.241311 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:21:06.241861 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_3lcu"."dbt"."trips_prep__dbt_backup" cascade
[0m14:21:06.514489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m14:21:06.517487 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:21:06.517487 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies" is $dbt_comment_literal_block$Scooter statistics by company$dbt_comment_literal_block$;

  
[0m14:21:06.549432 [debug] [Thread-4 (]: SQL status: COMMIT in 0.347 seconds
[0m14:21:06.551978 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."users_full__dbt_backup"
[0m14:21:06.551978 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:21:06.553526 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
drop table if exists "dev_3lcu"."dbt"."users_full__dbt_backup" cascade
[0m14:21:06.585511 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.343 seconds
[0m14:21:06.586514 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: Close
[0m14:21:06.587512 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CE5BC50>]}
[0m14:21:06.588471 [info ] [Thread-3 (]: 33 of 51 OK created sql view model dbt.trips_prep .............................. [[32mCREATE VIEW[0m in 4.89s]
[0m14:21:06.589472 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_prep
[0m14:21:06.590473 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m14:21:06.591472 [info ] [Thread-3 (]: 37 of 51 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m14:21:06.591978 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.parking_finish_stat)
[0m14:21:06.591978 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m14:21:06.597127 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m14:21:06.598128 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m14:21:06.601673 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m14:21:06.604234 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:21:06.605224 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m14:21:06.606226 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:21:06.688177 [debug] [Thread-2 (]: SQL status: BEGIN in 2.774 seconds
[0m14:21:06.688177 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:21:06.689177 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_3lcu"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select * from
"dev_3lcu"."dbt"."events_clean" as e
left join "dev_3lcu"."dbt"."event_types" as t
using (type_id)
  );
[0m14:21:06.854436 [debug] [Thread-1 (]: SQL status: COMMENT in 0.336 seconds
[0m14:21:06.855476 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m14:21:06.856477 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:21:06.857436 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m14:21:06.901141 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.347 seconds
[0m14:21:06.903150 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: Close
[0m14:21:06.904161 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679C9434A0>]}
[0m14:21:06.905200 [info ] [Thread-4 (]: 35 of 51 OK created sql table model dbt.users_full ............................. [[32mSELECT 2000[0m in 4.97s]
[0m14:21:06.906162 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.users_full
[0m14:21:06.907163 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_start_stat
[0m14:21:06.907163 [info ] [Thread-4 (]: 38 of 51 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m14:21:06.908201 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.users_full, now model.dbt_scooters.parking_start_stat)
[0m14:21:06.909203 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m14:21:06.911752 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m14:21:06.913258 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m14:21:06.919307 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m14:21:06.920295 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:21:06.921267 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m14:21:06.921267 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:21:07.031306 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.341 seconds
[0m14:21:07.035452 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:21:07.035452 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m14:21:07.194176 [debug] [Thread-1 (]: SQL status: COMMIT in 0.337 seconds
[0m14:21:07.197689 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."companies__dbt_backup"
[0m14:21:07.198690 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:21:07.198690 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_3lcu"."dbt"."companies__dbt_backup" cascade
[0m14:21:07.375407 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.339 seconds
[0m14:21:07.379361 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:21:07.379361 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m14:21:07.541942 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.343 seconds
[0m14:21:07.544530 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m14:21:07.545489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CE6FF20>]}
[0m14:21:07.546486 [info ] [Thread-1 (]: 34 of 51 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 5.84s]
[0m14:21:07.547540 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m14:21:07.548528 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m14:21:07.549489 [info ] [Thread-1 (]: 39 of 51 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m14:21:07.549489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.revenue_daily)
[0m14:21:07.551038 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m14:21:07.556086 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m14:21:07.558049 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m14:21:07.581205 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:07.581205 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
select * from (
        select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_3lcu"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
    ) as __dbt_sbq
    where false
    limit 0

[0m14:21:07.582471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:07.717481 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m14:21:07.720435 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:21:07.720435 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

    
  
  comment on view "dev_3lcu"."dbt"."events_full" is $dbt_comment_literal_block$User events enriched with meaningful types$dbt_comment_literal_block$;

  
[0m14:21:08.068171 [debug] [Thread-2 (]: SQL status: COMMENT in 0.347 seconds
[0m14:21:08.070171 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: COMMIT
[0m14:21:08.071172 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:21:08.071682 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: COMMIT
[0m14:21:08.417446 [debug] [Thread-2 (]: SQL status: COMMIT in 0.346 seconds
[0m14:21:08.420445 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."events_full__dbt_backup"
[0m14:21:08.421446 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:21:08.421956 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_3lcu"."dbt"."events_full__dbt_backup" cascade
[0m14:21:08.761691 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.340 seconds
[0m14:21:08.764292 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: Close
[0m14:21:08.765246 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CD5C230>]}
[0m14:21:08.766286 [info ] [Thread-2 (]: 36 of 51 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 4.87s]
[0m14:21:08.767247 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_full
[0m14:21:08.768247 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat
[0m14:21:08.768247 [info ] [Thread-2 (]: 40 of 51 START sql table model dbt.trips_stat .................................. [RUN]
[0m14:21:08.769286 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_stat)
[0m14:21:08.770246 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat
[0m14:21:08.773261 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m14:21:08.775272 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat
[0m14:21:08.779272 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m14:21:08.780272 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:21:08.781779 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m14:21:08.781779 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:09.516529 [debug] [Thread-3 (]: SQL status: BEGIN in 2.911 seconds
[0m14:21:09.517485 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:21:09.518484 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m14:21:09.624593 [debug] [Thread-4 (]: SQL status: BEGIN in 2.703 seconds
[0m14:21:09.625602 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:21:09.625602 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m14:21:10.350404 [debug] [Thread-1 (]: SQL status: SELECT 0 in 2.768 seconds
[0m14:21:10.364135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:10.365138 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
select * from (
        select
    
      
    cast(null as decimal(20, 2))
 as revenue_rub, 
      
    cast(null as date)
 as date, 
      
    cast(null as timestamptz)
 as updated_at
    ) as __dbt_sbq
    where false
    limit 0

[0m14:21:10.747367 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.382 seconds
[0m14:21:10.754511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:10.755508 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp142107560086"
  
  
    
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_3lcu"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m14:21:11.862194 [debug] [Thread-2 (]: SQL status: BEGIN in 3.080 seconds
[0m14:21:11.863214 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:21:11.863214 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count(*) as trips,
    count(distinct user_id) as users,
    avg(duration_s) / 60 as avg_duration_min,
    sum(distance_m) / 1000 as sum_distance_km,
    sum(price_rub) as revenue_rub,
    count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from
    "dev_3lcu"."dbt"."trips_prep"
  );
  
[0m14:21:15.548492 [debug] [Thread-1 (]: SQL status: SELECT 3 in 4.792 seconds
[0m14:21:15.552076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:15.553081 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m14:21:15.953105 [debug] [Thread-1 (]: SQL status: BEGIN in 0.399 seconds
[0m14:21:15.953105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:15.954105 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp142107560086'
        
      order by ordinal_position

  
[0m14:21:16.849437 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.895 seconds
[0m14:21:16.851976 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:16.853531 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m14:21:17.380488 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.526 seconds
[0m14:21:17.383459 [debug] [Thread-1 (]: 
    In "dev_3lcu"."finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:21:17.384468 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m14:21:17.385468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:17.386468 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        
            delete from "dev_3lcu"."finance"."revenue_daily"
            using "revenue_daily__dbt_tmp142107560086"
            where (
                
                    "revenue_daily__dbt_tmp142107560086".date = "dev_3lcu"."finance"."revenue_daily".date
                    
                
                
            );
        
    

    insert into "dev_3lcu"."finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp142107560086"
    )
  
[0m14:21:17.752111 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.365 seconds
[0m14:21:17.756161 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:17.757153 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_3lcu".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'finance'
        and table_name = 'revenue_daily'
  
[0m14:21:18.347089 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.590 seconds
[0m14:21:18.349082 [debug] [Thread-1 (]: On "dev_3lcu"."finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m14:21:18.350082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:18.351044 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  comment on table "dev_3lcu"."finance"."revenue_daily" is $dbt_comment_literal_block$Summary daily revenue$dbt_comment_literal_block$;

  
[0m14:21:18.747435 [debug] [Thread-1 (]: SQL status: COMMENT in 0.396 seconds
[0m14:21:18.750393 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:18.751393 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m14:21:19.348563 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.597 seconds
[0m14:21:19.351112 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:19.351112 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  
    
    
    comment on column "dev_3lcu"."finance"."revenue_daily".revenue_rub is $dbt_comment_literal_block$Daily revenue in rubles$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."finance"."revenue_daily".date is $dbt_comment_literal_block$Unique day$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."finance"."revenue_daily".updated_at is $dbt_comment_literal_block$When row was updated last time$dbt_comment_literal_block$;
  

  
[0m14:21:19.745461 [debug] [Thread-1 (]: SQL status: COMMENT in 0.394 seconds
[0m14:21:19.748466 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m14:21:19.748466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:19.749461 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m14:21:19.850441 [debug] [Thread-2 (]: SQL status: SELECT 1 in 7.986 seconds
[0m14:21:19.854471 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:21:19.854471 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m14:21:20.151874 [debug] [Thread-1 (]: SQL status: COMMIT in 0.401 seconds
[0m14:21:20.153383 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m14:21:20.154394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679C9FE600>]}
[0m14:21:20.155394 [info ] [Thread-1 (]: 39 of 51 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 3[0m in 12.60s]
[0m14:21:20.156399 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m14:21:20.157397 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m14:21:20.158395 [info ] [Thread-1 (]: 41 of 51 START sql table model dbt.trips_stat_daily ............................ [RUN]
[0m14:21:20.159396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_stat_daily)
[0m14:21:20.159396 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m14:21:20.161903 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m14:21:20.163414 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m14:21:20.167422 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m14:21:20.168424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:20.169425 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m14:21:20.169425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:20.248362 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.393 seconds
[0m14:21:20.251879 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:21:20.253388 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m14:21:20.651755 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.398 seconds
[0m14:21:20.655309 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:21:20.655309 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat" is $dbt_comment_literal_block$Overall trips statistics$dbt_comment_literal_block$;

  
[0m14:21:21.001706 [debug] [Thread-2 (]: SQL status: COMMENT in 0.345 seconds
[0m14:21:21.003213 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m14:21:21.004222 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:21:21.004222 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m14:21:21.357582 [debug] [Thread-2 (]: SQL status: COMMIT in 0.353 seconds
[0m14:21:21.361039 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat__dbt_backup"
[0m14:21:21.362047 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:21:21.362047 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat__dbt_backup" cascade
[0m14:21:21.755496 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.392 seconds
[0m14:21:21.757531 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: Close
[0m14:21:21.757531 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679C943E90>]}
[0m14:21:21.758494 [info ] [Thread-2 (]: 40 of 51 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 12.99s]
[0m14:21:21.759499 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat
[0m14:21:21.761031 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_users
[0m14:21:21.762040 [info ] [Thread-2 (]: 42 of 51 START sql incremental model dbt.trips_users ........................... [RUN]
[0m14:21:21.763041 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_users)
[0m14:21:21.763041 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_users
[0m14:21:21.767069 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m14:21:21.768071 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_users
[0m14:21:21.773255 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:21.773255 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp142121771069"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep" as t
left join
    "dev_3lcu"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_3lcu"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m14:21:21.774246 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:23.351803 [debug] [Thread-1 (]: SQL status: BEGIN in 3.183 seconds
[0m14:21:23.353308 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:23.353308 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    count(*) as trips,
    max(price_rub) as max_price_rub,
    avg(distance_m) / 1000 as avg_distance_km,
    avg(price_rub)/avg(duration_s) * 60 as avg_price_rub_per_min
from
    "dev_3lcu"."dbt"."trips_prep"
group by
    1
order by
    1
  );
  
[0m14:21:27.853404 [debug] [Thread-2 (]: SQL status: SELECT 0 in 6.079 seconds
[0m14:21:27.858406 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:27.859402 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: BEGIN
[0m14:21:28.248168 [debug] [Thread-2 (]: SQL status: BEGIN in 0.389 seconds
[0m14:21:28.249163 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:28.249163 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp142121771069'
        
      order by ordinal_position

  
[0m14:21:29.156265 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.906 seconds
[0m14:21:29.160264 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:29.161263 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:21:29.654119 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.492 seconds
[0m14:21:29.659122 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:29.660118 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp142121771069'
        
      order by ordinal_position

  
[0m14:21:30.369210 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.709 seconds
[0m14:21:30.373222 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:30.374233 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:21:30.851802 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.477 seconds
[0m14:21:30.855322 [debug] [Thread-2 (]: 
    In "dev_3lcu"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:21:30.857320 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m14:21:30.858321 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:30.859320 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_3lcu"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp142121771069"
    )


  
[0m14:21:31.349430 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.490 seconds
[0m14:21:31.351941 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:31.351941 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_users" is $dbt_comment_literal_block$Prepared trips enriched with users data$dbt_comment_literal_block$;

  
[0m14:21:31.749400 [debug] [Thread-2 (]: SQL status: COMMENT in 0.396 seconds
[0m14:21:31.751912 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:31.751912 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m14:21:39.249168 [debug] [Thread-1 (]: SQL status: SELECT 91 in 15.895 seconds
[0m14:21:39.254189 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:39.255191 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m14:21:39.648467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.393 seconds
[0m14:21:39.652029 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:39.652029 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m14:21:40.048260 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.395 seconds
[0m14:21:40.059234 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:40.060233 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    create  index if not exists
  "c19794f7bf39390222e5029f780d234b"
  on "dev_3lcu"."dbt"."trips_stat_daily" 
  (date)
  
[0m14:21:40.648294 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.588 seconds
[0m14:21:40.650240 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:40.651240 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat_daily" is $dbt_comment_literal_block$Overall trips statistics per day$dbt_comment_literal_block$;

  
[0m14:21:41.048425 [debug] [Thread-1 (]: SQL status: COMMENT in 0.397 seconds
[0m14:21:41.052020 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:41.053014 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_stat_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:21:41.979379 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.926 seconds
[0m14:21:41.981975 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:41.981975 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."trips_stat_daily".date is $dbt_comment_literal_block$Trips date$dbt_comment_literal_block$;
  

  
[0m14:21:42.368309 [debug] [Thread-1 (]: SQL status: COMMENT in 0.386 seconds
[0m14:21:42.371304 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m14:21:42.371304 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:42.372755 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m14:21:42.758179 [debug] [Thread-1 (]: SQL status: COMMIT in 0.385 seconds
[0m14:21:42.761723 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup"
[0m14:21:42.761723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:42.761723 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m14:21:43.151598 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.389 seconds
[0m14:21:43.154110 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m14:21:43.155110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CE1C860>]}
[0m14:21:43.156111 [info ] [Thread-1 (]: 41 of 51 OK created sql table model dbt.trips_stat_daily ....................... [[32mSELECT 91[0m in 23.00s]
[0m14:21:43.157112 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m14:21:43.158116 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies_trips
[0m14:21:43.159111 [info ] [Thread-1 (]: 43 of 51 START sql table model dbt.companies_trips ............................. [RUN]
[0m14:21:43.160118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.companies_trips)
[0m14:21:43.161124 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies_trips
[0m14:21:43.164398 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m14:21:43.165396 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies_trips
[0m14:21:43.168398 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m14:21:43.169396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:43.170903 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m14:21:43.170903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:43.253036 [debug] [Thread-2 (]: SQL status: ANALYZE in 11.500 seconds
[0m14:21:43.254046 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m14:21:43.255085 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:43.256045 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m14:21:43.648018 [debug] [Thread-2 (]: SQL status: COMMIT in 0.392 seconds
[0m14:21:43.648971 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:43.649970 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m14:21:44.050182 [debug] [Thread-2 (]: SQL status: COMMIT in 0.400 seconds
[0m14:21:44.051640 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:44.053146 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m14:21:44.449514 [debug] [Thread-2 (]: SQL status: VACUUM in 0.396 seconds
[0m14:21:44.452029 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: Close
[0m14:21:44.453030 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CEB6090>]}
[0m14:21:44.453030 [info ] [Thread-2 (]: 42 of 51 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 22.69s]
[0m14:21:44.455039 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_users
[0m14:21:44.456039 [debug] [Thread-2 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m14:21:44.457038 [info ] [Thread-2 (]: 44 of 51 START test events_full_is_complete .................................... [RUN]
[0m14:21:44.458039 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now test.dbt_scooters.events_full_is_complete)
[0m14:21:44.458039 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m14:21:44.461636 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m14:21:44.463187 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m14:21:44.465242 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.events_full_is_complete"
[0m14:21:44.467199 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m14:21:44.467199 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: BEGIN
[0m14:21:44.468196 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:46.213343 [debug] [Thread-3 (]: SQL status: SELECT 464 in 36.695 seconds
[0m14:21:46.217861 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:21:46.217861 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m14:21:46.248512 [debug] [Thread-1 (]: SQL status: BEGIN in 3.078 seconds
[0m14:21:46.249504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:46.249504 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_3lcu"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_3lcu"."dbt"."trips_prep" as t
        join "dev_3lcu"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_3lcu"."dbt"."companies" as c
        using (company)
  );
  
[0m14:21:46.569125 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.350 seconds
[0m14:21:46.573100 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:21:46.573100 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m14:21:46.951669 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.378 seconds
[0m14:21:46.954266 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:21:46.954266 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_finish_stat" is $dbt_comment_literal_block$Trip finish parking statistics by 10 m hexagons$dbt_comment_literal_block$;

  
[0m14:21:47.349647 [debug] [Thread-3 (]: SQL status: COMMENT in 0.394 seconds
[0m14:21:47.351154 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m14:21:47.351154 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:21:47.352161 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m14:21:47.452113 [debug] [Thread-2 (]: SQL status: BEGIN in 2.984 seconds
[0m14:21:47.453110 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m14:21:47.453110 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.events_full_is_complete"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with source_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_clean"
),
target_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_full"
)
select
    'Row count mismatch' as error_message,
    source_cte.row_count as source_count,
    target_cte.row_count as target_count
from
    source_cte,
    target_cte
where
    source_cte.row_count != target_cte.row_count
      
    ) dbt_internal_test
[0m14:21:47.761877 [debug] [Thread-3 (]: SQL status: COMMIT in 0.409 seconds
[0m14:21:47.766393 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup"
[0m14:21:47.767394 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:21:47.767394 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m14:21:48.049409 [debug] [Thread-1 (]: SQL status: SELECT 6 in 1.800 seconds
[0m14:21:48.054441 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:48.055440 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m14:21:48.149137 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.381 seconds
[0m14:21:48.151691 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m14:21:48.153197 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CF596A0>]}
[0m14:21:48.154205 [info ] [Thread-3 (]: 37 of 51 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 41.56s]
[0m14:21:48.155207 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m14:21:48.155207 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m14:21:48.156205 [info ] [Thread-3 (]: 45 of 51 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m14:21:48.157207 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_finish_stat, now model.dbt_scooters.trips_age_daily)
[0m14:21:48.158206 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m14:21:48.161726 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m14:21:48.163240 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m14:21:48.167253 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m14:21:48.168254 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:21:48.169254 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m14:21:48.169254 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:21:48.394488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.339 seconds
[0m14:21:48.398478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:48.399442 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m14:21:48.747960 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.348 seconds
[0m14:21:48.750002 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:48.750955 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies_trips" is $dbt_comment_literal_block$Trip statistics by company$dbt_comment_literal_block$;

  
[0m14:21:49.146168 [debug] [Thread-1 (]: SQL status: COMMENT in 0.395 seconds
[0m14:21:49.150169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:49.151169 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'companies_trips'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:21:50.051075 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.900 seconds
[0m14:21:50.053183 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:50.054189 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."companies_trips".company is $dbt_comment_literal_block$Scooters manufacturing company$dbt_comment_literal_block$;
  

  
[0m14:21:50.446058 [debug] [Thread-1 (]: SQL status: COMMENT in 0.392 seconds
[0m14:21:50.448057 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m14:21:50.448057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:50.449059 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m14:21:50.848017 [debug] [Thread-1 (]: SQL status: COMMIT in 0.399 seconds
[0m14:21:50.851562 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."companies_trips__dbt_backup"
[0m14:21:50.851562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:50.851562 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_3lcu"."dbt"."companies_trips__dbt_backup" cascade
[0m14:21:50.946457 [debug] [Thread-2 (]: SQL status: SELECT 1 in 3.493 seconds
[0m14:21:50.948456 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: ROLLBACK
[0m14:21:51.246450 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.394 seconds
[0m14:21:51.248446 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: Close
[0m14:21:51.249444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CF392E0>]}
[0m14:21:51.249444 [info ] [Thread-1 (]: 43 of 51 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 8.09s]
[0m14:21:51.252000 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies_trips
[0m14:21:51.252998 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_group
[0m14:21:51.252998 [info ] [Thread-1 (]: 46 of 51 START sql table model dbt.trips_age_group ............................. [RUN]
[0m14:21:51.254032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_age_group)
[0m14:21:51.255035 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m14:21:51.258031 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m14:21:51.258997 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_group
[0m14:21:51.263125 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m14:21:51.264136 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:21:51.265138 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m14:21:51.265138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:51.346155 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: Close
[0m14:21:51.346155 [debug] [Thread-3 (]: SQL status: BEGIN in 3.177 seconds
[0m14:21:51.347149 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:21:51.349150 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    Select "date",
       age,
       count(*) as trips,
       sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m14:21:51.348150 [info ] [Thread-2 (]: 44 of 51 PASS events_full_is_complete .......................................... [[32mPASS[0m in 6.89s]
[0m14:21:51.350153 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m14:21:51.351151 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m14:21:51.351151 [info ] [Thread-2 (]: 47 of 51 START test unique_companies_trips_company ............................. [RUN]
[0m14:21:51.352639 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.events_full_is_complete, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m14:21:51.353609 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m14:21:51.359649 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m14:21:51.361158 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m14:21:51.363208 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m14:21:51.365167 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m14:21:51.365167 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m14:21:51.366207 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:53.528397 [debug] [Thread-3 (]: SQL status: SELECT 7049 in 2.179 seconds
[0m14:21:53.532914 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:21:53.533923 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m14:21:53.989396 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.454 seconds
[0m14:21:53.995917 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:21:53.996916 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m14:21:54.346034 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.349 seconds
[0m14:21:54.349034 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:21:54.349034 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily" is $dbt_comment_literal_block$Daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m14:21:54.753387 [debug] [Thread-4 (]: SQL status: SELECT 142 in 45.126 seconds
[0m14:21:54.757381 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:21:54.757381 [debug] [Thread-3 (]: SQL status: COMMENT in 0.408 seconds
[0m14:21:54.758350 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m14:21:54.759352 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m14:21:54.760861 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:21:54.761871 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m14:21:54.793330 [debug] [Thread-2 (]: SQL status: BEGIN in 3.427 seconds
[0m14:21:54.793330 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m14:21:54.794374 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



      
    ) dbt_internal_test
[0m14:21:55.097186 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.336 seconds
[0m14:21:55.101184 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:21:55.102645 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m14:21:55.160943 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.365 seconds
[0m14:21:55.163085 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m14:21:55.165088 [debug] [Thread-3 (]: SQL status: COMMIT in 0.402 seconds
[0m14:21:55.168086 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily__dbt_backup"
[0m14:21:55.169089 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:21:55.170086 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily__dbt_backup" cascade
[0m14:21:55.439338 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m14:21:55.442926 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:21:55.443890 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_start_stat" is $dbt_comment_literal_block$Trip start parking statistics by 500 m hexagons$dbt_comment_literal_block$;

  
[0m14:21:55.501766 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m14:21:55.503310 [info ] [Thread-2 (]: 47 of 51 PASS unique_companies_trips_company ................................... [[32mPASS[0m in 4.15s]
[0m14:21:55.504318 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m14:21:55.505321 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_stat
[0m14:21:55.506318 [info ] [Thread-2 (]: 48 of 51 START sql table model dbt.events_stat ................................. [RUN]
[0m14:21:55.507320 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0, now model.dbt_scooters.events_stat)
[0m14:21:55.508321 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_stat
[0m14:21:55.511889 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m14:21:55.513429 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_stat
[0m14:21:55.517437 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m14:21:55.519469 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:21:55.520981 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: BEGIN
[0m14:21:55.520981 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:55.523021 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.352 seconds
[0m14:21:55.526990 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m14:21:55.529513 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CF9A720>]}
[0m14:21:55.532035 [info ] [Thread-3 (]: 45 of 51 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 7.37s]
[0m14:21:55.546080 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m14:21:55.547080 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m14:21:55.548070 [info ] [Thread-3 (]: 49 of 51 START test unique_key_trips_age_daily_date__age ....................... [RUN]
[0m14:21:55.549073 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be)
[0m14:21:55.550075 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m14:21:55.556100 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m14:21:55.558102 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m14:21:55.560102 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m14:21:55.561617 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m14:21:55.563130 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: BEGIN
[0m14:21:55.564142 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:21:55.780195 [debug] [Thread-4 (]: SQL status: COMMENT in 0.336 seconds
[0m14:21:55.781707 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m14:21:55.783218 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:21:55.783218 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m14:21:56.071881 [debug] [Thread-1 (]: SQL status: BEGIN in 4.806 seconds
[0m14:21:56.072886 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:21:56.073883 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users" as tu
    cross join "dev_3lcu"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m14:21:56.132104 [debug] [Thread-4 (]: SQL status: COMMIT in 0.348 seconds
[0m14:21:56.137150 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_start_stat__dbt_backup"
[0m14:21:56.138145 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:21:56.139145 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_start_stat__dbt_backup" cascade
[0m14:21:56.481302 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.341 seconds
[0m14:21:56.483318 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: Close
[0m14:21:56.484327 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CEC7FB0>]}
[0m14:21:56.485327 [info ] [Thread-4 (]: 38 of 51 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 49.58s]
[0m14:21:56.487330 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m14:21:56.488337 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m14:21:56.489327 [info ] [Thread-4 (]: 50 of 51 START test unique_trips_age_daily_date_text_age_text .................. [RUN]
[0m14:21:56.490328 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e)
[0m14:21:56.490839 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m14:21:56.496367 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m14:21:56.498367 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m14:21:56.500875 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m14:21:56.501882 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m14:21:56.504411 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: BEGIN
[0m14:21:56.505417 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:21:58.644388 [debug] [Thread-2 (]: SQL status: BEGIN in 3.124 seconds
[0m14:21:58.645388 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:21:58.646386 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
       count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from "dev_3lcu"."dbt"."events_full"
  );
  
[0m14:21:58.648389 [debug] [Thread-3 (]: SQL status: BEGIN in 3.084 seconds
[0m14:21:58.649388 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m14:21:58.649388 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "date"::text ||
    
        "age"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m14:21:59.347331 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.697 seconds
[0m14:21:59.349333 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: ROLLBACK
[0m14:21:59.750109 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: Close
[0m14:21:59.751622 [info ] [Thread-3 (]: 49 of 51 PASS unique_key_trips_age_daily_date__age ............................. [[32mPASS[0m in 4.20s]
[0m14:21:59.753132 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m14:21:59.947311 [debug] [Thread-1 (]: SQL status: SELECT 7 in 3.873 seconds
[0m14:21:59.957341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:21:59.958340 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m14:22:00.304979 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.346 seconds
[0m14:22:00.309979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:22:00.309979 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m14:22:00.546014 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.899 seconds
[0m14:22:00.546014 [debug] [Thread-4 (]: SQL status: BEGIN in 4.041 seconds
[0m14:22:00.551015 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:22:00.551524 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m14:22:00.553032 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m14:22:00.553032 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date::text || age::text as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."trips_age_daily"
where date::text || age::text is not null
group by date::text || age::text
having count(*) > 1



      
    ) dbt_internal_test
[0m14:22:00.656452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.345 seconds
[0m14:22:00.658451 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:22:00.659451 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_group" is $dbt_comment_literal_block$Overall trips statistics by user age group$dbt_comment_literal_block$;

  
[0m14:22:00.894166 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.339 seconds
[0m14:22:00.898163 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:22:00.899114 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m14:22:00.909169 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.355 seconds
[0m14:22:00.912272 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: ROLLBACK
[0m14:22:01.004197 [debug] [Thread-1 (]: SQL status: COMMENT in 0.344 seconds
[0m14:22:01.006209 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m14:22:01.007170 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:22:01.007170 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m14:22:01.252035 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.352 seconds
[0m14:22:01.253047 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: Close
[0m14:22:01.255049 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:22:01.256046 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_stat" is $dbt_comment_literal_block$Overall user events statistics$dbt_comment_literal_block$;

  
[0m14:22:01.257007 [info ] [Thread-4 (]: 50 of 51 PASS unique_trips_age_daily_date_text_age_text ........................ [[32mPASS[0m in 4.77s]
[0m14:22:01.258011 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m14:22:01.259005 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m14:22:01.260004 [info ] [Thread-3 (]: 51 of 51 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m14:22:01.261006 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be, now model.dbt_scooters.trips_age_daily_stat)
[0m14:22:01.261515 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m14:22:01.265033 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:01.267033 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m14:22:01.271031 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:01.273047 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:01.273047 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m14:22:01.274060 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:22:01.401716 [debug] [Thread-1 (]: SQL status: COMMIT in 0.394 seconds
[0m14:22:01.405278 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_group__dbt_backup"
[0m14:22:01.406275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:22:01.406275 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_group__dbt_backup" cascade
[0m14:22:01.596346 [debug] [Thread-2 (]: SQL status: COMMENT in 0.339 seconds
[0m14:22:01.598310 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: COMMIT
[0m14:22:01.599310 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:22:01.599310 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: COMMIT
[0m14:22:01.754399 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.348 seconds
[0m14:22:01.756406 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: Close
[0m14:22:01.757406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CF49550>]}
[0m14:22:01.758364 [info ] [Thread-1 (]: 46 of 51 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 10.50s]
[0m14:22:01.759364 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_group
[0m14:22:01.939676 [debug] [Thread-2 (]: SQL status: COMMIT in 0.340 seconds
[0m14:22:01.943197 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."events_stat__dbt_backup"
[0m14:22:01.944194 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:22:01.945195 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_3lcu"."dbt"."events_stat__dbt_backup" cascade
[0m14:22:02.353312 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.408 seconds
[0m14:22:02.355322 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: Close
[0m14:22:02.356322 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CF44230>]}
[0m14:22:02.357324 [info ] [Thread-2 (]: 48 of 51 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 6.85s]
[0m14:22:02.358326 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_stat
[0m14:22:04.226916 [debug] [Thread-3 (]: SQL status: BEGIN in 2.953 seconds
[0m14:22:04.227875 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:04.227875 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m14:22:04.590186 [debug] [Thread-3 (]: SQL status: SELECT 83 in 0.361 seconds
[0m14:22:04.593198 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:04.594207 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m14:22:04.938984 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.344 seconds
[0m14:22:04.942958 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:04.942958 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m14:22:05.289303 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.346 seconds
[0m14:22:05.291757 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:05.291757 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily_stat" is $dbt_comment_literal_block$Aggregation of daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m14:22:05.637486 [debug] [Thread-3 (]: SQL status: COMMENT in 0.344 seconds
[0m14:22:05.639446 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m14:22:05.639446 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:05.639446 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m14:22:06.009015 [debug] [Thread-3 (]: SQL status: COMMIT in 0.369 seconds
[0m14:22:06.011557 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup"
[0m14:22:06.013065 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:06.013065 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m14:22:06.357401 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.343 seconds
[0m14:22:06.358401 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m14:22:06.359401 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CFDD100>]}
[0m14:22:06.360908 [info ] [Thread-3 (]: 51 of 51 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 5.10s]
[0m14:22:06.361919 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m14:22:06.363925 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:06.364961 [debug] [MainThread]: On master: BEGIN
[0m14:22:06.364961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:22:09.111574 [debug] [MainThread]: SQL status: BEGIN in 2.747 seconds
[0m14:22:09.111574 [debug] [MainThread]: On master: COMMIT
[0m14:22:09.113084 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:09.113084 [debug] [MainThread]: On master: COMMIT
[0m14:22:09.457937 [debug] [MainThread]: SQL status: COMMIT in 0.344 seconds
[0m14:22:09.458914 [info ] [MainThread]: 
[0m14:22:09.458914 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:22:09.461530 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m14:22:09.468130 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m14:22:09.470091 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:09.470091 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m14:22:09.952067 [debug] [MainThread]: SQL status: GRANT in 0.481 seconds
[0m14:22:09.953067 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mGRANT[0m in 0.48s]
[0m14:22:09.954114 [info ] [MainThread]: 
[0m14:22:09.955070 [debug] [MainThread]: On master: Close
[0m14:22:09.956111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:09.957097 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m14:22:09.957097 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m14:22:09.957097 [debug] [MainThread]: Connection 'list_dev_3lcu_finance' was properly closed.
[0m14:22:09.958070 [debug] [MainThread]: Connection 'list_dev_3lcu_dbt' was properly closed.
[0m14:22:09.958070 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m14:22:09.959115 [debug] [MainThread]: Connection 'model.dbt_scooters.events_stat' was properly closed.
[0m14:22:09.959115 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m14:22:09.959115 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e' was properly closed.
[0m14:22:09.960069 [info ] [MainThread]: 
[0m14:22:09.961067 [info ] [MainThread]: Finished running 4 seeds, 28 data tests, 12 table models, 4 incremental models, 3 view models, 1 project hook in 0 hours 1 minutes and 57.68 seconds (117.68s).
[0m14:22:09.971766 [debug] [MainThread]: Command end result
[0m14:22:10.015382 [info ] [MainThread]: 
[0m14:22:10.016348 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m14:22:10.017344 [info ] [MainThread]: 
[0m14:22:10.017344 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models\properties.yml)[0m
[0m14:22:10.018349 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m14:22:10.019344 [info ] [MainThread]: 
[0m14:22:10.020853 [info ] [MainThread]:   compiled code at target\compiled\dbt_scooters\models\properties.yml\source_not_null_scooters_raw_users_sex.sql
[0m14:22:10.020853 [info ] [MainThread]: 
[0m14:22:10.021863 [info ] [MainThread]: Done. PASS=50 WARN=1 ERROR=0 SKIP=0 TOTAL=51
[0m14:22:10.023889 [debug] [MainThread]: Command `dbt build` succeeded at 14:22:10.022882 after 120.00 seconds
[0m14:22:10.023889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679A6294C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679A62B200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679A733AA0>]}
[0m14:22:10.923011 [debug] [MainThread]: Flushing usage events
[0m14:22:40.266094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016994DDF740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016995009B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016995009A90>]}


============================== 14:22:40.272138 | 3b27ff04-9be1-45f6-aa34-a47dd2e7cd6a ==============================
[0m14:22:40.272138 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:22:40.273150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:22:40.581386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b27ff04-9be1-45f6-aa34-a47dd2e7cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016994439910>]}
[0m14:22:40.669353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b27ff04-9be1-45f6-aa34-a47dd2e7cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001699412F9B0>]}
[0m14:22:40.671870 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:22:41.004801 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:22:41.336992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:22:41.337993 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:22:41.447799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b27ff04-9be1-45f6-aa34-a47dd2e7cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001699673F8F0>]}
[0m14:22:41.490789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b27ff04-9be1-45f6-aa34-a47dd2e7cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016996775910>]}
[0m14:22:41.491341 [info ] [MainThread]: Found 19 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 437 macros
[0m14:22:41.492893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b27ff04-9be1-45f6-aa34-a47dd2e7cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016996746B10>]}
[0m14:22:41.500941 [info ] [MainThread]: 
[0m14:22:41.501493 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:22:41.510082 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_dbt'
[0m14:22:41.519221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_finance'
[0m14:22:41.661645 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m14:22:41.661645 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m14:22:41.663190 [debug] [ThreadPool]: On list_dev_3lcu_dbt: BEGIN
[0m14:22:41.663190 [debug] [ThreadPool]: On list_dev_3lcu_finance: BEGIN
[0m14:22:41.664203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:41.665234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:44.590892 [debug] [ThreadPool]: SQL status: BEGIN in 2.927 seconds
[0m14:22:44.591907 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m14:22:44.592902 [debug] [ThreadPool]: On list_dev_3lcu_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_dbt"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m14:22:44.608061 [debug] [ThreadPool]: SQL status: BEGIN in 2.943 seconds
[0m14:22:44.608061 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m14:22:44.609061 [debug] [ThreadPool]: On list_dev_3lcu_finance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_finance"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m14:22:44.941025 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.348 seconds
[0m14:22:44.943123 [debug] [ThreadPool]: On list_dev_3lcu_dbt: ROLLBACK
[0m14:22:44.955335 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.346 seconds
[0m14:22:44.957328 [debug] [ThreadPool]: On list_dev_3lcu_finance: ROLLBACK
[0m14:22:45.287764 [debug] [ThreadPool]: On list_dev_3lcu_dbt: Close
[0m14:22:45.301514 [debug] [ThreadPool]: On list_dev_3lcu_finance: Close
[0m14:22:45.308027 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:45.309027 [debug] [MainThread]: On master: BEGIN
[0m14:22:45.309027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:48.022893 [debug] [MainThread]: SQL status: BEGIN in 2.714 seconds
[0m14:22:48.023887 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:48.024848 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:22:48.555233 [debug] [MainThread]: SQL status: SELECT 4 in 0.530 seconds
[0m14:22:48.557236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b27ff04-9be1-45f6-aa34-a47dd2e7cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016995217440>]}
[0m14:22:48.558235 [debug] [MainThread]: On master: ROLLBACK
[0m14:22:48.893941 [debug] [MainThread]: On master: Close
[0m14:22:48.894942 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:22:48.895943 [info ] [MainThread]: 
[0m14:22:48.901453 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m14:22:48.902964 [debug] [Thread-2 (]: Began running node model.dbt_scooters.first_name_sex
[0m14:22:48.902964 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m14:22:48.903973 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_geom
[0m14:22:48.904972 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_scooters.events_clean'
[0m14:22:48.904972 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.first_name_sex'
[0m14:22:48.905973 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m14:22:48.906976 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m14:22:48.907977 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m14:22:48.907977 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.first_name_sex
[0m14:22:48.908976 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m14:22:48.909974 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_geom
[0m14:22:48.926189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m14:22:48.929192 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.first_name_sex"
[0m14:22:48.934216 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m14:22:48.937217 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m14:22:48.939218 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m14:22:48.940726 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m14:22:48.940726 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m14:22:48.941738 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m14:22:48.941738 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.first_name_sex
[0m14:22:48.943250 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m14:22:48.944261 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_geom
[0m14:22:48.944261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.trips_prep)
[0m14:22:48.945258 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.first_name_sex
[0m14:22:48.946258 [debug] [Thread-3 (]: Began running node operation.dbt_scooters.dbt_scooters-on-run-end-0
[0m14:22:48.947272 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_geom
[0m14:22:48.948259 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m14:22:48.948259 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.add_first_name_sex
[0m14:22:48.949259 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now operation.dbt_scooters.dbt_scooters-on-run-end-0)
[0m14:22:48.949259 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.age_groups
[0m14:22:48.953774 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m14:22:48.954774 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.first_name_sex, now seed.dbt_scooters.add_first_name_sex)
[0m14:22:48.955775 [debug] [Thread-3 (]: Began compiling node operation.dbt_scooters.dbt_scooters-on-run-end-0
[0m14:22:48.955775 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now seed.dbt_scooters.age_groups)
[0m14:22:48.956775 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.add_first_name_sex
[0m14:22:48.958776 [debug] [Thread-3 (]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m14:22:48.959776 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m14:22:48.959776 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.age_groups
[0m14:22:48.962796 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.add_first_name_sex
[0m14:22:48.963807 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m14:22:48.965806 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.age_groups
[0m14:22:48.966808 [debug] [Thread-3 (]: Began executing node operation.dbt_scooters.dbt_scooters-on-run-end-0
[0m14:22:48.967807 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.add_first_name_sex
[0m14:22:48.968805 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.event_types
[0m14:22:48.969808 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.age_groups
[0m14:22:48.970806 [debug] [Thread-3 (]: Finished running node operation.dbt_scooters.dbt_scooters-on-run-end-0
[0m14:22:48.971315 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.scooters
[0m14:22:48.971315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now seed.dbt_scooters.event_types)
[0m14:22:48.972897 [debug] [Thread-4 (]: Began running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m14:22:48.973906 [debug] [Thread-3 (]: Began running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m14:22:48.974906 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.add_first_name_sex, now seed.dbt_scooters.scooters)
[0m14:22:48.974906 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.event_types
[0m14:22:48.975906 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now test.dbt_scooters.every_event_has_user.7eea25f36c)
[0m14:22:48.976907 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly operation.dbt_scooters.dbt_scooters-on-run-end-0, now test.dbt_scooters.every_trip_has_user.6bc71135e2)
[0m14:22:48.976907 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.scooters
[0m14:22:48.978908 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.event_types
[0m14:22:48.979907 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m14:22:48.980907 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m14:22:48.982927 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.scooters
[0m14:22:48.983936 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.event_types
[0m14:22:48.996964 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m14:22:49.003995 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m14:22:49.004996 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.scooters
[0m14:22:49.005996 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m14:22:49.006999 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m14:22:49.007998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m14:22:49.008996 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m14:22:49.009998 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7)
[0m14:22:49.009998 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m14:22:49.010997 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m14:22:49.011508 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m14:22:49.013018 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m14:22:49.014028 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m14:22:49.024056 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m14:22:49.024056 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m14:22:49.034084 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m14:22:49.035086 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m14:22:49.036087 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_user.7eea25f36c, now test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b)
[0m14:22:49.037090 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m14:22:49.038085 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_user.6bc71135e2, now test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d)
[0m14:22:49.039090 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m14:22:49.039090 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m14:22:49.040088 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m14:22:49.041087 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m14:22:49.045118 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m14:22:49.047120 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m14:22:49.047120 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m14:22:49.051629 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m14:22:49.053140 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m14:22:49.054151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f)
[0m14:22:49.055148 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m14:22:49.055148 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7, now test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62)
[0m14:22:49.056153 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m14:22:49.057150 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m14:22:49.058150 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m14:22:49.058150 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m14:22:49.063168 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m14:22:49.064180 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m14:22:49.065178 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m14:22:49.069178 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m14:22:49.070177 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b, now test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d)
[0m14:22:49.071693 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m14:22:49.071693 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m14:22:49.073204 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m14:22:49.073204 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m14:22:49.074215 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m14:22:49.075216 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m14:22:49.079214 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m14:22:49.080726 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m14:22:49.081737 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m14:22:49.081737 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m14:22:49.088258 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m14:22:49.089261 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m14:22:49.089261 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m14:22:49.090772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f, now test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4)
[0m14:22:49.091784 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62, now test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf)
[0m14:22:49.092786 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m14:22:49.092786 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m14:22:49.093781 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m14:22:49.094784 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m14:22:49.094784 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m14:22:49.095783 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m14:22:49.104009 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m14:22:49.108009 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m14:22:49.109009 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d, now model.dbt_scooters.parking_finish_stat)
[0m14:22:49.109009 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_start_stat
[0m14:22:49.111012 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m14:22:49.111525 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now model.dbt_scooters.parking_start_stat)
[0m14:22:49.111525 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m14:22:49.119047 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m14:22:49.119047 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m14:22:49.120047 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m14:22:49.121046 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m14:22:49.121557 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m14:22:49.126150 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m14:22:49.127116 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m14:22:49.128118 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m14:22:49.129120 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat
[0m14:22:49.130116 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m14:22:49.131119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4, now model.dbt_scooters.revenue_daily)
[0m14:22:49.131635 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m14:22:49.131635 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf, now model.dbt_scooters.trips_stat)
[0m14:22:49.133141 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m14:22:49.134181 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m14:22:49.135181 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m14:22:49.135181 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat
[0m14:22:49.136148 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_finish_stat, now model.dbt_scooters.trips_stat_daily)
[0m14:22:49.140185 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m14:22:49.141657 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_users
[0m14:22:49.144246 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m14:22:49.145244 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m14:22:49.146212 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now model.dbt_scooters.trips_users)
[0m14:22:49.147214 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m14:22:49.150790 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m14:22:49.151804 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat
[0m14:22:49.151804 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_users
[0m14:22:49.152814 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m14:22:49.154799 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat
[0m14:22:49.158837 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m14:22:49.159834 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m14:22:49.160842 [debug] [Thread-1 (]: Began running node model.dbt_scooters.users_full
[0m14:22:49.161358 [debug] [Thread-2 (]: Began running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m14:22:49.162864 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m14:22:49.163872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.users_full)
[0m14:22:49.163872 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_users
[0m14:22:49.164915 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199)
[0m14:22:49.165872 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m14:22:49.166908 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.users_full
[0m14:22:49.167907 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_users
[0m14:22:49.167907 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m14:22:49.168875 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f)
[0m14:22:49.173058 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.users_full"
[0m14:22:49.174068 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m14:22:49.178066 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m14:22:49.179066 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m14:22:49.180070 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac)
[0m14:22:49.181116 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.users_full
[0m14:22:49.187322 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m14:22:49.188326 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m14:22:49.188326 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m14:22:49.189323 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.users_full
[0m14:22:49.190830 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m14:22:49.194876 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m14:22:49.195878 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m14:22:49.196840 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m14:22:49.197842 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m14:22:49.198838 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m14:22:49.199882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.users_full, now test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b)
[0m14:22:49.200846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199, now test.dbt_scooters.unique_not_null_age_groups_group.39342291f1)
[0m14:22:49.200846 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m14:22:49.201947 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_full
[0m14:22:49.202986 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m14:22:49.203951 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m14:22:49.204986 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m14:22:49.205973 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f, now model.dbt_scooters.events_full)
[0m14:22:49.210987 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m14:22:49.215103 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m14:22:49.216065 [debug] [Thread-3 (]: Began running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m14:22:49.217068 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_full
[0m14:22:49.218073 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac, now test.dbt_scooters.every_event_has_type.1e5fc977eb)
[0m14:22:49.224088 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m14:22:49.224088 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m14:22:49.225096 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m14:22:49.226088 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m14:22:49.227089 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m14:22:49.234262 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m14:22:49.235231 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_full
[0m14:22:49.236266 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m14:22:49.236266 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m14:22:49.238230 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_full
[0m14:22:49.239231 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m14:22:49.239231 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m14:22:49.240746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b, now test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1)
[0m14:22:49.240746 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies
[0m14:22:49.241792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_group.39342291f1, now test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85)
[0m14:22:49.242794 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m14:22:49.243755 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m14:22:49.244754 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.companies)
[0m14:22:49.244754 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m14:22:49.245797 [debug] [Thread-3 (]: Began running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m14:22:49.250795 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m14:22:49.251342 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies
[0m14:22:49.255895 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m14:22:49.256899 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_type.1e5fc977eb, now test.dbt_scooters.every_trip_has_scooter_id.e0b845a190)
[0m14:22:49.259895 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m14:22:49.260898 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m14:22:49.261978 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m14:22:49.262979 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m14:22:49.264017 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m14:22:49.271018 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m14:22:49.271531 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies
[0m14:22:49.271531 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m14:22:49.273106 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m14:22:49.274112 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies
[0m14:22:49.275114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1, now test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e)
[0m14:22:49.276118 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m14:22:49.277116 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m14:22:49.277116 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m14:22:49.278156 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m14:22:49.279115 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85, now test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d)
[0m14:22:49.280114 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m14:22:49.281113 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc)
[0m14:22:49.288223 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m14:22:49.289226 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m14:22:49.289226 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m14:22:49.290733 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m14:22:49.295780 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m14:22:49.296786 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_scooter_id.e0b845a190, now model.dbt_scooters.trips_age_daily)
[0m14:22:49.301326 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m14:22:49.301326 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m14:22:49.303846 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m14:22:49.304844 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m14:22:49.305880 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m14:22:49.308879 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m14:22:49.309848 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m14:22:49.309848 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_group
[0m14:22:49.311358 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m14:22:49.313914 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m14:22:49.314913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e, now model.dbt_scooters.trips_age_group)
[0m14:22:49.314913 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m14:22:49.315962 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_stat
[0m14:22:49.316916 [debug] [Thread-4 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m14:22:49.317913 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m14:22:49.318952 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m14:22:49.318952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d, now model.dbt_scooters.events_stat)
[0m14:22:49.319947 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc, now test.dbt_scooters.events_full_is_complete)
[0m14:22:49.324037 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m14:22:49.324996 [debug] [Thread-3 (]: Began running node model.dbt_scooters.companies_trips
[0m14:22:49.325995 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_stat
[0m14:22:49.325995 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m14:22:49.327035 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now model.dbt_scooters.companies_trips)
[0m14:22:49.331038 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m14:22:49.331584 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_group
[0m14:22:49.338177 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m14:22:49.338177 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.companies_trips
[0m14:22:49.340149 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_group
[0m14:22:49.344289 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m14:22:49.345291 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_stat
[0m14:22:49.346296 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m14:22:49.347252 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m14:22:49.348257 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_stat
[0m14:22:49.349258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_group, now model.dbt_scooters.trips_age_daily_stat)
[0m14:22:49.349258 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.companies_trips
[0m14:22:49.350803 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m14:22:49.351812 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m14:22:49.352818 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m14:22:49.353815 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.companies_trips
[0m14:22:49.354811 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m14:22:49.355814 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be)
[0m14:22:49.358818 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:49.359818 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m14:22:49.360812 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.events_full_is_complete, now test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e)
[0m14:22:49.361359 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m14:22:49.362874 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m14:22:49.362874 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m14:22:49.363920 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m14:22:49.370919 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m14:22:49.371463 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m14:22:49.378139 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m14:22:49.379108 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m14:22:49.384246 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m14:22:49.386210 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m14:22:49.387211 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m14:22:49.388209 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m14:22:49.389209 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m14:22:49.389209 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m14:22:49.391774 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m14:22:49.393734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:49.394733 [debug] [MainThread]: Connection 'list_dev_3lcu_dbt' was properly closed.
[0m14:22:49.394733 [debug] [MainThread]: Connection 'list_dev_3lcu_finance' was properly closed.
[0m14:22:49.395773 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m14:22:49.396738 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be' was properly closed.
[0m14:22:49.396738 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0' was properly closed.
[0m14:22:49.397772 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e' was properly closed.
[0m14:22:49.413008 [debug] [MainThread]: Command end result
[0m14:22:49.611710 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:22:49.612712 [info ] [MainThread]: Building catalog
[0m14:22:49.631743 [debug] [ThreadPool]: Acquiring new postgres connection 'dev_3lcu.information_schema'
[0m14:22:49.643850 [debug] [ThreadPool]: Using postgres connection "dev_3lcu.information_schema"
[0m14:22:49.644885 [debug] [ThreadPool]: On dev_3lcu.information_schema: BEGIN
[0m14:22:49.644885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:52.437777 [debug] [ThreadPool]: SQL status: BEGIN in 2.793 seconds
[0m14:22:52.438774 [debug] [ThreadPool]: Using postgres connection "dev_3lcu.information_schema"
[0m14:22:52.439733 [debug] [ThreadPool]: On dev_3lcu.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "dev_3lcu.information_schema"} */

    
    

    select
        'dev_3lcu' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('scooters_raw') and
           upper(tbl.relname) = upper('users')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('users_full')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_geom')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('age_groups')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_stat_daily')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_age_daily_stat')) or (upper(sch.nspname) = upper('scooters_raw') and
           upper(tbl.relname) = upper('trips')) or (upper(sch.nspname) = upper('finance') and
           upper(tbl.relname) = upper('revenue_daily')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_prep')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_stat')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_users')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('scooters')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('events_full')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('events_clean')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('parking_start_stat')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_age_daily')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('companies_trips')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_concurrency')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_age_group')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('first_name_sex')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('events_stat')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('parking_finish_stat')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('companies')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('event_types')) or (upper(sch.nspname) = upper('scooters_raw') and
           upper(tbl.relname) = upper('events')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('add_first_name_sex')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:22:53.063141 [debug] [ThreadPool]: SQL status: SELECT 121 in 0.622 seconds
[0m14:22:53.070652 [debug] [ThreadPool]: On dev_3lcu.information_schema: ROLLBACK
[0m14:22:53.418769 [debug] [ThreadPool]: On dev_3lcu.information_schema: Close
[0m14:22:53.467911 [info ] [MainThread]: Catalog written to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\catalog.json
[0m14:22:53.468878 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:22:53.468878 after 13.41 seconds
[0m14:22:53.469875 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:22:53.469875 [debug] [MainThread]: Connection 'dev_3lcu.information_schema' was properly closed.
[0m14:22:53.470872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016994FC4CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016994D7A270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016996A463C0>]}
[0m14:22:53.471376 [debug] [MainThread]: Flushing usage events
[0m14:23:11.900065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1462396D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A145A63290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A14294CF20>]}


============================== 14:23:11.907140 | bdfb4af2-4e50-4cbd-ac11-cf3ed9c19ca2 ==============================
[0m14:23:11.907140 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:23:11.908105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:23:12.223743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdfb4af2-4e50-4cbd-ac11-cf3ed9c19ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1463E63C0>]}
[0m14:23:12.310770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdfb4af2-4e50-4cbd-ac11-cf3ed9c19ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1463E5B50>]}
[0m14:24:19.494934 [error] [MainThread]: Encountered an error:

[0m14:24:19.503454 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 240, in serve_forever
    self._handle_request_noblock()
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 318, in _handle_request_noblock
    self.process_request(request, client_address)
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 349, in process_request
    self.finish_request(request, client_address)
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 672, in __init__
    super().__init__(*args, **kwargs)
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 761, in __init__
    self.handle()
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 436, in handle
    self.handle_one_request()
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 708, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m14:24:19.506456 [debug] [MainThread]: Command `dbt docs serve` failed at 14:24:19.506456 after 67.79 seconds
[0m14:24:19.507457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A146144140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A145A35760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A146576C00>]}
[0m14:24:19.508457 [debug] [MainThread]: Flushing usage events
[0m17:41:16.851591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3A1C59D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3A13D0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3A13D280>]}


============================== 17:41:16.869610 | b80814ef-a391-49b7-a6cc-622171488c11 ==============================
[0m17:41:16.869610 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:41:16.872608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build -s events_prep', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:41:17.789538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b80814ef-a391-49b7-a6cc-622171488c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C392336E0>]}
[0m17:41:18.164422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b80814ef-a391-49b7-a6cc-622171488c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3A37A750>]}
[0m17:41:18.169420 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:41:19.182682 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:41:20.173794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:41:20.176790 [debug] [MainThread]: Partial parsing: added file: dbt_scooters://models\events_prep.sql
[0m17:41:20.179805 [debug] [MainThread]: Partial parsing: updated file: dbt_scooters://models\properties.yml
[0m17:41:21.464422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b80814ef-a391-49b7-a6cc-622171488c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3BB01E50>]}
[0m17:41:22.106727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b80814ef-a391-49b7-a6cc-622171488c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3BD2F6B0>]}
[0m17:41:22.108725 [info ] [MainThread]: Found 20 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 437 macros
[0m17:41:22.121738 [info ] [MainThread]: 
[0m17:41:22.124750 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:41:22.128750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m17:41:22.728411 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m17:41:22.730409 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m17:41:22.731409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:26.692639 [debug] [ThreadPool]: SQL status: SELECT 23 in 3.961 seconds
[0m17:41:26.694680 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m17:41:26.703336 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_dbt'
[0m17:41:26.711871 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m17:41:26.713380 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_finance'
[0m17:41:26.714427 [debug] [ThreadPool]: On list_dev_3lcu_dbt: BEGIN
[0m17:41:26.716911 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m17:41:26.717920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:26.718925 [debug] [ThreadPool]: On list_dev_3lcu_finance: BEGIN
[0m17:41:26.719927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:29.580332 [debug] [ThreadPool]: SQL status: BEGIN in 2.860 seconds
[0m17:41:29.581336 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m17:41:29.581336 [debug] [ThreadPool]: On list_dev_3lcu_finance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_finance"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m17:41:29.583338 [debug] [ThreadPool]: SQL status: BEGIN in 2.865 seconds
[0m17:41:29.583338 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m17:41:29.583338 [debug] [ThreadPool]: On list_dev_3lcu_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_dbt"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m17:41:29.939343 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.358 seconds
[0m17:41:29.941341 [debug] [ThreadPool]: On list_dev_3lcu_finance: ROLLBACK
[0m17:41:29.949948 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.366 seconds
[0m17:41:29.951914 [debug] [ThreadPool]: On list_dev_3lcu_dbt: ROLLBACK
[0m17:41:30.293677 [debug] [ThreadPool]: On list_dev_3lcu_finance: Close
[0m17:41:30.305208 [debug] [ThreadPool]: On list_dev_3lcu_dbt: Close
[0m17:41:30.315244 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:30.316250 [debug] [MainThread]: On master: BEGIN
[0m17:41:30.316250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:41:33.141859 [debug] [MainThread]: SQL status: BEGIN in 2.825 seconds
[0m17:41:33.141859 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:33.143381 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:41:33.627265 [debug] [MainThread]: SQL status: SELECT 4 in 0.483 seconds
[0m17:41:33.630218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b80814ef-a391-49b7-a6cc-622171488c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3B986F90>]}
[0m17:41:33.631218 [debug] [MainThread]: On master: ROLLBACK
[0m17:41:33.980277 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:33.981236 [debug] [MainThread]: On master: BEGIN
[0m17:41:34.704252 [debug] [MainThread]: SQL status: BEGIN in 0.722 seconds
[0m17:41:34.704252 [debug] [MainThread]: On master: COMMIT
[0m17:41:34.705254 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:34.705760 [debug] [MainThread]: On master: COMMIT
[0m17:41:35.054687 [debug] [MainThread]: SQL status: COMMIT in 0.348 seconds
[0m17:41:35.055192 [debug] [MainThread]: On master: Close
[0m17:41:35.056200 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:41:35.058244 [info ] [MainThread]: 
[0m17:41:35.066223 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_prep
[0m17:41:35.067221 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt.events_prep .................................... [RUN]
[0m17:41:35.068220 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_scooters.events_prep'
[0m17:41:35.069222 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_prep
[0m17:41:35.077239 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_prep"
[0m17:41:35.078238 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_prep
[0m17:41:35.116887 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_prep"
[0m17:41:35.118936 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:41:35.119881 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: BEGIN
[0m17:41:35.119881 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:41:37.948232 [debug] [Thread-1 (]: SQL status: BEGIN in 2.828 seconds
[0m17:41:37.949231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:41:37.949231 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

  create view "dev_3lcu"."dbt"."events_prep__dbt_tmp"
    
    
  as (
    select
    user_id,
    "timestamp",
    type_id,
    date("timestamp") as "date"
from
    "dev_3lcu"."scooters_raw"."events"
  );
[0m17:41:38.313307 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.363 seconds
[0m17:41:38.320344 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:41:38.321343 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
alter table "dev_3lcu"."dbt"."events_prep__dbt_tmp" rename to "events_prep"
[0m17:41:38.669618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.348 seconds
[0m17:41:38.692138 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:41:38.693644 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

    
  
  comment on view "dev_3lcu"."dbt"."events_prep" is $dbt_comment_literal_block$User events prepared for following processing$dbt_comment_literal_block$;

  
[0m17:41:39.041642 [debug] [Thread-1 (]: SQL status: COMMENT in 0.348 seconds
[0m17:41:39.062603 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:41:39.063602 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_prep'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:41:39.422524 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.358 seconds
[0m17:41:39.427566 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:41:39.427566 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."events_prep".date is $dbt_comment_literal_block$Date of event derived from timestamp.
Imitates Hive-styled partitioning of events by date.
It is needed for efficient incremental processing by engines
with partitioning support (i.e. Trino).$dbt_comment_literal_block$;
  

  
[0m17:41:39.779374 [debug] [Thread-1 (]: SQL status: COMMENT in 0.351 seconds
[0m17:41:39.781368 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: COMMIT
[0m17:41:39.782327 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:41:39.782327 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: COMMIT
[0m17:41:40.135251 [debug] [Thread-1 (]: SQL status: COMMIT in 0.352 seconds
[0m17:41:40.143201 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."events_prep__dbt_backup"
[0m17:41:40.151251 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:41:40.151251 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
drop view if exists "dev_3lcu"."dbt"."events_prep__dbt_backup" cascade
[0m17:41:40.507543 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.356 seconds
[0m17:41:40.511495 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: Close
[0m17:41:40.513496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b80814ef-a391-49b7-a6cc-622171488c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C37D58D10>]}
[0m17:41:40.514505 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt.events_prep ............................... [[32mCREATE VIEW[0m in 5.44s]
[0m17:41:40.515506 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_prep
[0m17:41:40.517505 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:40.518506 [debug] [MainThread]: On master: BEGIN
[0m17:41:40.518506 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:41:43.337332 [debug] [MainThread]: SQL status: BEGIN in 2.819 seconds
[0m17:41:43.337332 [debug] [MainThread]: On master: COMMIT
[0m17:41:43.338334 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:43.338334 [debug] [MainThread]: On master: COMMIT
[0m17:41:43.702171 [debug] [MainThread]: SQL status: COMMIT in 0.363 seconds
[0m17:41:43.702171 [info ] [MainThread]: 
[0m17:41:43.703678 [info ] [MainThread]: Running 1 on-run-end hook
[0m17:41:43.706727 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m17:41:43.712685 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m17:41:43.713692 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:43.714696 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m17:41:44.067695 [debug] [MainThread]: SQL status: GRANT in 0.353 seconds
[0m17:41:44.069700 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mGRANT[0m in 0.36s]
[0m17:41:44.070700 [info ] [MainThread]: 
[0m17:41:44.071702 [debug] [MainThread]: On master: Close
[0m17:41:44.072699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:44.073706 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m17:41:44.073706 [debug] [MainThread]: Connection 'list_dev_3lcu_dbt' was properly closed.
[0m17:41:44.074709 [debug] [MainThread]: Connection 'list_dev_3lcu_finance' was properly closed.
[0m17:41:44.074709 [debug] [MainThread]: Connection 'model.dbt_scooters.events_prep' was properly closed.
[0m17:41:44.074709 [info ] [MainThread]: 
[0m17:41:44.075708 [info ] [MainThread]: Finished running 1 view model, 1 project hook in 0 hours 0 minutes and 21.95 seconds (21.95s).
[0m17:41:44.077707 [debug] [MainThread]: Command end result
[0m17:41:44.118758 [info ] [MainThread]: 
[0m17:41:44.119756 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:41:44.120760 [info ] [MainThread]: 
[0m17:41:44.121756 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:41:44.123263 [debug] [MainThread]: Command `dbt build` succeeded at 17:41:44.121756 after 28.07 seconds
[0m17:41:44.123263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C39FB5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C39F1C920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C39F1C6B0>]}
[0m17:41:44.124276 [debug] [MainThread]: Flushing usage events
[0m17:46:31.858208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DF258BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DC4C5100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DDDE2C00>]}


============================== 17:46:31.992424 | 49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1 ==============================
[0m17:46:31.992424 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:46:31.994415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:46:32.479353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DF4D6D20>]}
[0m17:46:32.585646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DF2894F0>]}
[0m17:46:32.590221 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:46:32.958409 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:46:33.256399 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:46:33.258401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DFA12ED0>]}
[0m17:46:36.372252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E001B200>]}
[0m17:46:36.601176 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m17:46:36.611190 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m17:46:36.838455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DFCC2C60>]}
[0m17:46:36.839489 [info ] [MainThread]: Found 20 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 438 macros
[0m17:46:36.840460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DFD4BC80>]}
[0m17:46:36.844495 [info ] [MainThread]: 
[0m17:46:36.846460 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:46:36.847460 [info ] [MainThread]: 
[0m17:46:36.849468 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:46:36.857469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m17:46:36.858471 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m17:46:37.562397 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m17:46:37.563397 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m17:46:37.564374 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m17:46:37.565358 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m17:46:37.566364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:37.567361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:38.819421 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.254 seconds
[0m17:46:38.821410 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m17:46:40.611226 [debug] [ThreadPool]: SQL status: SELECT 5 in 3.044 seconds
[0m17:46:40.613227 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m17:46:40.614229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_gom1, now create_dev_gom1_dbt)
[0m17:46:40.614229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_gom1, now create_dev_gom1_finance)
[0m17:46:40.615227 [debug] [ThreadPool]: Creating schema "database: "dev_gom1"
schema: "dbt"
"
[0m17:46:40.616226 [debug] [ThreadPool]: Creating schema "database: "dev_gom1"
schema: "finance"
"
[0m17:46:40.622266 [debug] [ThreadPool]: Using postgres connection "create_dev_gom1_dbt"
[0m17:46:40.624227 [debug] [ThreadPool]: Using postgres connection "create_dev_gom1_finance"
[0m17:46:40.625226 [debug] [ThreadPool]: On create_dev_gom1_dbt: BEGIN
[0m17:46:40.626226 [debug] [ThreadPool]: On create_dev_gom1_finance: BEGIN
[0m17:46:40.626226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:40.627226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:41.711343 [debug] [ThreadPool]: SQL status: BEGIN in 1.085 seconds
[0m17:46:41.712345 [debug] [ThreadPool]: Using postgres connection "create_dev_gom1_finance"
[0m17:46:41.713344 [debug] [ThreadPool]: On create_dev_gom1_finance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "create_dev_gom1_finance"} */
create schema if not exists "finance"
[0m17:46:41.780349 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.066 seconds
[0m17:46:41.781345 [debug] [ThreadPool]: On create_dev_gom1_finance: COMMIT
[0m17:46:41.782386 [debug] [ThreadPool]: Using postgres connection "create_dev_gom1_finance"
[0m17:46:41.782386 [debug] [ThreadPool]: On create_dev_gom1_finance: COMMIT
[0m17:46:41.849528 [debug] [ThreadPool]: SQL status: COMMIT in 0.066 seconds
[0m17:46:41.850480 [debug] [ThreadPool]: On create_dev_gom1_finance: Close
[0m17:46:42.615329 [debug] [ThreadPool]: SQL status: BEGIN in 1.989 seconds
[0m17:46:42.617334 [debug] [ThreadPool]: Using postgres connection "create_dev_gom1_dbt"
[0m17:46:42.618329 [debug] [ThreadPool]: On create_dev_gom1_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "create_dev_gom1_dbt"} */
create schema if not exists "dbt"
[0m17:46:42.695925 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.077 seconds
[0m17:46:42.697929 [debug] [ThreadPool]: On create_dev_gom1_dbt: COMMIT
[0m17:46:42.697929 [debug] [ThreadPool]: Using postgres connection "create_dev_gom1_dbt"
[0m17:46:42.697929 [debug] [ThreadPool]: On create_dev_gom1_dbt: COMMIT
[0m17:46:42.771515 [debug] [ThreadPool]: SQL status: COMMIT in 0.072 seconds
[0m17:46:42.772477 [debug] [ThreadPool]: On create_dev_gom1_dbt: Close
[0m17:46:42.777523 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_dbt'
[0m17:46:42.785518 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_finance'
[0m17:46:42.786480 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m17:46:42.789618 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m17:46:42.789618 [debug] [ThreadPool]: On list_dev_gom1_dbt: BEGIN
[0m17:46:42.790659 [debug] [ThreadPool]: On list_dev_gom1_finance: BEGIN
[0m17:46:42.791628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:42.791628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:43.930457 [debug] [ThreadPool]: SQL status: BEGIN in 1.139 seconds
[0m17:46:43.931459 [debug] [ThreadPool]: SQL status: BEGIN in 1.140 seconds
[0m17:46:43.932461 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m17:46:43.933458 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m17:46:43.933458 [debug] [ThreadPool]: On list_dev_gom1_finance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_finance"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m17:46:43.934458 [debug] [ThreadPool]: On list_dev_gom1_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_dbt"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m17:46:44.013493 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.078 seconds
[0m17:46:44.014492 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.079 seconds
[0m17:46:44.016489 [debug] [ThreadPool]: On list_dev_gom1_dbt: ROLLBACK
[0m17:46:44.017491 [debug] [ThreadPool]: On list_dev_gom1_finance: ROLLBACK
[0m17:46:44.087490 [debug] [ThreadPool]: On list_dev_gom1_dbt: Close
[0m17:46:44.089490 [debug] [ThreadPool]: On list_dev_gom1_finance: Close
[0m17:46:44.097010 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:44.098010 [debug] [MainThread]: On master: BEGIN
[0m17:46:44.098010 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:46:45.226462 [debug] [MainThread]: SQL status: BEGIN in 1.128 seconds
[0m17:46:45.227461 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:45.228462 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:46:45.302520 [debug] [MainThread]: SQL status: SELECT 0 in 0.073 seconds
[0m17:46:45.304519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DF4C9130>]}
[0m17:46:45.305518 [debug] [MainThread]: On master: ROLLBACK
[0m17:46:45.374517 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:45.375518 [debug] [MainThread]: On master: BEGIN
[0m17:46:45.512167 [debug] [MainThread]: SQL status: BEGIN in 0.136 seconds
[0m17:46:45.513168 [debug] [MainThread]: On master: COMMIT
[0m17:46:45.514169 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:45.514169 [debug] [MainThread]: On master: COMMIT
[0m17:46:45.582167 [debug] [MainThread]: SQL status: COMMIT in 0.067 seconds
[0m17:46:45.584168 [debug] [MainThread]: On master: Close
[0m17:46:45.589170 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m17:46:45.590165 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_clean
[0m17:46:45.591173 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_prep
[0m17:46:45.591173 [debug] [Thread-4 (]: Began running node model.dbt_scooters.first_name_sex
[0m17:46:45.592321 [info ] [Thread-1 (]: 1 of 20 START sql table model dbt.companies .................................... [RUN]
[0m17:46:45.594323 [info ] [Thread-2 (]: 2 of 20 START sql incremental model dbt.events_clean ........................... [RUN]
[0m17:46:45.595321 [info ] [Thread-3 (]: 3 of 20 START sql view model dbt.events_prep ................................... [RUN]
[0m17:46:45.597321 [info ] [Thread-4 (]: 4 of 20 START sql table model dbt.first_name_sex ............................... [RUN]
[0m17:46:45.598318 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_scooters.companies'
[0m17:46:45.600322 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.events_clean'
[0m17:46:45.601327 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.events_prep'
[0m17:46:45.603325 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.first_name_sex'
[0m17:46:45.604319 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m17:46:45.604319 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_clean
[0m17:46:45.605325 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_prep
[0m17:46:45.606323 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.first_name_sex
[0m17:46:45.619318 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m17:46:45.628323 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m17:46:45.634324 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_prep"
[0m17:46:45.642320 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.first_name_sex"
[0m17:46:45.645325 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m17:46:45.680322 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.first_name_sex
[0m17:46:45.681324 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_prep
[0m17:46:45.682324 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_clean
[0m17:46:45.708360 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m17:46:45.713359 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.first_name_sex"
[0m17:46:45.739360 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_prep"
[0m17:46:45.786373 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m17:46:45.789375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:46:45.790375 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m17:46:45.791375 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:46:45.791375 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:46:45.792882 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:46:45.793852 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:46:45.794850 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: BEGIN
[0m17:46:45.795848 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: BEGIN
[0m17:46:45.796846 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: BEGIN
[0m17:46:45.797849 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:46:45.797849 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:46:45.799355 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:46:46.888446 [debug] [Thread-1 (]: SQL status: BEGIN in 1.095 seconds
[0m17:46:46.889445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:46:46.890446 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_gom1"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_gom1"."dbt"."scooters"
group by
    1
  );
  
[0m17:46:46.957213 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt.scooters" does not exist
LINE 17:     "dev_gom1"."dbt"."scooters"
             ^

[0m17:46:46.958213 [debug] [Thread-1 (]: On model.dbt_scooters.companies: ROLLBACK
[0m17:46:47.023451 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m17:46:47.035444 [debug] [Thread-1 (]: Database Error in model companies (models\companies.sql)
  relation "dbt.scooters" does not exist
  LINE 17:     "dev_gom1"."dbt"."scooters"
               ^
  compiled code at target\run\dbt_scooters\models\companies.sql
[0m17:46:47.040452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DD5B1AF0>]}
[0m17:46:47.041452 [error] [Thread-1 (]: 1 of 20 ERROR creating sql table model dbt.companies ........................... [[31mERROR[0m in 1.44s]
[0m17:46:47.043454 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m17:46:47.044463 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_concurrency
[0m17:46:47.045459 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.companies' to be skipped because of status 'error'.  Reason: Database Error in model companies (models\companies.sql)
  relation "dbt.scooters" does not exist
  LINE 17:     "dev_gom1"."dbt"."scooters"
               ^
  compiled code at target\run\dbt_scooters\models\companies.sql.
[0m17:46:47.046451 [info ] [Thread-1 (]: 5 of 20 START sql incremental model dbt.trips_concurrency ...................... [RUN]
[0m17:46:47.048455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.trips_concurrency)
[0m17:46:47.049453 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m17:46:47.055452 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m17:46:47.056451 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m17:46:47.062465 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m17:46:47.064465 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:46:47.064465 [debug] [Thread-1 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m17:46:47.065465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:47.858216 [debug] [Thread-3 (]: SQL status: BEGIN in 2.061 seconds
[0m17:46:47.859158 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:46:47.859158 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

  create view "dev_gom1"."dbt"."events_prep__dbt_tmp"
    
    
  as (
    select
    user_id,
    "timestamp",
    type_id,
    date("timestamp") as "date"
from
    "dev_gom1"."scooters_raw"."events"
  );
[0m17:46:47.938374 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.078 seconds
[0m17:46:47.946374 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:46:47.947375 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
alter table "dev_gom1"."dbt"."events_prep__dbt_tmp" rename to "events_prep"
[0m17:46:48.018316 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.070 seconds
[0m17:46:48.043324 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:46:48.044323 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

    
  
  comment on view "dev_gom1"."dbt"."events_prep" is $dbt_comment_literal_block$User events prepared for following processing$dbt_comment_literal_block$;

  
[0m17:46:48.119163 [debug] [Thread-3 (]: SQL status: COMMENT in 0.075 seconds
[0m17:46:48.142156 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:46:48.142156 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_prep'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:46:48.236341 [debug] [Thread-1 (]: SQL status: BEGIN in 1.171 seconds
[0m17:46:48.237348 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:46:48.237348 [debug] [Thread-1 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      
  
    

  create  table "dev_gom1"."dbt"."trips_concurrency"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_gom1"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now()  as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m17:46:48.248383 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.105 seconds
[0m17:46:48.253342 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:46:48.254341 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."events_prep".date is $dbt_comment_literal_block$Date of event derived from timestamp.
Imitates Hive-styled partitioning of events by date.
It is needed for efficient incremental processing by engines
with partitioning support (i.e. Trino).$dbt_comment_literal_block$;
  

  
[0m17:46:48.341204 [debug] [Thread-3 (]: SQL status: COMMENT in 0.086 seconds
[0m17:46:48.342204 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: COMMIT
[0m17:46:48.343216 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:46:48.344166 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: COMMIT
[0m17:46:48.436381 [debug] [Thread-3 (]: SQL status: COMMIT in 0.092 seconds
[0m17:46:48.443416 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."events_prep__dbt_backup"
[0m17:46:48.449418 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:46:48.450378 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
drop view if exists "dev_gom1"."dbt"."events_prep__dbt_backup" cascade
[0m17:46:48.608098 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.158 seconds
[0m17:46:48.611097 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: Close
[0m17:46:48.612095 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E050F920>]}
[0m17:46:48.613094 [info ] [Thread-3 (]: 3 of 20 OK created sql view model dbt.events_prep .............................. [[32mCREATE VIEW[0m in 3.01s]
[0m17:46:48.614096 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_prep
[0m17:46:48.615053 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_geom
[0m17:46:48.616096 [info ] [Thread-3 (]: 6 of 20 START sql view model dbt.trips_geom .................................... [RUN]
[0m17:46:48.617096 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_prep, now model.dbt_scooters.trips_geom)
[0m17:46:48.618058 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_geom
[0m17:46:48.622062 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m17:46:48.625055 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_geom
[0m17:46:48.629092 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m17:46:48.630053 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m17:46:48.631057 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m17:46:48.631057 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:46:49.001518 [debug] [Thread-2 (]: SQL status: BEGIN in 3.202 seconds
[0m17:46:49.002524 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:46:49.003525 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
  
    

  create  table "dev_gom1"."dbt"."events_clean"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at

from
    "dev_gom1"."scooters_raw"."events"
where

    "timestamp" < timestamp '2023-08-01'

  );
  
  
[0m17:46:49.404544 [debug] [Thread-4 (]: SQL status: BEGIN in 3.606 seconds
[0m17:46:49.405497 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:46:49.406496 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

  
    

  create  table "dev_gom1"."dbt"."first_name_sex__dbt_tmp"
  
  
    as
  
  (
    select distinct first_name, sex
from "dev_gom1"."scooters_raw"."users"
Where sex is not null
  );
  
[0m17:46:49.590182 [debug] [Thread-4 (]: SQL status: SELECT 387 in 0.184 seconds
[0m17:46:49.595179 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:46:49.595179 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_gom1"."dbt"."first_name_sex__dbt_tmp" rename to "first_name_sex"
[0m17:46:49.690255 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m17:46:49.696757 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:46:49.696757 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

    
  
  comment on table "dev_gom1"."dbt"."first_name_sex" is $dbt_comment_literal_block$Unique name_sex glossary$dbt_comment_literal_block$;

  
[0m17:46:49.809354 [debug] [Thread-4 (]: SQL status: COMMENT in 0.112 seconds
[0m17:46:49.811359 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m17:46:49.811359 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:46:49.812356 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m17:46:49.892402 [debug] [Thread-4 (]: SQL status: COMMIT in 0.079 seconds
[0m17:46:49.894402 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."first_name_sex__dbt_backup"
[0m17:46:49.897925 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:46:49.899433 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
drop table if exists "dev_gom1"."dbt"."first_name_sex__dbt_backup" cascade
[0m17:46:49.987487 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.088 seconds
[0m17:46:49.989493 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: Close
[0m17:46:49.990495 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E0459F70>]}
[0m17:46:49.992494 [info ] [Thread-4 (]: 4 of 20 OK created sql table model dbt.first_name_sex .......................... [[32mSELECT 387[0m in 4.39s]
[0m17:46:49.993494 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.first_name_sex
[0m17:46:49.994499 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_prep
[0m17:46:49.995492 [info ] [Thread-4 (]: 7 of 20 START sql view model dbt.trips_prep .................................... [RUN]
[0m17:46:49.995492 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.first_name_sex, now model.dbt_scooters.trips_prep)
[0m17:46:49.997003 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_prep
[0m17:46:50.000530 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m17:46:50.003532 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_prep
[0m17:46:50.006531 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m17:46:50.007528 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:46:50.009035 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m17:46:50.009035 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:46:50.093094 [debug] [Thread-1 (]: SQL status: SELECT 10 in 1.855 seconds
[0m17:46:50.097603 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:46:50.097603 [debug] [Thread-1 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_concurrency" is $dbt_comment_literal_block$Number of simultaneous rides in time$dbt_comment_literal_block$;

  
[0m17:46:50.168204 [debug] [Thread-1 (]: SQL status: COMMENT in 0.069 seconds
[0m17:46:50.170203 [debug] [Thread-1 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m17:46:50.170203 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:46:50.171204 [debug] [Thread-1 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m17:46:50.288411 [debug] [Thread-3 (]: SQL status: BEGIN in 1.657 seconds
[0m17:46:50.289370 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m17:46:50.290370 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_gom1"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_gom1"."scooters_raw"."trips"
  );
[0m17:46:50.291372 [debug] [Thread-1 (]: SQL status: COMMIT in 0.120 seconds
[0m17:46:50.293411 [debug] [Thread-1 (]: On model.dbt_scooters.trips_concurrency: Close
[0m17:46:50.294371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E0B1DC10>]}
[0m17:46:50.296412 [info ] [Thread-1 (]: 5 of 20 OK created sql incremental model dbt.trips_concurrency ................. [[32mSELECT 10[0m in 3.25s]
[0m17:46:50.297893 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m17:46:50.297893 [debug] [Thread-1 (]: Began running node model.dbt_scooters.users_full
[0m17:46:50.299438 [info ] [Thread-1 (]: 8 of 20 START sql table model dbt.users_full ................................... [RUN]
[0m17:46:50.300482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.users_full)
[0m17:46:50.301449 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.users_full
[0m17:46:50.305478 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.users_full"
[0m17:46:50.308451 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.users_full
[0m17:46:50.312451 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.users_full"
[0m17:46:50.314452 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:46:50.314452 [debug] [Thread-1 (]: On model.dbt_scooters.users_full: BEGIN
[0m17:46:50.315452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:50.356446 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function st_makepoint(double precision, double precision) does not exist
LINE 9:     st_setsrid(st_makepoint(start_lon, start_lat), 4326) as ...
                       ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m17:46:50.356446 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: ROLLBACK
[0m17:46:50.422216 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: Close
[0m17:46:50.425220 [debug] [Thread-3 (]: Database Error in model trips_geom (models\trips_geom.sql)
  function st_makepoint(double precision, double precision) does not exist
  LINE 9:     st_setsrid(st_makepoint(start_lon, start_lat), 4326) as ...
                         ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_scooters\models\trips_geom.sql
[0m17:46:50.426254 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E0AC3740>]}
[0m17:46:50.427220 [error] [Thread-3 (]: 6 of 20 ERROR creating sql view model dbt.trips_geom ........................... [[31mERROR[0m in 1.81s]
[0m17:46:50.428217 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_geom
[0m17:46:50.429220 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.trips_geom' to be skipped because of status 'error'.  Reason: Database Error in model trips_geom (models\trips_geom.sql)
  function st_makepoint(double precision, double precision) does not exist
  LINE 9:     st_setsrid(st_makepoint(start_lon, start_lat), 4326) as ...
                         ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_scooters\models\trips_geom.sql.
[0m17:46:50.430220 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m17:46:50.432223 [info ] [Thread-3 (]: 9 of 20 SKIP relation dbt.parking_finish_stat .................................. [[33mSKIP[0m]
[0m17:46:50.433218 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m17:46:50.434222 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_start_stat
[0m17:46:50.435255 [info ] [Thread-3 (]: 10 of 20 SKIP relation dbt.parking_start_stat .................................. [[33mSKIP[0m]
[0m17:46:50.436225 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m17:46:51.130114 [debug] [Thread-4 (]: SQL status: BEGIN in 1.120 seconds
[0m17:46:51.130114 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:46:51.131149 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_gom1"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select
    id,
    user_id,
    scooter_hw_id,
    started_at,
    finished_at,
    start_lat,
    start_lon,
    finish_lat,
    finish_lon,
    distance as distance_m,
    cast(price as decimal(20, 2)) / 100 as price_rub,
    extract(epoch from (finished_at - started_at)) as duration_s,
    finished_at <> started_at and price = 0 as is_free,
    
    date(started_at at time zone 'Europe/Moscow')
 as "date"
from
    "dev_gom1"."scooters_raw"."trips"
  );
[0m17:46:51.393326 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.262 seconds
[0m17:46:51.396331 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:46:51.397878 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_gom1"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m17:46:51.493107 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m17:46:51.495142 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:46:51.495142 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

    
  
  comment on view "dev_gom1"."dbt"."trips_prep" is $dbt_comment_literal_block$Trips prepared for analysis$dbt_comment_literal_block$;

  
[0m17:46:51.590449 [debug] [Thread-4 (]: SQL status: COMMENT in 0.095 seconds
[0m17:46:51.592445 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m17:46:51.593447 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:46:51.593447 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m17:46:51.691325 [debug] [Thread-4 (]: SQL status: COMMIT in 0.097 seconds
[0m17:46:51.691325 [debug] [Thread-1 (]: SQL status: BEGIN in 1.376 seconds
[0m17:46:51.694325 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."trips_prep__dbt_backup"
[0m17:46:51.695284 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:46:51.696286 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:46:51.696286 [debug] [Thread-1 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

  
    

  create  table "dev_gom1"."dbt"."users_full__dbt_tmp"
  
  
    as
  
  (
    select
   u.id, u.first_name ,u.last_name ,u.phone ,
   COALESCE(u.sex, fns.sex, afns.sex) as sex2,
   u.birth_date
from "dev_gom1"."scooters_raw"."users" u
left join "dev_gom1"."dbt"."first_name_sex" fns on u.first_name = fns.first_name
left join "dev_gom1"."dbt"."add_first_name_sex" afns on u.first_name =afns.first_name
  );
  
[0m17:46:51.697285 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_gom1"."dbt"."trips_prep__dbt_backup" cascade
[0m17:46:51.790494 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.092 seconds
[0m17:46:51.792490 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: Close
[0m17:46:51.793448 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E0B12210>]}
[0m17:46:51.795450 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt.add_first_name_sex" does not exist
LINE 18: left join "dev_gom1"."dbt"."add_first_name_sex" afns on u.fi...
                   ^

[0m17:46:51.794465 [info ] [Thread-4 (]: 7 of 20 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 1.80s]
[0m17:46:51.796457 [debug] [Thread-1 (]: On model.dbt_scooters.users_full: ROLLBACK
[0m17:46:51.797451 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_prep
[0m17:46:51.798453 [debug] [Thread-3 (]: Began running node model.dbt_scooters.companies_trips
[0m17:46:51.799550 [debug] [Thread-4 (]: Began running node model.dbt_scooters.revenue_daily
[0m17:46:51.799550 [info ] [Thread-3 (]: 11 of 20 SKIP relation dbt.companies_trips ..................................... [[33mSKIP[0m]
[0m17:46:51.800547 [info ] [Thread-4 (]: 12 of 20 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m17:46:51.801550 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.companies_trips
[0m17:46:51.802549 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.revenue_daily)
[0m17:46:51.803551 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_stat
[0m17:46:51.804551 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m17:46:51.805549 [info ] [Thread-3 (]: 13 of 20 START sql table model dbt.trips_stat .................................. [RUN]
[0m17:46:51.809130 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m17:46:51.810176 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.trips_stat)
[0m17:46:51.811175 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_stat
[0m17:46:51.814137 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m17:46:51.815139 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.revenue_daily
[0m17:46:51.838140 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:46:51.839144 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_stat
[0m17:46:51.840155 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
select * from (
        select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep"

group by
    2,
    3
order by
    2
    ) as __dbt_sbq
    where false
    limit 0

[0m17:46:51.843153 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m17:46:51.844153 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:46:51.846156 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:46:51.846156 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m17:46:51.847152 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:46:51.891185 [debug] [Thread-1 (]: On model.dbt_scooters.users_full: Close
[0m17:46:51.895187 [debug] [Thread-1 (]: Database Error in model users_full (models\users_full.sql)
  relation "dbt.add_first_name_sex" does not exist
  LINE 18: left join "dev_gom1"."dbt"."add_first_name_sex" afns on u.fi...
                     ^
  compiled code at target\run\dbt_scooters\models\users_full.sql
[0m17:46:51.896185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E0AC3EC0>]}
[0m17:46:51.896185 [error] [Thread-1 (]: 8 of 20 ERROR creating sql table model dbt.users_full .......................... [[31mERROR[0m in 1.59s]
[0m17:46:51.897183 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.users_full
[0m17:46:51.898701 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m17:46:51.899715 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.users_full' to be skipped because of status 'error'.  Reason: Database Error in model users_full (models\users_full.sql)
  relation "dbt.add_first_name_sex" does not exist
  LINE 18: left join "dev_gom1"."dbt"."add_first_name_sex" afns on u.fi...
                     ^
  compiled code at target\run\dbt_scooters\models\users_full.sql.
[0m17:46:51.900709 [info ] [Thread-1 (]: 14 of 20 START sql table model dbt.trips_stat_daily ............................ [RUN]
[0m17:46:51.901710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.users_full, now model.dbt_scooters.trips_stat_daily)
[0m17:46:51.901710 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m17:46:51.904708 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m17:46:51.906713 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m17:46:51.911224 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m17:46:51.913226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:46:51.914227 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m17:46:51.914227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:53.020173 [debug] [Thread-4 (]: SQL status: SELECT 0 in 1.176 seconds
[0m17:46:53.033171 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:46:53.034173 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
select * from (
        select
    
      
    cast(null as decimal(20, 2))
 as revenue_rub, 
      
    cast(null as date)
 as date, 
      
    cast(null as timestamptz)
 as updated_at
    ) as __dbt_sbq
    where false
    limit 0

[0m17:46:53.187201 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.152 seconds
[0m17:46:53.206715 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m17:46:53.210245 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:46:53.211245 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m17:46:53.276239 [debug] [Thread-4 (]: SQL status: BEGIN in 0.065 seconds
[0m17:46:53.277241 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:46:53.278242 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
  
    

  create  table "dev_gom1"."finance"."revenue_daily"
  
  
    
  
  (
    revenue_rub decimal(20, 2),
    date date,
    updated_at timestamptz
    
    )
 ;
    insert into "dev_gom1"."finance"."revenue_daily" (
      revenue_rub, date, updated_at
    )
  
  (
    
    select revenue_rub, date, updated_at
    from (
        select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep"

group by
    2,
    3
order by
    2
    ) as model_subq
  );
  
  
[0m17:46:54.289075 [debug] [Thread-1 (]: SQL status: BEGIN in 2.375 seconds
[0m17:46:54.290076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:46:54.291075 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_gom1"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    count(*) as trips,
    max(price_rub) as max_price_rub,
    avg(distance_m) / 1000 as avg_distance_km,
    avg(price_rub)/avg(duration_s) * 60 as avg_price_rub_per_min
from
    "dev_gom1"."dbt"."trips_prep"
group by
    1
order by
    1
  );
  
[0m17:46:54.291075 [debug] [Thread-3 (]: SQL status: BEGIN in 2.444 seconds
[0m17:46:54.292078 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:46:54.293077 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_gom1"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count(*) as trips,
    count(distinct user_id) as users,
    avg(duration_s) / 60 as avg_duration_min,
    sum(distance_m) / 1000 as sum_distance_km,
    sum(price_rub) as revenue_rub,
    count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from
    "dev_gom1"."dbt"."trips_prep"
  );
  
[0m17:46:59.013149 [debug] [Thread-4 (]: SQL status: INSERT 0 91 in 5.735 seconds
[0m17:46:59.028207 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:46:59.029145 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

        
            grant select on "dev_gom1"."finance"."revenue_daily" to finance;
        
    
[0m17:46:59.097145 [debug] [Thread-4 (]: Postgres adapter: Postgres error: role "finance" does not exist

[0m17:46:59.098145 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: ROLLBACK
[0m17:46:59.189406 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: Close
[0m17:46:59.194408 [debug] [Thread-4 (]: Database Error in model revenue_daily (models\finance\revenue_daily.sql)
  role "finance" does not exist
  compiled code at target\run\dbt_scooters\models\finance\revenue_daily.sql
[0m17:46:59.195409 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E0B604A0>]}
[0m17:46:59.196368 [error] [Thread-4 (]: 12 of 20 ERROR creating sql incremental model finance.revenue_daily ............ [[31mERROR[0m in 7.39s]
[0m17:46:59.197407 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.revenue_daily
[0m17:46:59.198367 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m17:46:59.199377 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.revenue_daily' to be skipped because of status 'error'.  Reason: Database Error in model revenue_daily (models\finance\revenue_daily.sql)
  role "finance" does not exist
  compiled code at target\run\dbt_scooters\models\finance\revenue_daily.sql.
[0m17:46:59.200411 [info ] [Thread-4 (]: 15 of 20 START sql incremental model dbt.trips_users ........................... [RUN]
[0m17:46:59.201380 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_users)
[0m17:46:59.202378 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m17:46:59.205995 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m17:46:59.208001 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m17:46:59.212553 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m17:46:59.214516 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:46:59.214516 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m17:46:59.215553 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:46:59.501198 [debug] [Thread-2 (]: SQL status: SELECT 221370 in 10.497 seconds
[0m17:46:59.503154 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:46:59.504153 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
  comment on table "dev_gom1"."dbt"."events_clean" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m17:46:59.593287 [debug] [Thread-2 (]: SQL status: COMMENT in 0.088 seconds
[0m17:46:59.595287 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m17:46:59.595287 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:46:59.596287 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m17:46:59.694118 [debug] [Thread-2 (]: SQL status: COMMIT in 0.097 seconds
[0m17:46:59.695157 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: Close
[0m17:46:59.696117 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E0496120>]}
[0m17:46:59.697117 [info ] [Thread-2 (]: 2 of 20 OK created sql incremental model dbt.events_clean ...................... [[32mSELECT 221370[0m in 14.10s]
[0m17:46:59.698121 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_clean
[0m17:46:59.699117 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_full
[0m17:46:59.700116 [info ] [Thread-2 (]: 16 of 20 START sql view model dbt.events_full .................................. [RUN]
[0m17:46:59.701116 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.events_full)
[0m17:46:59.702119 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_full
[0m17:46:59.705696 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m17:46:59.710218 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_full
[0m17:46:59.713217 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m17:46:59.715217 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:46:59.715217 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: BEGIN
[0m17:46:59.716218 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:00.289243 [debug] [Thread-1 (]: SQL status: SELECT 91 in 5.997 seconds
[0m17:47:00.293191 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:47:00.294189 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_gom1"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m17:47:00.387348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m17:47:00.398357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:47:00.398357 [debug] [Thread-3 (]: SQL status: SELECT 1 in 6.105 seconds
[0m17:47:00.399356 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    create  index if not exists
  "17ee560a6c2f8b1000adc1fcd0ec9373"
  on "dev_gom1"."dbt"."trips_stat_daily" 
  (date)
  
[0m17:47:00.402397 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:47:00.403399 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_gom1"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m17:47:00.431222 [debug] [Thread-4 (]: SQL status: BEGIN in 1.216 seconds
[0m17:47:00.432209 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:47:00.433191 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      
  
    

  create  table "dev_gom1"."dbt"."trips_users"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep" as t
left join
    "dev_gom1"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id <= 75000

  );
  
  
[0m17:47:00.473210 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.070 seconds
[0m17:47:00.473210 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.069 seconds
[0m17:47:00.476168 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:47:00.478203 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:47:00.478203 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_stat_daily" is $dbt_comment_literal_block$Overall trips statistics per day$dbt_comment_literal_block$;

  
[0m17:47:00.479168 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_stat" is $dbt_comment_literal_block$Overall trips statistics$dbt_comment_literal_block$;

  
[0m17:47:00.552280 [debug] [Thread-1 (]: SQL status: COMMENT in 0.072 seconds
[0m17:47:00.557234 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:47:00.558234 [debug] [Thread-3 (]: SQL status: COMMENT in 0.078 seconds
[0m17:47:00.559234 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_stat_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:47:00.560280 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m17:47:00.561252 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:47:00.562282 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m17:47:00.696496 [debug] [Thread-3 (]: SQL status: COMMIT in 0.134 seconds
[0m17:47:00.764082 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."trips_stat__dbt_backup"
[0m17:47:00.765083 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:47:00.765083 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_gom1"."dbt"."trips_stat__dbt_backup" cascade
[0m17:47:00.791107 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.229 seconds
[0m17:47:00.793107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:47:00.794104 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."trips_stat_daily".date is $dbt_comment_literal_block$Trips date$dbt_comment_literal_block$;
  

  
[0m17:47:00.835159 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.070 seconds
[0m17:47:00.838160 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: Close
[0m17:47:00.839159 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E0AF8BC0>]}
[0m17:47:00.840164 [info ] [Thread-3 (]: 13 of 20 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 9.03s]
[0m17:47:00.841171 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_stat
[0m17:47:00.859167 [debug] [Thread-1 (]: SQL status: COMMENT in 0.065 seconds
[0m17:47:00.861177 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m17:47:00.862179 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:47:00.863208 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m17:47:00.995276 [debug] [Thread-1 (]: SQL status: COMMIT in 0.131 seconds
[0m17:47:00.998277 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."trips_stat_daily__dbt_backup"
[0m17:47:00.999280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:47:00.999280 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_gom1"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m17:47:01.065339 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.066 seconds
[0m17:47:01.068350 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m17:47:01.069358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E04AB770>]}
[0m17:47:01.070356 [info ] [Thread-1 (]: 14 of 20 OK created sql table model dbt.trips_stat_daily ....................... [[32mSELECT 91[0m in 9.17s]
[0m17:47:01.072356 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m17:47:01.890440 [debug] [Thread-2 (]: SQL status: BEGIN in 2.174 seconds
[0m17:47:01.891444 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:47:01.892439 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_gom1"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select * from
"dev_gom1"."dbt"."events_clean" as e
left join "dev_gom1"."dbt"."event_types" as t
using (type_id)
  );
[0m17:47:01.992508 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "dbt.event_types" does not exist
LINE 9: left join "dev_gom1"."dbt"."event_types" as t
                  ^

[0m17:47:01.992508 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: ROLLBACK
[0m17:47:02.090094 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: Close
[0m17:47:02.094095 [debug] [Thread-2 (]: Database Error in model events_full (models\events_full.sql)
  relation "dbt.event_types" does not exist
  LINE 9: left join "dev_gom1"."dbt"."event_types" as t
                    ^
  compiled code at target\run\dbt_scooters\models\events_full.sql
[0m17:47:02.094095 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E0AF9370>]}
[0m17:47:02.095092 [error] [Thread-2 (]: 16 of 20 ERROR creating sql view model dbt.events_full ......................... [[31mERROR[0m in 2.39s]
[0m17:47:02.096094 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_full
[0m17:47:02.097103 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.events_full' to be skipped because of status 'error'.  Reason: Database Error in model events_full (models\events_full.sql)
  relation "dbt.event_types" does not exist
  LINE 9: left join "dev_gom1"."dbt"."event_types" as t
                    ^
  compiled code at target\run\dbt_scooters\models\events_full.sql.
[0m17:47:02.098098 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_stat
[0m17:47:02.099092 [info ] [Thread-3 (]: 17 of 20 SKIP relation dbt.events_stat ......................................... [[33mSKIP[0m]
[0m17:47:02.100104 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_stat
[0m17:47:03.592446 [debug] [Thread-4 (]: SQL status: SELECT 75000 in 3.158 seconds
[0m17:47:03.594447 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:47:03.594447 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_users" is $dbt_comment_literal_block$Prepared trips enriched with users data$dbt_comment_literal_block$;

  
[0m17:47:03.664506 [debug] [Thread-4 (]: SQL status: COMMENT in 0.070 seconds
[0m17:47:03.667504 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:47:03.667504 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m17:47:06.601158 [debug] [Thread-4 (]: SQL status: ANALYZE in 2.933 seconds
[0m17:47:06.603155 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m17:47:06.603155 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:47:06.604155 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m17:47:06.698231 [debug] [Thread-4 (]: SQL status: COMMIT in 0.093 seconds
[0m17:47:06.699230 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:47:06.699230 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m17:47:06.792310 [debug] [Thread-4 (]: SQL status: COMMIT in 0.092 seconds
[0m17:47:06.793311 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:47:06.794309 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m17:47:06.992223 [debug] [Thread-4 (]: SQL status: VACUUM in 0.197 seconds
[0m17:47:06.994216 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m17:47:06.995176 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E04A94F0>]}
[0m17:47:06.996176 [info ] [Thread-4 (]: 15 of 20 OK created sql incremental model dbt.trips_users ...................... [[32mSELECT 75000[0m in 7.79s]
[0m17:47:06.997175 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m17:47:06.998174 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_daily
[0m17:47:06.999174 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_group
[0m17:47:06.999174 [info ] [Thread-2 (]: 18 of 20 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m17:47:07.000175 [info ] [Thread-1 (]: 19 of 20 START sql table model dbt.trips_age_group ............................. [RUN]
[0m17:47:07.001176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_age_daily)
[0m17:47:07.002175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.trips_age_group)
[0m17:47:07.003181 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m17:47:07.003181 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m17:47:07.006174 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m17:47:07.009210 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m17:47:07.012732 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m17:47:07.015771 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m17:47:07.016770 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_group
[0m17:47:07.021268 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m17:47:07.022263 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:47:07.022263 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m17:47:07.023262 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:07.024261 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m17:47:07.024261 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m17:47:07.025262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:08.104216 [debug] [Thread-2 (]: SQL status: BEGIN in 1.080 seconds
[0m17:47:08.104216 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:47:08.105253 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_gom1"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    Select "date",
       age,
       count(*) as trips,
       sum(price_rub) as revenue_rub
from
    "dev_gom1"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m17:47:08.144077 [debug] [Thread-1 (]: SQL status: BEGIN in 1.119 seconds
[0m17:47:08.145028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m17:47:08.146027 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_gom1"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_gom1"."dbt"."trips_users" as tu
    cross join "dev_gom1"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m17:47:08.224246 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt.age_groups" does not exist
LINE 18:     cross join "dev_gom1"."dbt"."age_groups" as ag
                        ^

[0m17:47:08.225218 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: ROLLBACK
[0m17:47:08.295313 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: Close
[0m17:47:08.299274 [debug] [Thread-1 (]: Database Error in model trips_age_group (models\trips_age_group.sql)
  relation "dbt.age_groups" does not exist
  LINE 18:     cross join "dev_gom1"."dbt"."age_groups" as ag
                          ^
  compiled code at target\run\dbt_scooters\models\trips_age_group.sql
[0m17:47:08.300274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DFBC7560>]}
[0m17:47:08.300274 [error] [Thread-1 (]: 19 of 20 ERROR creating sql table model dbt.trips_age_group .................... [[31mERROR[0m in 1.30s]
[0m17:47:08.301275 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_group
[0m17:47:08.302275 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.trips_age_group' to be skipped because of status 'error'.  Reason: Database Error in model trips_age_group (models\trips_age_group.sql)
  relation "dbt.age_groups" does not exist
  LINE 18:     cross join "dev_gom1"."dbt"."age_groups" as ag
                          ^
  compiled code at target\run\dbt_scooters\models\trips_age_group.sql.
[0m17:47:08.692251 [debug] [Thread-2 (]: SQL status: SELECT 4946 in 0.586 seconds
[0m17:47:08.696292 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:47:08.696292 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_gom1"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m17:47:08.763067 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.066 seconds
[0m17:47:08.765068 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:47:08.766068 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_age_daily" is $dbt_comment_literal_block$Daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m17:47:08.832284 [debug] [Thread-2 (]: SQL status: COMMENT in 0.066 seconds
[0m17:47:08.834285 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m17:47:08.834285 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:47:08.835286 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m17:47:08.902283 [debug] [Thread-2 (]: SQL status: COMMIT in 0.066 seconds
[0m17:47:08.905284 [debug] [Thread-2 (]: Applying DROP to: "dev_gom1"."dbt"."trips_age_daily__dbt_backup"
[0m17:47:08.906284 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:47:08.906284 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_gom1"."dbt"."trips_age_daily__dbt_backup" cascade
[0m17:47:08.973086 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.066 seconds
[0m17:47:08.975039 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: Close
[0m17:47:08.976038 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DF477D10>]}
[0m17:47:08.977039 [info ] [Thread-2 (]: 18 of 20 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 4946[0m in 1.97s]
[0m17:47:08.978039 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m17:47:08.980048 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m17:47:08.980048 [info ] [Thread-4 (]: 20 of 20 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m17:47:08.981083 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_daily_stat)
[0m17:47:08.982049 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m17:47:08.985082 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m17:47:08.986049 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m17:47:08.991084 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m17:47:08.994052 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:47:08.994052 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m17:47:08.995083 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:11.031325 [debug] [Thread-4 (]: SQL status: BEGIN in 2.037 seconds
[0m17:47:11.032317 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:47:11.033283 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_gom1"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_gom1"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m17:47:11.105276 [debug] [Thread-4 (]: SQL status: SELECT 83 in 0.071 seconds
[0m17:47:11.110313 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:47:11.111315 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_gom1"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m17:47:11.176126 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.065 seconds
[0m17:47:11.179110 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:47:11.179110 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_age_daily_stat" is $dbt_comment_literal_block$Aggregation of daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m17:47:11.245256 [debug] [Thread-4 (]: SQL status: COMMENT in 0.065 seconds
[0m17:47:11.247255 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m17:47:11.247255 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:47:11.248252 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m17:47:11.315253 [debug] [Thread-4 (]: SQL status: COMMIT in 0.066 seconds
[0m17:47:11.317848 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."trips_age_daily_stat__dbt_backup"
[0m17:47:11.317848 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:47:11.319394 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_gom1"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m17:47:11.385045 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.065 seconds
[0m17:47:11.387048 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m17:47:11.388046 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e5cd3f-3220-40d7-a730-4e0ce7e1a4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DFF1ACC0>]}
[0m17:47:11.389049 [info ] [Thread-4 (]: 20 of 20 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 2.41s]
[0m17:47:11.390054 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m17:47:11.392011 [info ] [MainThread]: 
[0m17:47:11.393006 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:11.394008 [debug] [MainThread]: On master: BEGIN
[0m17:47:11.394008 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:12.516358 [debug] [MainThread]: SQL status: BEGIN in 1.122 seconds
[0m17:47:12.517307 [debug] [MainThread]: On master: COMMIT
[0m17:47:12.517307 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:12.518308 [debug] [MainThread]: On master: COMMIT
[0m17:47:12.587028 [debug] [MainThread]: SQL status: COMMIT in 0.068 seconds
[0m17:47:12.589027 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m17:47:12.596034 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m17:47:12.597034 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:12.598033 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m17:47:12.669239 [debug] [MainThread]: Postgres adapter: Postgres error: role "finance" does not exist

[0m17:47:12.670242 [info ] [MainThread]: 1 of 1 ERROR hook: dbt_scooters.on-run-end.0 ................................... [[31mERROR[0m in 0.08s]
[0m17:47:12.671242 [debug] [MainThread]: On master: Close
[0m17:47:12.673240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:12.674243 [debug] [MainThread]: Connection 'create_dev_gom1_dbt' was properly closed.
[0m17:47:12.674243 [debug] [MainThread]: Connection 'create_dev_gom1_finance' was properly closed.
[0m17:47:12.675274 [debug] [MainThread]: Connection 'list_dev_gom1_dbt' was properly closed.
[0m17:47:12.676258 [debug] [MainThread]: Connection 'list_dev_gom1_finance' was properly closed.
[0m17:47:12.676258 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m17:47:12.677274 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily' was properly closed.
[0m17:47:12.678239 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_stat' was properly closed.
[0m17:47:12.678239 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m17:47:12.679276 [info ] [MainThread]: 
[0m17:47:12.681240 [info ] [MainThread]: Finished running 4 incremental models, 1 project hook, 12 table models, 4 view models in 0 hours 0 minutes and 35.83 seconds (35.83s).
[0m17:47:12.687237 [debug] [MainThread]: Command end result
[0m17:47:12.725765 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m17:47:12.729277 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m17:47:12.737288 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\run_results.json
[0m17:47:12.738292 [info ] [MainThread]: 
[0m17:47:12.739307 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m17:47:12.740301 [info ] [MainThread]: 
[0m17:47:12.742313 [error] [MainThread]:   Database Error in model companies (models\companies.sql)
  relation "dbt.scooters" does not exist
  LINE 17:     "dev_gom1"."dbt"."scooters"
               ^
  compiled code at target\run\dbt_scooters\models\companies.sql
[0m17:47:12.743305 [info ] [MainThread]: 
[0m17:47:12.744302 [error] [MainThread]:   Database Error in model trips_geom (models\trips_geom.sql)
  function st_makepoint(double precision, double precision) does not exist
  LINE 9:     st_setsrid(st_makepoint(start_lon, start_lat), 4326) as ...
                         ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_scooters\models\trips_geom.sql
[0m17:47:12.745306 [info ] [MainThread]: 
[0m17:47:12.747305 [error] [MainThread]:   Database Error in model users_full (models\users_full.sql)
  relation "dbt.add_first_name_sex" does not exist
  LINE 18: left join "dev_gom1"."dbt"."add_first_name_sex" afns on u.fi...
                     ^
  compiled code at target\run\dbt_scooters\models\users_full.sql
[0m17:47:12.748303 [info ] [MainThread]: 
[0m17:47:12.750321 [error] [MainThread]:   Database Error in model revenue_daily (models\finance\revenue_daily.sql)
  role "finance" does not exist
  compiled code at target\run\dbt_scooters\models\finance\revenue_daily.sql
[0m17:47:12.752314 [info ] [MainThread]: 
[0m17:47:12.753317 [error] [MainThread]:   Database Error in model events_full (models\events_full.sql)
  relation "dbt.event_types" does not exist
  LINE 9: left join "dev_gom1"."dbt"."event_types" as t
                    ^
  compiled code at target\run\dbt_scooters\models\events_full.sql
[0m17:47:12.754319 [info ] [MainThread]: 
[0m17:47:12.756315 [error] [MainThread]:   Database Error in model trips_age_group (models\trips_age_group.sql)
  relation "dbt.age_groups" does not exist
  LINE 18:     cross join "dev_gom1"."dbt"."age_groups" as ag
                          ^
  compiled code at target\run\dbt_scooters\models\trips_age_group.sql
[0m17:47:12.758320 [info ] [MainThread]: 
[0m17:47:12.759330 [error] [MainThread]:   dbt_scooters.on-run-end.0 failed, error:
 role "finance" does not exist
[0m17:47:12.760331 [info ] [MainThread]: 
[0m17:47:12.761335 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=7 SKIP=4 TOTAL=21
[0m17:47:12.763331 [debug] [MainThread]: Command `dbt run` failed at 17:47:12.763331 after 41.27 seconds
[0m17:47:12.764337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DD4C95B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DD6E7BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DDEBC2F0>]}
[0m17:47:12.765332 [debug] [MainThread]: Flushing usage events
[0m17:47:13.734100 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:47:28.112379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51A383E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51A1F3C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51A381C40>]}


============================== 17:47:28.118379 | 06364a2a-2587-4c3e-81f4-511834419d62 ==============================
[0m17:47:28.118379 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:47:28.119388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:47:28.455403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51A68EF90>]}
[0m17:47:28.558977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51A178230>]}
[0m17:47:28.561987 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:47:28.920355 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:47:29.292251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:47:29.293248 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:47:29.414400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51A7AE720>]}
[0m17:47:29.627211 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m17:47:29.633211 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m17:47:29.959192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51BC20380>]}
[0m17:47:29.960191 [info ] [MainThread]: Found 20 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 438 macros
[0m17:47:29.968231 [info ] [MainThread]: 
[0m17:47:29.969199 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:47:29.970195 [info ] [MainThread]: 
[0m17:47:29.972189 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:47:29.980222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m17:47:29.999229 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m17:47:30.134012 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m17:47:30.134012 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m17:47:30.135008 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m17:47:30.136047 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m17:47:30.137012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:30.137012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:32.165248 [debug] [ThreadPool]: SQL status: SELECT 7 in 2.028 seconds
[0m17:47:32.167202 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m17:47:32.201248 [debug] [ThreadPool]: SQL status: SELECT 7 in 2.064 seconds
[0m17:47:32.203243 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m17:47:32.206200 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_dbt'
[0m17:47:32.213207 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m17:47:32.214203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_finance'
[0m17:47:32.215209 [debug] [ThreadPool]: On list_dev_gom1_dbt: BEGIN
[0m17:47:32.217204 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m17:47:32.218202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:32.219206 [debug] [ThreadPool]: On list_dev_gom1_finance: BEGIN
[0m17:47:32.220216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:33.329269 [debug] [ThreadPool]: SQL status: BEGIN in 1.111 seconds
[0m17:47:33.330292 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m17:47:33.330292 [debug] [ThreadPool]: On list_dev_gom1_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_dbt"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m17:47:33.406087 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.076 seconds
[0m17:47:33.408084 [debug] [ThreadPool]: On list_dev_gom1_dbt: ROLLBACK
[0m17:47:33.479127 [debug] [ThreadPool]: On list_dev_gom1_dbt: Close
[0m17:47:35.148080 [debug] [ThreadPool]: SQL status: BEGIN in 2.928 seconds
[0m17:47:35.149081 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m17:47:35.149584 [debug] [ThreadPool]: On list_dev_gom1_finance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_finance"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m17:47:35.223207 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.074 seconds
[0m17:47:35.225203 [debug] [ThreadPool]: On list_dev_gom1_finance: ROLLBACK
[0m17:47:35.294036 [debug] [ThreadPool]: On list_dev_gom1_finance: Close
[0m17:47:35.300998 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:35.301997 [debug] [MainThread]: On master: BEGIN
[0m17:47:35.301997 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:37.303221 [debug] [MainThread]: SQL status: BEGIN in 2.001 seconds
[0m17:47:37.304173 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:37.305173 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:47:37.379029 [debug] [MainThread]: SQL status: SELECT 2 in 0.073 seconds
[0m17:47:37.380984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51BC56FF0>]}
[0m17:47:37.381984 [debug] [MainThread]: On master: ROLLBACK
[0m17:47:37.448996 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:37.448996 [debug] [MainThread]: On master: BEGIN
[0m17:47:37.583243 [debug] [MainThread]: SQL status: BEGIN in 0.133 seconds
[0m17:47:37.584244 [debug] [MainThread]: On master: COMMIT
[0m17:47:37.584244 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:37.585250 [debug] [MainThread]: On master: COMMIT
[0m17:47:37.652254 [debug] [MainThread]: SQL status: COMMIT in 0.067 seconds
[0m17:47:37.653253 [debug] [MainThread]: On master: Close
[0m17:47:37.658402 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.add_first_name_sex
[0m17:47:37.658402 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m17:47:37.659399 [debug] [Thread-3 (]: Began running node seed.dbt_scooters.event_types
[0m17:47:37.659399 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.scooters
[0m17:47:37.660435 [info ] [Thread-1 (]: 1 of 52 START seed file dbt.add_first_name_sex ................................. [RUN]
[0m17:47:37.661438 [info ] [Thread-2 (]: 2 of 52 START seed file dbt.age_groups ......................................... [RUN]
[0m17:47:37.662406 [info ] [Thread-3 (]: 3 of 52 START seed file dbt.event_types ........................................ [RUN]
[0m17:47:37.663442 [info ] [Thread-4 (]: 4 of 52 START seed file dbt.scooters ........................................... [RUN]
[0m17:47:37.665402 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.dbt_scooters.add_first_name_sex'
[0m17:47:37.666401 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.dbt_scooters.age_groups'
[0m17:47:37.667401 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.dbt_scooters.event_types'
[0m17:47:37.668913 [debug] [Thread-4 (]: Acquiring new postgres connection 'seed.dbt_scooters.scooters'
[0m17:47:37.670928 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.add_first_name_sex
[0m17:47:37.671930 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m17:47:37.671930 [debug] [Thread-3 (]: Began compiling node seed.dbt_scooters.event_types
[0m17:47:37.672932 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.scooters
[0m17:47:37.673931 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.add_first_name_sex
[0m17:47:37.674928 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m17:47:37.675930 [debug] [Thread-3 (]: Began executing node seed.dbt_scooters.event_types
[0m17:47:37.675930 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.scooters
[0m17:47:37.725943 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:47:37.729946 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:47:37.734950 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:47:37.739970 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:47:37.739970 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: BEGIN
[0m17:47:37.740961 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m17:47:37.741961 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: BEGIN
[0m17:47:37.742959 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: BEGIN
[0m17:47:37.742959 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:47:37.743959 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:47:37.744963 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:47:37.745972 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:47:39.048089 [debug] [Thread-2 (]: SQL status: BEGIN in 1.305 seconds
[0m17:47:39.049088 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:47:39.050089 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    create table "dev_gom1"."dbt"."age_groups" ("group" text,"age_start" integer,"age_end" integer)
  
[0m17:47:39.128275 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.077 seconds
[0m17:47:39.150289 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:47:39.151290 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_gom1"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m17:47:39.235930 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.084 seconds
[0m17:47:39.243920 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m17:47:39.275933 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:47:39.276934 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  comment on table "dev_gom1"."dbt"."age_groups" is $dbt_comment_literal_block$Age groups to split users for analysis$dbt_comment_literal_block$;

  
[0m17:47:39.360201 [debug] [Thread-2 (]: SQL status: COMMENT in 0.083 seconds
[0m17:47:39.386167 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:47:39.387167 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'age_groups'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:47:39.467471 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.080 seconds
[0m17:47:39.473987 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:47:39.473987 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."age_groups".group is $dbt_comment_literal_block$Age group name for report$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."age_groups".age_start is $dbt_comment_literal_block$Start age of group$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."age_groups".age_end is $dbt_comment_literal_block$End age of group$dbt_comment_literal_block$;
  

  
[0m17:47:39.548036 [debug] [Thread-2 (]: SQL status: COMMENT in 0.073 seconds
[0m17:47:39.555025 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m17:47:39.555025 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:47:39.556023 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m17:47:39.639991 [debug] [Thread-2 (]: SQL status: COMMIT in 0.083 seconds
[0m17:47:39.642951 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m17:47:39.644975 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5177D8AA0>]}
[0m17:47:39.645976 [info ] [Thread-2 (]: 2 of 52 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 1.98s]
[0m17:47:39.647951 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m17:47:39.648951 [debug] [Thread-2 (]: Began running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m17:47:39.649951 [info ] [Thread-2 (]: 5 of 52 START test every_event_has_user ........................................ [RUN]
[0m17:47:39.650952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now test.dbt_scooters.every_event_has_user.7eea25f36c)
[0m17:47:39.650952 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m17:47:39.672092 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m17:47:39.673094 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m17:47:39.694086 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m17:47:39.696058 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m17:47:39.697056 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: BEGIN
[0m17:47:39.697056 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:39.780316 [debug] [Thread-4 (]: SQL status: BEGIN in 2.035 seconds
[0m17:47:39.781305 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:47:39.782272 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    create table "dev_gom1"."dbt"."scooters" ("company" text,"model" text,"hardware_id" text,"scooters" integer)
  
[0m17:47:39.797316 [debug] [Thread-1 (]: SQL status: BEGIN in 2.054 seconds
[0m17:47:39.798271 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:47:39.799271 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    create table "dev_gom1"."dbt"."add_first_name_sex" ("first_name" text,"sex" text)
  
[0m17:47:39.870323 [debug] [Thread-4 (]: SQL status: CREATE TABLE in 0.088 seconds
[0m17:47:39.875325 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:47:39.876325 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_gom1"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m17:47:39.888287 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.088 seconds
[0m17:47:39.890287 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:47:39.891287 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: 
          insert into "dev_gom1"."dbt"."add_first_name_sex" ("first_name", "sex") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m17:47:39.945335 [debug] [Thread-4 (]: SQL status: INSERT 0 10 in 0.069 seconds
[0m17:47:39.947330 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m17:47:39.952293 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:47:39.953291 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  comment on table "dev_gom1"."dbt"."scooters" is $dbt_comment_literal_block$Scooter models information and park statistics by model. Includes information about the manufacturing company. Data received from the service team and uploaded by Mark. Data is current as of summer 2023.
$dbt_comment_literal_block$;

  
[0m17:47:39.965990 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.074 seconds
[0m17:47:39.966989 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.add_first_name_sex"
[0m17:47:39.969991 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:47:39.970990 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  comment on table "dev_gom1"."dbt"."add_first_name_sex" is $dbt_comment_literal_block$additional name_sex glossary$dbt_comment_literal_block$;

  
[0m17:47:40.017031 [debug] [Thread-4 (]: SQL status: COMMENT in 0.063 seconds
[0m17:47:40.022032 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:47:40.022032 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'scooters'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:47:40.038996 [debug] [Thread-1 (]: SQL status: COMMENT in 0.068 seconds
[0m17:47:40.043991 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:47:40.045998 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'add_first_name_sex'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:47:40.095092 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.072 seconds
[0m17:47:40.098091 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:47:40.098091 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."scooters".company is $dbt_comment_literal_block$Scooter company model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."scooters".model is $dbt_comment_literal_block$Scooter model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."scooters".hardware_id is $dbt_comment_literal_block$scooter model id$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."scooters".scooters is $dbt_comment_literal_block$Count of scooters$dbt_comment_literal_block$;
  

  
[0m17:47:40.186209 [debug] [Thread-4 (]: SQL status: COMMENT in 0.087 seconds
[0m17:47:40.189212 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m17:47:40.190223 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:47:40.190223 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m17:47:40.197222 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.151 seconds
[0m17:47:40.199236 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:47:40.200234 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."add_first_name_sex".first_name is $dbt_comment_literal_block$First name of user$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."add_first_name_sex".sex is $dbt_comment_literal_block$user gender$dbt_comment_literal_block$;
  

  
[0m17:47:40.255278 [debug] [Thread-4 (]: SQL status: COMMIT in 0.065 seconds
[0m17:47:40.257793 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: Close
[0m17:47:40.259307 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51BD45C40>]}
[0m17:47:40.259307 [info ] [Thread-4 (]: 4 of 52 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 2.59s]
[0m17:47:40.261326 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.scooters
[0m17:47:40.262326 [debug] [Thread-4 (]: Began running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m17:47:40.263318 [info ] [Thread-4 (]: 6 of 52 START test every_trip_has_user ......................................... [RUN]
[0m17:47:40.264319 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now test.dbt_scooters.every_trip_has_user.6bc71135e2)
[0m17:47:40.265323 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m17:47:40.273356 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m17:47:40.276334 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m17:47:40.279351 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m17:47:40.281353 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m17:47:40.282320 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: BEGIN
[0m17:47:40.282320 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:40.286350 [debug] [Thread-1 (]: SQL status: COMMENT in 0.085 seconds
[0m17:47:40.288320 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m17:47:40.288320 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:47:40.289352 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m17:47:40.360129 [debug] [Thread-1 (]: SQL status: COMMIT in 0.071 seconds
[0m17:47:40.362082 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: Close
[0m17:47:40.363082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51D9F7500>]}
[0m17:47:40.364083 [info ] [Thread-1 (]: 1 of 52 OK loaded seed file dbt.add_first_name_sex ............................. [[32mINSERT 5[0m in 2.70s]
[0m17:47:40.365082 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.add_first_name_sex
[0m17:47:40.366118 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m17:47:40.367121 [info ] [Thread-1 (]: 7 of 52 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m17:47:40.369090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.add_first_name_sex, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m17:47:40.369090 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m17:47:40.381088 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m17:47:40.383090 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m17:47:40.386088 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m17:47:40.389082 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m17:47:40.390083 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m17:47:40.391088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:40.667344 [debug] [Thread-3 (]: SQL status: BEGIN in 2.922 seconds
[0m17:47:40.668347 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:47:40.668347 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    create table "dev_gom1"."dbt"."event_types" ("type_id" integer,"type" text)
  
[0m17:47:40.736922 [debug] [Thread-3 (]: SQL status: CREATE TABLE in 0.067 seconds
[0m17:47:40.739932 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:47:40.739932 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_gom1"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m17:47:40.804999 [debug] [Thread-3 (]: SQL status: INSERT 0 4 in 0.064 seconds
[0m17:47:40.806994 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m17:47:40.811006 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:47:40.812003 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  comment on table "dev_gom1"."dbt"."event_types" is $dbt_comment_literal_block$Table provides a mapping between unique event type identifiers (`type_id`) and their descriptive names (`type`). It is essential for converting numerical codes from user activity logs into readable descriptions for analysis of user interactions with application features.

The table is crucial for analytics and reporting, allowing for the decoding of event identifiers in user activity datasets. By joining with event logs, it facilitates intuitive reporting and dashboarding of user interactions. The mapping enables effective segmentation and analysis of user activities, such as:

- **start_search**: Represents the initiation of a search process by a user.
- **book_scooter**: Indicates that a user has booked a scooter.
- **release_scooter**: Signifies that a user has released a previously booked scooter.
- **cancel_search**: Denotes the cancellation of a search process by a user.$dbt_comment_literal_block$;

  
[0m17:47:40.877132 [debug] [Thread-3 (]: SQL status: COMMENT in 0.064 seconds
[0m17:47:40.881143 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:47:40.882138 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'event_types'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:47:40.957697 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.075 seconds
[0m17:47:40.960246 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:47:40.961251 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."event_types".type_id is $dbt_comment_literal_block$An integer serving as a unique identifier for each event type. It is used in user event tables as a foreign key to link events to their descriptions
$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."event_types".type is $dbt_comment_literal_block$A string describing the event type, enhancing the interpretability of event data by providing a human-readable label
$dbt_comment_literal_block$;
  

  
[0m17:47:41.027280 [debug] [Thread-3 (]: SQL status: COMMENT in 0.065 seconds
[0m17:47:41.029298 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m17:47:41.030298 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:47:41.031298 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m17:47:41.102923 [debug] [Thread-3 (]: SQL status: COMMIT in 0.072 seconds
[0m17:47:41.104925 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: Close
[0m17:47:41.105937 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51DA1AF60>]}
[0m17:47:41.106929 [info ] [Thread-3 (]: 3 of 52 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 3.44s]
[0m17:47:41.108924 [debug] [Thread-3 (]: Finished running node seed.dbt_scooters.event_types
[0m17:47:41.108924 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m17:47:41.109934 [info ] [Thread-3 (]: 8 of 52 START test source_not_null_scooters_raw_events_type_id ................. [RUN]
[0m17:47:41.110930 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7)
[0m17:47:41.111934 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m17:47:41.119936 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m17:47:41.121946 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m17:47:41.125939 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m17:47:41.127941 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m17:47:41.128942 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: BEGIN
[0m17:47:41.128942 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:41.767449 [debug] [Thread-2 (]: SQL status: BEGIN in 2.070 seconds
[0m17:47:41.768447 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m17:47:41.768447 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_user.7eea25f36c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_gom1"."scooters_raw"."events"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_gom1"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:47:42.489981 [debug] [Thread-3 (]: SQL status: BEGIN in 1.360 seconds
[0m17:47:42.490981 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m17:47:42.490981 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from "dev_gom1"."scooters_raw"."events"
where type_id is null



      
    ) dbt_internal_test
[0m17:47:42.872250 [debug] [Thread-1 (]: SQL status: BEGIN in 2.481 seconds
[0m17:47:42.873253 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m17:47:42.874252 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_gom1"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m17:47:42.888253 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.119 seconds
[0m17:47:42.892251 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: ROLLBACK
[0m17:47:42.893252 [debug] [Thread-4 (]: SQL status: BEGIN in 2.611 seconds
[0m17:47:42.894252 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m17:47:42.895253 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_user.6bc71135e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_gom1"."scooters_raw"."trips"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_gom1"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:47:42.989178 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: Close
[0m17:47:42.990185 [info ] [Thread-2 (]: 5 of 52 PASS every_event_has_user .............................................. [[32mPASS[0m in 3.34s]
[0m17:47:42.992181 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m17:47:42.993180 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.118 seconds
[0m17:47:42.993180 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m17:47:42.995219 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m17:47:42.996183 [info ] [Thread-2 (]: 9 of 52 START test source_not_null_scooters_raw_events_user_id ................. [RUN]
[0m17:47:42.998181 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_user.7eea25f36c, now test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b)
[0m17:47:42.998181 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m17:47:43.003185 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m17:47:43.005185 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m17:47:43.011196 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m17:47:43.015195 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m17:47:43.015195 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: BEGIN
[0m17:47:43.016193 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:43.065238 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m17:47:43.066239 [info ] [Thread-1 (]: 7 of 52 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 2.70s]
[0m17:47:43.068237 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m17:47:43.070247 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m17:47:43.071254 [info ] [Thread-1 (]: 10 of 52 START test source_not_null_scooters_raw_trips_id ...................... [RUN]
[0m17:47:43.073245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d)
[0m17:47:43.074247 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m17:47:43.080245 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m17:47:43.083248 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m17:47:43.086248 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m17:47:43.088247 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m17:47:43.089253 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: BEGIN
[0m17:47:43.090283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:43.299325 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.807 seconds
[0m17:47:43.301332 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: ROLLBACK
[0m17:47:43.387947 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: Close
[0m17:47:43.389942 [info ] [Thread-3 (]: 8 of 52 PASS source_not_null_scooters_raw_events_type_id ....................... [[32mPASS[0m in 2.28s]
[0m17:47:43.390902 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m17:47:43.391906 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m17:47:43.392903 [info ] [Thread-3 (]: 11 of 52 START test source_not_null_scooters_raw_trips_scooter_hw_id ........... [RUN]
[0m17:47:43.393906 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7, now test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f)
[0m17:47:43.393906 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m17:47:43.398949 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m17:47:43.402902 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m17:47:43.404937 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m17:47:43.406903 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m17:47:43.406903 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: BEGIN
[0m17:47:43.407939 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:43.492121 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.596 seconds
[0m17:47:43.494122 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: ROLLBACK
[0m17:47:43.560679 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: Close
[0m17:47:43.562731 [info ] [Thread-4 (]: 6 of 52 PASS every_trip_has_user ............................................... [[32mPASS[0m in 3.30s]
[0m17:47:43.563731 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m17:47:43.564690 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m17:47:43.565725 [info ] [Thread-4 (]: 12 of 52 START test source_not_null_scooters_raw_trips_user_id ................. [RUN]
[0m17:47:43.566690 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_user.6bc71135e2, now test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62)
[0m17:47:43.567734 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m17:47:43.572288 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m17:47:43.574291 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m17:47:43.577324 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m17:47:43.578288 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m17:47:43.579325 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: BEGIN
[0m17:47:43.580323 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:44.490045 [debug] [Thread-1 (]: SQL status: BEGIN in 1.400 seconds
[0m17:47:44.491008 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m17:47:44.492008 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_gom1"."scooters_raw"."trips"
where id is null



      
    ) dbt_internal_test
[0m17:47:44.575223 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.083 seconds
[0m17:47:44.578187 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: ROLLBACK
[0m17:47:44.646187 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: Close
[0m17:47:44.647195 [info ] [Thread-1 (]: 10 of 52 PASS source_not_null_scooters_raw_trips_id ............................ [[32mPASS[0m in 1.57s]
[0m17:47:44.649191 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m17:47:44.649191 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m17:47:44.650252 [info ] [Thread-1 (]: 13 of 52 START test source_not_null_scooters_raw_users_id ...................... [RUN]
[0m17:47:44.651233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d, now test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d)
[0m17:47:44.652205 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m17:47:44.657234 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m17:47:44.659209 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m17:47:44.662733 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m17:47:44.664736 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m17:47:44.665741 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: BEGIN
[0m17:47:44.665741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:45.125187 [debug] [Thread-2 (]: SQL status: BEGIN in 2.109 seconds
[0m17:47:45.126149 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m17:47:45.126149 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_gom1"."scooters_raw"."events"
where user_id is null



      
    ) dbt_internal_test
[0m17:47:45.587081 [debug] [Thread-3 (]: SQL status: BEGIN in 2.179 seconds
[0m17:47:45.587081 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m17:47:45.588087 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select scooter_hw_id
from "dev_gom1"."scooters_raw"."trips"
where scooter_hw_id is null



      
    ) dbt_internal_test
[0m17:47:45.592074 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.465 seconds
[0m17:47:45.594038 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: ROLLBACK
[0m17:47:45.687257 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: Close
[0m17:47:45.688258 [info ] [Thread-2 (]: 9 of 52 PASS source_not_null_scooters_raw_events_user_id ....................... [[32mPASS[0m in 2.69s]
[0m17:47:45.689264 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m17:47:45.690268 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m17:47:45.691302 [info ] [Thread-2 (]: 14 of 52 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m17:47:45.692265 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m17:47:45.693297 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m17:47:45.698266 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m17:47:45.699308 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m17:47:45.702301 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m17:47:45.705265 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m17:47:45.705265 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m17:47:45.706266 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:45.792138 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.203 seconds
[0m17:47:45.794130 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: ROLLBACK
[0m17:47:45.859137 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: Close
[0m17:47:45.860126 [info ] [Thread-3 (]: 11 of 52 PASS source_not_null_scooters_raw_trips_scooter_hw_id ................. [[32mPASS[0m in 2.47s]
[0m17:47:45.861093 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m17:47:45.862093 [debug] [Thread-4 (]: SQL status: BEGIN in 2.282 seconds
[0m17:47:45.863093 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m17:47:45.863093 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m17:47:45.864125 [info ] [Thread-3 (]: 15 of 52 START test source_unique_scooters_raw_trips_id ........................ [RUN]
[0m17:47:45.865383 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_gom1"."scooters_raw"."trips"
where user_id is null



      
    ) dbt_internal_test
[0m17:47:45.865383 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f, now test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4)
[0m17:47:45.866418 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m17:47:45.874386 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m17:47:45.876386 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m17:47:45.880904 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m17:47:45.881905 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m17:47:45.882905 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: BEGIN
[0m17:47:45.882905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:45.916914 [debug] [Thread-1 (]: SQL status: BEGIN in 1.250 seconds
[0m17:47:45.916914 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m17:47:45.917950 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_gom1"."scooters_raw"."users"
where id is null



      
    ) dbt_internal_test
[0m17:47:45.986136 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.067 seconds
[0m17:47:45.988169 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: ROLLBACK
[0m17:47:45.992161 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.126 seconds
[0m17:47:45.994166 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: ROLLBACK
[0m17:47:46.053177 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: Close
[0m17:47:46.054169 [info ] [Thread-1 (]: 13 of 52 PASS source_not_null_scooters_raw_users_id ............................ [[32mPASS[0m in 1.40s]
[0m17:47:46.056131 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m17:47:46.057129 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m17:47:46.058130 [info ] [Thread-1 (]: 16 of 52 START test source_unique_scooters_raw_users_id ........................ [RUN]
[0m17:47:46.059131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d, now test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf)
[0m17:47:46.059131 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m17:47:46.064642 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m17:47:46.065657 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: Close
[0m17:47:46.066649 [info ] [Thread-4 (]: 12 of 52 PASS source_not_null_scooters_raw_trips_user_id ....................... [[32mPASS[0m in 2.50s]
[0m17:47:46.067649 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m17:47:46.069161 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m17:47:46.070178 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m17:47:46.071173 [info ] [Thread-4 (]: 17 of 52 START test unique_not_null_age_groups_age_end ......................... [RUN]
[0m17:47:46.074175 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m17:47:46.075175 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62, now test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac)
[0m17:47:46.076171 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m17:47:46.082185 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m17:47:46.083184 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m17:47:46.084182 [debug] [Thread-1 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: BEGIN
[0m17:47:46.085181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:46.086182 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m17:47:46.089201 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m17:47:46.091197 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m17:47:46.092205 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: BEGIN
[0m17:47:46.092205 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:46.802350 [debug] [Thread-2 (]: SQL status: BEGIN in 1.096 seconds
[0m17:47:46.803354 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m17:47:46.803354 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sex
from "dev_gom1"."scooters_raw"."users"
where sex is null



      
    ) dbt_internal_test
[0m17:47:46.870424 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.066 seconds
[0m17:47:46.872422 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m17:47:46.936972 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m17:47:46.937973 [warn ] [Thread-2 (]: 14 of 52 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 1.25s]
[0m17:47:46.939987 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m17:47:46.940986 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m17:47:46.941990 [info ] [Thread-2 (]: 18 of 52 START test unique_not_null_age_groups_age_start ....................... [RUN]
[0m17:47:46.942985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b)
[0m17:47:46.943984 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m17:47:46.947986 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m17:47:46.950992 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m17:47:46.953993 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m17:47:46.954993 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m17:47:46.955990 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: BEGIN
[0m17:47:46.956994 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:48.050892 [debug] [Thread-4 (]: SQL status: BEGIN in 1.959 seconds
[0m17:47:48.051891 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m17:47:48.052891 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_end"
from
    "dev_gom1"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_end" is null


      
    ) dbt_internal_test
[0m17:47:48.120938 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.067 seconds
[0m17:47:48.122938 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: ROLLBACK
[0m17:47:48.188980 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: Close
[0m17:47:48.189982 [info ] [Thread-4 (]: 17 of 52 PASS unique_not_null_age_groups_age_end ............................... [[32mPASS[0m in 2.12s]
[0m17:47:48.191983 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m17:47:48.192984 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m17:47:48.192984 [info ] [Thread-4 (]: 19 of 52 START test unique_not_null_age_groups_group ........................... [RUN]
[0m17:47:48.194983 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac, now test.dbt_scooters.unique_not_null_age_groups_group.39342291f1)
[0m17:47:48.194983 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m17:47:48.200979 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m17:47:48.202978 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m17:47:48.206012 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m17:47:48.207981 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m17:47:48.207981 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: BEGIN
[0m17:47:48.209011 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:48.302224 [debug] [Thread-1 (]: SQL status: BEGIN in 2.217 seconds
[0m17:47:48.303223 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m17:47:48.304225 [debug] [Thread-1 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_gom1"."scooters_raw"."users"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:47:48.374453 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.070 seconds
[0m17:47:48.377411 [debug] [Thread-1 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: ROLLBACK
[0m17:47:48.445011 [debug] [Thread-1 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: Close
[0m17:47:48.446014 [info ] [Thread-1 (]: 16 of 52 PASS source_unique_scooters_raw_users_id .............................. [[32mPASS[0m in 2.39s]
[0m17:47:48.448005 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m17:47:48.449015 [debug] [Thread-1 (]: Began running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m17:47:48.449978 [info ] [Thread-1 (]: 20 of 52 START test every_trip_has_scooter_id .................................. [RUN]
[0m17:47:48.451013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf, now test.dbt_scooters.every_trip_has_scooter_id.e0b845a190)
[0m17:47:48.452015 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m17:47:48.460018 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m17:47:48.462985 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m17:47:48.466019 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m17:47:48.467015 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m17:47:48.468241 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: BEGIN
[0m17:47:48.469243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:48.897117 [debug] [Thread-3 (]: SQL status: BEGIN in 3.014 seconds
[0m17:47:48.898105 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m17:47:48.899069 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_gom1"."scooters_raw"."trips"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:47:48.978910 [debug] [Thread-2 (]: SQL status: BEGIN in 2.022 seconds
[0m17:47:48.979919 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m17:47:48.979919 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_start"
from
    "dev_gom1"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_start" is null


      
    ) dbt_internal_test
[0m17:47:49.087018 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.106 seconds
[0m17:47:49.089017 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: ROLLBACK
[0m17:47:49.186065 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: Close
[0m17:47:49.187068 [info ] [Thread-2 (]: 18 of 52 PASS unique_not_null_age_groups_age_start ............................. [[32mPASS[0m in 2.24s]
[0m17:47:49.189068 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m17:47:49.191066 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m17:47:49.191066 [info ] [Thread-2 (]: 21 of 52 START test unique_key_scooters_company__model__hardware_id ............ [RUN]
[0m17:47:49.193068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b, now test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e)
[0m17:47:49.194071 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m17:47:49.203068 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m17:47:49.207064 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m17:47:49.213078 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m17:47:49.216076 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m17:47:49.217078 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: BEGIN
[0m17:47:49.218076 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:49.796003 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.896 seconds
[0m17:47:49.798002 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: ROLLBACK
[0m17:47:49.865003 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: Close
[0m17:47:49.866003 [info ] [Thread-3 (]: 15 of 52 PASS source_unique_scooters_raw_trips_id .............................. [[32mPASS[0m in 4.00s]
[0m17:47:49.868005 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m17:47:49.869254 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m17:47:49.870253 [info ] [Thread-3 (]: 22 of 52 START test unique_not_null_scooters_hardware_id ....................... [RUN]
[0m17:47:49.871260 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4, now test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d)
[0m17:47:49.872256 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m17:47:49.940323 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m17:47:49.944292 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m17:47:49.946321 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m17:47:49.948291 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m17:47:49.949330 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: BEGIN
[0m17:47:49.950292 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:50.224233 [debug] [Thread-4 (]: SQL status: BEGIN in 2.015 seconds
[0m17:47:50.225238 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m17:47:50.227235 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "group"
from
    "dev_gom1"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "group" is null


      
    ) dbt_internal_test
[0m17:47:50.294065 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.066 seconds
[0m17:47:50.297057 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: ROLLBACK
[0m17:47:50.362022 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: Close
[0m17:47:50.363023 [info ] [Thread-4 (]: 19 of 52 PASS unique_not_null_age_groups_group ................................. [[32mPASS[0m in 2.17s]
[0m17:47:50.365021 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m17:47:50.366022 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m17:47:50.367070 [info ] [Thread-4 (]: 23 of 52 START test unique_not_null_scooters_model ............................. [RUN]
[0m17:47:50.368583 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_group.39342291f1, now test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc)
[0m17:47:50.369592 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m17:47:50.376626 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m17:47:50.379109 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m17:47:50.382121 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m17:47:50.385155 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m17:47:50.386156 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: BEGIN
[0m17:47:50.387123 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:50.464164 [debug] [Thread-1 (]: SQL status: BEGIN in 1.995 seconds
[0m17:47:50.465162 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m17:47:50.466202 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select scooter_hw_id as from_field
    from "dev_gom1"."scooters_raw"."trips"
    where scooter_hw_id is not null
),

parent as (
    select hardware_id as to_field
    from "dev_gom1"."dbt"."scooters"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:47:50.810225 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.343 seconds
[0m17:47:50.812226 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: ROLLBACK
[0m17:47:50.891032 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: Close
[0m17:47:50.892032 [info ] [Thread-1 (]: 20 of 52 PASS every_trip_has_scooter_id ........................................ [[32mPASS[0m in 2.44s]
[0m17:47:50.894034 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m17:47:50.895068 [debug] [Thread-1 (]: Began running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m17:47:50.896066 [info ] [Thread-1 (]: 24 of 52 START test accepted_values_add_first_name_sex_sex__M__F ............... [RUN]
[0m17:47:50.897027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_scooter_id.e0b845a190, now test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199)
[0m17:47:50.898067 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m17:47:50.904069 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m17:47:50.906073 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m17:47:50.909031 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m17:47:50.911068 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m17:47:50.912061 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: BEGIN
[0m17:47:50.913031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:51.086000 [debug] [Thread-3 (]: SQL status: BEGIN in 1.136 seconds
[0m17:47:51.086999 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m17:47:51.088001 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "hardware_id"
from
    "dev_gom1"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "hardware_id" is null


      
    ) dbt_internal_test
[0m17:47:51.155016 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.067 seconds
[0m17:47:51.159014 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: ROLLBACK
[0m17:47:51.203287 [debug] [Thread-2 (]: SQL status: BEGIN in 1.985 seconds
[0m17:47:51.206246 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m17:47:51.206246 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "company"::text ||
    
        "model"::text ||
    
        "hardware_id"::text ||
    
    ''
from
    "dev_gom1"."dbt"."scooters"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m17:47:51.238241 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: Close
[0m17:47:51.239242 [info ] [Thread-3 (]: 22 of 52 PASS unique_not_null_scooters_hardware_id ............................. [[32mPASS[0m in 1.37s]
[0m17:47:51.241244 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m17:47:51.242242 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m17:47:51.243244 [info ] [Thread-3 (]: 25 of 52 START test unique_not_null_add_first_name_sex_first_name .............. [RUN]
[0m17:47:51.244243 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d, now test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f)
[0m17:47:51.245241 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m17:47:51.250275 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m17:47:51.253245 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m17:47:51.256278 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m17:47:51.258240 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m17:47:51.259244 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: BEGIN
[0m17:47:51.259244 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:51.284298 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.077 seconds
[0m17:47:51.287274 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: ROLLBACK
[0m17:47:51.358262 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: Close
[0m17:47:51.359262 [info ] [Thread-2 (]: 21 of 52 PASS unique_key_scooters_company__model__hardware_id .................. [[32mPASS[0m in 2.17s]
[0m17:47:51.361270 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m17:47:51.361270 [debug] [Thread-2 (]: Began running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m17:47:51.362268 [info ] [Thread-2 (]: 26 of 52 START test every_event_has_type ....................................... [RUN]
[0m17:47:51.364263 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e, now test.dbt_scooters.every_event_has_type.1e5fc977eb)
[0m17:47:51.364263 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m17:47:51.372659 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m17:47:51.374633 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m17:47:51.377629 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m17:47:51.380165 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m17:47:51.381166 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: BEGIN
[0m17:47:51.382164 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:51.518061 [debug] [Thread-4 (]: SQL status: BEGIN in 1.131 seconds
[0m17:47:51.519014 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m17:47:51.520047 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "model"
from
    "dev_gom1"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "model" is null


      
    ) dbt_internal_test
[0m17:47:51.598166 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.077 seconds
[0m17:47:51.600217 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: ROLLBACK
[0m17:47:51.682191 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: Close
[0m17:47:51.683194 [info ] [Thread-4 (]: 23 of 52 PASS unique_not_null_scooters_model ................................... [[32mPASS[0m in 1.31s]
[0m17:47:51.685194 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m17:47:51.686194 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m17:47:51.687191 [info ] [Thread-4 (]: 27 of 52 START test unique_not_null_event_types_type ........................... [RUN]
[0m17:47:51.688192 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc, now test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1)
[0m17:47:51.689202 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m17:47:51.696199 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m17:47:51.699209 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m17:47:51.705204 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m17:47:51.707205 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m17:47:51.708212 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: BEGIN
[0m17:47:51.708212 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:52.003001 [debug] [Thread-1 (]: SQL status: BEGIN in 1.091 seconds
[0m17:47:52.004005 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m17:47:52.005006 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_gom1"."dbt"."add_first_name_sex"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m17:47:52.079068 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.073 seconds
[0m17:47:52.081080 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: ROLLBACK
[0m17:47:52.145121 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: Close
[0m17:47:52.146118 [info ] [Thread-1 (]: 24 of 52 PASS accepted_values_add_first_name_sex_sex__M__F ..................... [[32mPASS[0m in 1.25s]
[0m17:47:52.148123 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m17:47:52.149123 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m17:47:52.149123 [info ] [Thread-1 (]: 28 of 52 START test unique_not_null_event_types_type_id ........................ [RUN]
[0m17:47:52.151139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199, now test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85)
[0m17:47:52.152134 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m17:47:52.157132 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m17:47:52.160141 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m17:47:52.163137 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m17:47:52.165134 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m17:47:52.166136 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: BEGIN
[0m17:47:52.167135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:52.408897 [debug] [Thread-3 (]: SQL status: BEGIN in 1.149 seconds
[0m17:47:52.408897 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m17:47:52.409909 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "first_name"
from
    "dev_gom1"."dbt"."add_first_name_sex"
group by
    1
having
    count(*) > 1 or "first_name" is null


      
    ) dbt_internal_test
[0m17:47:52.480978 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.070 seconds
[0m17:47:52.484981 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: ROLLBACK
[0m17:47:52.553035 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: Close
[0m17:47:52.555035 [info ] [Thread-3 (]: 25 of 52 PASS unique_not_null_add_first_name_sex_first_name .................... [[32mPASS[0m in 1.31s]
[0m17:47:52.557045 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m17:47:52.558039 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_clean
[0m17:47:52.559033 [info ] [Thread-3 (]: 29 of 52 START sql incremental model dbt.events_clean .......................... [RUN]
[0m17:47:52.561051 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f, now model.dbt_scooters.events_clean)
[0m17:47:52.562045 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_clean
[0m17:47:52.576067 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m17:47:52.578069 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_clean
[0m17:47:52.654107 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:47:52.655107 [debug] [Thread-3 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp174752625104"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at

from
    "dev_gom1"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_gom1"."dbt"."events_clean")
    

  );
  
  
[0m17:47:52.656108 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:47:52.786184 [debug] [Thread-4 (]: SQL status: BEGIN in 1.077 seconds
[0m17:47:52.787150 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m17:47:52.787150 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type"
from
    "dev_gom1"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type" is null


      
    ) dbt_internal_test
[0m17:47:52.858185 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.070 seconds
[0m17:47:52.861184 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: ROLLBACK
[0m17:47:52.926045 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: Close
[0m17:47:52.928043 [info ] [Thread-4 (]: 27 of 52 PASS unique_not_null_event_types_type ................................. [[32mPASS[0m in 1.24s]
[0m17:47:52.929004 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m17:47:52.930049 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_prep
[0m17:47:52.931043 [info ] [Thread-4 (]: 30 of 52 START sql view model dbt.events_prep .................................. [RUN]
[0m17:47:52.932048 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1, now model.dbt_scooters.events_prep)
[0m17:47:52.933039 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_prep
[0m17:47:52.937044 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_prep"
[0m17:47:52.938044 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_prep
[0m17:47:52.964012 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_prep"
[0m17:47:52.966005 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:47:52.967007 [debug] [Thread-4 (]: On model.dbt_scooters.events_prep: BEGIN
[0m17:47:52.968005 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:53.255158 [debug] [Thread-1 (]: SQL status: BEGIN in 1.089 seconds
[0m17:47:53.256191 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m17:47:53.257192 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type_id"
from
    "dev_gom1"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type_id" is null


      
    ) dbt_internal_test
[0m17:47:53.322045 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.064 seconds
[0m17:47:53.324035 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: ROLLBACK
[0m17:47:53.374605 [debug] [Thread-2 (]: SQL status: BEGIN in 1.993 seconds
[0m17:47:53.375607 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m17:47:53.375607 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_type.1e5fc977eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type_id as from_field
    from "dev_gom1"."scooters_raw"."events"
    where type_id is not null
),

parent as (
    select type_id as to_field
    from "dev_gom1"."dbt"."event_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:47:53.389271 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: Close
[0m17:47:53.390254 [info ] [Thread-1 (]: 28 of 52 PASS unique_not_null_event_types_type_id .............................. [[32mPASS[0m in 1.24s]
[0m17:47:53.392220 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m17:47:53.393216 [debug] [Thread-1 (]: Began running node model.dbt_scooters.first_name_sex
[0m17:47:53.394254 [info ] [Thread-1 (]: 31 of 52 START sql table model dbt.first_name_sex .............................. [RUN]
[0m17:47:53.395220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85, now model.dbt_scooters.first_name_sex)
[0m17:47:53.396218 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.first_name_sex
[0m17:47:53.399217 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.first_name_sex"
[0m17:47:53.401219 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.first_name_sex
[0m17:47:53.418220 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.first_name_sex"
[0m17:47:53.420249 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:47:53.421220 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: BEGIN
[0m17:47:53.421220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:54.288313 [debug] [Thread-4 (]: SQL status: BEGIN in 1.321 seconds
[0m17:47:54.289310 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:47:54.290309 [debug] [Thread-4 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

  create view "dev_gom1"."dbt"."events_prep__dbt_tmp"
    
    
  as (
    select
    user_id,
    "timestamp",
    type_id,
    date("timestamp") as "date"
from
    "dev_gom1"."scooters_raw"."events"
  );
[0m17:47:54.394930 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.105 seconds
[0m17:47:54.402925 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:47:54.403889 [debug] [Thread-4 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
alter table "dev_gom1"."dbt"."events_prep" rename to "events_prep__dbt_backup"
[0m17:47:54.491143 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.115 seconds
[0m17:47:54.494102 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: ROLLBACK
[0m17:47:54.494102 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m17:47:54.499145 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:47:54.500142 [debug] [Thread-4 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
alter table "dev_gom1"."dbt"."events_prep__dbt_tmp" rename to "events_prep"
[0m17:47:54.568141 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.068 seconds
[0m17:47:54.572143 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:47:54.573693 [debug] [Thread-4 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

    
  
  comment on view "dev_gom1"."dbt"."events_prep" is $dbt_comment_literal_block$User events prepared for following processing$dbt_comment_literal_block$;

  
[0m17:47:54.586348 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: Close
[0m17:47:54.588308 [info ] [Thread-2 (]: 26 of 52 PASS every_event_has_type ............................................. [[32mPASS[0m in 3.22s]
[0m17:47:54.589317 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m17:47:54.590318 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_concurrency
[0m17:47:54.591321 [info ] [Thread-2 (]: 32 of 52 START sql incremental model dbt.trips_concurrency ..................... [RUN]
[0m17:47:54.592316 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_type.1e5fc977eb, now model.dbt_scooters.trips_concurrency)
[0m17:47:54.592316 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m17:47:54.597355 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m17:47:54.598904 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m17:47:54.603951 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:47:54.604914 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp174754601953"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_gom1"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_gom1"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_gom1"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_gom1"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now()  as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m17:47:54.604914 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:47:54.690159 [debug] [Thread-4 (]: SQL status: COMMENT in 0.115 seconds
[0m17:47:54.693159 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:47:54.694158 [debug] [Thread-4 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_prep'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:47:54.792029 [debug] [Thread-1 (]: SQL status: BEGIN in 1.370 seconds
[0m17:47:54.792984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:47:54.792984 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

  
    

  create  table "dev_gom1"."dbt"."first_name_sex__dbt_tmp"
  
  
    as
  
  (
    select distinct first_name, sex
from "dev_gom1"."scooters_raw"."users"
Where sex is not null
  );
  
[0m17:47:54.897234 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.202 seconds
[0m17:47:54.899234 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:47:54.900237 [debug] [Thread-4 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."events_prep".date is $dbt_comment_literal_block$Date of event derived from timestamp.
Imitates Hive-styled partitioning of events by date.
It is needed for efficient incremental processing by engines
with partitioning support (i.e. Trino).$dbt_comment_literal_block$;
  

  
[0m17:47:54.987460 [debug] [Thread-1 (]: SQL status: SELECT 387 in 0.193 seconds
[0m17:47:54.990977 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:47:54.991976 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_gom1"."dbt"."first_name_sex" rename to "first_name_sex__dbt_backup"
[0m17:47:54.994023 [debug] [Thread-4 (]: SQL status: COMMENT in 0.094 seconds
[0m17:47:54.996019 [debug] [Thread-4 (]: On model.dbt_scooters.events_prep: COMMIT
[0m17:47:54.996979 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:47:54.996979 [debug] [Thread-4 (]: On model.dbt_scooters.events_prep: COMMIT
[0m17:47:55.088225 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.096 seconds
[0m17:47:55.092184 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:47:55.092184 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_gom1"."dbt"."first_name_sex__dbt_tmp" rename to "first_name_sex"
[0m17:47:55.093185 [debug] [Thread-4 (]: SQL status: COMMIT in 0.096 seconds
[0m17:47:55.100228 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."events_prep__dbt_backup"
[0m17:47:55.106220 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:47:55.106220 [debug] [Thread-4 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
drop view if exists "dev_gom1"."dbt"."events_prep__dbt_backup" cascade
[0m17:47:55.158233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.065 seconds
[0m17:47:55.160232 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:47:55.161243 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

    
  
  comment on table "dev_gom1"."dbt"."first_name_sex" is $dbt_comment_literal_block$Unique name_sex glossary$dbt_comment_literal_block$;

  
[0m17:47:55.192019 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.084 seconds
[0m17:47:55.194059 [debug] [Thread-4 (]: On model.dbt_scooters.events_prep: Close
[0m17:47:55.194059 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51BCFD8E0>]}
[0m17:47:55.195056 [info ] [Thread-4 (]: 30 of 52 OK created sql view model dbt.events_prep ............................. [[32mCREATE VIEW[0m in 2.26s]
[0m17:47:55.197022 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_prep
[0m17:47:55.198016 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_geom
[0m17:47:55.198016 [info ] [Thread-4 (]: 33 of 52 START sql view model dbt.trips_geom ................................... [RUN]
[0m17:47:55.200022 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_prep, now model.dbt_scooters.trips_geom)
[0m17:47:55.200022 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_geom
[0m17:47:55.203054 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m17:47:55.204023 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_geom
[0m17:47:55.209052 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m17:47:55.211018 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m17:47:55.212053 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m17:47:55.213052 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:55.227018 [debug] [Thread-1 (]: SQL status: COMMENT in 0.065 seconds
[0m17:47:55.228052 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m17:47:55.229055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:47:55.229055 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m17:47:55.295229 [debug] [Thread-1 (]: SQL status: COMMIT in 0.065 seconds
[0m17:47:55.299236 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."first_name_sex__dbt_backup"
[0m17:47:55.303237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:47:55.305261 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
drop table if exists "dev_gom1"."dbt"."first_name_sex__dbt_backup" cascade
[0m17:47:55.392323 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.087 seconds
[0m17:47:55.394271 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: Close
[0m17:47:55.395270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51D9E49E0>]}
[0m17:47:55.396271 [info ] [Thread-1 (]: 31 of 52 OK created sql table model dbt.first_name_sex ......................... [[32mSELECT 387[0m in 2.00s]
[0m17:47:55.398273 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.first_name_sex
[0m17:47:55.399322 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m17:47:55.400317 [info ] [Thread-1 (]: 34 of 52 START sql view model dbt.trips_prep ................................... [RUN]
[0m17:47:55.401284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.first_name_sex, now model.dbt_scooters.trips_prep)
[0m17:47:55.401284 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m17:47:55.405317 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m17:47:55.407282 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m17:47:55.410316 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m17:47:55.412282 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:47:55.412282 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m17:47:55.413323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:56.492276 [debug] [Thread-4 (]: SQL status: BEGIN in 1.279 seconds
[0m17:47:56.493276 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m17:47:56.494277 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_gom1"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_gom1"."scooters_raw"."trips"
  );
[0m17:47:56.590201 [debug] [Thread-4 (]: Postgres adapter: Postgres error: function st_makepoint(double precision, double precision) does not exist
LINE 9:     st_setsrid(st_makepoint(start_lon, start_lat), 4326) as ...
                       ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m17:47:56.591162 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: ROLLBACK
[0m17:47:56.691087 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: Close
[0m17:47:56.697082 [debug] [Thread-4 (]: Database Error in model trips_geom (models\trips_geom.sql)
  function st_makepoint(double precision, double precision) does not exist
  LINE 9:     st_setsrid(st_makepoint(start_lon, start_lat), 4326) as ...
                         ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_scooters\models\trips_geom.sql
[0m17:47:56.698084 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51D9E3500>]}
[0m17:47:56.699084 [error] [Thread-4 (]: 33 of 52 ERROR creating sql view model dbt.trips_geom .......................... [[31mERROR[0m in 1.50s]
[0m17:47:56.700044 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_geom
[0m17:47:56.701044 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies
[0m17:47:56.702040 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.trips_geom' to be skipped because of status 'error'.  Reason: Database Error in model trips_geom (models\trips_geom.sql)
  function st_makepoint(double precision, double precision) does not exist
  LINE 9:     st_setsrid(st_makepoint(start_lon, start_lat), 4326) as ...
                         ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_scooters\models\trips_geom.sql.
[0m17:47:56.702040 [info ] [Thread-4 (]: 35 of 52 START sql table model dbt.companies ................................... [RUN]
[0m17:47:56.704044 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.companies)
[0m17:47:56.705067 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies
[0m17:47:56.709078 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m17:47:56.711078 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies
[0m17:47:56.715081 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m17:47:56.717044 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:47:56.717044 [debug] [Thread-4 (]: On model.dbt_scooters.companies: BEGIN
[0m17:47:56.718072 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:56.789325 [debug] [Thread-1 (]: SQL status: BEGIN in 1.376 seconds
[0m17:47:56.790327 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:47:56.790327 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_gom1"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select
    id,
    user_id,
    scooter_hw_id,
    started_at,
    finished_at,
    start_lat,
    start_lon,
    finish_lat,
    finish_lon,
    distance as distance_m,
    cast(price as decimal(20, 2)) / 100 as price_rub,
    extract(epoch from (finished_at - started_at)) as duration_s,
    finished_at <> started_at and price = 0 as is_free,
    
    date(started_at at time zone 'Europe/Moscow')
 as "date"
from
    "dev_gom1"."scooters_raw"."trips"
  );
[0m17:47:56.987524 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.197 seconds
[0m17:47:56.992037 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:47:56.993036 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_gom1"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m17:47:57.088185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m17:47:57.091191 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:47:57.092192 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_gom1"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m17:47:57.186718 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m17:47:57.187752 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:47:57.189259 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

    
  
  comment on view "dev_gom1"."dbt"."trips_prep" is $dbt_comment_literal_block$Trips prepared for analysis$dbt_comment_literal_block$;

  
[0m17:47:57.287863 [debug] [Thread-1 (]: SQL status: COMMENT in 0.098 seconds
[0m17:47:57.290459 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m17:47:57.291423 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:47:57.291423 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m17:47:57.389227 [debug] [Thread-1 (]: SQL status: COMMIT in 0.097 seconds
[0m17:47:57.392234 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."trips_prep__dbt_backup"
[0m17:47:57.393234 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:47:57.393234 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_gom1"."dbt"."trips_prep__dbt_backup" cascade
[0m17:47:57.585699 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.192 seconds
[0m17:47:57.587695 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m17:47:57.589242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51DA1DF70>]}
[0m17:47:57.590294 [info ] [Thread-1 (]: 34 of 52 OK created sql view model dbt.trips_prep .............................. [[32mCREATE VIEW[0m in 2.19s]
[0m17:47:57.591256 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m17:47:57.592288 [debug] [Thread-1 (]: Began running node model.dbt_scooters.users_full
[0m17:47:57.593249 [info ] [Thread-1 (]: 36 of 52 START sql table model dbt.users_full .................................. [RUN]
[0m17:47:57.594250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.users_full)
[0m17:47:57.594250 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.users_full
[0m17:47:57.598250 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.users_full"
[0m17:47:57.599263 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.users_full
[0m17:47:57.605286 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.users_full"
[0m17:47:57.606251 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:47:57.607294 [debug] [Thread-1 (]: On model.dbt_scooters.users_full: BEGIN
[0m17:47:57.607294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:58.185811 [debug] [Thread-4 (]: SQL status: BEGIN in 1.468 seconds
[0m17:47:58.186806 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:47:58.186806 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_gom1"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_gom1"."dbt"."scooters"
group by
    1
  );
  
[0m17:47:58.487610 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.300 seconds
[0m17:47:58.491166 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:47:58.492168 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_gom1"."dbt"."companies__dbt_tmp" rename to "companies"
[0m17:47:58.584779 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m17:47:58.587773 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:47:58.587773 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

    
  
  comment on table "dev_gom1"."dbt"."companies" is $dbt_comment_literal_block$Scooter statistics by company$dbt_comment_literal_block$;

  
[0m17:47:58.685565 [debug] [Thread-4 (]: SQL status: COMMENT in 0.097 seconds
[0m17:47:58.687605 [debug] [Thread-4 (]: On model.dbt_scooters.companies: COMMIT
[0m17:47:58.687605 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:47:58.687605 [debug] [Thread-4 (]: On model.dbt_scooters.companies: COMMIT
[0m17:47:58.790379 [debug] [Thread-4 (]: SQL status: COMMIT in 0.101 seconds
[0m17:47:58.792378 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."companies__dbt_backup"
[0m17:47:58.793384 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:47:58.794387 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_gom1"."dbt"."companies__dbt_backup" cascade
[0m17:47:58.886542 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.092 seconds
[0m17:47:58.886542 [debug] [Thread-3 (]: SQL status: SELECT 101377 in 6.231 seconds
[0m17:47:58.889088 [debug] [Thread-4 (]: On model.dbt_scooters.companies: Close
[0m17:47:58.892137 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:47:58.893141 [debug] [Thread-3 (]: On model.dbt_scooters.events_clean: BEGIN
[0m17:47:58.894098 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51BD45A90>]}
[0m17:47:58.895137 [info ] [Thread-4 (]: 35 of 52 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 2.19s]
[0m17:47:58.896103 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies
[0m17:47:58.896103 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m17:47:58.897137 [info ] [Thread-4 (]: 37 of 52 SKIP relation dbt.parking_finish_stat ................................. [[33mSKIP[0m]
[0m17:47:58.898094 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m17:47:58.899101 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_start_stat
[0m17:47:58.899101 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.parking_finish_stat' to be skipped because of status 'skipped'. 
[0m17:47:58.900097 [info ] [Thread-4 (]: 38 of 52 SKIP relation dbt.parking_start_stat .................................. [[33mSKIP[0m]
[0m17:47:58.901098 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m17:47:58.902100 [debug] [Thread-4 (]: Began running node model.dbt_scooters.revenue_daily
[0m17:47:58.903098 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.parking_start_stat' to be skipped because of status 'skipped'. 
[0m17:47:58.904103 [info ] [Thread-4 (]: 39 of 52 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m17:47:58.906135 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.revenue_daily)
[0m17:47:58.906135 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m17:47:58.912137 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m17:47:58.914133 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.revenue_daily
[0m17:47:58.935107 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:47:58.936111 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
select * from (
        select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep"

group by
    2,
    3
order by
    2
    ) as __dbt_sbq
    where false
    limit 0

[0m17:47:58.937111 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:47:58.986653 [debug] [Thread-3 (]: SQL status: BEGIN in 0.092 seconds
[0m17:47:58.986653 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:47:58.987659 [debug] [Thread-3 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp174752625104'
        
      order by ordinal_position

  
[0m17:47:59.086741 [debug] [Thread-1 (]: SQL status: BEGIN in 1.479 seconds
[0m17:47:59.086741 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:47:59.087745 [debug] [Thread-1 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

  
    

  create  table "dev_gom1"."dbt"."users_full__dbt_tmp"
  
  
    as
  
  (
    select
   u.id, u.first_name ,u.last_name ,u.phone ,
   COALESCE(u.sex, fns.sex, afns.sex) as sex2,
   u.birth_date
from "dev_gom1"."scooters_raw"."users" u
left join "dev_gom1"."dbt"."first_name_sex" fns on u.first_name = fns.first_name
left join "dev_gom1"."dbt"."add_first_name_sex" afns on u.first_name =afns.first_name
  );
  
[0m17:47:59.187820 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.200 seconds
[0m17:47:59.192342 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:47:59.192342 [debug] [Thread-3 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:47:59.287429 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.094 seconds
[0m17:47:59.301948 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:47:59.301948 [debug] [Thread-3 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp174752625104'
        
      order by ordinal_position

  
[0m17:47:59.386513 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.084 seconds
[0m17:47:59.392033 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:47:59.393029 [debug] [Thread-3 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:47:59.489094 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.096 seconds
[0m17:47:59.500106 [debug] [Thread-3 (]: 
    In "dev_gom1"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:47:59.500106 [debug] [Thread-1 (]: SQL status: SELECT 2000 in 0.412 seconds
[0m17:47:59.518113 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m17:47:59.522123 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:47:59.523123 [debug] [Thread-1 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_gom1"."dbt"."users_full__dbt_tmp" rename to "users_full"
[0m17:47:59.524122 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:47:59.524122 [debug] [Thread-3 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        
            delete from "dev_gom1"."dbt"."events_clean"
            using "events_clean__dbt_tmp174752625104"
            where (
                
                    "events_clean__dbt_tmp174752625104".user_id = "dev_gom1"."dbt"."events_clean".user_id
                    and 
                
                    "events_clean__dbt_tmp174752625104".timestamp = "dev_gom1"."dbt"."events_clean".timestamp
                    and 
                
                    "events_clean__dbt_tmp174752625104".type_id = "dev_gom1"."dbt"."events_clean".type_id
                    
                
                
            );
        
    

    insert into "dev_gom1"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp174752625104"
    )
  
[0m17:47:59.587672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.065 seconds
[0m17:47:59.590186 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:47:59.593186 [debug] [Thread-1 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

    
  
  comment on table "dev_gom1"."dbt"."users_full" is $dbt_comment_literal_block$Users enriched with sex$dbt_comment_literal_block$;

  
[0m17:47:59.686744 [debug] [Thread-1 (]: SQL status: COMMENT in 0.092 seconds
[0m17:47:59.687745 [debug] [Thread-1 (]: On model.dbt_scooters.users_full: COMMIT
[0m17:47:59.687745 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:47:59.689254 [debug] [Thread-1 (]: On model.dbt_scooters.users_full: COMMIT
[0m17:47:59.785845 [debug] [Thread-1 (]: SQL status: COMMIT in 0.096 seconds
[0m17:47:59.787845 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."users_full__dbt_backup"
[0m17:47:59.789354 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:47:59.789354 [debug] [Thread-1 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
drop table if exists "dev_gom1"."dbt"."users_full__dbt_backup" cascade
[0m17:47:59.885439 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.095 seconds
[0m17:47:59.887439 [debug] [Thread-1 (]: On model.dbt_scooters.users_full: Close
[0m17:47:59.888948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51D42AE40>]}
[0m17:47:59.888948 [info ] [Thread-1 (]: 36 of 52 OK created sql table model dbt.users_full ............................. [[32mSELECT 2000[0m in 2.29s]
[0m17:47:59.889960 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.users_full
[0m17:47:59.890963 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_stat
[0m17:47:59.891960 [info ] [Thread-1 (]: 40 of 52 START sql table model dbt.trips_stat .................................. [RUN]
[0m17:47:59.892957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.users_full, now model.dbt_scooters.trips_stat)
[0m17:47:59.893964 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_stat
[0m17:47:59.895959 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m17:47:59.897956 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_stat
[0m17:47:59.900964 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m17:47:59.902970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:47:59.902970 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m17:47:59.903969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:00.589138 [debug] [Thread-4 (]: SQL status: SELECT 0 in 1.652 seconds
[0m17:48:00.604152 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:48:00.605152 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
select * from (
        select
    
      
    cast(null as decimal(20, 2))
 as revenue_rub, 
      
    cast(null as date)
 as date, 
      
    cast(null as timestamptz)
 as updated_at
    ) as __dbt_sbq
    where false
    limit 0

[0m17:48:00.686817 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.080 seconds
[0m17:48:00.706016 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m17:48:00.707972 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:48:00.707972 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m17:48:00.777018 [debug] [Thread-4 (]: SQL status: BEGIN in 0.068 seconds
[0m17:48:00.778028 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:48:00.778028 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
  
    

  create  table "dev_gom1"."finance"."revenue_daily"
  
  
    
  
  (
    revenue_rub decimal(20, 2),
    date date,
    updated_at timestamptz
    
    )
 ;
    insert into "dev_gom1"."finance"."revenue_daily" (
      revenue_rub, date, updated_at
    )
  
  (
    
    select revenue_rub, date, updated_at
    from (
        select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep"

group by
    2,
    3
order by
    2
    ) as model_subq
  );
  
  
[0m17:48:02.490407 [debug] [Thread-1 (]: SQL status: BEGIN in 2.586 seconds
[0m17:48:02.491349 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:48:02.491349 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_gom1"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count(*) as trips,
    count(distinct user_id) as users,
    avg(duration_s) / 60 as avg_duration_min,
    sum(distance_m) / 1000 as sum_distance_km,
    sum(price_rub) as revenue_rub,
    count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from
    "dev_gom1"."dbt"."trips_prep"
  );
  
[0m17:48:04.890249 [debug] [Thread-4 (]: SQL status: INSERT 0 91 in 4.111 seconds
[0m17:48:04.905249 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:48:04.906249 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

        
            grant select on "dev_gom1"."finance"."revenue_daily" to finance;
        
    
[0m17:48:04.986256 [debug] [Thread-4 (]: Postgres adapter: Postgres error: role "finance" does not exist

[0m17:48:04.987816 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: ROLLBACK
[0m17:48:05.087678 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: Close
[0m17:48:05.092337 [debug] [Thread-4 (]: Database Error in model revenue_daily (models\finance\revenue_daily.sql)
  role "finance" does not exist
  compiled code at target\run\dbt_scooters\models\finance\revenue_daily.sql
[0m17:48:05.093342 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51D42B620>]}
[0m17:48:05.094327 [error] [Thread-4 (]: 39 of 52 ERROR creating sql incremental model finance.revenue_daily ............ [[31mERROR[0m in 6.19s]
[0m17:48:05.095297 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.revenue_daily
[0m17:48:05.096304 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m17:48:05.097299 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.revenue_daily' to be skipped because of status 'error'.  Reason: Database Error in model revenue_daily (models\finance\revenue_daily.sql)
  role "finance" does not exist
  compiled code at target\run\dbt_scooters\models\finance\revenue_daily.sql.
[0m17:48:05.098808 [info ] [Thread-4 (]: 41 of 52 START sql table model dbt.trips_stat_daily ............................ [RUN]
[0m17:48:05.099823 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_stat_daily)
[0m17:48:05.100820 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m17:48:05.103817 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m17:48:05.104817 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m17:48:05.108817 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m17:48:05.109824 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:48:05.109824 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m17:48:05.110825 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:48:06.689785 [debug] [Thread-4 (]: SQL status: BEGIN in 1.579 seconds
[0m17:48:06.690786 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:48:06.690786 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_gom1"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    count(*) as trips,
    max(price_rub) as max_price_rub,
    avg(distance_m) / 1000 as avg_distance_km,
    avg(price_rub)/avg(duration_s) * 60 as avg_price_rub_per_min
from
    "dev_gom1"."dbt"."trips_prep"
group by
    1
order by
    1
  );
  
[0m17:48:09.390897 [debug] [Thread-1 (]: SQL status: SELECT 1 in 6.899 seconds
[0m17:48:09.394024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:48:09.395062 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_gom1"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m17:48:09.489022 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m17:48:09.492611 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:48:09.492611 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_gom1"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m17:48:09.588295 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m17:48:09.591231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:48:09.591231 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_stat" is $dbt_comment_literal_block$Overall trips statistics$dbt_comment_literal_block$;

  
[0m17:48:09.688789 [debug] [Thread-1 (]: SQL status: COMMENT in 0.097 seconds
[0m17:48:09.690787 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m17:48:09.690787 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:48:09.690787 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m17:48:09.792495 [debug] [Thread-1 (]: SQL status: COMMIT in 0.100 seconds
[0m17:48:09.795503 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."trips_stat__dbt_backup"
[0m17:48:09.796502 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:48:09.796502 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_gom1"."dbt"."trips_stat__dbt_backup" cascade
[0m17:48:09.987947 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.191 seconds
[0m17:48:09.989886 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: Close
[0m17:48:09.990886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51D4289E0>]}
[0m17:48:09.991887 [info ] [Thread-1 (]: 40 of 52 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 10.10s]
[0m17:48:09.992889 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_stat
[0m17:48:09.993970 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_users
[0m17:48:09.995010 [info ] [Thread-1 (]: 42 of 52 START sql incremental model dbt.trips_users ........................... [RUN]
[0m17:48:09.995971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_users)
[0m17:48:09.995971 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_users
[0m17:48:10.002007 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m17:48:10.003009 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_users
[0m17:48:10.007969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:48:10.007969 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp174810005010"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep" as t
left join
    "dev_gom1"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_gom1"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m17:48:10.009005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:11.090926 [debug] [Thread-3 (]: SQL status: INSERT 0 101377 in 11.566 seconds
[0m17:48:11.092915 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:48:11.093917 [debug] [Thread-3 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
  comment on table "dev_gom1"."dbt"."events_clean" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m17:48:11.192105 [debug] [Thread-3 (]: SQL status: COMMENT in 0.098 seconds
[0m17:48:11.194104 [debug] [Thread-3 (]: On model.dbt_scooters.events_clean: COMMIT
[0m17:48:11.194660 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:48:11.194660 [debug] [Thread-3 (]: On model.dbt_scooters.events_clean: COMMIT
[0m17:48:11.287923 [debug] [Thread-3 (]: SQL status: COMMIT in 0.093 seconds
[0m17:48:11.289921 [debug] [Thread-3 (]: On model.dbt_scooters.events_clean: Close
[0m17:48:11.290919 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51D4123C0>]}
[0m17:48:11.290919 [info ] [Thread-3 (]: 29 of 52 OK created sql incremental model dbt.events_clean ..................... [[32mINSERT 0 101377[0m in 18.73s]
[0m17:48:11.292879 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_clean
[0m17:48:11.292879 [debug] [Thread-3 (]: Began running node model.dbt_scooters.companies_trips
[0m17:48:11.294390 [info ] [Thread-3 (]: 43 of 52 START sql table model dbt.companies_trips ............................. [RUN]
[0m17:48:11.295398 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.companies_trips)
[0m17:48:11.295398 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.companies_trips
[0m17:48:11.299921 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m17:48:11.302918 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.companies_trips
[0m17:48:11.307922 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m17:48:11.309928 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:48:11.309928 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m17:48:11.310926 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:12.586893 [debug] [Thread-3 (]: SQL status: BEGIN in 1.276 seconds
[0m17:48:12.587895 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:48:12.587895 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_gom1"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_gom1"."dbt"."trips_prep" as t
        join "dev_gom1"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_gom1"."dbt"."companies" as c
        using (company)
  );
  
[0m17:48:14.789035 [debug] [Thread-3 (]: SQL status: SELECT 6 in 2.200 seconds
[0m17:48:14.792045 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:48:14.793039 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_gom1"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m17:48:14.887102 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m17:48:14.889116 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:48:14.890117 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  comment on table "dev_gom1"."dbt"."companies_trips" is $dbt_comment_literal_block$Trip statistics by company$dbt_comment_literal_block$;

  
[0m17:48:14.894116 [debug] [Thread-4 (]: SQL status: SELECT 91 in 8.202 seconds
[0m17:48:14.897622 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:48:14.897622 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_gom1"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m17:48:14.967165 [debug] [Thread-3 (]: SQL status: COMMENT in 0.077 seconds
[0m17:48:14.971177 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:48:14.972174 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'companies_trips'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:48:14.973173 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.074 seconds
[0m17:48:14.976173 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:48:14.976173 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_gom1"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m17:48:15.092258 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.115 seconds
[0m17:48:15.103280 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:48:15.103280 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    create  index if not exists
  "1f93a6ee0a7dd616ab0b109465ac3383"
  on "dev_gom1"."dbt"."trips_stat_daily" 
  (date)
  
[0m17:48:15.191846 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.220 seconds
[0m17:48:15.193848 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:48:15.194843 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."companies_trips".company is $dbt_comment_literal_block$Scooters manufacturing company$dbt_comment_literal_block$;
  

  
[0m17:48:15.195847 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.091 seconds
[0m17:48:15.197355 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:48:15.198930 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_stat_daily" is $dbt_comment_literal_block$Overall trips statistics per day$dbt_comment_literal_block$;

  
[0m17:48:15.285982 [debug] [Thread-3 (]: SQL status: COMMENT in 0.091 seconds
[0m17:48:15.287985 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m17:48:15.287985 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:48:15.288983 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m17:48:15.289993 [debug] [Thread-4 (]: SQL status: COMMENT in 0.091 seconds
[0m17:48:15.292991 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:48:15.293988 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_stat_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:48:15.485804 [debug] [Thread-3 (]: SQL status: COMMIT in 0.196 seconds
[0m17:48:15.488809 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."companies_trips__dbt_backup"
[0m17:48:15.489816 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:48:15.490818 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_gom1"."dbt"."companies_trips__dbt_backup" cascade
[0m17:48:15.585011 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.094 seconds
[0m17:48:15.587012 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: Close
[0m17:48:15.588012 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51C3B0EF0>]}
[0m17:48:15.589014 [info ] [Thread-3 (]: 43 of 52 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 4.29s]
[0m17:48:15.589988 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.companies_trips
[0m17:48:15.589988 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_full
[0m17:48:15.591016 [info ] [Thread-3 (]: 44 of 52 START sql view model dbt.events_full .................................. [RUN]
[0m17:48:15.592012 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.events_full)
[0m17:48:15.592986 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_full
[0m17:48:15.597007 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m17:48:15.599127 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_full
[0m17:48:15.603170 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m17:48:15.604126 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:48:15.605127 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: BEGIN
[0m17:48:15.605127 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:15.692202 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.398 seconds
[0m17:48:15.695200 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:48:15.695200 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."trips_stat_daily".date is $dbt_comment_literal_block$Trips date$dbt_comment_literal_block$;
  

  
[0m17:48:15.790033 [debug] [Thread-4 (]: SQL status: COMMENT in 0.094 seconds
[0m17:48:15.792030 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m17:48:15.792987 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:48:15.792987 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m17:48:15.894184 [debug] [Thread-4 (]: SQL status: COMMIT in 0.100 seconds
[0m17:48:15.897228 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."trips_stat_daily__dbt_backup"
[0m17:48:15.898188 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:48:15.898188 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_gom1"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m17:48:15.990937 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.092 seconds
[0m17:48:15.992931 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m17:48:15.993930 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51BD41D90>]}
[0m17:48:15.994932 [info ] [Thread-4 (]: 41 of 52 OK created sql table model dbt.trips_stat_daily ....................... [[32mSELECT 91[0m in 10.89s]
[0m17:48:15.996891 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m17:48:15.996891 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m17:48:15.998436 [info ] [Thread-4 (]: 45 of 52 START test unique_companies_trips_company ............................. [RUN]
[0m17:48:15.998436 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m17:48:15.999446 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m17:48:16.003479 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m17:48:16.004446 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m17:48:16.007481 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m17:48:16.007481 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m17:48:16.008988 [debug] [Thread-4 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m17:48:16.010032 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:48:16.111262 [debug] [Thread-1 (]: SQL status: SELECT 30901 in 6.102 seconds
[0m17:48:16.115258 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:48:16.115258 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: BEGIN
[0m17:48:16.191243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.075 seconds
[0m17:48:16.192221 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:48:16.192221 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp174810005010'
        
      order by ordinal_position

  
[0m17:48:16.423956 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.230 seconds
[0m17:48:16.426957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:48:16.427958 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:48:16.689006 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.260 seconds
[0m17:48:16.692960 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:48:16.693960 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp174810005010'
        
      order by ordinal_position

  
[0m17:48:16.792885 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.099 seconds
[0m17:48:16.796837 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:48:16.797837 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:48:16.872049 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.074 seconds
[0m17:48:16.875087 [debug] [Thread-1 (]: 
    In "dev_gom1"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:48:16.881088 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m17:48:16.883049 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:48:16.883049 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_gom1"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp174810005010"
    )


  
[0m17:48:16.889094 [debug] [Thread-3 (]: SQL status: BEGIN in 1.284 seconds
[0m17:48:16.890087 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:48:16.891046 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_gom1"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select * from
"dev_gom1"."dbt"."events_clean" as e
left join "dev_gom1"."dbt"."event_types" as t
using (type_id)
  );
[0m17:48:17.094123 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.203 seconds
[0m17:48:17.098118 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:48:17.099078 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_gom1"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m17:48:17.194148 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m17:48:17.196149 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:48:17.196149 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

    
  
  comment on view "dev_gom1"."dbt"."events_full" is $dbt_comment_literal_block$User events enriched with meaningful types$dbt_comment_literal_block$;

  
[0m17:48:17.288177 [debug] [Thread-3 (]: SQL status: COMMENT in 0.091 seconds
[0m17:48:17.290174 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m17:48:17.290174 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:48:17.291172 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m17:48:17.360004 [debug] [Thread-4 (]: SQL status: BEGIN in 1.350 seconds
[0m17:48:17.360998 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m17:48:17.361958 [debug] [Thread-4 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_gom1"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



      
    ) dbt_internal_test
[0m17:48:17.388989 [debug] [Thread-3 (]: SQL status: COMMIT in 0.097 seconds
[0m17:48:17.391996 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."events_full__dbt_backup"
[0m17:48:17.391996 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:48:17.392998 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_gom1"."dbt"."events_full__dbt_backup" cascade
[0m17:48:17.433163 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.071 seconds
[0m17:48:17.435214 [debug] [Thread-4 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m17:48:17.489208 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.096 seconds
[0m17:48:17.491207 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: Close
[0m17:48:17.492166 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51D42A8D0>]}
[0m17:48:17.493166 [info ] [Thread-3 (]: 44 of 52 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 1.90s]
[0m17:48:17.494167 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_full
[0m17:48:17.495164 [debug] [Thread-3 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m17:48:17.496166 [info ] [Thread-3 (]: 46 of 52 START test events_full_is_complete .................................... [RUN]
[0m17:48:17.497169 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now test.dbt_scooters.events_full_is_complete)
[0m17:48:17.498167 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m17:48:17.502750 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m17:48:17.504749 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m17:48:17.507786 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.events_full_is_complete"
[0m17:48:17.509303 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m17:48:17.509303 [debug] [Thread-3 (]: On test.dbt_scooters.events_full_is_complete: BEGIN
[0m17:48:17.510348 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:17.511308 [debug] [Thread-4 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m17:48:17.512347 [info ] [Thread-4 (]: 45 of 52 PASS unique_companies_trips_company ................................... [[32mPASS[0m in 1.51s]
[0m17:48:17.514314 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m17:48:18.088974 [debug] [Thread-1 (]: SQL status: INSERT 0 30901 in 1.205 seconds
[0m17:48:18.091018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:48:18.091978 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_users" is $dbt_comment_literal_block$Prepared trips enriched with users data$dbt_comment_literal_block$;

  
[0m17:48:18.187231 [debug] [Thread-1 (]: SQL status: COMMENT in 0.095 seconds
[0m17:48:18.189196 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:48:18.189196 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m17:48:18.998122 [debug] [Thread-3 (]: SQL status: BEGIN in 1.488 seconds
[0m17:48:18.999123 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m17:48:18.999123 [debug] [Thread-3 (]: On test.dbt_scooters.events_full_is_complete: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.events_full_is_complete"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with source_cte as (
    select count(*) as row_count
    from "dev_gom1"."dbt"."events_clean"
),
target_cte as (
    select count(*) as row_count
    from "dev_gom1"."dbt"."events_full"
)
select
    'Row count mismatch' as error_message,
    source_cte.row_count as source_count,
    target_cte.row_count as target_count
from
    source_cte,
    target_cte
where
    source_cte.row_count != target_cte.row_count
      
    ) dbt_internal_test
[0m17:48:20.707589 [debug] [Thread-2 (]: SQL status: SELECT 199849 in 26.102 seconds
[0m17:48:20.711106 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:48:20.711106 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m17:48:20.803156 [debug] [Thread-2 (]: SQL status: BEGIN in 0.091 seconds
[0m17:48:20.804361 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:48:20.804361 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp174754601953'
        
      order by ordinal_position

  
[0m17:48:21.019061 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.214 seconds
[0m17:48:21.023013 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:48:21.023013 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:48:21.193833 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.170 seconds
[0m17:48:21.197832 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:48:21.198833 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp174754601953'
        
      order by ordinal_position

  
[0m17:48:21.299031 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.100 seconds
[0m17:48:21.303024 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:48:21.303572 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:48:21.499035 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.195 seconds
[0m17:48:21.501029 [debug] [Thread-2 (]: 
    In "dev_gom1"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:48:21.502034 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m17:48:21.504277 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:48:21.504277 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_gom1"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp174754601953"
    )


  
[0m17:48:24.590959 [debug] [Thread-3 (]: SQL status: SELECT 1 in 5.591 seconds
[0m17:48:24.592954 [debug] [Thread-3 (]: On test.dbt_scooters.events_full_is_complete: ROLLBACK
[0m17:48:24.659163 [debug] [Thread-3 (]: On test.dbt_scooters.events_full_is_complete: Close
[0m17:48:24.660166 [info ] [Thread-3 (]: 46 of 52 PASS events_full_is_complete .......................................... [[32mPASS[0m in 7.16s]
[0m17:48:24.661125 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m17:48:24.662123 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_stat
[0m17:48:24.663125 [info ] [Thread-4 (]: 47 of 52 START sql table model dbt.events_stat ................................. [RUN]
[0m17:48:24.663125 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0, now model.dbt_scooters.events_stat)
[0m17:48:24.664126 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_stat
[0m17:48:24.667161 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m17:48:24.668126 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_stat
[0m17:48:24.672166 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m17:48:24.673125 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:48:24.674163 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: BEGIN
[0m17:48:24.674163 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:48:26.085936 [debug] [Thread-4 (]: SQL status: BEGIN in 1.412 seconds
[0m17:48:26.086937 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:48:26.087938 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_gom1"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
       count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from "dev_gom1"."dbt"."events_full"
  );
  
[0m17:48:27.787118 [debug] [Thread-2 (]: SQL status: INSERT 0 199849 in 6.282 seconds
[0m17:48:27.789116 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:48:27.790110 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_concurrency" is $dbt_comment_literal_block$Number of simultaneous rides in time$dbt_comment_literal_block$;

  
[0m17:48:27.855818 [debug] [Thread-2 (]: SQL status: COMMENT in 0.065 seconds
[0m17:48:27.857819 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m17:48:27.858819 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:48:27.858819 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m17:48:28.086868 [debug] [Thread-1 (]: SQL status: ANALYZE in 9.897 seconds
[0m17:48:28.088863 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m17:48:28.088863 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:48:28.089864 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m17:48:28.894102 [debug] [Thread-2 (]: SQL status: COMMIT in 1.035 seconds
[0m17:48:28.896062 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: Close
[0m17:48:28.896062 [debug] [Thread-1 (]: SQL status: COMMIT in 0.806 seconds
[0m17:48:28.897056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:48:28.898058 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51A6B8A10>]}
[0m17:48:28.899064 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m17:48:28.900065 [info ] [Thread-2 (]: 32 of 52 OK created sql incremental model dbt.trips_concurrency ................ [[32mINSERT 0 199849[0m in 34.31s]
[0m17:48:28.901067 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m17:48:28.966856 [debug] [Thread-1 (]: SQL status: COMMIT in 0.066 seconds
[0m17:48:28.967807 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:48:28.968808 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m17:48:29.091109 [debug] [Thread-1 (]: SQL status: VACUUM in 0.122 seconds
[0m17:48:29.093109 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: Close
[0m17:48:29.094068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51C3CFC80>]}
[0m17:48:29.095108 [info ] [Thread-1 (]: 42 of 52 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 30901[0m in 19.10s]
[0m17:48:29.096066 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_users
[0m17:48:29.097110 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m17:48:29.098067 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_group
[0m17:48:29.099068 [info ] [Thread-3 (]: 48 of 52 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m17:48:29.100067 [info ] [Thread-2 (]: 49 of 52 START sql table model dbt.trips_age_group ............................. [RUN]
[0m17:48:29.101072 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.events_full_is_complete, now model.dbt_scooters.trips_age_daily)
[0m17:48:29.102106 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.trips_age_group)
[0m17:48:29.103067 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m17:48:29.104066 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m17:48:29.107103 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m17:48:29.110073 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m17:48:29.111581 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m17:48:29.112593 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_group
[0m17:48:29.117591 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m17:48:29.122105 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m17:48:29.124109 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:48:29.124109 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m17:48:29.125109 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m17:48:29.125109 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m17:48:29.126106 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:29.126106 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:48:30.393234 [debug] [Thread-4 (]: SQL status: SELECT 1 in 4.305 seconds
[0m17:48:30.396230 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:48:30.397231 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_gom1"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m17:48:30.461838 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.064 seconds
[0m17:48:30.464833 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:48:30.464833 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."events_stat" is $dbt_comment_literal_block$Overall user events statistics$dbt_comment_literal_block$;

  
[0m17:48:30.530011 [debug] [Thread-4 (]: SQL status: COMMENT in 0.065 seconds
[0m17:48:30.532042 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m17:48:30.533043 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:48:30.533043 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m17:48:30.555049 [debug] [Thread-2 (]: SQL status: BEGIN in 1.429 seconds
[0m17:48:30.556059 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m17:48:30.557047 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_gom1"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_gom1"."dbt"."trips_users" as tu
    cross join "dev_gom1"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m17:48:30.598046 [debug] [Thread-4 (]: SQL status: COMMIT in 0.064 seconds
[0m17:48:30.601092 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."events_stat__dbt_backup"
[0m17:48:30.602093 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:48:30.602093 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_gom1"."dbt"."events_stat__dbt_backup" cascade
[0m17:48:30.624279 [debug] [Thread-3 (]: SQL status: BEGIN in 1.498 seconds
[0m17:48:30.625261 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:48:30.625261 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_gom1"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    Select "date",
       age,
       count(*) as trips,
       sum(price_rub) as revenue_rub
from
    "dev_gom1"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m17:48:30.667920 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.065 seconds
[0m17:48:30.669907 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: Close
[0m17:48:30.670867 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51DA9B110>]}
[0m17:48:30.671868 [info ] [Thread-4 (]: 47 of 52 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 6.01s]
[0m17:48:30.672870 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_stat
[0m17:48:31.797895 [debug] [Thread-3 (]: SQL status: SELECT 7049 in 1.172 seconds
[0m17:48:31.801903 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:48:31.801903 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_gom1"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m17:48:31.869962 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.067 seconds
[0m17:48:31.873961 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:48:31.873961 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_gom1"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m17:48:31.942018 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.068 seconds
[0m17:48:31.944019 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:48:31.945020 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_age_daily" is $dbt_comment_literal_block$Daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m17:48:32.012061 [debug] [Thread-3 (]: SQL status: COMMENT in 0.067 seconds
[0m17:48:32.014065 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m17:48:32.015062 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:48:32.015569 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m17:48:32.091139 [debug] [Thread-3 (]: SQL status: COMMIT in 0.075 seconds
[0m17:48:32.094135 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."trips_age_daily__dbt_backup"
[0m17:48:32.094135 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:48:32.095137 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_gom1"."dbt"."trips_age_daily__dbt_backup" cascade
[0m17:48:32.192211 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.096 seconds
[0m17:48:32.194211 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m17:48:32.195213 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51A6B8A10>]}
[0m17:48:32.196212 [info ] [Thread-3 (]: 48 of 52 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 3.09s]
[0m17:48:32.197224 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m17:48:32.198221 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m17:48:32.198221 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m17:48:32.199229 [info ] [Thread-1 (]: 50 of 52 START test unique_key_trips_age_daily_date__age ....................... [RUN]
[0m17:48:32.200230 [info ] [Thread-4 (]: 51 of 52 START test unique_trips_age_daily_date_text_age_text .................. [RUN]
[0m17:48:32.201236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be)
[0m17:48:32.202227 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e)
[0m17:48:32.203226 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m17:48:32.204228 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m17:48:32.209232 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m17:48:32.213230 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m17:48:32.215235 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m17:48:32.217756 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m17:48:32.217756 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m17:48:32.222277 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m17:48:32.223284 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m17:48:32.224277 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: BEGIN
[0m17:48:32.224277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:32.225275 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m17:48:32.226276 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: BEGIN
[0m17:48:32.227281 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:48:33.786007 [debug] [Thread-1 (]: SQL status: BEGIN in 1.561 seconds
[0m17:48:33.786007 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m17:48:33.787012 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "date"::text ||
    
        "age"::text ||
    
    ''
from
    "dev_gom1"."dbt"."trips_age_daily"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m17:48:33.789009 [debug] [Thread-4 (]: SQL status: BEGIN in 1.562 seconds
[0m17:48:33.789009 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m17:48:33.790014 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date::text || age::text as unique_field,
    count(*) as n_records

from "dev_gom1"."dbt"."trips_age_daily"
where date::text || age::text is not null
group by date::text || age::text
having count(*) > 1



      
    ) dbt_internal_test
[0m17:48:34.131785 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.341 seconds
[0m17:48:34.133788 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: ROLLBACK
[0m17:48:34.192824 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.405 seconds
[0m17:48:34.194822 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: ROLLBACK
[0m17:48:34.201830 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: Close
[0m17:48:34.202833 [info ] [Thread-4 (]: 51 of 52 PASS unique_trips_age_daily_date_text_age_text ........................ [[32mPASS[0m in 2.00s]
[0m17:48:34.203831 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m17:48:34.286895 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: Close
[0m17:48:34.287893 [info ] [Thread-1 (]: 50 of 52 PASS unique_key_trips_age_daily_date__age ............................. [[32mPASS[0m in 2.09s]
[0m17:48:34.289903 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m17:48:34.290906 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m17:48:34.291900 [info ] [Thread-3 (]: 52 of 52 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m17:48:34.292904 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now model.dbt_scooters.trips_age_daily_stat)
[0m17:48:34.292904 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m17:48:34.297900 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m17:48:34.298903 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m17:48:34.302908 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m17:48:34.303911 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:48:34.304910 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m17:48:34.305909 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:35.587090 [debug] [Thread-3 (]: SQL status: BEGIN in 1.281 seconds
[0m17:48:35.588089 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:48:35.588089 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_gom1"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_gom1"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m17:48:35.793226 [debug] [Thread-3 (]: SQL status: SELECT 83 in 0.204 seconds
[0m17:48:35.796224 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:48:35.797223 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_gom1"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m17:48:35.886793 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.089 seconds
[0m17:48:35.889802 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:48:35.890801 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_gom1"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m17:48:36.001901 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.110 seconds
[0m17:48:36.003902 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:48:36.004898 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_age_daily_stat" is $dbt_comment_literal_block$Aggregation of daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m17:48:36.084969 [debug] [Thread-3 (]: SQL status: COMMENT in 0.079 seconds
[0m17:48:36.085967 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m17:48:36.086972 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:48:36.086972 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m17:48:36.187043 [debug] [Thread-3 (]: SQL status: COMMIT in 0.099 seconds
[0m17:48:36.190050 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."trips_age_daily_stat__dbt_backup"
[0m17:48:36.191054 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:48:36.192053 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_gom1"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m17:48:36.287124 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.094 seconds
[0m17:48:36.288125 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m17:48:36.289134 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51DAC2A80>]}
[0m17:48:36.290133 [info ] [Thread-3 (]: 52 of 52 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 2.00s]
[0m17:48:36.291130 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m17:48:43.592110 [debug] [Thread-2 (]: SQL status: SELECT 7 in 13.035 seconds
[0m17:48:43.596104 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m17:48:43.597064 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_gom1"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m17:48:43.670917 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.073 seconds
[0m17:48:43.672917 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m17:48:43.673878 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_age_group" is $dbt_comment_literal_block$Overall trips statistics by user age group$dbt_comment_literal_block$;

  
[0m17:48:43.740138 [debug] [Thread-2 (]: SQL status: COMMENT in 0.066 seconds
[0m17:48:43.742132 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m17:48:43.743143 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m17:48:43.743143 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m17:48:43.811092 [debug] [Thread-2 (]: SQL status: COMMIT in 0.067 seconds
[0m17:48:43.814130 [debug] [Thread-2 (]: Applying DROP to: "dev_gom1"."dbt"."trips_age_group__dbt_backup"
[0m17:48:43.814130 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m17:48:43.815143 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_gom1"."dbt"."trips_age_group__dbt_backup" cascade
[0m17:48:43.882913 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.067 seconds
[0m17:48:43.884955 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: Close
[0m17:48:43.885954 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06364a2a-2587-4c3e-81f4-511834419d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51D4252E0>]}
[0m17:48:43.886967 [info ] [Thread-2 (]: 49 of 52 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 14.78s]
[0m17:48:43.887918 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_group
[0m17:48:43.889916 [info ] [MainThread]: 
[0m17:48:43.890916 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:43.891952 [debug] [MainThread]: On master: BEGIN
[0m17:48:43.892916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:48:46.934519 [debug] [MainThread]: SQL status: BEGIN in 3.042 seconds
[0m17:48:46.935521 [debug] [MainThread]: On master: COMMIT
[0m17:48:46.935521 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:46.936518 [debug] [MainThread]: On master: COMMIT
[0m17:48:47.004066 [debug] [MainThread]: SQL status: COMMIT in 0.067 seconds
[0m17:48:47.006065 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m17:48:47.011078 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m17:48:47.012076 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:47.012076 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m17:48:47.084169 [debug] [MainThread]: Postgres adapter: Postgres error: role "finance" does not exist

[0m17:48:47.085168 [info ] [MainThread]: 1 of 1 ERROR hook: dbt_scooters.on-run-end.0 ................................... [[31mERROR[0m in 0.08s]
[0m17:48:47.086175 [debug] [MainThread]: On master: Close
[0m17:48:47.087173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:47.087173 [debug] [MainThread]: Connection 'list_dev_gom1' was properly closed.
[0m17:48:47.088175 [debug] [MainThread]: Connection 'list_dev_gom1' was properly closed.
[0m17:48:47.088175 [debug] [MainThread]: Connection 'list_dev_gom1_dbt' was properly closed.
[0m17:48:47.089180 [debug] [MainThread]: Connection 'list_dev_gom1_finance' was properly closed.
[0m17:48:47.089180 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be' was properly closed.
[0m17:48:47.089180 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m17:48:47.090183 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m17:48:47.090183 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e' was properly closed.
[0m17:48:47.091182 [info ] [MainThread]: 
[0m17:48:47.092184 [info ] [MainThread]: Finished running 4 incremental models, 1 project hook, 4 seeds, 12 table models, 28 data tests, 4 view models in 0 hours 1 minutes and 17.12 seconds (77.12s).
[0m17:48:47.102191 [debug] [MainThread]: Command end result
[0m17:48:47.137718 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m17:48:47.141236 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m17:48:47.151754 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\run_results.json
[0m17:48:47.152757 [info ] [MainThread]: 
[0m17:48:47.152757 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 1 warning:[0m
[0m17:48:47.153759 [info ] [MainThread]: 
[0m17:48:47.154763 [error] [MainThread]:   Database Error in model trips_geom (models\trips_geom.sql)
  function st_makepoint(double precision, double precision) does not exist
  LINE 9:     st_setsrid(st_makepoint(start_lon, start_lat), 4326) as ...
                         ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_scooters\models\trips_geom.sql
[0m17:48:47.155757 [info ] [MainThread]: 
[0m17:48:47.156757 [error] [MainThread]:   Database Error in model revenue_daily (models\finance\revenue_daily.sql)
  role "finance" does not exist
  compiled code at target\run\dbt_scooters\models\finance\revenue_daily.sql
[0m17:48:47.157759 [info ] [MainThread]: 
[0m17:48:47.158760 [error] [MainThread]:   dbt_scooters.on-run-end.0 failed, error:
 role "finance" does not exist
[0m17:48:47.160774 [info ] [MainThread]: 
[0m17:48:47.161768 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models\properties.yml)[0m
[0m17:48:47.162774 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m17:48:47.163769 [info ] [MainThread]: 
[0m17:48:47.164772 [info ] [MainThread]:   compiled code at target\compiled\dbt_scooters\models\properties.yml\source_not_null_scooters_raw_users_sex.sql
[0m17:48:47.165772 [info ] [MainThread]: 
[0m17:48:47.166771 [info ] [MainThread]: Done. PASS=47 WARN=1 ERROR=3 SKIP=2 TOTAL=53
[0m17:48:47.168775 [debug] [MainThread]: Command `dbt build` failed at 17:48:47.168775 after 79.30 seconds
[0m17:48:47.169788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51A1F3C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51A3821B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B51A383DD0>]}
[0m17:48:47.170789 [debug] [MainThread]: Flushing usage events
[0m17:48:48.099860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:55:08.855715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEF897AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEF895340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEF16E090>]}


============================== 17:55:08.861732 | deb47d83-838d-471e-9dfe-f77668751acd ==============================
[0m17:55:08.861732 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:55:08.863733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:55:09.171645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEFB5D880>]}
[0m17:55:09.266762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEF191580>]}
[0m17:55:09.268777 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:55:09.609651 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:55:09.961696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:09.962696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:10.074919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF00ADD30>]}
[0m17:55:10.283879 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m17:55:10.289885 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m17:55:10.361657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF161AC30>]}
[0m17:55:10.362653 [info ] [MainThread]: Found 20 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 438 macros
[0m17:55:10.371673 [info ] [MainThread]: 
[0m17:55:10.372672 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:55:10.373674 [info ] [MainThread]: 
[0m17:55:10.374675 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:55:10.382681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m17:55:10.396687 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m17:55:10.531145 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m17:55:10.532145 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m17:55:10.532145 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m17:55:10.533146 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m17:55:10.534148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:10.535110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:11.675885 [debug] [ThreadPool]: SQL status: SELECT 13 in 1.142 seconds
[0m17:55:11.677840 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m17:55:12.572871 [debug] [ThreadPool]: SQL status: SELECT 13 in 2.038 seconds
[0m17:55:12.573910 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m17:55:12.577911 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_finance'
[0m17:55:12.584911 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m17:55:12.585914 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_dbt'
[0m17:55:12.586869 [debug] [ThreadPool]: On list_dev_gom1_finance: BEGIN
[0m17:55:12.588917 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m17:55:12.588917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:12.589909 [debug] [ThreadPool]: On list_dev_gom1_dbt: BEGIN
[0m17:55:12.590871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:13.749893 [debug] [ThreadPool]: SQL status: BEGIN in 1.161 seconds
[0m17:55:13.750848 [debug] [ThreadPool]: SQL status: BEGIN in 1.160 seconds
[0m17:55:13.750848 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m17:55:13.751890 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m17:55:13.751890 [debug] [ThreadPool]: On list_dev_gom1_finance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_finance"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m17:55:13.752892 [debug] [ThreadPool]: On list_dev_gom1_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_dbt"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m17:55:13.843152 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.090 seconds
[0m17:55:13.844140 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.090 seconds
[0m17:55:13.845138 [debug] [ThreadPool]: On list_dev_gom1_finance: ROLLBACK
[0m17:55:13.846138 [debug] [ThreadPool]: On list_dev_gom1_dbt: ROLLBACK
[0m17:55:13.926755 [debug] [ThreadPool]: On list_dev_gom1_dbt: Close
[0m17:55:13.926755 [debug] [ThreadPool]: On list_dev_gom1_finance: Close
[0m17:55:13.938833 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:13.939806 [debug] [MainThread]: On master: BEGIN
[0m17:55:13.939806 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:16.006926 [debug] [MainThread]: SQL status: BEGIN in 2.066 seconds
[0m17:55:16.006926 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:16.007933 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:55:16.200625 [debug] [MainThread]: SQL status: SELECT 4 in 0.192 seconds
[0m17:55:16.203579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEFD73EF0>]}
[0m17:55:16.203579 [debug] [MainThread]: On master: ROLLBACK
[0m17:55:16.286752 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:16.287702 [debug] [MainThread]: On master: BEGIN
[0m17:55:16.486757 [debug] [MainThread]: SQL status: BEGIN in 0.199 seconds
[0m17:55:16.487711 [debug] [MainThread]: On master: COMMIT
[0m17:55:16.487711 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:16.487711 [debug] [MainThread]: On master: COMMIT
[0m17:55:16.596920 [debug] [MainThread]: SQL status: COMMIT in 0.108 seconds
[0m17:55:16.596920 [debug] [MainThread]: On master: Close
[0m17:55:16.600929 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.add_first_name_sex
[0m17:55:16.601962 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m17:55:16.602927 [debug] [Thread-3 (]: Began running node seed.dbt_scooters.event_types
[0m17:55:16.602927 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.scooters
[0m17:55:16.603929 [info ] [Thread-1 (]: 1 of 52 START seed file dbt.add_first_name_sex ................................. [RUN]
[0m17:55:16.604927 [info ] [Thread-2 (]: 2 of 52 START seed file dbt.age_groups ......................................... [RUN]
[0m17:55:16.605930 [info ] [Thread-3 (]: 3 of 52 START seed file dbt.event_types ........................................ [RUN]
[0m17:55:16.606933 [info ] [Thread-4 (]: 4 of 52 START seed file dbt.scooters ........................................... [RUN]
[0m17:55:16.607927 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.dbt_scooters.add_first_name_sex'
[0m17:55:16.608927 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.dbt_scooters.age_groups'
[0m17:55:16.609929 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.dbt_scooters.event_types'
[0m17:55:16.609929 [debug] [Thread-4 (]: Acquiring new postgres connection 'seed.dbt_scooters.scooters'
[0m17:55:16.610967 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.add_first_name_sex
[0m17:55:16.610967 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m17:55:16.611964 [debug] [Thread-3 (]: Began compiling node seed.dbt_scooters.event_types
[0m17:55:16.611964 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.scooters
[0m17:55:16.612926 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.add_first_name_sex
[0m17:55:16.613926 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m17:55:16.613926 [debug] [Thread-3 (]: Began executing node seed.dbt_scooters.event_types
[0m17:55:16.614964 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.scooters
[0m17:55:16.659679 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:55:16.662625 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:55:16.666624 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:55:16.668669 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: BEGIN
[0m17:55:16.669633 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: BEGIN
[0m17:55:16.673671 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:55:16.674630 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m17:55:16.674630 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:55:16.675669 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:55:16.675669 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: BEGIN
[0m17:55:16.676631 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:55:16.677631 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:55:18.005990 [debug] [Thread-2 (]: SQL status: BEGIN in 1.329 seconds
[0m17:55:18.006948 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:55:18.006948 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_gom1"."dbt"."age_groups"
[0m17:55:18.074795 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.067 seconds
[0m17:55:18.093751 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:55:18.093751 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_gom1"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m17:55:18.158961 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.064 seconds
[0m17:55:18.165961 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m17:55:18.189979 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:55:18.190980 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  comment on table "dev_gom1"."dbt"."age_groups" is $dbt_comment_literal_block$Age groups to split users for analysis$dbt_comment_literal_block$;

  
[0m17:55:18.256802 [debug] [Thread-2 (]: SQL status: COMMENT in 0.064 seconds
[0m17:55:18.279803 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:55:18.279803 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'age_groups'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:55:18.382687 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.102 seconds
[0m17:55:18.387632 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:55:18.388639 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."age_groups".group is $dbt_comment_literal_block$Age group name for report$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."age_groups".age_start is $dbt_comment_literal_block$Start age of group$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."age_groups".age_end is $dbt_comment_literal_block$End age of group$dbt_comment_literal_block$;
  

  
[0m17:55:18.453904 [debug] [Thread-2 (]: SQL status: COMMENT in 0.065 seconds
[0m17:55:18.455851 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m17:55:18.456852 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:55:18.456852 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m17:55:18.517903 [debug] [Thread-4 (]: SQL status: BEGIN in 1.840 seconds
[0m17:55:18.518899 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:55:18.518899 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_gom1"."dbt"."scooters"
[0m17:55:18.522899 [debug] [Thread-2 (]: SQL status: COMMIT in 0.065 seconds
[0m17:55:18.524858 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m17:55:18.527857 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDED058BF0>]}
[0m17:55:18.528865 [info ] [Thread-2 (]: 2 of 52 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 1.92s]
[0m17:55:18.529866 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m17:55:18.530872 [debug] [Thread-2 (]: Began running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m17:55:18.531867 [info ] [Thread-2 (]: 5 of 52 START test every_event_has_user ........................................ [RUN]
[0m17:55:18.532865 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now test.dbt_scooters.every_event_has_user.7eea25f36c)
[0m17:55:18.533875 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m17:55:18.553971 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m17:55:18.554938 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m17:55:18.573944 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m17:55:18.575943 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m17:55:18.575943 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: BEGIN
[0m17:55:18.576944 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:55:18.587994 [debug] [Thread-4 (]: SQL status: TRUNCATE TABLE in 0.068 seconds
[0m17:55:18.592992 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:55:18.592992 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_gom1"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m17:55:18.659816 [debug] [Thread-4 (]: SQL status: INSERT 0 10 in 0.066 seconds
[0m17:55:18.659816 [debug] [Thread-3 (]: SQL status: BEGIN in 1.985 seconds
[0m17:55:18.660773 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m17:55:18.661816 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:55:18.662777 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_gom1"."dbt"."event_types"
[0m17:55:18.664775 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:55:18.665775 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  comment on table "dev_gom1"."dbt"."scooters" is $dbt_comment_literal_block$Scooter models information and park statistics by model. Includes information about the manufacturing company. Data received from the service team and uploaded by Mark. Data is current as of summer 2023.
$dbt_comment_literal_block$;

  
[0m17:55:18.730816 [debug] [Thread-4 (]: SQL status: COMMENT in 0.064 seconds
[0m17:55:18.734816 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:55:18.734816 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'scooters'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:55:18.736280 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.073 seconds
[0m17:55:18.739876 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:55:18.740836 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_gom1"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m17:55:18.808928 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.073 seconds
[0m17:55:18.809924 [debug] [Thread-3 (]: SQL status: INSERT 0 4 in 0.068 seconds
[0m17:55:18.811926 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:55:18.812882 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m17:55:18.813884 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."scooters".company is $dbt_comment_literal_block$Scooter company model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."scooters".model is $dbt_comment_literal_block$Scooter model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."scooters".hardware_id is $dbt_comment_literal_block$scooter model id$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."scooters".scooters is $dbt_comment_literal_block$Count of scooters$dbt_comment_literal_block$;
  

  
[0m17:55:18.816927 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:55:18.817884 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  comment on table "dev_gom1"."dbt"."event_types" is $dbt_comment_literal_block$Table provides a mapping between unique event type identifiers (`type_id`) and their descriptive names (`type`). It is essential for converting numerical codes from user activity logs into readable descriptions for analysis of user interactions with application features.

The table is crucial for analytics and reporting, allowing for the decoding of event identifiers in user activity datasets. By joining with event logs, it facilitates intuitive reporting and dashboarding of user interactions. The mapping enables effective segmentation and analysis of user activities, such as:

- **start_search**: Represents the initiation of a search process by a user.
- **book_scooter**: Indicates that a user has booked a scooter.
- **release_scooter**: Signifies that a user has released a previously booked scooter.
- **cancel_search**: Denotes the cancellation of a search process by a user.$dbt_comment_literal_block$;

  
[0m17:55:18.878785 [debug] [Thread-4 (]: SQL status: COMMENT in 0.064 seconds
[0m17:55:18.880764 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m17:55:18.880764 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:55:18.881759 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m17:55:18.886754 [debug] [Thread-3 (]: SQL status: COMMENT in 0.068 seconds
[0m17:55:18.889761 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:55:18.890759 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'event_types'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:55:18.947968 [debug] [Thread-4 (]: SQL status: COMMIT in 0.066 seconds
[0m17:55:18.948927 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: Close
[0m17:55:18.949927 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF1C79640>]}
[0m17:55:18.950926 [info ] [Thread-4 (]: 4 of 52 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 2.34s]
[0m17:55:18.951925 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.scooters
[0m17:55:18.952969 [debug] [Thread-4 (]: Began running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m17:55:18.953961 [info ] [Thread-4 (]: 6 of 52 START test every_trip_has_user ......................................... [RUN]
[0m17:55:18.955928 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now test.dbt_scooters.every_trip_has_user.6bc71135e2)
[0m17:55:18.955928 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m17:55:18.961961 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m17:55:18.962961 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m17:55:18.965964 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m17:55:18.966963 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m17:55:18.967970 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: BEGIN
[0m17:55:18.967970 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:55:18.987972 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.097 seconds
[0m17:55:18.990964 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:55:18.990964 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."event_types".type_id is $dbt_comment_literal_block$An integer serving as a unique identifier for each event type. It is used in user event tables as a foreign key to link events to their descriptions
$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."event_types".type is $dbt_comment_literal_block$A string describing the event type, enhancing the interpretability of event data by providing a human-readable label
$dbt_comment_literal_block$;
  

  
[0m17:55:19.060800 [debug] [Thread-3 (]: SQL status: COMMENT in 0.069 seconds
[0m17:55:19.062797 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m17:55:19.063764 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:55:19.064755 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m17:55:19.087797 [debug] [Thread-1 (]: SQL status: BEGIN in 2.413 seconds
[0m17:55:19.088755 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:55:19.088755 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */
truncate table "dev_gom1"."dbt"."add_first_name_sex"
[0m17:55:19.133799 [debug] [Thread-3 (]: SQL status: COMMIT in 0.068 seconds
[0m17:55:19.134757 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: Close
[0m17:55:19.135310 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF1BE05F0>]}
[0m17:55:19.136358 [info ] [Thread-3 (]: 3 of 52 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 2.53s]
[0m17:55:19.137865 [debug] [Thread-3 (]: Finished running node seed.dbt_scooters.event_types
[0m17:55:19.138915 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m17:55:19.139881 [info ] [Thread-3 (]: 7 of 52 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m17:55:19.141878 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m17:55:19.141878 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m17:55:19.151879 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m17:55:19.153880 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m17:55:19.155880 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m17:55:19.157882 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m17:55:19.157882 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m17:55:19.158891 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:55:19.160891 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.071 seconds
[0m17:55:19.163928 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:55:19.164891 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: 
          insert into "dev_gom1"."dbt"."add_first_name_sex" ("first_name", "sex") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m17:55:19.231898 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.067 seconds
[0m17:55:19.232889 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.add_first_name_sex"
[0m17:55:19.235396 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:55:19.237912 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  comment on table "dev_gom1"."dbt"."add_first_name_sex" is $dbt_comment_literal_block$additional name_sex glossary$dbt_comment_literal_block$;

  
[0m17:55:19.309962 [debug] [Thread-1 (]: SQL status: COMMENT in 0.072 seconds
[0m17:55:19.313965 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:55:19.314963 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'add_first_name_sex'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:55:19.389790 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.074 seconds
[0m17:55:19.391747 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:55:19.392747 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."add_first_name_sex".first_name is $dbt_comment_literal_block$First name of user$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."add_first_name_sex".sex is $dbt_comment_literal_block$user gender$dbt_comment_literal_block$;
  

  
[0m17:55:19.464785 [debug] [Thread-1 (]: SQL status: COMMENT in 0.072 seconds
[0m17:55:19.466741 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m17:55:19.467742 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:55:19.468741 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m17:55:19.535784 [debug] [Thread-1 (]: SQL status: COMMIT in 0.067 seconds
[0m17:55:19.537042 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: Close
[0m17:55:19.538049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF216AEA0>]}
[0m17:55:19.539050 [info ] [Thread-1 (]: 1 of 52 OK loaded seed file dbt.add_first_name_sex ............................. [[32mINSERT 5[0m in 2.93s]
[0m17:55:19.540050 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.add_first_name_sex
[0m17:55:19.541053 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m17:55:19.542052 [info ] [Thread-1 (]: 8 of 52 START test source_not_null_scooters_raw_events_type_id ................. [RUN]
[0m17:55:19.543052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.add_first_name_sex, now test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7)
[0m17:55:19.543052 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m17:55:19.550673 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m17:55:19.551674 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m17:55:19.554681 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m17:55:19.555677 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m17:55:19.556641 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: BEGIN
[0m17:55:19.557648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:19.725875 [debug] [Thread-2 (]: SQL status: BEGIN in 1.149 seconds
[0m17:55:19.726845 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m17:55:19.726845 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_user.7eea25f36c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_gom1"."scooters_raw"."events"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_gom1"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:55:20.276826 [debug] [Thread-4 (]: SQL status: BEGIN in 1.309 seconds
[0m17:55:20.277826 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m17:55:20.278803 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_user.6bc71135e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_gom1"."scooters_raw"."trips"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_gom1"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:55:20.884742 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.605 seconds
[0m17:55:20.888751 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: ROLLBACK
[0m17:55:20.979819 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: Close
[0m17:55:20.981820 [info ] [Thread-4 (]: 6 of 52 PASS every_trip_has_user ............................................... [[32mPASS[0m in 2.03s]
[0m17:55:20.982830 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m17:55:20.983819 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m17:55:20.983819 [info ] [Thread-4 (]: 9 of 52 START test source_not_null_scooters_raw_events_user_id ................. [RUN]
[0m17:55:20.984817 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_user.6bc71135e2, now test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b)
[0m17:55:20.985820 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m17:55:20.989825 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m17:55:20.991826 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m17:55:20.994824 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m17:55:20.996828 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m17:55:20.997829 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: BEGIN
[0m17:55:20.997829 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:55:21.182976 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.455 seconds
[0m17:55:21.184979 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: ROLLBACK
[0m17:55:21.252031 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: Close
[0m17:55:21.253029 [info ] [Thread-2 (]: 5 of 52 PASS every_event_has_user .............................................. [[32mPASS[0m in 2.72s]
[0m17:55:21.255039 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m17:55:21.256033 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m17:55:21.257031 [info ] [Thread-2 (]: 10 of 52 START test source_not_null_scooters_raw_trips_id ...................... [RUN]
[0m17:55:21.258038 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_user.7eea25f36c, now test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d)
[0m17:55:21.258038 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m17:55:21.263037 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m17:55:21.264040 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m17:55:21.266036 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m17:55:21.268049 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m17:55:21.268049 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: BEGIN
[0m17:55:21.269047 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:55:21.310073 [debug] [Thread-3 (]: SQL status: BEGIN in 2.151 seconds
[0m17:55:21.311070 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m17:55:21.311070 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_gom1"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m17:55:21.378632 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.067 seconds
[0m17:55:21.380631 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m17:55:21.446180 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m17:55:21.447689 [info ] [Thread-3 (]: 7 of 52 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 2.31s]
[0m17:55:21.449699 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m17:55:21.449699 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m17:55:21.450702 [info ] [Thread-3 (]: 11 of 52 START test source_not_null_scooters_raw_trips_scooter_hw_id ........... [RUN]
[0m17:55:21.451699 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f)
[0m17:55:21.452699 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m17:55:21.456696 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m17:55:21.457698 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m17:55:21.459705 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m17:55:21.461703 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m17:55:21.461703 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: BEGIN
[0m17:55:21.462707 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:55:21.533749 [debug] [Thread-1 (]: SQL status: BEGIN in 1.976 seconds
[0m17:55:21.534752 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m17:55:21.534752 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from "dev_gom1"."scooters_raw"."events"
where type_id is null



      
    ) dbt_internal_test
[0m17:55:21.982056 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.447 seconds
[0m17:55:21.984059 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: ROLLBACK
[0m17:55:22.051119 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: Close
[0m17:55:22.052121 [info ] [Thread-1 (]: 8 of 52 PASS source_not_null_scooters_raw_events_type_id ....................... [[32mPASS[0m in 2.51s]
[0m17:55:22.053117 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m17:55:22.054124 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m17:55:22.055121 [info ] [Thread-1 (]: 12 of 52 START test source_not_null_scooters_raw_trips_user_id ................. [RUN]
[0m17:55:22.056120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7, now test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62)
[0m17:55:22.056120 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m17:55:22.061636 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m17:55:22.063638 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m17:55:22.067639 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m17:55:22.068646 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m17:55:22.069644 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: BEGIN
[0m17:55:22.069644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:22.106659 [debug] [Thread-4 (]: SQL status: BEGIN in 1.108 seconds
[0m17:55:22.107666 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m17:55:22.107666 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_gom1"."scooters_raw"."events"
where user_id is null



      
    ) dbt_internal_test
[0m17:55:22.480939 [debug] [Thread-2 (]: SQL status: BEGIN in 1.212 seconds
[0m17:55:22.481943 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m17:55:22.482944 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_gom1"."scooters_raw"."trips"
where id is null



      
    ) dbt_internal_test
[0m17:55:22.483943 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.375 seconds
[0m17:55:22.484943 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: ROLLBACK
[0m17:55:22.549997 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: Close
[0m17:55:22.551000 [info ] [Thread-4 (]: 9 of 52 PASS source_not_null_scooters_raw_events_user_id ....................... [[32mPASS[0m in 1.57s]
[0m17:55:22.552999 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m17:55:22.552999 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m17:55:22.553997 [info ] [Thread-4 (]: 13 of 52 START test source_not_null_scooters_raw_users_id ...................... [RUN]
[0m17:55:22.554998 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b, now test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d)
[0m17:55:22.556004 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m17:55:22.562002 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m17:55:22.564004 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m17:55:22.566007 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m17:55:22.567006 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m17:55:22.568015 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: BEGIN
[0m17:55:22.568015 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:55:22.586023 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.103 seconds
[0m17:55:22.588034 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: ROLLBACK
[0m17:55:22.654077 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: Close
[0m17:55:22.656078 [info ] [Thread-2 (]: 10 of 52 PASS source_not_null_scooters_raw_trips_id ............................ [[32mPASS[0m in 1.40s]
[0m17:55:22.657593 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m17:55:22.658603 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m17:55:22.659607 [info ] [Thread-2 (]: 14 of 52 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m17:55:22.659607 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m17:55:22.660607 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m17:55:22.664604 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m17:55:22.666601 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m17:55:22.668613 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m17:55:22.669616 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m17:55:22.670618 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m17:55:22.671620 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:55:23.434678 [debug] [Thread-3 (]: SQL status: BEGIN in 1.972 seconds
[0m17:55:23.435680 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m17:55:23.435680 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select scooter_hw_id
from "dev_gom1"."scooters_raw"."trips"
where scooter_hw_id is null



      
    ) dbt_internal_test
[0m17:55:23.509736 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.073 seconds
[0m17:55:23.511742 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: ROLLBACK
[0m17:55:23.577785 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: Close
[0m17:55:23.578792 [info ] [Thread-3 (]: 11 of 52 PASS source_not_null_scooters_raw_trips_scooter_hw_id ................. [[32mPASS[0m in 2.13s]
[0m17:55:23.580793 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m17:55:23.580793 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m17:55:23.581792 [info ] [Thread-3 (]: 15 of 52 START test source_unique_scooters_raw_trips_id ........................ [RUN]
[0m17:55:23.582797 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f, now test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4)
[0m17:55:23.583796 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m17:55:23.590801 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m17:55:23.592802 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m17:55:23.594798 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m17:55:23.595798 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m17:55:23.596802 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: BEGIN
[0m17:55:23.596802 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:55:23.650853 [debug] [Thread-4 (]: SQL status: BEGIN in 1.082 seconds
[0m17:55:23.650853 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m17:55:23.651854 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_gom1"."scooters_raw"."users"
where id is null



      
    ) dbt_internal_test
[0m17:55:23.730904 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.078 seconds
[0m17:55:23.732908 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: ROLLBACK
[0m17:55:23.796954 [debug] [Thread-2 (]: SQL status: BEGIN in 1.126 seconds
[0m17:55:23.797958 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m17:55:23.798958 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sex
from "dev_gom1"."scooters_raw"."users"
where sex is null



      
    ) dbt_internal_test
[0m17:55:23.818973 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: Close
[0m17:55:23.819973 [info ] [Thread-4 (]: 13 of 52 PASS source_not_null_scooters_raw_users_id ............................ [[32mPASS[0m in 1.26s]
[0m17:55:23.821976 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m17:55:23.822980 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m17:55:23.823977 [info ] [Thread-4 (]: 16 of 52 START test source_unique_scooters_raw_users_id ........................ [RUN]
[0m17:55:23.824973 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d, now test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf)
[0m17:55:23.825974 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m17:55:23.830981 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m17:55:23.831986 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m17:55:23.833986 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m17:55:23.835985 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m17:55:23.835985 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: BEGIN
[0m17:55:23.836985 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:55:23.868042 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.068 seconds
[0m17:55:23.870051 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m17:55:23.937600 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m17:55:23.938610 [warn ] [Thread-2 (]: 14 of 52 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 1.28s]
[0m17:55:23.940120 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m17:55:23.941135 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m17:55:23.941135 [info ] [Thread-2 (]: 17 of 52 START test unique_not_null_age_groups_age_end ......................... [RUN]
[0m17:55:23.942133 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac)
[0m17:55:23.943130 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m17:55:23.948656 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m17:55:23.950649 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m17:55:23.953654 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m17:55:23.955649 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m17:55:23.956649 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: BEGIN
[0m17:55:23.956649 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:55:24.079751 [debug] [Thread-1 (]: SQL status: BEGIN in 2.010 seconds
[0m17:55:24.080749 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m17:55:24.080749 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_gom1"."scooters_raw"."trips"
where user_id is null



      
    ) dbt_internal_test
[0m17:55:24.311942 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.230 seconds
[0m17:55:24.313940 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: ROLLBACK
[0m17:55:24.393998 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: Close
[0m17:55:24.395001 [info ] [Thread-1 (]: 12 of 52 PASS source_not_null_scooters_raw_trips_user_id ....................... [[32mPASS[0m in 2.34s]
[0m17:55:24.396002 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m17:55:24.397008 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m17:55:24.398016 [info ] [Thread-1 (]: 18 of 52 START test unique_not_null_age_groups_age_start ....................... [RUN]
[0m17:55:24.399018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62, now test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b)
[0m17:55:24.399018 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m17:55:24.404017 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m17:55:24.405016 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m17:55:24.407017 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m17:55:24.409026 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m17:55:24.409026 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: BEGIN
[0m17:55:24.410024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:24.981014 [debug] [Thread-3 (]: SQL status: BEGIN in 1.384 seconds
[0m17:55:24.982014 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m17:55:24.982014 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_gom1"."scooters_raw"."trips"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:55:25.080592 [debug] [Thread-4 (]: SQL status: BEGIN in 1.243 seconds
[0m17:55:25.081594 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m17:55:25.081594 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_gom1"."scooters_raw"."users"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:55:25.183664 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.101 seconds
[0m17:55:25.185669 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: ROLLBACK
[0m17:55:25.280735 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: Close
[0m17:55:25.281737 [info ] [Thread-4 (]: 16 of 52 PASS source_unique_scooters_raw_users_id .............................. [[32mPASS[0m in 1.46s]
[0m17:55:25.283742 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m17:55:25.283742 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m17:55:25.284738 [info ] [Thread-4 (]: 19 of 52 START test unique_not_null_age_groups_group ........................... [RUN]
[0m17:55:25.285739 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf, now test.dbt_scooters.unique_not_null_age_groups_group.39342291f1)
[0m17:55:25.286742 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m17:55:25.292744 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m17:55:25.293744 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m17:55:25.348900 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m17:55:25.350898 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m17:55:25.351941 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: BEGIN
[0m17:55:25.352938 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:55:25.876990 [debug] [Thread-1 (]: SQL status: BEGIN in 1.467 seconds
[0m17:55:25.877994 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m17:55:25.877994 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_start"
from
    "dev_gom1"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_start" is null


      
    ) dbt_internal_test
[0m17:55:25.979641 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.101 seconds
[0m17:55:25.981637 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: ROLLBACK
[0m17:55:26.079890 [debug] [Thread-2 (]: SQL status: BEGIN in 2.123 seconds
[0m17:55:26.080848 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m17:55:26.080848 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_end"
from
    "dev_gom1"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_end" is null


      
    ) dbt_internal_test
[0m17:55:26.182682 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.101 seconds
[0m17:55:26.184647 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: ROLLBACK
[0m17:55:26.279849 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: Close
[0m17:55:26.280853 [info ] [Thread-2 (]: 17 of 52 PASS unique_not_null_age_groups_age_end ............................... [[32mPASS[0m in 2.34s]
[0m17:55:26.282851 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m17:55:26.283854 [debug] [Thread-2 (]: Began running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m17:55:26.284852 [info ] [Thread-2 (]: 20 of 52 START test every_trip_has_scooter_id .................................. [RUN]
[0m17:55:26.285851 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac, now test.dbt_scooters.every_trip_has_scooter_id.e0b845a190)
[0m17:55:26.286857 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m17:55:26.292856 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m17:55:26.293857 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m17:55:26.297852 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m17:55:26.299863 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m17:55:26.300867 [debug] [Thread-2 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: BEGIN
[0m17:55:26.301870 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:55:26.387979 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: Close
[0m17:55:26.388980 [info ] [Thread-1 (]: 18 of 52 PASS unique_not_null_age_groups_age_start ............................. [[32mPASS[0m in 1.99s]
[0m17:55:26.389981 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m17:55:26.391026 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m17:55:26.392021 [info ] [Thread-1 (]: 21 of 52 START test unique_key_scooters_company__model__hardware_id ............ [RUN]
[0m17:55:26.393019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b, now test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e)
[0m17:55:26.394018 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m17:55:26.404979 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m17:55:26.406982 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m17:55:26.411011 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m17:55:26.413018 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m17:55:26.413981 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: BEGIN
[0m17:55:26.413981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:26.779878 [debug] [Thread-4 (]: SQL status: BEGIN in 1.428 seconds
[0m17:55:26.780872 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m17:55:26.781871 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "group"
from
    "dev_gom1"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "group" is null


      
    ) dbt_internal_test
[0m17:55:26.880710 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.099 seconds
[0m17:55:26.882704 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: ROLLBACK
[0m17:55:26.984902 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: Close
[0m17:55:26.986897 [info ] [Thread-4 (]: 19 of 52 PASS unique_not_null_age_groups_group ................................. [[32mPASS[0m in 1.70s]
[0m17:55:26.987856 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m17:55:26.988899 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m17:55:26.988899 [info ] [Thread-4 (]: 22 of 52 START test unique_not_null_scooters_hardware_id ....................... [RUN]
[0m17:55:26.989853 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_group.39342291f1, now test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d)
[0m17:55:26.990895 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m17:55:26.994893 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m17:55:26.996853 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m17:55:26.999889 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m17:55:27.000892 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m17:55:27.001856 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: BEGIN
[0m17:55:27.001856 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:55:27.878870 [debug] [Thread-1 (]: SQL status: BEGIN in 1.464 seconds
[0m17:55:27.878870 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m17:55:27.879871 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "company"::text ||
    
        "model"::text ||
    
        "hardware_id"::text ||
    
    ''
from
    "dev_gom1"."dbt"."scooters"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m17:55:27.979730 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.099 seconds
[0m17:55:27.981690 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: ROLLBACK
[0m17:55:28.046346 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: Close
[0m17:55:28.047896 [info ] [Thread-1 (]: 21 of 52 PASS unique_key_scooters_company__model__hardware_id .................. [[32mPASS[0m in 1.65s]
[0m17:55:28.048907 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m17:55:28.049910 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m17:55:28.050906 [info ] [Thread-1 (]: 23 of 52 START test unique_not_null_scooters_model ............................. [RUN]
[0m17:55:28.051905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e, now test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc)
[0m17:55:28.052903 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m17:55:28.057935 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m17:55:28.058937 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m17:55:28.061935 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m17:55:28.062943 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m17:55:28.063906 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: BEGIN
[0m17:55:28.063906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:28.109949 [debug] [Thread-3 (]: SQL status: SELECT 1 in 3.127 seconds
[0m17:55:28.111944 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: ROLLBACK
[0m17:55:28.193721 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: Close
[0m17:55:28.194714 [info ] [Thread-3 (]: 15 of 52 PASS source_unique_scooters_raw_trips_id .............................. [[32mPASS[0m in 4.61s]
[0m17:55:28.196676 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m17:55:28.196676 [debug] [Thread-3 (]: Began running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m17:55:28.197715 [info ] [Thread-3 (]: 24 of 52 START test every_event_has_type ....................................... [RUN]
[0m17:55:28.198715 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4, now test.dbt_scooters.every_event_has_type.1e5fc977eb)
[0m17:55:28.199677 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m17:55:28.206705 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m17:55:28.207711 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m17:55:28.210709 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m17:55:28.211709 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m17:55:28.212713 [debug] [Thread-3 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: BEGIN
[0m17:55:28.212713 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:55:28.549765 [debug] [Thread-2 (]: SQL status: BEGIN in 2.249 seconds
[0m17:55:28.550718 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m17:55:28.551717 [debug] [Thread-2 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select scooter_hw_id as from_field
    from "dev_gom1"."scooters_raw"."trips"
    where scooter_hw_id is not null
),

parent as (
    select hardware_id as to_field
    from "dev_gom1"."dbt"."scooters"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:55:29.190905 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.639 seconds
[0m17:55:29.192862 [debug] [Thread-2 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: ROLLBACK
[0m17:55:29.283775 [debug] [Thread-2 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: Close
[0m17:55:29.284769 [info ] [Thread-2 (]: 20 of 52 PASS every_trip_has_scooter_id ........................................ [[32mPASS[0m in 3.00s]
[0m17:55:29.286739 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m17:55:29.286739 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m17:55:29.287737 [info ] [Thread-2 (]: 25 of 52 START test unique_not_null_event_types_type ........................... [RUN]
[0m17:55:29.288729 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_scooter_id.e0b845a190, now test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1)
[0m17:55:29.289780 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m17:55:29.294770 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m17:55:29.296729 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m17:55:29.298765 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m17:55:29.299732 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m17:55:29.300772 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: BEGIN
[0m17:55:29.301733 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:55:29.376650 [debug] [Thread-1 (]: SQL status: BEGIN in 1.313 seconds
[0m17:55:29.377601 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m17:55:29.377601 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "model"
from
    "dev_gom1"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "model" is null


      
    ) dbt_internal_test
[0m17:55:29.424642 [debug] [Thread-4 (]: SQL status: BEGIN in 2.423 seconds
[0m17:55:29.425601 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m17:55:29.426601 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "hardware_id"
from
    "dev_gom1"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "hardware_id" is null


      
    ) dbt_internal_test
[0m17:55:29.443648 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.065 seconds
[0m17:55:29.444642 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: ROLLBACK
[0m17:55:29.495823 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.069 seconds
[0m17:55:29.497823 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: ROLLBACK
[0m17:55:29.509831 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: Close
[0m17:55:29.510872 [info ] [Thread-1 (]: 23 of 52 PASS unique_not_null_scooters_model ................................... [[32mPASS[0m in 1.46s]
[0m17:55:29.512832 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m17:55:29.512832 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m17:55:29.513831 [info ] [Thread-1 (]: 26 of 52 START test unique_not_null_event_types_type_id ........................ [RUN]
[0m17:55:29.514828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc, now test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85)
[0m17:55:29.515859 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m17:55:29.519871 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m17:55:29.521832 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m17:55:29.523873 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m17:55:29.525837 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m17:55:29.526833 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: BEGIN
[0m17:55:29.526833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:29.564729 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: Close
[0m17:55:29.565723 [info ] [Thread-4 (]: 22 of 52 PASS unique_not_null_scooters_hardware_id ............................. [[32mPASS[0m in 2.58s]
[0m17:55:29.567690 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m17:55:29.567690 [debug] [Thread-4 (]: Began running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m17:55:29.568724 [info ] [Thread-4 (]: 27 of 52 START test accepted_values_add_first_name_sex_sex__M__F ............... [RUN]
[0m17:55:29.569686 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d, now test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199)
[0m17:55:29.570689 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m17:55:29.574723 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m17:55:29.576724 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m17:55:29.578724 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m17:55:29.580690 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m17:55:29.581689 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: BEGIN
[0m17:55:29.581689 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:55:30.266138 [debug] [Thread-3 (]: SQL status: BEGIN in 2.053 seconds
[0m17:55:30.267645 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m17:55:30.267645 [debug] [Thread-3 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_type.1e5fc977eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type_id as from_field
    from "dev_gom1"."scooters_raw"."events"
    where type_id is not null
),

parent as (
    select type_id as to_field
    from "dev_gom1"."dbt"."event_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:55:30.491892 [debug] [Thread-2 (]: SQL status: BEGIN in 1.190 seconds
[0m17:55:30.492897 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m17:55:30.492897 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type"
from
    "dev_gom1"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type" is null


      
    ) dbt_internal_test
[0m17:55:30.583944 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.090 seconds
[0m17:55:30.585944 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: ROLLBACK
[0m17:55:30.654584 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: Close
[0m17:55:30.655583 [info ] [Thread-2 (]: 25 of 52 PASS unique_not_null_event_types_type ................................. [[32mPASS[0m in 1.37s]
[0m17:55:30.657554 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m17:55:30.657554 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m17:55:30.658545 [info ] [Thread-2 (]: 28 of 52 START test unique_not_null_add_first_name_sex_first_name .............. [RUN]
[0m17:55:30.659550 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1, now test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f)
[0m17:55:30.661545 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m17:55:30.666551 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m17:55:30.668554 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m17:55:30.671550 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m17:55:30.673549 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m17:55:30.673549 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: BEGIN
[0m17:55:30.674550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:55:30.878933 [debug] [Thread-1 (]: SQL status: BEGIN in 1.351 seconds
[0m17:55:30.879937 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m17:55:30.880940 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type_id"
from
    "dev_gom1"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type_id" is null


      
    ) dbt_internal_test
[0m17:55:30.977516 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.096 seconds
[0m17:55:30.979524 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: ROLLBACK
[0m17:55:31.080606 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: Close
[0m17:55:31.081605 [info ] [Thread-1 (]: 26 of 52 PASS unique_not_null_event_types_type_id .............................. [[32mPASS[0m in 1.57s]
[0m17:55:31.083605 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m17:55:31.083605 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m17:55:31.084609 [info ] [Thread-1 (]: 29 of 52 START sql incremental model dbt.events_clean .......................... [RUN]
[0m17:55:31.085608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85, now model.dbt_scooters.events_clean)
[0m17:55:31.086609 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m17:55:31.099625 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m17:55:31.101626 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m17:55:31.169713 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:55:31.170705 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp175531142656"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at

from
    "dev_gom1"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_gom1"."dbt"."events_clean")
    

  );
  
  
[0m17:55:31.171710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:31.176705 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.908 seconds
[0m17:55:31.178713 [debug] [Thread-3 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: ROLLBACK
[0m17:55:31.244756 [debug] [Thread-3 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: Close
[0m17:55:31.245760 [info ] [Thread-3 (]: 24 of 52 PASS every_event_has_type ............................................. [[32mPASS[0m in 3.05s]
[0m17:55:31.248275 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m17:55:31.249287 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_prep
[0m17:55:31.250286 [info ] [Thread-3 (]: 30 of 52 START sql view model dbt.events_prep .................................. [RUN]
[0m17:55:31.251294 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_type.1e5fc977eb, now model.dbt_scooters.events_prep)
[0m17:55:31.252294 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_prep
[0m17:55:31.258826 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_prep"
[0m17:55:31.260829 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_prep
[0m17:55:31.295828 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_prep"
[0m17:55:31.298825 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:55:31.299832 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: BEGIN
[0m17:55:31.300830 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:55:31.626866 [debug] [Thread-4 (]: SQL status: BEGIN in 2.045 seconds
[0m17:55:31.627894 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m17:55:31.627894 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_gom1"."dbt"."add_first_name_sex"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m17:55:31.702730 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.073 seconds
[0m17:55:31.705731 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: ROLLBACK
[0m17:55:31.785755 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: Close
[0m17:55:31.786750 [debug] [Thread-2 (]: SQL status: BEGIN in 1.113 seconds
[0m17:55:31.788753 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m17:55:31.789755 [info ] [Thread-4 (]: 27 of 52 PASS accepted_values_add_first_name_sex_sex__M__F ..................... [[32mPASS[0m in 2.22s]
[0m17:55:31.791754 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "first_name"
from
    "dev_gom1"."dbt"."add_first_name_sex"
group by
    1
having
    count(*) > 1 or "first_name" is null


      
    ) dbt_internal_test
[0m17:55:31.793751 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m17:55:31.794751 [debug] [Thread-4 (]: Began running node model.dbt_scooters.first_name_sex
[0m17:55:31.796759 [info ] [Thread-4 (]: 31 of 52 START sql table model dbt.first_name_sex .............................. [RUN]
[0m17:55:31.797755 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199, now model.dbt_scooters.first_name_sex)
[0m17:55:31.798757 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.first_name_sex
[0m17:55:31.802756 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.first_name_sex"
[0m17:55:31.804758 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.first_name_sex
[0m17:55:31.830757 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.first_name_sex"
[0m17:55:31.833756 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:55:31.834756 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: BEGIN
[0m17:55:31.835754 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:55:31.876623 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.082 seconds
[0m17:55:31.879575 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: ROLLBACK
[0m17:55:31.945618 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: Close
[0m17:55:31.947578 [info ] [Thread-2 (]: 28 of 52 PASS unique_not_null_add_first_name_sex_first_name .................... [[32mPASS[0m in 1.29s]
[0m17:55:31.949089 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m17:55:31.950100 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_concurrency
[0m17:55:31.951100 [info ] [Thread-2 (]: 32 of 52 START sql incremental model dbt.trips_concurrency ..................... [RUN]
[0m17:55:31.952099 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f, now model.dbt_scooters.trips_concurrency)
[0m17:55:31.953103 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m17:55:31.959695 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m17:55:31.961692 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m17:55:31.967694 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:55:31.968694 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp175531965697"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_gom1"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_gom1"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_gom1"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_gom1"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now()  as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m17:55:31.969702 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:55:32.477922 [debug] [Thread-3 (]: SQL status: BEGIN in 1.177 seconds
[0m17:55:32.478920 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:55:32.478920 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

  create view "dev_gom1"."dbt"."events_prep__dbt_tmp"
    
    
  as (
    select
    user_id,
    "timestamp",
    type_id,
    date("timestamp") as "date"
from
    "dev_gom1"."scooters_raw"."events"
  );
[0m17:55:32.578537 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.098 seconds
[0m17:55:32.587533 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:55:32.588544 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
alter table "dev_gom1"."dbt"."events_prep" rename to "events_prep__dbt_backup"
[0m17:55:32.653099 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.064 seconds
[0m17:55:32.657605 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:55:32.658615 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
alter table "dev_gom1"."dbt"."events_prep__dbt_tmp" rename to "events_prep"
[0m17:55:32.725664 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.066 seconds
[0m17:55:32.730670 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:55:32.730670 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

    
  
  comment on view "dev_gom1"."dbt"."events_prep" is $dbt_comment_literal_block$User events prepared for following processing$dbt_comment_literal_block$;

  
[0m17:55:32.880816 [debug] [Thread-3 (]: SQL status: COMMENT in 0.149 seconds
[0m17:55:32.884818 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:55:32.884818 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_prep'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:55:33.083021 [debug] [Thread-4 (]: SQL status: BEGIN in 1.248 seconds
[0m17:55:33.084023 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:55:33.085024 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

  
    

  create  table "dev_gom1"."dbt"."first_name_sex__dbt_tmp"
  
  
    as
  
  (
    select distinct first_name, sex
from "dev_gom1"."scooters_raw"."users"
Where sex is not null
  );
  
[0m17:55:33.180636 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.295 seconds
[0m17:55:33.184644 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:55:33.185639 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."events_prep".date is $dbt_comment_literal_block$Date of event derived from timestamp.
Imitates Hive-styled partitioning of events by date.
It is needed for efficient incremental processing by engines
with partitioning support (i.e. Trino).$dbt_comment_literal_block$;
  

  
[0m17:55:33.189650 [debug] [Thread-4 (]: SQL status: SELECT 387 in 0.104 seconds
[0m17:55:33.195649 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:55:33.196651 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_gom1"."dbt"."first_name_sex" rename to "first_name_sex__dbt_backup"
[0m17:55:33.277769 [debug] [Thread-3 (]: SQL status: COMMENT in 0.090 seconds
[0m17:55:33.279775 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: COMMIT
[0m17:55:33.280779 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:55:33.281775 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: COMMIT
[0m17:55:33.281775 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.084 seconds
[0m17:55:33.286780 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:55:33.287780 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_gom1"."dbt"."first_name_sex__dbt_tmp" rename to "first_name_sex"
[0m17:55:33.379874 [debug] [Thread-3 (]: SQL status: COMMIT in 0.097 seconds
[0m17:55:33.388883 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."events_prep__dbt_backup"
[0m17:55:33.389880 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.101 seconds
[0m17:55:33.396879 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:55:33.403888 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:55:33.404884 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
drop view if exists "dev_gom1"."dbt"."events_prep__dbt_backup" cascade
[0m17:55:33.405884 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

    
  
  comment on table "dev_gom1"."dbt"."first_name_sex" is $dbt_comment_literal_block$Unique name_sex glossary$dbt_comment_literal_block$;

  
[0m17:55:33.480962 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.074 seconds
[0m17:55:33.482963 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: Close
[0m17:55:33.483965 [debug] [Thread-4 (]: SQL status: COMMENT in 0.077 seconds
[0m17:55:33.485970 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m17:55:33.486963 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF1CE62A0>]}
[0m17:55:33.487970 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:55:33.488973 [info ] [Thread-3 (]: 30 of 52 OK created sql view model dbt.events_prep ............................. [[32mCREATE VIEW[0m in 2.24s]
[0m17:55:33.489971 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m17:55:33.490977 [debug] [Thread-1 (]: SQL status: SELECT 0 in 2.319 seconds
[0m17:55:33.491969 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_prep
[0m17:55:33.495973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:55:33.496973 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_geom
[0m17:55:33.497984 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m17:55:33.498984 [info ] [Thread-3 (]: 33 of 52 START sql view model dbt.trips_geom ................................... [RUN]
[0m17:55:33.500989 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_prep, now model.dbt_scooters.trips_geom)
[0m17:55:33.501980 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_geom
[0m17:55:33.506985 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m17:55:33.509997 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_geom
[0m17:55:33.518003 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m17:55:33.520010 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m17:55:33.521006 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m17:55:33.522005 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:55:33.580588 [debug] [Thread-4 (]: SQL status: COMMIT in 0.088 seconds
[0m17:55:33.584590 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."first_name_sex__dbt_backup"
[0m17:55:33.585588 [debug] [Thread-1 (]: SQL status: BEGIN in 0.086 seconds
[0m17:55:33.590601 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:55:33.591608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:55:33.592607 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
drop table if exists "dev_gom1"."dbt"."first_name_sex__dbt_backup" cascade
[0m17:55:33.593600 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp175531142656'
        
      order by ordinal_position

  
[0m17:55:33.683711 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.090 seconds
[0m17:55:33.686712 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: Close
[0m17:55:33.687712 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF1BBF470>]}
[0m17:55:33.688722 [info ] [Thread-4 (]: 31 of 52 OK created sql table model dbt.first_name_sex ......................... [[32mSELECT 387[0m in 1.89s]
[0m17:55:33.690727 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.first_name_sex
[0m17:55:33.691723 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_prep
[0m17:55:33.692718 [info ] [Thread-4 (]: 34 of 52 START sql view model dbt.trips_prep ................................... [RUN]
[0m17:55:33.693718 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.first_name_sex, now model.dbt_scooters.trips_prep)
[0m17:55:33.694719 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_prep
[0m17:55:33.699728 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m17:55:33.700724 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_prep
[0m17:55:33.706735 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m17:55:33.708773 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:55:33.708773 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m17:55:33.709770 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:55:33.881972 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.287 seconds
[0m17:55:33.886964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:55:33.887976 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:55:34.001575 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.113 seconds
[0m17:55:34.021590 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:55:34.022590 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp175531142656'
        
      order by ordinal_position

  
[0m17:55:34.182781 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.159 seconds
[0m17:55:34.187782 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:55:34.187782 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:55:34.284888 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.096 seconds
[0m17:55:34.298903 [debug] [Thread-1 (]: 
    In "dev_gom1"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:55:34.324918 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m17:55:34.326919 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:55:34.327926 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        
            delete from "dev_gom1"."dbt"."events_clean"
            using "events_clean__dbt_tmp175531142656"
            where (
                
                    "events_clean__dbt_tmp175531142656".user_id = "dev_gom1"."dbt"."events_clean".user_id
                    and 
                
                    "events_clean__dbt_tmp175531142656".timestamp = "dev_gom1"."dbt"."events_clean".timestamp
                    and 
                
                    "events_clean__dbt_tmp175531142656".type_id = "dev_gom1"."dbt"."events_clean".type_id
                    
                
                
            );
        
    

    insert into "dev_gom1"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp175531142656"
    )
  
[0m17:55:34.493593 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.165 seconds
[0m17:55:34.495593 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:55:34.496595 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
  comment on table "dev_gom1"."dbt"."events_clean" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m17:55:34.582676 [debug] [Thread-1 (]: SQL status: COMMENT in 0.085 seconds
[0m17:55:34.584677 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m17:55:34.584677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:55:34.585677 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m17:55:34.681775 [debug] [Thread-1 (]: SQL status: COMMIT in 0.095 seconds
[0m17:55:34.683770 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m17:55:34.684770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF1CE2A20>]}
[0m17:55:34.685775 [info ] [Thread-1 (]: 29 of 52 OK created sql incremental model dbt.events_clean ..................... [[32mINSERT 0 0[0m in 3.60s]
[0m17:55:34.686778 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m17:55:34.687777 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m17:55:34.688787 [info ] [Thread-1 (]: 35 of 52 START sql table model dbt.companies ................................... [RUN]
[0m17:55:34.689786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.companies)
[0m17:55:34.690788 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m17:55:34.694786 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m17:55:34.696788 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m17:55:34.701793 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m17:55:34.703795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:55:34.704796 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m17:55:34.705798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:34.978626 [debug] [Thread-3 (]: SQL status: BEGIN in 1.457 seconds
[0m17:55:34.979630 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m17:55:34.980627 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_gom1"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_gom1"."scooters_raw"."trips"
  );
[0m17:55:35.079729 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.098 seconds
[0m17:55:35.080730 [debug] [Thread-4 (]: SQL status: BEGIN in 1.371 seconds
[0m17:55:35.084725 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m17:55:35.085730 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:55:35.086731 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_gom1"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m17:55:35.086731 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_gom1"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select
    id,
    user_id,
    scooter_hw_id,
    started_at,
    finished_at,
    start_lat,
    start_lon,
    finish_lat,
    finish_lon,
    distance as distance_m,
    cast(price as decimal(20, 2)) / 100 as price_rub,
    extract(epoch from (finished_at - started_at)) as duration_s,
    finished_at <> started_at and price = 0 as is_free,
    
    date(started_at at time zone 'Europe/Moscow')
 as "date"
from
    "dev_gom1"."scooters_raw"."trips"
  );
[0m17:55:35.175815 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m17:55:35.178826 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m17:55:35.178826 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

    
  
  comment on view "dev_gom1"."dbt"."trips_geom" is $dbt_comment_literal_block$Trips prepared for geometry analysis$dbt_comment_literal_block$;

  
[0m17:55:35.181823 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.094 seconds
[0m17:55:35.185827 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:55:35.186828 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_gom1"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m17:55:35.244882 [debug] [Thread-3 (]: SQL status: COMMENT in 0.065 seconds
[0m17:55:35.247901 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m17:55:35.248896 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m17:55:35.249897 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m17:55:35.278963 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m17:55:35.282959 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:55:35.283959 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_gom1"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m17:55:35.316985 [debug] [Thread-3 (]: SQL status: COMMIT in 0.066 seconds
[0m17:55:35.321995 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."trips_geom__dbt_backup"
[0m17:55:35.322996 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m17:55:35.323993 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_gom1"."dbt"."trips_geom__dbt_backup" cascade
[0m17:55:35.353538 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.068 seconds
[0m17:55:35.356547 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:55:35.356547 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

    
  
  comment on view "dev_gom1"."dbt"."trips_prep" is $dbt_comment_literal_block$Trips prepared for analysis$dbt_comment_literal_block$;

  
[0m17:55:35.396608 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.072 seconds
[0m17:55:35.399615 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: Close
[0m17:55:35.401624 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF008A750>]}
[0m17:55:35.402621 [info ] [Thread-3 (]: 33 of 52 OK created sql view model dbt.trips_geom .............................. [[32mCREATE VIEW[0m in 1.90s]
[0m17:55:35.404626 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_geom
[0m17:55:35.406620 [debug] [Thread-3 (]: Began running node model.dbt_scooters.users_full
[0m17:55:35.407621 [info ] [Thread-3 (]: 36 of 52 START sql table model dbt.users_full .................................. [RUN]
[0m17:55:35.409638 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.users_full)
[0m17:55:35.410634 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.users_full
[0m17:55:35.414631 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.users_full"
[0m17:55:35.417634 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.users_full
[0m17:55:35.423641 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.users_full"
[0m17:55:35.425643 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:55:35.425643 [debug] [Thread-4 (]: SQL status: COMMENT in 0.068 seconds
[0m17:55:35.426646 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: BEGIN
[0m17:55:35.428655 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m17:55:35.429650 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:55:35.430651 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:55:35.431659 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m17:55:35.498789 [debug] [Thread-2 (]: SQL status: SELECT 0 in 3.529 seconds
[0m17:55:35.505792 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:55:35.506794 [debug] [Thread-4 (]: SQL status: COMMIT in 0.074 seconds
[0m17:55:35.507790 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m17:55:35.511795 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."trips_prep__dbt_backup"
[0m17:55:35.513802 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:55:35.514801 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_gom1"."dbt"."trips_prep__dbt_backup" cascade
[0m17:55:35.580906 [debug] [Thread-2 (]: SQL status: BEGIN in 0.068 seconds
[0m17:55:35.581905 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:55:35.582901 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp175531965697'
        
      order by ordinal_position

  
[0m17:55:35.584900 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.069 seconds
[0m17:55:35.587917 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: Close
[0m17:55:35.588913 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF21C51C0>]}
[0m17:55:35.589911 [info ] [Thread-4 (]: 34 of 52 OK created sql view model dbt.trips_prep .............................. [[32mCREATE VIEW[0m in 1.90s]
[0m17:55:35.591921 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_prep
[0m17:55:35.591921 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_full
[0m17:55:35.593912 [info ] [Thread-4 (]: 37 of 52 START sql view model dbt.events_full .................................. [RUN]
[0m17:55:35.594918 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.events_full)
[0m17:55:35.595915 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_full
[0m17:55:35.599925 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m17:55:35.602936 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_full
[0m17:55:35.607939 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m17:55:35.609934 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:55:35.610934 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: BEGIN
[0m17:55:35.610934 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:55:35.682553 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.099 seconds
[0m17:55:35.687546 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:55:35.688553 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:55:35.763645 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.075 seconds
[0m17:55:35.768651 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:55:35.769648 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp175531965697'
        
      order by ordinal_position

  
[0m17:55:35.852721 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.082 seconds
[0m17:55:35.857754 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:55:35.858763 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:55:35.940815 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.081 seconds
[0m17:55:35.943814 [debug] [Thread-2 (]: 
    In "dev_gom1"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:55:35.951827 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m17:55:35.953829 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:55:35.954336 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_gom1"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp175531965697"
    )


  
[0m17:55:36.025912 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.071 seconds
[0m17:55:36.028923 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:55:36.029923 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_concurrency" is $dbt_comment_literal_block$Number of simultaneous rides in time$dbt_comment_literal_block$;

  
[0m17:55:36.102011 [debug] [Thread-2 (]: SQL status: COMMENT in 0.072 seconds
[0m17:55:36.105008 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m17:55:36.105008 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:55:36.106007 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m17:55:36.178618 [debug] [Thread-2 (]: SQL status: COMMIT in 0.072 seconds
[0m17:55:36.180620 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: Close
[0m17:55:36.181615 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF2040200>]}
[0m17:55:36.182615 [info ] [Thread-2 (]: 32 of 52 OK created sql incremental model dbt.trips_concurrency ................ [[32mINSERT 0 0[0m in 4.23s]
[0m17:55:36.184627 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m17:55:36.185616 [debug] [Thread-2 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m17:55:36.186619 [info ] [Thread-2 (]: 38 of 52 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m17:55:36.187622 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.parking_finish_stat)
[0m17:55:36.188669 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m17:55:36.194631 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m17:55:36.196637 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m17:55:36.202640 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m17:55:36.212652 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m17:55:36.213659 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m17:55:36.214651 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:55:36.697816 [debug] [Thread-3 (]: SQL status: BEGIN in 1.268 seconds
[0m17:55:36.698768 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:55:36.699767 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

  
    

  create  table "dev_gom1"."dbt"."users_full__dbt_tmp"
  
  
    as
  
  (
    select
   u.id, u.first_name ,u.last_name ,u.phone ,
   COALESCE(u.sex, fns.sex, afns.sex) as sex2,
   u.birth_date
from "dev_gom1"."scooters_raw"."users" u
left join "dev_gom1"."dbt"."first_name_sex" fns on u.first_name = fns.first_name
left join "dev_gom1"."dbt"."add_first_name_sex" afns on u.first_name =afns.first_name
  );
  
[0m17:55:36.775609 [debug] [Thread-1 (]: SQL status: BEGIN in 2.069 seconds
[0m17:55:36.776609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:55:36.777608 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_gom1"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_gom1"."dbt"."scooters"
group by
    1
  );
  
[0m17:55:36.927888 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.150 seconds
[0m17:55:36.928847 [debug] [Thread-3 (]: SQL status: SELECT 2000 in 0.228 seconds
[0m17:55:36.932880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:55:36.938890 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:55:36.939881 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_gom1"."dbt"."companies" rename to "companies__dbt_backup"
[0m17:55:36.940846 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_gom1"."dbt"."users_full" rename to "users_full__dbt_backup"
[0m17:55:37.033723 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m17:55:37.034707 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m17:55:37.038699 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:55:37.042699 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:55:37.042699 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_gom1"."dbt"."companies__dbt_tmp" rename to "companies"
[0m17:55:37.043702 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_gom1"."dbt"."users_full__dbt_tmp" rename to "users_full"
[0m17:55:37.126891 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.082 seconds
[0m17:55:37.129891 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:55:37.129891 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

    
  
  comment on table "dev_gom1"."dbt"."users_full" is $dbt_comment_literal_block$Users enriched with sex$dbt_comment_literal_block$;

  
[0m17:55:37.146890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.102 seconds
[0m17:55:37.148893 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:55:37.149892 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

    
  
  comment on table "dev_gom1"."dbt"."companies" is $dbt_comment_literal_block$Scooter statistics by company$dbt_comment_literal_block$;

  
[0m17:55:37.206750 [debug] [Thread-3 (]: SQL status: COMMENT in 0.076 seconds
[0m17:55:37.208711 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: COMMIT
[0m17:55:37.209711 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:55:37.209711 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: COMMIT
[0m17:55:37.219737 [debug] [Thread-1 (]: SQL status: COMMENT in 0.069 seconds
[0m17:55:37.221744 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m17:55:37.221744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:55:37.222743 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m17:55:37.285774 [debug] [Thread-3 (]: SQL status: COMMIT in 0.076 seconds
[0m17:55:37.288781 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."users_full__dbt_backup"
[0m17:55:37.289783 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:55:37.290783 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
drop table if exists "dev_gom1"."dbt"."users_full__dbt_backup" cascade
[0m17:55:37.302782 [debug] [Thread-1 (]: SQL status: COMMIT in 0.079 seconds
[0m17:55:37.305782 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."companies__dbt_backup"
[0m17:55:37.306783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:55:37.307783 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_gom1"."dbt"."companies__dbt_backup" cascade
[0m17:55:37.374633 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.083 seconds
[0m17:55:37.376672 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: Close
[0m17:55:37.377636 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF1C36990>]}
[0m17:55:37.378632 [info ] [Thread-3 (]: 36 of 52 OK created sql table model dbt.users_full ............................. [[32mSELECT 2000[0m in 1.97s]
[0m17:55:37.379638 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.users_full
[0m17:55:37.380671 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_start_stat
[0m17:55:37.381633 [info ] [Thread-3 (]: 39 of 52 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m17:55:37.382633 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.users_full, now model.dbt_scooters.parking_start_stat)
[0m17:55:37.383659 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m17:55:37.387684 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m17:55:37.390633 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m17:55:37.391668 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.084 seconds
[0m17:55:37.396668 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m17:55:37.398667 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m17:55:37.399636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF1C36450>]}
[0m17:55:37.400633 [info ] [Thread-1 (]: 35 of 52 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 2.71s]
[0m17:55:37.401638 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m17:55:37.402667 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m17:55:37.403632 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m17:55:37.404635 [debug] [Thread-2 (]: SQL status: BEGIN in 1.190 seconds
[0m17:55:37.405638 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m17:55:37.406639 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:55:37.407666 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m17:55:37.408640 [info ] [Thread-1 (]: 40 of 52 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m17:55:37.409637 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_gom1"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_gom1"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m17:55:37.410638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.revenue_daily)
[0m17:55:37.411634 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m17:55:37.415669 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m17:55:37.417670 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m17:55:37.444666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:55:37.445632 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
select * from (
        select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep"

group by
    2,
    3
order by
    2
    ) as __dbt_sbq
    where false
    limit 0

[0m17:55:37.446636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:38.579636 [debug] [Thread-4 (]: SQL status: BEGIN in 2.969 seconds
[0m17:55:38.580633 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:55:38.581622 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_gom1"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select * from
"dev_gom1"."dbt"."events_clean" as e
left join "dev_gom1"."dbt"."event_types" as t
using (type_id)
  );
[0m17:55:38.690805 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.109 seconds
[0m17:55:38.694808 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:55:38.695764 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_gom1"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m17:55:38.783629 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m17:55:38.788627 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:55:38.789625 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_gom1"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m17:55:38.883834 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m17:55:38.885833 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:55:38.886803 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

    
  
  comment on view "dev_gom1"."dbt"."events_full" is $dbt_comment_literal_block$User events enriched with meaningful types$dbt_comment_literal_block$;

  
[0m17:55:38.980952 [debug] [Thread-4 (]: SQL status: COMMENT in 0.094 seconds
[0m17:55:38.982954 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m17:55:38.982954 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:55:38.983956 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m17:55:39.089539 [debug] [Thread-4 (]: SQL status: COMMIT in 0.105 seconds
[0m17:55:39.092537 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."events_full__dbt_backup"
[0m17:55:39.093538 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:55:39.093538 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_gom1"."dbt"."events_full__dbt_backup" cascade
[0m17:55:39.187608 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.093 seconds
[0m17:55:39.189615 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: Close
[0m17:55:39.190613 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF2254410>]}
[0m17:55:39.191614 [info ] [Thread-4 (]: 37 of 52 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 3.60s]
[0m17:55:39.192614 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_full
[0m17:55:39.193617 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat
[0m17:55:39.194616 [info ] [Thread-4 (]: 41 of 52 START sql table model dbt.trips_stat .................................. [RUN]
[0m17:55:39.195619 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_stat)
[0m17:55:39.195619 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat
[0m17:55:39.198625 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m17:55:39.200626 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat
[0m17:55:39.204622 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m17:55:39.206629 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:55:39.207628 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m17:55:39.207628 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:55:39.785578 [debug] [Thread-3 (]: SQL status: BEGIN in 2.379 seconds
[0m17:55:39.786579 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m17:55:39.786579 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_gom1"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_gom1"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m17:55:39.789587 [debug] [Thread-1 (]: SQL status: SELECT 0 in 2.343 seconds
[0m17:55:39.801593 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:55:39.802594 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
select * from (
        select
    
      
    cast(null as decimal(20, 2))
 as revenue_rub, 
      
    cast(null as date)
 as date, 
      
    cast(null as timestamptz)
 as updated_at
    ) as __dbt_sbq
    where false
    limit 0

[0m17:55:39.903660 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.100 seconds
[0m17:55:39.922669 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m17:55:39.923669 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:55:39.924670 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m17:55:40.002729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m17:55:40.002729 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:55:40.003733 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
  
    

  create  table "dev_gom1"."finance"."revenue_daily"
  
  
    
  
  (
    revenue_rub decimal(20, 2),
    date date,
    updated_at timestamptz
    
    )
 ;
    insert into "dev_gom1"."finance"."revenue_daily" (
      revenue_rub, date, updated_at
    )
  
  (
    
    select revenue_rub, date, updated_at
    from (
        select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep"

group by
    2,
    3
order by
    2
    ) as model_subq
  );
  
  
[0m17:55:40.776872 [debug] [Thread-4 (]: SQL status: BEGIN in 1.569 seconds
[0m17:55:40.777877 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:55:40.777877 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_gom1"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count(*) as trips,
    count(distinct user_id) as users,
    avg(duration_s) / 60 as avg_duration_min,
    sum(distance_m) / 1000 as sum_distance_km,
    sum(price_rub) as revenue_rub,
    count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from
    "dev_gom1"."dbt"."trips_prep"
  );
  
[0m17:55:44.680928 [debug] [Thread-1 (]: SQL status: INSERT 0 91 in 4.677 seconds
[0m17:55:44.695934 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:55:44.696936 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

        
            grant select on "dev_gom1"."finance"."revenue_daily" to finance;
        
    
[0m17:55:44.783999 [debug] [Thread-1 (]: Postgres adapter: Postgres error: role "finance" does not exist

[0m17:55:44.784998 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: ROLLBACK
[0m17:55:44.881590 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m17:55:44.889592 [debug] [Thread-1 (]: Database Error in model revenue_daily (models\finance\revenue_daily.sql)
  role "finance" does not exist
  compiled code at target\run\dbt_scooters\models\finance\revenue_daily.sql
[0m17:55:44.890592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF21BFEC0>]}
[0m17:55:44.891594 [error] [Thread-1 (]: 40 of 52 ERROR creating sql incremental model finance.revenue_daily ............ [[31mERROR[0m in 7.48s]
[0m17:55:44.892594 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m17:55:44.893594 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m17:55:44.893594 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.revenue_daily' to be skipped because of status 'error'.  Reason: Database Error in model revenue_daily (models\finance\revenue_daily.sql)
  role "finance" does not exist
  compiled code at target\run\dbt_scooters\models\finance\revenue_daily.sql.
[0m17:55:44.894598 [info ] [Thread-1 (]: 42 of 52 START sql table model dbt.trips_stat_daily ............................ [RUN]
[0m17:55:44.895595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_stat_daily)
[0m17:55:44.896600 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m17:55:44.900603 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m17:55:44.902601 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m17:55:44.906601 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m17:55:44.908606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:55:44.908606 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m17:55:44.909608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:46.277965 [debug] [Thread-1 (]: SQL status: BEGIN in 1.368 seconds
[0m17:55:46.278965 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:55:46.278965 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_gom1"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    count(*) as trips,
    max(price_rub) as max_price_rub,
    avg(distance_m) / 1000 as avg_distance_km,
    avg(price_rub)/avg(duration_s) * 60 as avg_price_rub_per_min
from
    "dev_gom1"."dbt"."trips_prep"
group by
    1
order by
    1
  );
  
[0m17:55:46.282963 [debug] [Thread-4 (]: SQL status: SELECT 1 in 5.504 seconds
[0m17:55:46.285963 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:55:46.286964 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_gom1"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m17:55:46.378993 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m17:55:46.381992 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:55:46.382992 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_gom1"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m17:55:46.477529 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m17:55:46.479537 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:55:46.480538 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_stat" is $dbt_comment_literal_block$Overall trips statistics$dbt_comment_literal_block$;

  
[0m17:55:46.578564 [debug] [Thread-4 (]: SQL status: COMMENT in 0.097 seconds
[0m17:55:46.579565 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m17:55:46.580563 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:55:46.580563 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m17:55:46.681592 [debug] [Thread-4 (]: SQL status: COMMIT in 0.100 seconds
[0m17:55:46.684591 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."trips_stat__dbt_backup"
[0m17:55:46.685590 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:55:46.685590 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_gom1"."dbt"."trips_stat__dbt_backup" cascade
[0m17:55:46.779619 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.093 seconds
[0m17:55:46.781620 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: Close
[0m17:55:46.782620 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF1C68110>]}
[0m17:55:46.783621 [info ] [Thread-4 (]: 41 of 52 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 7.59s]
[0m17:55:46.784622 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat
[0m17:55:46.785622 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m17:55:46.785622 [info ] [Thread-4 (]: 43 of 52 START sql incremental model dbt.trips_users ........................... [RUN]
[0m17:55:46.786619 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_users)
[0m17:55:46.787620 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m17:55:46.792618 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m17:55:46.793620 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m17:55:46.798619 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:55:46.799619 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp175546796621"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep" as t
left join
    "dev_gom1"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_gom1"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m17:55:46.799619 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:55:49.379976 [debug] [Thread-4 (]: SQL status: SELECT 0 in 2.580 seconds
[0m17:55:49.383974 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:55:49.384933 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m17:55:49.453975 [debug] [Thread-4 (]: SQL status: BEGIN in 0.069 seconds
[0m17:55:49.454935 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:55:49.454935 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp175546796621'
        
      order by ordinal_position

  
[0m17:55:49.781736 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.326 seconds
[0m17:55:49.785739 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:55:49.785739 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:55:49.884015 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.097 seconds
[0m17:55:49.887565 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:55:49.888597 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp175546796621'
        
      order by ordinal_position

  
[0m17:55:49.982834 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.094 seconds
[0m17:55:49.986827 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:55:49.987839 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:55:50.086094 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.098 seconds
[0m17:55:50.089687 [debug] [Thread-4 (]: 
    In "dev_gom1"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:55:50.090649 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m17:55:50.091646 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:55:50.092688 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_gom1"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp175546796621"
    )


  
[0m17:55:50.183938 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.091 seconds
[0m17:55:50.185933 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:55:50.186894 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_users" is $dbt_comment_literal_block$Prepared trips enriched with users data$dbt_comment_literal_block$;

  
[0m17:55:50.283143 [debug] [Thread-4 (]: SQL status: COMMENT in 0.095 seconds
[0m17:55:50.284146 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:55:50.285143 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m17:55:51.478888 [debug] [Thread-1 (]: Postgres adapter: Postgres error: SSL connection has been closed unexpectedly

[0m17:55:51.479843 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: ROLLBACK
[0m17:55:51.481843 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_scooters.trips_stat_daily'
[0m17:55:51.482842 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m17:55:51.484842 [debug] [Thread-1 (]: Database Error in model trips_stat_daily (models\trips_stat_daily.sql)
  SSL connection has been closed unexpectedly
  compiled code at target\run\dbt_scooters\models\trips_stat_daily.sql
[0m17:55:51.485842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF2183F80>]}
[0m17:55:51.486843 [error] [Thread-1 (]: 42 of 52 ERROR creating sql table model dbt.trips_stat_daily ................... [[31mERROR[0m in 6.59s]
[0m17:55:51.487849 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m17:55:51.488892 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies_trips
[0m17:55:51.489887 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.trips_stat_daily' to be skipped because of status 'error'.  Reason: Database Error in model trips_stat_daily (models\trips_stat_daily.sql)
  SSL connection has been closed unexpectedly
  compiled code at target\run\dbt_scooters\models\trips_stat_daily.sql.
[0m17:55:51.490850 [info ] [Thread-1 (]: 44 of 52 START sql table model dbt.companies_trips ............................. [RUN]
[0m17:55:51.491855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.companies_trips)
[0m17:55:51.491855 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies_trips
[0m17:55:51.495851 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m17:55:51.497853 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies_trips
[0m17:55:51.501886 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m17:55:51.502853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:55:51.503888 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m17:55:51.503888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:51.678960 [debug] [Thread-3 (]: Postgres adapter: Postgres error: SSL connection has been closed unexpectedly

[0m17:55:51.679902 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: ROLLBACK
[0m17:55:51.680940 [debug] [Thread-3 (]: Failed to rollback 'model.dbt_scooters.parking_start_stat'
[0m17:55:51.681898 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: Close
[0m17:55:51.681898 [debug] [Thread-2 (]: Postgres adapter: Postgres error: SSL connection has been closed unexpectedly

[0m17:55:51.683932 [debug] [Thread-4 (]: Postgres adapter: Postgres error: SSL connection has been closed unexpectedly

[0m17:55:51.684902 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: ROLLBACK
[0m17:55:51.685938 [debug] [Thread-3 (]: Database Error in model parking_start_stat (models\parking_start_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target\run\dbt_scooters\models\parking_start_stat.sql
[0m17:55:51.686899 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: ROLLBACK
[0m17:55:51.687898 [debug] [Thread-2 (]: Failed to rollback 'model.dbt_scooters.parking_finish_stat'
[0m17:55:51.687898 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF215ECC0>]}
[0m17:55:51.688938 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m17:55:51.689898 [debug] [Thread-4 (]: Failed to rollback 'model.dbt_scooters.trips_users'
[0m17:55:51.690897 [error] [Thread-3 (]: 39 of 52 ERROR creating sql table model dbt.parking_start_stat ................. [[31mERROR[0m in 14.31s]
[0m17:55:51.692903 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m17:55:51.693897 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m17:55:51.696897 [debug] [Thread-2 (]: Database Error in model parking_finish_stat (models\parking_finish_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target\run\dbt_scooters\models\parking_finish_stat.sql
[0m17:55:51.697907 [debug] [Thread-3 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m17:55:51.698902 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.parking_start_stat' to be skipped because of status 'error'.  Reason: Database Error in model parking_start_stat (models\parking_start_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target\run\dbt_scooters\models\parking_start_stat.sql.
[0m17:55:51.699904 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF22F8830>]}
[0m17:55:51.699904 [info ] [Thread-3 (]: 45 of 52 START test events_full_is_complete .................................... [RUN]
[0m17:55:51.701940 [debug] [Thread-4 (]: Database Error in model trips_users (models\trips_users.sql)
  SSL connection has been closed unexpectedly
  compiled code at target\run\dbt_scooters\models\trips_users.sql
[0m17:55:51.703905 [error] [Thread-2 (]: 38 of 52 ERROR creating sql table model dbt.parking_finish_stat ................ [[31mERROR[0m in 15.51s]
[0m17:55:51.704905 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now test.dbt_scooters.events_full_is_complete)
[0m17:55:51.705905 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF13D7500>]}
[0m17:55:51.706917 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m17:55:51.707905 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m17:55:51.707905 [error] [Thread-4 (]: 43 of 52 ERROR creating sql incremental model dbt.trips_users .................. [[31mERROR[0m in 4.92s]
[0m17:55:51.709905 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.parking_finish_stat' to be skipped because of status 'error'.  Reason: Database Error in model parking_finish_stat (models\parking_finish_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target\run\dbt_scooters\models\parking_finish_stat.sql.
[0m17:55:51.712940 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m17:55:51.713940 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m17:55:51.715906 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.trips_users' to be skipped because of status 'error'.  Reason: Database Error in model trips_users (models\trips_users.sql)
  SSL connection has been closed unexpectedly
  compiled code at target\run\dbt_scooters\models\trips_users.sql.
[0m17:55:51.716904 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m17:55:51.716904 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_daily
[0m17:55:51.719939 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.events_full_is_complete"
[0m17:55:51.719939 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_group
[0m17:55:51.720903 [info ] [Thread-2 (]: 46 of 52 SKIP relation dbt.trips_age_daily ..................................... [[33mSKIP[0m]
[0m17:55:51.721908 [info ] [Thread-4 (]: 47 of 52 SKIP relation dbt.trips_age_group ..................................... [[33mSKIP[0m]
[0m17:55:51.722903 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m17:55:51.723907 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m17:55:51.723907 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_group
[0m17:55:51.724905 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.trips_age_daily' to be skipped because of status 'skipped'. 
[0m17:55:51.725906 [debug] [Thread-3 (]: On test.dbt_scooters.events_full_is_complete: BEGIN
[0m17:55:51.726905 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.trips_age_group' to be skipped because of status 'skipped'. 
[0m17:55:51.727910 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m17:55:51.727910 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:55:51.728908 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m17:55:51.729912 [info ] [Thread-2 (]: 48 of 52 SKIP test unique_key_trips_age_daily_date__age ........................ [[33mSKIP[0m]
[0m17:55:51.730903 [info ] [Thread-4 (]: 49 of 52 SKIP test unique_trips_age_daily_date_text_age_text ................... [[33mSKIP[0m]
[0m17:55:51.732905 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m17:55:51.733906 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m17:55:51.733906 [debug] [Thread-7 (]: Marking all children of 'test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be' to be skipped because of status 'skipped'. 
[0m17:55:51.734904 [debug] [Thread-7 (]: Marking all children of 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e' to be skipped because of status 'skipped'. 
[0m17:55:51.735904 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m17:55:51.736907 [info ] [Thread-2 (]: 50 of 52 SKIP relation dbt.trips_age_daily_stat ................................ [[33mSKIP[0m]
[0m17:55:51.737907 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m17:55:51.738904 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.trips_age_daily_stat' to be skipped because of status 'skipped'. 
[0m17:55:52.392957 [debug] [Thread-1 (]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "dpg-cve3bdt2ng1s73cctvfg-a.frankfurt-postgres.render.com" (3.65.142.85), port 5432 failed: FATAL:  the database system is in recovery mode

[0m17:55:52.780985 [debug] [Thread-3 (]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "dpg-cve3bdt2ng1s73cctvfg-a.frankfurt-postgres.render.com" (3.65.142.85), port 5432 failed: FATAL:  the database system is not yet accepting connections
DETAIL:  Consistent recovery state has not been yet reached.

[0m17:55:53.293759 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: BEGIN
[0m17:55:53.294759 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m17:55:53.294759 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: No close available on handle
[0m17:55:53.298764 [debug] [Thread-1 (]: Database Error in model companies_trips (models\companies_trips.sql)
  connection to server at "dpg-cve3bdt2ng1s73cctvfg-a.frankfurt-postgres.render.com" (3.65.142.85), port 5432 failed: FATAL:  the database system is not yet accepting connections
  DETAIL:  Consistent recovery state has not been yet reached.
  
  compiled code at target\run\dbt_scooters\models\companies_trips.sql
[0m17:55:53.299764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF23184A0>]}
[0m17:55:53.300765 [error] [Thread-1 (]: 44 of 52 ERROR creating sql table model dbt.companies_trips .................... [[31mERROR[0m in 1.81s]
[0m17:55:53.301765 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies_trips
[0m17:55:53.302765 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.companies_trips' to be skipped because of status 'error'.  Reason: Database Error in model companies_trips (models\companies_trips.sql)
  connection to server at "dpg-cve3bdt2ng1s73cctvfg-a.frankfurt-postgres.render.com" (3.65.142.85), port 5432 failed: FATAL:  the database system is not yet accepting connections
  DETAIL:  Consistent recovery state has not been yet reached.
  
  compiled code at target\run\dbt_scooters\models\companies_trips.sql.
[0m17:55:53.303765 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m17:55:53.303765 [info ] [Thread-4 (]: 51 of 52 SKIP test unique_companies_trips_company .............................. [[33mSKIP[0m]
[0m17:55:53.304765 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m17:55:53.305767 [debug] [Thread-7 (]: Marking all children of 'test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0' to be skipped because of status 'skipped'. 
[0m17:55:54.123869 [debug] [Thread-3 (]: SQL status: BEGIN in 2.395 seconds
[0m17:55:54.123869 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m17:55:54.124872 [debug] [Thread-3 (]: On test.dbt_scooters.events_full_is_complete: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.events_full_is_complete"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with source_cte as (
    select count(*) as row_count
    from "dev_gom1"."dbt"."events_clean"
),
target_cte as (
    select count(*) as row_count
    from "dev_gom1"."dbt"."events_full"
)
select
    'Row count mismatch' as error_message,
    source_cte.row_count as source_count,
    target_cte.row_count as target_count
from
    source_cte,
    target_cte
where
    source_cte.row_count != target_cte.row_count
      
    ) dbt_internal_test
[0m17:55:56.322773 [debug] [Thread-3 (]: SQL status: SELECT 1 in 2.197 seconds
[0m17:55:56.324781 [debug] [Thread-3 (]: On test.dbt_scooters.events_full_is_complete: ROLLBACK
[0m17:55:56.395957 [debug] [Thread-3 (]: On test.dbt_scooters.events_full_is_complete: Close
[0m17:55:56.397501 [info ] [Thread-3 (]: 45 of 52 PASS events_full_is_complete .......................................... [[32mPASS[0m in 4.69s]
[0m17:55:56.398509 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m17:55:56.399548 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_stat
[0m17:55:56.400510 [info ] [Thread-1 (]: 52 of 52 START sql table model dbt.events_stat ................................. [RUN]
[0m17:55:56.401541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.events_stat)
[0m17:55:56.402542 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_stat
[0m17:55:56.405540 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m17:55:56.406510 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_stat
[0m17:55:56.412540 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m17:55:56.413511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:55:56.414549 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: BEGIN
[0m17:55:56.415511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:57.486358 [debug] [Thread-1 (]: SQL status: BEGIN in 1.071 seconds
[0m17:55:57.486358 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:55:57.486358 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_gom1"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
       count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from "dev_gom1"."dbt"."events_full"
  );
  
[0m17:55:59.178962 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.691 seconds
[0m17:55:59.182480 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:55:59.183478 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_gom1"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m17:55:59.251520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.068 seconds
[0m17:55:59.255519 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:55:59.255519 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_gom1"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m17:55:59.320546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.064 seconds
[0m17:55:59.323550 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:55:59.323550 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."events_stat" is $dbt_comment_literal_block$Overall user events statistics$dbt_comment_literal_block$;

  
[0m17:55:59.391579 [debug] [Thread-1 (]: SQL status: COMMENT in 0.068 seconds
[0m17:55:59.393583 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: COMMIT
[0m17:55:59.394580 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:55:59.394580 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: COMMIT
[0m17:55:59.460579 [debug] [Thread-1 (]: SQL status: COMMIT in 0.065 seconds
[0m17:55:59.463579 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."events_stat__dbt_backup"
[0m17:55:59.464581 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:55:59.465581 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_gom1"."dbt"."events_stat__dbt_backup" cascade
[0m17:55:59.535606 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.070 seconds
[0m17:55:59.537611 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: Close
[0m17:55:59.538609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb47d83-838d-471e-9dfe-f77668751acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF191E9C0>]}
[0m17:55:59.539610 [info ] [Thread-1 (]: 52 of 52 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 3.14s]
[0m17:55:59.540611 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_stat
[0m17:55:59.542611 [info ] [MainThread]: 
[0m17:55:59.543610 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:59.544611 [debug] [MainThread]: On master: BEGIN
[0m17:55:59.544611 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:56:01.566703 [debug] [MainThread]: SQL status: BEGIN in 2.021 seconds
[0m17:56:01.566703 [debug] [MainThread]: On master: COMMIT
[0m17:56:01.567706 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:01.567706 [debug] [MainThread]: On master: COMMIT
[0m17:56:01.634734 [debug] [MainThread]: SQL status: COMMIT in 0.066 seconds
[0m17:56:01.636737 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m17:56:01.642736 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m17:56:01.643739 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:01.643739 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m17:56:01.713763 [debug] [MainThread]: Postgres adapter: Postgres error: role "finance" does not exist

[0m17:56:01.713763 [info ] [MainThread]: 1 of 1 ERROR hook: dbt_scooters.on-run-end.0 ................................... [[31mERROR[0m in 0.08s]
[0m17:56:01.714764 [debug] [MainThread]: On master: Close
[0m17:56:01.715767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:01.716768 [debug] [MainThread]: Connection 'list_dev_gom1' was properly closed.
[0m17:56:01.716768 [debug] [MainThread]: Connection 'list_dev_gom1' was properly closed.
[0m17:56:01.717765 [debug] [MainThread]: Connection 'list_dev_gom1_finance' was properly closed.
[0m17:56:01.717765 [debug] [MainThread]: Connection 'list_dev_gom1_dbt' was properly closed.
[0m17:56:01.717765 [debug] [MainThread]: Connection 'model.dbt_scooters.events_stat' was properly closed.
[0m17:56:01.718764 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_finish_stat' was properly closed.
[0m17:56:01.718764 [debug] [MainThread]: Connection 'test.dbt_scooters.events_full_is_complete' was properly closed.
[0m17:56:01.719765 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m17:56:01.719765 [info ] [MainThread]: 
[0m17:56:01.720764 [info ] [MainThread]: Finished running 4 incremental models, 1 project hook, 4 seeds, 12 table models, 28 data tests, 4 view models in 0 hours 0 minutes and 51.35 seconds (51.35s).
[0m17:56:01.731767 [debug] [MainThread]: Command end result
[0m17:56:01.767765 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m17:56:01.771765 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m17:56:01.781273 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\run_results.json
[0m17:56:01.782285 [info ] [MainThread]: 
[0m17:56:01.782285 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 1 warning:[0m
[0m17:56:01.783301 [info ] [MainThread]: 
[0m17:56:01.784281 [error] [MainThread]:   Database Error in model revenue_daily (models\finance\revenue_daily.sql)
  role "finance" does not exist
  compiled code at target\run\dbt_scooters\models\finance\revenue_daily.sql
[0m17:56:01.785284 [info ] [MainThread]: 
[0m17:56:01.786281 [error] [MainThread]:   Database Error in model trips_stat_daily (models\trips_stat_daily.sql)
  SSL connection has been closed unexpectedly
  compiled code at target\run\dbt_scooters\models\trips_stat_daily.sql
[0m17:56:01.786281 [info ] [MainThread]: 
[0m17:56:01.787787 [error] [MainThread]:   Database Error in model parking_start_stat (models\parking_start_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target\run\dbt_scooters\models\parking_start_stat.sql
[0m17:56:01.789799 [info ] [MainThread]: 
[0m17:56:01.790796 [error] [MainThread]:   Database Error in model parking_finish_stat (models\parking_finish_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target\run\dbt_scooters\models\parking_finish_stat.sql
[0m17:56:01.791797 [info ] [MainThread]: 
[0m17:56:01.793796 [error] [MainThread]:   Database Error in model trips_users (models\trips_users.sql)
  SSL connection has been closed unexpectedly
  compiled code at target\run\dbt_scooters\models\trips_users.sql
[0m17:56:01.794796 [info ] [MainThread]: 
[0m17:56:01.795803 [error] [MainThread]:   Database Error in model companies_trips (models\companies_trips.sql)
  connection to server at "dpg-cve3bdt2ng1s73cctvfg-a.frankfurt-postgres.render.com" (3.65.142.85), port 5432 failed: FATAL:  the database system is not yet accepting connections
  DETAIL:  Consistent recovery state has not been yet reached.
  
  compiled code at target\run\dbt_scooters\models\companies_trips.sql
[0m17:56:01.796799 [info ] [MainThread]: 
[0m17:56:01.797799 [error] [MainThread]:   dbt_scooters.on-run-end.0 failed, error:
 role "finance" does not exist
[0m17:56:01.798796 [info ] [MainThread]: 
[0m17:56:01.799801 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models\properties.yml)[0m
[0m17:56:01.800800 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m17:56:01.801799 [info ] [MainThread]: 
[0m17:56:01.802795 [info ] [MainThread]:   compiled code at target\compiled\dbt_scooters\models\properties.yml\source_not_null_scooters_raw_users_sex.sql
[0m17:56:01.803804 [info ] [MainThread]: 
[0m17:56:01.804801 [info ] [MainThread]: Done. PASS=39 WARN=1 ERROR=7 SKIP=6 TOTAL=53
[0m17:56:01.806801 [debug] [MainThread]: Command `dbt build` failed at 17:56:01.806801 after 53.32 seconds
[0m17:56:01.807810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEFA25640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEFA24EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF220A0C0>]}
[0m17:56:01.807810 [debug] [MainThread]: Flushing usage events
[0m17:56:02.693781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:57:32.360571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274AE2E4BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274AE456630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274AD9DECC0>]}


============================== 17:57:32.366572 | b6356e09-4358-4343-b676-efe8e98f2919 ==============================
[0m17:57:32.366572 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:57:32.368582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run-operation create_role --args name: finance', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:57:32.669435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6356e09-4358-4343-b676-efe8e98f2919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274B12522D0>]}
[0m17:57:32.760533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6356e09-4358-4343-b676-efe8e98f2919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274B0908170>]}
[0m17:57:32.762536 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:57:33.094401 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:57:33.454393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:57:33.455395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:57:33.578508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6356e09-4358-4343-b676-efe8e98f2919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274B134A480>]}
[0m17:57:33.800290 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m17:57:33.807322 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m17:57:33.848381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6356e09-4358-4343-b676-efe8e98f2919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274B254FD70>]}
[0m17:57:33.849383 [info ] [MainThread]: Found 20 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 438 macros
[0m17:57:33.850376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6356e09-4358-4343-b676-efe8e98f2919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274B27E46E0>]}
[0m17:57:33.851377 [debug] [MainThread]: Acquiring new postgres connection 'macro_create_role'
[0m17:57:33.852377 [debug] [MainThread]: Using postgres connection "macro_create_role"
[0m17:57:33.853381 [debug] [MainThread]: On macro_create_role: BEGIN
[0m17:57:33.853381 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:35.030358 [debug] [MainThread]: SQL status: BEGIN in 1.176 seconds
[0m17:57:35.030358 [debug] [MainThread]: On macro_create_role: COMMIT
[0m17:57:35.031358 [debug] [MainThread]: Using postgres connection "macro_create_role"
[0m17:57:35.031358 [debug] [MainThread]: On macro_create_role: COMMIT
[0m17:57:35.095403 [debug] [MainThread]: SQL status: COMMIT in 0.063 seconds
[0m17:57:35.101398 [info ] [MainThread]: Creating role: finance
[0m17:57:35.209619 [debug] [MainThread]: Using postgres connection "macro_create_role"
[0m17:57:35.210585 [debug] [MainThread]: On macro_create_role: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "macro_create_role"} */

    
        create role finance nologin;
    
  
[0m17:57:35.286580 [debug] [MainThread]: SQL status: CREATE ROLE in 0.076 seconds
[0m17:57:35.288619 [debug] [MainThread]: On macro_create_role: Close
[0m17:57:35.297584 [debug] [MainThread]: Wrote artifact RunResultsArtifact to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\run_results.json
[0m17:57:35.298585 [debug] [MainThread]: Command `dbt run-operation` succeeded at 17:57:35.298585 after 3.30 seconds
[0m17:57:35.299580 [debug] [MainThread]: Connection 'macro_create_role' was properly closed.
[0m17:57:35.299580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274B0094B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274B254F950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274AAF08500>]}
[0m17:57:35.300584 [debug] [MainThread]: Flushing usage events
[0m17:57:36.029220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:57:46.071469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6D912480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6A938140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6AD75640>]}


============================== 17:57:46.078468 | ea048cfe-7f21-4b82-9d12-e438dfde72b7 ==============================
[0m17:57:46.078468 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:57:46.080473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:57:46.485479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6E4F3DD0>]}
[0m17:57:46.612237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6DA07F20>]}
[0m17:57:46.614240 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:57:47.066530 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:57:47.461324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:57:47.462324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:57:47.589549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6E6E59D0>]}
[0m17:57:47.814433 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m17:57:47.820958 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m17:57:47.889535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6FCEAAE0>]}
[0m17:57:47.891540 [info ] [MainThread]: Found 20 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 438 macros
[0m17:57:47.899541 [info ] [MainThread]: 
[0m17:57:47.900545 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:57:47.901547 [info ] [MainThread]: 
[0m17:57:47.903546 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:57:47.912552 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m17:57:47.913553 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m17:57:48.064166 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m17:57:48.064166 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m17:57:48.065168 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m17:57:48.066167 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m17:57:48.067170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:48.068171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:50.978609 [debug] [ThreadPool]: SQL status: SELECT 17 in 2.911 seconds
[0m17:57:50.980610 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m17:57:50.991609 [debug] [ThreadPool]: SQL status: SELECT 17 in 2.925 seconds
[0m17:57:50.992611 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m17:57:50.996611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_dbt'
[0m17:57:51.003611 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m17:57:51.003611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_finance'
[0m17:57:51.004612 [debug] [ThreadPool]: On list_dev_gom1_dbt: BEGIN
[0m17:57:51.006611 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m17:57:51.006611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:51.007612 [debug] [ThreadPool]: On list_dev_gom1_finance: BEGIN
[0m17:57:51.008610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:53.013484 [debug] [ThreadPool]: SQL status: BEGIN in 2.006 seconds
[0m17:57:53.013484 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m17:57:53.014485 [debug] [ThreadPool]: On list_dev_gom1_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_dbt"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m17:57:53.018483 [debug] [ThreadPool]: SQL status: BEGIN in 2.010 seconds
[0m17:57:53.018483 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m17:57:53.019486 [debug] [ThreadPool]: On list_dev_gom1_finance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_finance"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m17:57:53.117520 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.098 seconds
[0m17:57:53.119520 [debug] [ThreadPool]: On list_dev_gom1_finance: ROLLBACK
[0m17:57:53.120520 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.105 seconds
[0m17:57:53.122675 [debug] [ThreadPool]: On list_dev_gom1_dbt: ROLLBACK
[0m17:57:53.191191 [debug] [ThreadPool]: On list_dev_gom1_finance: Close
[0m17:57:53.193194 [debug] [ThreadPool]: On list_dev_gom1_dbt: Close
[0m17:57:53.203195 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:53.204195 [debug] [MainThread]: On master: BEGIN
[0m17:57:53.205195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:54.269218 [debug] [MainThread]: SQL status: BEGIN in 1.064 seconds
[0m17:57:54.270222 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:54.270222 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:57:54.349249 [debug] [MainThread]: SQL status: SELECT 5 in 0.078 seconds
[0m17:57:54.352249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D70203290>]}
[0m17:57:54.353253 [debug] [MainThread]: On master: ROLLBACK
[0m17:57:54.417249 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:54.418251 [debug] [MainThread]: On master: BEGIN
[0m17:57:54.549381 [debug] [MainThread]: SQL status: BEGIN in 0.131 seconds
[0m17:57:54.550382 [debug] [MainThread]: On master: COMMIT
[0m17:57:54.551383 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:54.551383 [debug] [MainThread]: On master: COMMIT
[0m17:57:54.616384 [debug] [MainThread]: SQL status: COMMIT in 0.064 seconds
[0m17:57:54.617380 [debug] [MainThread]: On master: Close
[0m17:57:54.622900 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.add_first_name_sex
[0m17:57:54.623904 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m17:57:54.623904 [debug] [Thread-3 (]: Began running node seed.dbt_scooters.event_types
[0m17:57:54.624902 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.scooters
[0m17:57:54.625904 [info ] [Thread-1 (]: 1 of 52 START seed file dbt.add_first_name_sex ................................. [RUN]
[0m17:57:54.625904 [info ] [Thread-2 (]: 2 of 52 START seed file dbt.age_groups ......................................... [RUN]
[0m17:57:54.627411 [info ] [Thread-3 (]: 3 of 52 START seed file dbt.event_types ........................................ [RUN]
[0m17:57:54.629422 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.dbt_scooters.add_first_name_sex'
[0m17:57:54.628423 [info ] [Thread-4 (]: 4 of 52 START seed file dbt.scooters ........................................... [RUN]
[0m17:57:54.630423 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.dbt_scooters.age_groups'
[0m17:57:54.631424 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.dbt_scooters.event_types'
[0m17:57:54.632423 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.add_first_name_sex
[0m17:57:54.632423 [debug] [Thread-4 (]: Acquiring new postgres connection 'seed.dbt_scooters.scooters'
[0m17:57:54.633422 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m17:57:54.634421 [debug] [Thread-3 (]: Began compiling node seed.dbt_scooters.event_types
[0m17:57:54.634421 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.add_first_name_sex
[0m17:57:54.635422 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.scooters
[0m17:57:54.636423 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m17:57:54.636423 [debug] [Thread-3 (]: Began executing node seed.dbt_scooters.event_types
[0m17:57:54.657421 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.scooters
[0m17:57:54.675420 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:57:54.686422 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:57:54.691422 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:57:54.693421 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: BEGIN
[0m17:57:54.698420 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:57:54.698420 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m17:57:54.699420 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: BEGIN
[0m17:57:54.700421 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:57:54.700421 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: BEGIN
[0m17:57:54.701423 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:57:54.702423 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:57:54.703423 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:57:55.786441 [debug] [Thread-4 (]: SQL status: BEGIN in 1.083 seconds
[0m17:57:55.787443 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:57:55.788476 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_gom1"."dbt"."scooters"
[0m17:57:55.856530 [debug] [Thread-4 (]: SQL status: TRUNCATE TABLE in 0.067 seconds
[0m17:57:55.885563 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:57:55.886560 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_gom1"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m17:57:55.956194 [debug] [Thread-4 (]: SQL status: INSERT 0 10 in 0.068 seconds
[0m17:57:55.965189 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m17:57:56.014257 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:57:56.015264 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  comment on table "dev_gom1"."dbt"."scooters" is $dbt_comment_literal_block$Scooter models information and park statistics by model. Includes information about the manufacturing company. Data received from the service team and uploaded by Mark. Data is current as of summer 2023.
$dbt_comment_literal_block$;

  
[0m17:57:56.080394 [debug] [Thread-4 (]: SQL status: COMMENT in 0.064 seconds
[0m17:57:56.122407 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:57:56.124935 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'scooters'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:57:56.216513 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.090 seconds
[0m17:57:56.227571 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:57:56.228587 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."scooters".company is $dbt_comment_literal_block$Scooter company model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."scooters".model is $dbt_comment_literal_block$Scooter model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."scooters".hardware_id is $dbt_comment_literal_block$scooter model id$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."scooters".scooters is $dbt_comment_literal_block$Count of scooters$dbt_comment_literal_block$;
  

  
[0m17:57:56.295153 [debug] [Thread-4 (]: SQL status: COMMENT in 0.065 seconds
[0m17:57:56.298116 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m17:57:56.299120 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m17:57:56.299120 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m17:57:56.365266 [debug] [Thread-4 (]: SQL status: COMMIT in 0.065 seconds
[0m17:57:56.368303 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: Close
[0m17:57:56.372270 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6B7D89E0>]}
[0m17:57:56.373268 [info ] [Thread-4 (]: 4 of 52 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 1.74s]
[0m17:57:56.375269 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.scooters
[0m17:57:56.376305 [debug] [Thread-4 (]: Began running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m17:57:56.378270 [info ] [Thread-4 (]: 5 of 52 START test every_event_has_user ........................................ [RUN]
[0m17:57:56.379267 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now test.dbt_scooters.every_event_has_user.7eea25f36c)
[0m17:57:56.380271 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m17:57:56.410270 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m17:57:56.412265 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m17:57:56.441454 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m17:57:56.443423 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m17:57:56.443423 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: BEGIN
[0m17:57:56.444456 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:57:56.846354 [debug] [Thread-2 (]: SQL status: BEGIN in 2.145 seconds
[0m17:57:56.847336 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:57:56.848320 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_gom1"."dbt"."age_groups"
[0m17:57:56.918394 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.069 seconds
[0m17:57:56.924867 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:57:56.927411 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_gom1"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m17:57:56.996514 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.068 seconds
[0m17:57:56.997525 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m17:57:57.001525 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:57:57.003538 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  comment on table "dev_gom1"."dbt"."age_groups" is $dbt_comment_literal_block$Age groups to split users for analysis$dbt_comment_literal_block$;

  
[0m17:57:57.072137 [debug] [Thread-2 (]: SQL status: COMMENT in 0.067 seconds
[0m17:57:57.076140 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:57:57.078149 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'age_groups'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:57:57.155226 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.076 seconds
[0m17:57:57.158236 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:57:57.159240 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."age_groups".group is $dbt_comment_literal_block$Age group name for report$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."age_groups".age_start is $dbt_comment_literal_block$Start age of group$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."age_groups".age_end is $dbt_comment_literal_block$End age of group$dbt_comment_literal_block$;
  

  
[0m17:57:57.227304 [debug] [Thread-2 (]: SQL status: COMMENT in 0.067 seconds
[0m17:57:57.229318 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m17:57:57.230314 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m17:57:57.230314 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m17:57:57.299377 [debug] [Thread-2 (]: SQL status: COMMIT in 0.067 seconds
[0m17:57:57.300377 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m17:57:57.301378 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D703BC4D0>]}
[0m17:57:57.302379 [info ] [Thread-2 (]: 2 of 52 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 2.67s]
[0m17:57:57.304378 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m17:57:57.305384 [debug] [Thread-2 (]: Began running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m17:57:57.306383 [info ] [Thread-2 (]: 6 of 52 START test every_trip_has_user ......................................... [RUN]
[0m17:57:57.308388 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now test.dbt_scooters.every_trip_has_user.6bc71135e2)
[0m17:57:57.308388 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m17:57:57.315385 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m17:57:57.317387 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m17:57:57.321397 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m17:57:57.322393 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m17:57:57.323395 [debug] [Thread-2 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: BEGIN
[0m17:57:57.324393 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:57:57.612180 [debug] [Thread-3 (]: SQL status: BEGIN in 2.910 seconds
[0m17:57:57.613185 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:57:57.614184 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_gom1"."dbt"."event_types"
[0m17:57:57.619189 [debug] [Thread-1 (]: SQL status: BEGIN in 2.919 seconds
[0m17:57:57.620192 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:57:57.621190 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */
truncate table "dev_gom1"."dbt"."add_first_name_sex"
[0m17:57:57.687339 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.072 seconds
[0m17:57:57.687339 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.066 seconds
[0m17:57:57.690344 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:57:57.693344 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:57:57.693344 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_gom1"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m17:57:57.694348 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: 
          insert into "dev_gom1"."dbt"."add_first_name_sex" ("first_name", "sex") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m17:57:57.760489 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.065 seconds
[0m17:57:57.762489 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.add_first_name_sex"
[0m17:57:57.766487 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:57:57.767493 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  comment on table "dev_gom1"."dbt"."add_first_name_sex" is $dbt_comment_literal_block$additional name_sex glossary$dbt_comment_literal_block$;

  
[0m17:57:57.771500 [debug] [Thread-3 (]: SQL status: INSERT 0 4 in 0.076 seconds
[0m17:57:57.772500 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m17:57:57.776503 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:57:57.777518 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  comment on table "dev_gom1"."dbt"."event_types" is $dbt_comment_literal_block$Table provides a mapping between unique event type identifiers (`type_id`) and their descriptive names (`type`). It is essential for converting numerical codes from user activity logs into readable descriptions for analysis of user interactions with application features.

The table is crucial for analytics and reporting, allowing for the decoding of event identifiers in user activity datasets. By joining with event logs, it facilitates intuitive reporting and dashboarding of user interactions. The mapping enables effective segmentation and analysis of user activities, such as:

- **start_search**: Represents the initiation of a search process by a user.
- **book_scooter**: Indicates that a user has booked a scooter.
- **release_scooter**: Signifies that a user has released a previously booked scooter.
- **cancel_search**: Denotes the cancellation of a search process by a user.$dbt_comment_literal_block$;

  
[0m17:57:57.832671 [debug] [Thread-1 (]: SQL status: COMMENT in 0.064 seconds
[0m17:57:57.840209 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:57:57.841201 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'add_first_name_sex'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:57:57.849222 [debug] [Thread-3 (]: SQL status: COMMENT in 0.070 seconds
[0m17:57:57.854214 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:57:57.855221 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'event_types'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:57:57.916267 [debug] [Thread-4 (]: SQL status: BEGIN in 1.471 seconds
[0m17:57:57.917272 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m17:57:57.918282 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_user.7eea25f36c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_gom1"."scooters_raw"."events"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_gom1"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:57:57.921286 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.079 seconds
[0m17:57:57.925287 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:57:57.926798 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."add_first_name_sex".first_name is $dbt_comment_literal_block$First name of user$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."add_first_name_sex".sex is $dbt_comment_literal_block$user gender$dbt_comment_literal_block$;
  

  
[0m17:57:58.012337 [debug] [Thread-1 (]: SQL status: COMMENT in 0.084 seconds
[0m17:57:58.014340 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m17:57:58.015341 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m17:57:58.016339 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m17:57:58.077573 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.221 seconds
[0m17:57:58.079571 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:57:58.080571 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."event_types".type_id is $dbt_comment_literal_block$An integer serving as a unique identifier for each event type. It is used in user event tables as a foreign key to link events to their descriptions
$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."dbt"."event_types".type is $dbt_comment_literal_block$A string describing the event type, enhancing the interpretability of event data by providing a human-readable label
$dbt_comment_literal_block$;
  

  
[0m17:57:58.085582 [debug] [Thread-1 (]: SQL status: COMMIT in 0.068 seconds
[0m17:57:58.087590 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: Close
[0m17:57:58.089598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D70327F50>]}
[0m17:57:58.091603 [info ] [Thread-1 (]: 1 of 52 OK loaded seed file dbt.add_first_name_sex ............................. [[32mINSERT 5[0m in 3.46s]
[0m17:57:58.093593 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.add_first_name_sex
[0m17:57:58.094595 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m17:57:58.095597 [info ] [Thread-1 (]: 7 of 52 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m17:57:58.097605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.add_first_name_sex, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m17:57:58.097605 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m17:57:58.113621 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m17:57:58.115622 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m17:57:58.120149 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m17:57:58.123149 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m17:57:58.124146 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m17:57:58.125144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:58.149195 [debug] [Thread-3 (]: SQL status: COMMENT in 0.068 seconds
[0m17:57:58.152196 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m17:57:58.154201 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m17:57:58.155198 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m17:57:58.225268 [debug] [Thread-3 (]: SQL status: COMMIT in 0.069 seconds
[0m17:57:58.226781 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: Close
[0m17:57:58.228792 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D70890CE0>]}
[0m17:57:58.229789 [info ] [Thread-3 (]: 3 of 52 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 3.60s]
[0m17:57:58.230802 [debug] [Thread-3 (]: Finished running node seed.dbt_scooters.event_types
[0m17:57:58.231792 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m17:57:58.232791 [info ] [Thread-3 (]: 8 of 52 START test source_not_null_scooters_raw_events_type_id ................. [RUN]
[0m17:57:58.234791 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7)
[0m17:57:58.235797 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m17:57:58.245322 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m17:57:58.247326 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m17:57:58.250332 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m17:57:58.252333 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m17:57:58.253334 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: BEGIN
[0m17:57:58.253334 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:57:58.883434 [debug] [Thread-2 (]: SQL status: BEGIN in 1.559 seconds
[0m17:57:58.884440 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m17:57:58.885431 [debug] [Thread-2 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_user.6bc71135e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_gom1"."scooters_raw"."trips"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_gom1"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:57:59.378320 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.458 seconds
[0m17:57:59.383322 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: ROLLBACK
[0m17:57:59.476365 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: Close
[0m17:57:59.477365 [info ] [Thread-4 (]: 5 of 52 PASS every_event_has_user .............................................. [[32mPASS[0m in 3.10s]
[0m17:57:59.479360 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m17:57:59.480367 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m17:57:59.481365 [info ] [Thread-4 (]: 9 of 52 START test source_not_null_scooters_raw_events_user_id ................. [RUN]
[0m17:57:59.482360 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_user.7eea25f36c, now test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b)
[0m17:57:59.483365 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m17:57:59.489360 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m17:57:59.492362 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m17:57:59.495363 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m17:57:59.498365 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m17:57:59.498365 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: BEGIN
[0m17:57:59.499363 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:57:59.740515 [debug] [Thread-3 (]: SQL status: BEGIN in 1.487 seconds
[0m17:57:59.741519 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m17:57:59.742519 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from "dev_gom1"."scooters_raw"."events"
where type_id is null



      
    ) dbt_internal_test
[0m17:57:59.781517 [debug] [Thread-1 (]: SQL status: BEGIN in 1.656 seconds
[0m17:57:59.782513 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m17:57:59.783513 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_gom1"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m17:57:59.889560 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.002 seconds
[0m17:57:59.891556 [debug] [Thread-2 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: ROLLBACK
[0m17:57:59.986142 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.202 seconds
[0m17:57:59.987147 [debug] [Thread-2 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: Close
[0m17:57:59.990148 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m17:57:59.992142 [info ] [Thread-2 (]: 6 of 52 PASS every_trip_has_user ............................................... [[32mPASS[0m in 2.68s]
[0m17:57:59.993141 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m17:57:59.994143 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m17:57:59.995142 [info ] [Thread-2 (]: 10 of 52 START test source_not_null_scooters_raw_trips_id ...................... [RUN]
[0m17:57:59.997151 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_user.6bc71135e2, now test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d)
[0m17:57:59.998176 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m17:58:00.005143 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m17:58:00.008151 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m17:58:00.011151 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m17:58:00.013150 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m17:58:00.014151 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: BEGIN
[0m17:58:00.015150 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:58:00.084275 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m17:58:00.085275 [info ] [Thread-1 (]: 7 of 52 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 1.99s]
[0m17:58:00.087283 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m17:58:00.088286 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m17:58:00.089277 [info ] [Thread-1 (]: 11 of 52 START test source_not_null_scooters_raw_trips_scooter_hw_id ........... [RUN]
[0m17:58:00.090275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f)
[0m17:58:00.091324 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m17:58:00.098313 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m17:58:00.100311 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m17:58:00.105273 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m17:58:00.106278 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m17:58:00.107278 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: BEGIN
[0m17:58:00.108283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:00.381583 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.638 seconds
[0m17:58:00.384585 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: ROLLBACK
[0m17:58:00.451201 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: Close
[0m17:58:00.453202 [info ] [Thread-3 (]: 8 of 52 PASS source_not_null_scooters_raw_events_type_id ....................... [[32mPASS[0m in 2.22s]
[0m17:58:00.455203 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m17:58:00.456203 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m17:58:00.457211 [info ] [Thread-3 (]: 12 of 52 START test source_not_null_scooters_raw_trips_user_id ................. [RUN]
[0m17:58:00.458223 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7, now test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62)
[0m17:58:00.459230 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m17:58:00.466222 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m17:58:00.470238 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m17:58:00.474241 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m17:58:00.476243 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m17:58:00.477242 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: BEGIN
[0m17:58:00.478249 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:58:01.537511 [debug] [Thread-4 (]: SQL status: BEGIN in 2.038 seconds
[0m17:58:01.539525 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m17:58:01.540527 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_gom1"."scooters_raw"."events"
where user_id is null



      
    ) dbt_internal_test
[0m17:58:01.721361 [debug] [Thread-3 (]: SQL status: BEGIN in 1.242 seconds
[0m17:58:01.723361 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m17:58:01.724367 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_gom1"."scooters_raw"."trips"
where user_id is null



      
    ) dbt_internal_test
[0m17:58:02.000395 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.458 seconds
[0m17:58:02.005406 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: ROLLBACK
[0m17:58:02.075473 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.346 seconds
[0m17:58:02.076472 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: Close
[0m17:58:02.080474 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: ROLLBACK
[0m17:58:02.081473 [info ] [Thread-4 (]: 9 of 52 PASS source_not_null_scooters_raw_events_user_id ....................... [[32mPASS[0m in 2.60s]
[0m17:58:02.084477 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m17:58:02.086476 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m17:58:02.087486 [info ] [Thread-4 (]: 13 of 52 START test source_not_null_scooters_raw_users_id ...................... [RUN]
[0m17:58:02.089488 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b, now test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d)
[0m17:58:02.090493 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m17:58:02.098485 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m17:58:02.101490 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m17:58:02.109496 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m17:58:02.112495 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m17:58:02.113497 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: BEGIN
[0m17:58:02.114498 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:58:02.149161 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: Close
[0m17:58:02.151161 [info ] [Thread-3 (]: 12 of 52 PASS source_not_null_scooters_raw_trips_user_id ....................... [[32mPASS[0m in 1.69s]
[0m17:58:02.154166 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m17:58:02.156164 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m17:58:02.158202 [info ] [Thread-3 (]: 14 of 52 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m17:58:02.160172 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m17:58:02.161164 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m17:58:02.171172 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m17:58:02.173161 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m17:58:02.178170 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m17:58:02.181214 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m17:58:02.182204 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m17:58:02.183199 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:58:02.278446 [debug] [Thread-1 (]: SQL status: BEGIN in 2.171 seconds
[0m17:58:02.279439 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m17:58:02.281439 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select scooter_hw_id
from "dev_gom1"."scooters_raw"."trips"
where scooter_hw_id is null



      
    ) dbt_internal_test
[0m17:58:02.302472 [debug] [Thread-2 (]: SQL status: BEGIN in 2.287 seconds
[0m17:58:02.304472 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m17:58:02.305470 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_gom1"."scooters_raw"."trips"
where id is null



      
    ) dbt_internal_test
[0m17:58:02.375171 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.093 seconds
[0m17:58:02.379189 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: ROLLBACK
[0m17:58:02.405190 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.098 seconds
[0m17:58:02.408192 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: ROLLBACK
[0m17:58:02.445418 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: Close
[0m17:58:02.448384 [info ] [Thread-1 (]: 11 of 52 PASS source_not_null_scooters_raw_trips_scooter_hw_id ................. [[32mPASS[0m in 2.36s]
[0m17:58:02.450383 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m17:58:02.451382 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m17:58:02.453386 [info ] [Thread-1 (]: 15 of 52 START test source_unique_scooters_raw_trips_id ........................ [RUN]
[0m17:58:02.454420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f, now test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4)
[0m17:58:02.457380 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m17:58:02.471381 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m17:58:02.475381 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: Close
[0m17:58:02.478398 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m17:58:02.477382 [info ] [Thread-2 (]: 10 of 52 PASS source_not_null_scooters_raw_trips_id ............................ [[32mPASS[0m in 2.48s]
[0m17:58:02.484397 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m17:58:02.486407 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m17:58:02.488405 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m17:58:02.489404 [info ] [Thread-2 (]: 16 of 52 START test source_unique_scooters_raw_users_id ........................ [RUN]
[0m17:58:02.490407 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m17:58:02.491397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d, now test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf)
[0m17:58:02.493395 [debug] [Thread-1 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: BEGIN
[0m17:58:02.494404 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m17:58:02.495394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:02.503396 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m17:58:02.506398 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m17:58:02.513422 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m17:58:02.516424 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m17:58:02.517425 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: BEGIN
[0m17:58:02.519413 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:58:03.196150 [debug] [Thread-4 (]: SQL status: BEGIN in 1.081 seconds
[0m17:58:03.197149 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m17:58:03.198146 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_gom1"."scooters_raw"."users"
where id is null



      
    ) dbt_internal_test
[0m17:58:03.265286 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.065 seconds
[0m17:58:03.268289 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: ROLLBACK
[0m17:58:03.298301 [debug] [Thread-3 (]: SQL status: BEGIN in 1.115 seconds
[0m17:58:03.299290 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m17:58:03.300290 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sex
from "dev_gom1"."scooters_raw"."users"
where sex is null



      
    ) dbt_internal_test
[0m17:58:03.334304 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: Close
[0m17:58:03.335859 [info ] [Thread-4 (]: 13 of 52 PASS source_not_null_scooters_raw_users_id ............................ [[32mPASS[0m in 1.25s]
[0m17:58:03.338432 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m17:58:03.339432 [debug] [Thread-4 (]: Began running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m17:58:03.341434 [info ] [Thread-4 (]: 17 of 52 START test every_trip_has_scooter_id .................................. [RUN]
[0m17:58:03.344436 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d, now test.dbt_scooters.every_trip_has_scooter_id.e0b845a190)
[0m17:58:03.346434 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m17:58:03.358471 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m17:58:03.361444 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m17:58:03.365476 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m17:58:03.367457 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m17:58:03.368472 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: BEGIN
[0m17:58:03.369449 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:58:03.370438 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.069 seconds
[0m17:58:03.374471 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m17:58:03.443901 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m17:58:03.444898 [warn ] [Thread-3 (]: 14 of 52 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 1.29s]
[0m17:58:03.447416 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m17:58:03.448427 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m17:58:03.449431 [info ] [Thread-3 (]: 18 of 52 START test unique_key_scooters_company__model__hardware_id ............ [RUN]
[0m17:58:03.450464 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e)
[0m17:58:03.451465 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m17:58:03.465438 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m17:58:03.468482 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m17:58:03.472485 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m17:58:03.474487 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m17:58:03.475447 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: BEGIN
[0m17:58:03.476449 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:58:03.601301 [debug] [Thread-1 (]: SQL status: BEGIN in 1.106 seconds
[0m17:58:03.603303 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m17:58:03.604304 [debug] [Thread-1 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_gom1"."scooters_raw"."trips"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:04.624330 [debug] [Thread-2 (]: SQL status: BEGIN in 2.105 seconds
[0m17:58:04.626327 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m17:58:04.627326 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_gom1"."scooters_raw"."users"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:04.675554 [debug] [Thread-4 (]: SQL status: BEGIN in 1.305 seconds
[0m17:58:04.675554 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m17:58:04.676555 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select scooter_hw_id as from_field
    from "dev_gom1"."scooters_raw"."trips"
    where scooter_hw_id is not null
),

parent as (
    select hardware_id as to_field
    from "dev_gom1"."dbt"."scooters"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:58:04.778100 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.150 seconds
[0m17:58:04.781144 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: ROLLBACK
[0m17:58:04.880259 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.275 seconds
[0m17:58:04.883213 [debug] [Thread-1 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: ROLLBACK
[0m17:58:04.883213 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: Close
[0m17:58:04.885253 [info ] [Thread-2 (]: 16 of 52 PASS source_unique_scooters_raw_users_id .............................. [[32mPASS[0m in 2.39s]
[0m17:58:04.886214 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m17:58:04.887218 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m17:58:04.888232 [info ] [Thread-2 (]: 19 of 52 START test unique_not_null_scooters_hardware_id ....................... [RUN]
[0m17:58:04.890235 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf, now test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d)
[0m17:58:04.890235 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m17:58:04.898233 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m17:58:04.900232 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m17:58:04.958327 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m17:58:04.959329 [debug] [Thread-1 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: Close
[0m17:58:04.960322 [info ] [Thread-1 (]: 15 of 52 PASS source_unique_scooters_raw_trips_id .............................. [[32mPASS[0m in 2.51s]
[0m17:58:04.962324 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m17:58:04.963357 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m17:58:04.963357 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: BEGIN
[0m17:58:04.964354 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m17:58:04.965328 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:58:04.966354 [info ] [Thread-1 (]: 20 of 52 START test unique_not_null_scooters_model ............................. [RUN]
[0m17:58:04.967324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4, now test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc)
[0m17:58:04.968322 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m17:58:04.973324 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m17:58:04.975320 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m17:58:04.978329 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m17:58:04.979332 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m17:58:04.980331 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: BEGIN
[0m17:58:04.981332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:05.397230 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.720 seconds
[0m17:58:05.400236 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: ROLLBACK
[0m17:58:05.464308 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: Close
[0m17:58:05.466313 [info ] [Thread-4 (]: 17 of 52 PASS every_trip_has_scooter_id ........................................ [[32mPASS[0m in 2.12s]
[0m17:58:05.467314 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m17:58:05.468323 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m17:58:05.469323 [info ] [Thread-4 (]: 21 of 52 START test unique_not_null_age_groups_age_end ......................... [RUN]
[0m17:58:05.470328 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_scooter_id.e0b845a190, now test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac)
[0m17:58:05.471322 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m17:58:05.476320 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m17:58:05.477320 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m17:58:05.480326 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m17:58:05.482330 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m17:58:05.483335 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: BEGIN
[0m17:58:05.484332 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:58:05.520357 [debug] [Thread-3 (]: SQL status: BEGIN in 2.044 seconds
[0m17:58:05.521357 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m17:58:05.522366 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "company"::text ||
    
        "model"::text ||
    
        "hardware_id"::text ||
    
    ''
from
    "dev_gom1"."dbt"."scooters"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m17:58:05.594438 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.072 seconds
[0m17:58:05.596443 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: ROLLBACK
[0m17:58:05.664527 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: Close
[0m17:58:05.665528 [info ] [Thread-3 (]: 18 of 52 PASS unique_key_scooters_company__model__hardware_id .................. [[32mPASS[0m in 2.22s]
[0m17:58:05.666530 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m17:58:05.667539 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m17:58:05.668539 [info ] [Thread-3 (]: 22 of 52 START test unique_not_null_age_groups_age_start ....................... [RUN]
[0m17:58:05.670550 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e, now test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b)
[0m17:58:05.671547 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m17:58:05.677550 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m17:58:05.679546 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m17:58:05.682547 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m17:58:05.684546 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m17:58:05.685546 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: BEGIN
[0m17:58:05.686546 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:58:06.055578 [debug] [Thread-1 (]: SQL status: BEGIN in 1.075 seconds
[0m17:58:06.056568 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m17:58:06.057580 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "model"
from
    "dev_gom1"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "model" is null


      
    ) dbt_internal_test
[0m17:58:06.078591 [debug] [Thread-2 (]: SQL status: BEGIN in 1.114 seconds
[0m17:58:06.079595 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m17:58:06.080591 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "hardware_id"
from
    "dev_gom1"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "hardware_id" is null


      
    ) dbt_internal_test
[0m17:58:06.123142 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.065 seconds
[0m17:58:06.126137 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: ROLLBACK
[0m17:58:06.149283 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.068 seconds
[0m17:58:06.151283 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: ROLLBACK
[0m17:58:06.191295 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: Close
[0m17:58:06.192335 [info ] [Thread-1 (]: 20 of 52 PASS unique_not_null_scooters_model ................................... [[32mPASS[0m in 1.23s]
[0m17:58:06.194334 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m17:58:06.195331 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m17:58:06.195331 [info ] [Thread-1 (]: 23 of 52 START test unique_not_null_age_groups_group ........................... [RUN]
[0m17:58:06.197300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc, now test.dbt_scooters.unique_not_null_age_groups_group.39342291f1)
[0m17:58:06.198298 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m17:58:06.204303 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m17:58:06.207299 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m17:58:06.210313 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m17:58:06.212315 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m17:58:06.213311 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: BEGIN
[0m17:58:06.214314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:06.218352 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: Close
[0m17:58:06.220310 [info ] [Thread-2 (]: 19 of 52 PASS unique_not_null_scooters_hardware_id ............................. [[32mPASS[0m in 1.33s]
[0m17:58:06.221307 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m17:58:06.222343 [debug] [Thread-2 (]: Began running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m17:58:06.223344 [info ] [Thread-2 (]: 24 of 52 START test accepted_values_add_first_name_sex_sex__M__F ............... [RUN]
[0m17:58:06.224309 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d, now test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199)
[0m17:58:06.225308 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m17:58:06.231317 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m17:58:06.233317 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m17:58:06.236316 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m17:58:06.238829 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m17:58:06.239841 [debug] [Thread-2 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: BEGIN
[0m17:58:06.240841 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:58:06.816270 [debug] [Thread-4 (]: SQL status: BEGIN in 1.332 seconds
[0m17:58:06.817270 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m17:58:06.817270 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_end"
from
    "dev_gom1"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_end" is null


      
    ) dbt_internal_test
[0m17:58:06.885506 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.067 seconds
[0m17:58:06.888504 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: ROLLBACK
[0m17:58:06.954695 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: Close
[0m17:58:06.955728 [info ] [Thread-4 (]: 21 of 52 PASS unique_not_null_age_groups_age_end ............................... [[32mPASS[0m in 1.49s]
[0m17:58:06.958309 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m17:58:06.958309 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m17:58:06.959308 [info ] [Thread-4 (]: 25 of 52 START test unique_not_null_add_first_name_sex_first_name .............. [RUN]
[0m17:58:06.960281 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac, now test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f)
[0m17:58:06.961317 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m17:58:06.966308 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m17:58:06.967308 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m17:58:06.972317 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m17:58:06.974279 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m17:58:06.975316 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: BEGIN
[0m17:58:06.975316 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:58:07.295118 [debug] [Thread-1 (]: SQL status: BEGIN in 1.080 seconds
[0m17:58:07.295118 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m17:58:07.296117 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "group"
from
    "dev_gom1"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "group" is null


      
    ) dbt_internal_test
[0m17:58:07.364377 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.067 seconds
[0m17:58:07.366367 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: ROLLBACK
[0m17:58:07.433383 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: Close
[0m17:58:07.435341 [info ] [Thread-1 (]: 23 of 52 PASS unique_not_null_age_groups_group ................................. [[32mPASS[0m in 1.24s]
[0m17:58:07.436343 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m17:58:07.437347 [debug] [Thread-1 (]: Began running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m17:58:07.438342 [info ] [Thread-1 (]: 26 of 52 START test every_event_has_type ....................................... [RUN]
[0m17:58:07.439345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_group.39342291f1, now test.dbt_scooters.every_event_has_type.1e5fc977eb)
[0m17:58:07.440340 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m17:58:07.447494 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m17:58:07.449507 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m17:58:07.452534 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m17:58:07.453501 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m17:58:07.454552 [debug] [Thread-1 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: BEGIN
[0m17:58:07.455535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:07.684386 [debug] [Thread-3 (]: SQL status: BEGIN in 1.997 seconds
[0m17:58:07.685388 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m17:58:07.685388 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_start"
from
    "dev_gom1"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_start" is null


      
    ) dbt_internal_test
[0m17:58:07.754659 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.068 seconds
[0m17:58:07.755654 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: ROLLBACK
[0m17:58:07.823212 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: Close
[0m17:58:07.824210 [info ] [Thread-3 (]: 22 of 52 PASS unique_not_null_age_groups_age_start ............................. [[32mPASS[0m in 2.15s]
[0m17:58:07.826214 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m17:58:07.827244 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m17:58:07.827244 [info ] [Thread-3 (]: 27 of 52 START test unique_not_null_event_types_type ........................... [RUN]
[0m17:58:07.828245 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b, now test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1)
[0m17:58:07.829243 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m17:58:07.834249 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m17:58:07.835243 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m17:58:07.838242 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m17:58:07.839242 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m17:58:07.840213 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: BEGIN
[0m17:58:07.840213 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:58:08.060263 [debug] [Thread-4 (]: SQL status: BEGIN in 1.085 seconds
[0m17:58:08.061307 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m17:58:08.062298 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "first_name"
from
    "dev_gom1"."dbt"."add_first_name_sex"
group by
    1
having
    count(*) > 1 or "first_name" is null


      
    ) dbt_internal_test
[0m17:58:08.133265 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.070 seconds
[0m17:58:08.135294 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: ROLLBACK
[0m17:58:08.204425 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: Close
[0m17:58:08.206419 [info ] [Thread-4 (]: 25 of 52 PASS unique_not_null_add_first_name_sex_first_name .................... [[32mPASS[0m in 1.25s]
[0m17:58:08.208380 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m17:58:08.209381 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m17:58:08.210381 [info ] [Thread-4 (]: 28 of 52 START test unique_not_null_event_types_type_id ........................ [RUN]
[0m17:58:08.211379 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f, now test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85)
[0m17:58:08.211379 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m17:58:08.216378 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m17:58:08.216378 [debug] [Thread-2 (]: SQL status: BEGIN in 1.976 seconds
[0m17:58:08.217384 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m17:58:08.218384 [debug] [Thread-2 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_gom1"."dbt"."add_first_name_sex"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m17:58:08.219378 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m17:58:08.222378 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m17:58:08.224379 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m17:58:08.225410 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: BEGIN
[0m17:58:08.225410 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:58:08.287243 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.068 seconds
[0m17:58:08.289233 [debug] [Thread-2 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: ROLLBACK
[0m17:58:08.356427 [debug] [Thread-2 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: Close
[0m17:58:08.357466 [info ] [Thread-2 (]: 24 of 52 PASS accepted_values_add_first_name_sex_sex__M__F ..................... [[32mPASS[0m in 2.13s]
[0m17:58:08.358468 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m17:58:08.359426 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_clean
[0m17:58:08.360424 [info ] [Thread-2 (]: 29 of 52 START sql incremental model dbt.events_clean .......................... [RUN]
[0m17:58:08.361425 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199, now model.dbt_scooters.events_clean)
[0m17:58:08.362426 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_clean
[0m17:58:08.373424 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m17:58:08.375427 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_clean
[0m17:58:08.437438 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:58:08.439441 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp175808411460"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at

from
    "dev_gom1"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_gom1"."dbt"."events_clean")
    

  );
  
  
[0m17:58:08.439441 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:58:08.519328 [debug] [Thread-1 (]: SQL status: BEGIN in 1.064 seconds
[0m17:58:08.520280 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m17:58:08.521279 [debug] [Thread-1 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_type.1e5fc977eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type_id as from_field
    from "dev_gom1"."scooters_raw"."events"
    where type_id is not null
),

parent as (
    select type_id as to_field
    from "dev_gom1"."dbt"."event_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:58:09.380529 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.858 seconds
[0m17:58:09.382531 [debug] [Thread-1 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: ROLLBACK
[0m17:58:09.474136 [debug] [Thread-1 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: Close
[0m17:58:09.475137 [info ] [Thread-1 (]: 26 of 52 PASS every_event_has_type ............................................. [[32mPASS[0m in 2.04s]
[0m17:58:09.477138 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m17:58:09.478150 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_prep
[0m17:58:09.479152 [info ] [Thread-1 (]: 30 of 52 START sql view model dbt.events_prep .................................. [RUN]
[0m17:58:09.481152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_type.1e5fc977eb, now model.dbt_scooters.events_prep)
[0m17:58:09.481152 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_prep
[0m17:58:09.485148 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_prep"
[0m17:58:09.487149 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_prep
[0m17:58:09.517175 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_prep"
[0m17:58:09.519181 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:58:09.520192 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: BEGIN
[0m17:58:09.521192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:09.545719 [debug] [Thread-3 (]: SQL status: BEGIN in 1.705 seconds
[0m17:58:09.545719 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m17:58:09.547225 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type"
from
    "dev_gom1"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type" is null


      
    ) dbt_internal_test
[0m17:58:09.580255 [debug] [Thread-4 (]: SQL status: BEGIN in 1.355 seconds
[0m17:58:09.581257 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m17:58:09.582262 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type_id"
from
    "dev_gom1"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type_id" is null


      
    ) dbt_internal_test
[0m17:58:09.615284 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.068 seconds
[0m17:58:09.617286 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: ROLLBACK
[0m17:58:09.652339 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.069 seconds
[0m17:58:09.654338 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: ROLLBACK
[0m17:58:09.685369 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: Close
[0m17:58:09.686373 [info ] [Thread-3 (]: 27 of 52 PASS unique_not_null_event_types_type ................................. [[32mPASS[0m in 1.86s]
[0m17:58:09.688377 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m17:58:09.689381 [debug] [Thread-3 (]: Began running node model.dbt_scooters.first_name_sex
[0m17:58:09.689381 [info ] [Thread-3 (]: 31 of 52 START sql table model dbt.first_name_sex .............................. [RUN]
[0m17:58:09.691385 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1, now model.dbt_scooters.first_name_sex)
[0m17:58:09.691385 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.first_name_sex
[0m17:58:09.695380 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.first_name_sex"
[0m17:58:09.698391 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.first_name_sex
[0m17:58:09.716402 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.first_name_sex"
[0m17:58:09.718404 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:58:09.718404 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: BEGIN
[0m17:58:09.719404 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:58:09.723398 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: Close
[0m17:58:09.724397 [info ] [Thread-4 (]: 28 of 52 PASS unique_not_null_event_types_type_id .............................. [[32mPASS[0m in 1.51s]
[0m17:58:09.726400 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m17:58:09.726400 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_concurrency
[0m17:58:09.727408 [info ] [Thread-4 (]: 32 of 52 START sql incremental model dbt.trips_concurrency ..................... [RUN]
[0m17:58:09.729412 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85, now model.dbt_scooters.trips_concurrency)
[0m17:58:09.730441 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m17:58:09.736413 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m17:58:09.738407 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m17:58:09.742408 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:58:09.743915 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp175809741407"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_gom1"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_gom1"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_gom1"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_gom1"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now()  as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m17:58:09.744930 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:58:10.776419 [debug] [Thread-1 (]: SQL status: BEGIN in 1.255 seconds
[0m17:58:10.777456 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:58:10.778419 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

  create view "dev_gom1"."dbt"."events_prep__dbt_tmp"
    
    
  as (
    select
    user_id,
    "timestamp",
    type_id,
    date("timestamp") as "date"
from
    "dev_gom1"."scooters_raw"."events"
  );
[0m17:58:10.975487 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.196 seconds
[0m17:58:10.986446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:58:10.987479 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
alter table "dev_gom1"."dbt"."events_prep" rename to "events_prep__dbt_backup"
[0m17:58:11.073125 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.085 seconds
[0m17:58:11.079134 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:58:11.080130 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
alter table "dev_gom1"."dbt"."events_prep__dbt_tmp" rename to "events_prep"
[0m17:58:11.145701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.066 seconds
[0m17:58:11.156311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:58:11.157307 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

    
  
  comment on view "dev_gom1"."dbt"."events_prep" is $dbt_comment_literal_block$User events prepared for following processing$dbt_comment_literal_block$;

  
[0m17:58:11.273284 [debug] [Thread-1 (]: SQL status: COMMENT in 0.114 seconds
[0m17:58:11.278282 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:58:11.279274 [debug] [Thread-2 (]: SQL status: SELECT 0 in 2.840 seconds
[0m17:58:11.280250 [debug] [Thread-3 (]: SQL status: BEGIN in 1.561 seconds
[0m17:58:11.281283 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_prep'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:58:11.286251 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:58:11.287287 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:58:11.288287 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: BEGIN
[0m17:58:11.289287 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

  
    

  create  table "dev_gom1"."dbt"."first_name_sex__dbt_tmp"
  
  
    as
  
  (
    select distinct first_name, sex
from "dev_gom1"."scooters_raw"."users"
Where sex is not null
  );
  
[0m17:58:11.359138 [debug] [Thread-2 (]: SQL status: BEGIN in 0.069 seconds
[0m17:58:11.360138 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:58:11.361139 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp175808411460'
        
      order by ordinal_position

  
[0m17:58:11.402176 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.114 seconds
[0m17:58:11.403139 [debug] [Thread-3 (]: SQL status: SELECT 387 in 0.113 seconds
[0m17:58:11.406186 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:58:11.413188 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:58:11.414177 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."events_prep".date is $dbt_comment_literal_block$Date of event derived from timestamp.
Imitates Hive-styled partitioning of events by date.
It is needed for efficient incremental processing by engines
with partitioning support (i.e. Trino).$dbt_comment_literal_block$;
  

  
[0m17:58:11.415178 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_gom1"."dbt"."first_name_sex" rename to "first_name_sex__dbt_backup"
[0m17:58:11.480433 [debug] [Thread-1 (]: SQL status: COMMENT in 0.064 seconds
[0m17:58:11.481392 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.120 seconds
[0m17:58:11.483423 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: COMMIT
[0m17:58:11.488391 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:58:11.489390 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.073 seconds
[0m17:58:11.490392 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:58:11.491394 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:58:11.496391 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:58:11.497391 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: COMMIT
[0m17:58:11.498393 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_gom1"."dbt"."first_name_sex__dbt_tmp" rename to "first_name_sex"
[0m17:58:11.563508 [debug] [Thread-1 (]: SQL status: COMMIT in 0.064 seconds
[0m17:58:11.575507 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."events_prep__dbt_backup"
[0m17:58:11.576506 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.077 seconds
[0m17:58:11.588529 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m17:58:11.589528 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.091 seconds
[0m17:58:11.597527 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:58:11.598530 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
drop view if exists "dev_gom1"."dbt"."events_prep__dbt_backup" cascade
[0m17:58:11.626529 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:58:11.627528 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

    
  
  comment on table "dev_gom1"."dbt"."first_name_sex" is $dbt_comment_literal_block$Unique name_sex glossary$dbt_comment_literal_block$;

  
[0m17:58:11.628527 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp175808411460'
        
      order by ordinal_position

  
[0m17:58:11.693171 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.065 seconds
[0m17:58:11.696174 [debug] [Thread-1 (]: On model.dbt_scooters.events_prep: Close
[0m17:58:11.697175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D708F14F0>]}
[0m17:58:11.700172 [debug] [Thread-3 (]: SQL status: COMMENT in 0.070 seconds
[0m17:58:11.699174 [info ] [Thread-1 (]: 30 of 52 OK created sql view model dbt.events_prep ............................. [[32mCREATE VIEW[0m in 2.22s]
[0m17:58:11.702172 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.072 seconds
[0m17:58:11.705176 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m17:58:11.706178 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_prep
[0m17:58:11.712174 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:58:11.713173 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:58:11.714175 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_geom
[0m17:58:11.715175 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:58:11.715175 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m17:58:11.716174 [info ] [Thread-1 (]: 33 of 52 START sql view model dbt.trips_geom ................................... [RUN]
[0m17:58:11.719172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_prep, now model.dbt_scooters.trips_geom)
[0m17:58:11.722174 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_geom
[0m17:58:11.730174 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m17:58:11.733171 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_geom
[0m17:58:11.743176 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m17:58:11.746169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m17:58:11.748462 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m17:58:11.750463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:11.790471 [debug] [Thread-3 (]: SQL status: COMMIT in 0.072 seconds
[0m17:58:11.797488 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."first_name_sex__dbt_backup"
[0m17:58:11.798491 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.081 seconds
[0m17:58:11.806489 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m17:58:11.826498 [debug] [Thread-2 (]: 
    In "dev_gom1"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:58:11.828494 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
drop table if exists "dev_gom1"."dbt"."first_name_sex__dbt_backup" cascade
[0m17:58:11.857126 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m17:58:11.860141 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:58:11.861136 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        
            delete from "dev_gom1"."dbt"."events_clean"
            using "events_clean__dbt_tmp175808411460"
            where (
                
                    "events_clean__dbt_tmp175808411460".user_id = "dev_gom1"."dbt"."events_clean".user_id
                    and 
                
                    "events_clean__dbt_tmp175808411460".timestamp = "dev_gom1"."dbt"."events_clean".timestamp
                    and 
                
                    "events_clean__dbt_tmp175808411460".type_id = "dev_gom1"."dbt"."events_clean".type_id
                    
                
                
            );
        
    

    insert into "dev_gom1"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp175808411460"
    )
  
[0m17:58:11.978176 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.120 seconds
[0m17:58:11.981178 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: Close
[0m17:58:11.982178 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6E3836E0>]}
[0m17:58:11.984179 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.123 seconds
[0m17:58:11.984179 [info ] [Thread-3 (]: 31 of 52 OK created sql table model dbt.first_name_sex ......................... [[32mSELECT 387[0m in 2.29s]
[0m17:58:11.989177 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:58:11.991180 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.first_name_sex
[0m17:58:11.992178 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
  comment on table "dev_gom1"."dbt"."events_clean" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m17:58:11.993177 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_prep
[0m17:58:11.995180 [info ] [Thread-3 (]: 34 of 52 START sql view model dbt.trips_prep ................................... [RUN]
[0m17:58:11.996177 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.first_name_sex, now model.dbt_scooters.trips_prep)
[0m17:58:11.998182 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_prep
[0m17:58:12.005181 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m17:58:12.008181 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_prep
[0m17:58:12.016177 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m17:58:12.018179 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:58:12.019180 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m17:58:12.020182 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:58:12.077218 [debug] [Thread-2 (]: SQL status: COMMENT in 0.082 seconds
[0m17:58:12.079218 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m17:58:12.080219 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m17:58:12.081219 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m17:58:12.178254 [debug] [Thread-2 (]: SQL status: COMMIT in 0.097 seconds
[0m17:58:12.180257 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: Close
[0m17:58:12.181257 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D707DCE30>]}
[0m17:58:12.182256 [info ] [Thread-2 (]: 29 of 52 OK created sql incremental model dbt.events_clean ..................... [[32mINSERT 0 0[0m in 3.82s]
[0m17:58:12.184261 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_clean
[0m17:58:12.186257 [debug] [Thread-2 (]: Began running node model.dbt_scooters.companies
[0m17:58:12.187259 [info ] [Thread-2 (]: 35 of 52 START sql table model dbt.companies ................................... [RUN]
[0m17:58:12.188260 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.companies)
[0m17:58:12.189261 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.companies
[0m17:58:12.193255 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m17:58:12.195256 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.companies
[0m17:58:12.201255 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m17:58:12.204254 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:58:12.204254 [debug] [Thread-2 (]: On model.dbt_scooters.companies: BEGIN
[0m17:58:12.205253 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:58:13.437542 [debug] [Thread-3 (]: SQL status: BEGIN in 1.418 seconds
[0m17:58:13.438527 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:58:13.439528 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_gom1"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select
    id,
    user_id,
    scooter_hw_id,
    started_at,
    finished_at,
    start_lat,
    start_lon,
    finish_lat,
    finish_lon,
    distance as distance_m,
    cast(price as decimal(20, 2)) / 100 as price_rub,
    extract(epoch from (finished_at - started_at)) as duration_s,
    finished_at <> started_at and price = 0 as is_free,
    
    date(started_at at time zone 'Europe/Moscow')
 as "date"
from
    "dev_gom1"."scooters_raw"."trips"
  );
[0m17:58:13.576454 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.136 seconds
[0m17:58:13.582462 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:58:13.583464 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_gom1"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m17:58:13.650095 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.066 seconds
[0m17:58:13.654097 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:58:13.655097 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_gom1"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m17:58:13.686311 [debug] [Thread-4 (]: SQL status: SELECT 0 in 3.941 seconds
[0m17:58:13.689317 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:58:13.690318 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m17:58:13.778522 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.123 seconds
[0m17:58:13.780530 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:58:13.781534 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

    
  
  comment on view "dev_gom1"."dbt"."trips_prep" is $dbt_comment_literal_block$Trips prepared for analysis$dbt_comment_literal_block$;

  
[0m17:58:13.782523 [debug] [Thread-4 (]: SQL status: BEGIN in 0.091 seconds
[0m17:58:13.782523 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:58:13.783528 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp175809741407'
        
      order by ordinal_position

  
[0m17:58:13.846488 [debug] [Thread-3 (]: SQL status: COMMENT in 0.064 seconds
[0m17:58:13.848521 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m17:58:13.848521 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:58:13.849523 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m17:58:13.891124 [debug] [Thread-1 (]: SQL status: BEGIN in 2.141 seconds
[0m17:58:13.892082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m17:58:13.892082 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_gom1"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_gom1"."scooters_raw"."trips"
  );
[0m17:58:13.896122 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.112 seconds
[0m17:58:13.899118 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:58:13.900120 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:58:13.918084 [debug] [Thread-3 (]: SQL status: COMMIT in 0.068 seconds
[0m17:58:13.921118 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."trips_prep__dbt_backup"
[0m17:58:13.922119 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m17:58:13.922119 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_gom1"."dbt"."trips_prep__dbt_backup" cascade
[0m17:58:13.970358 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.077 seconds
[0m17:58:13.974305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m17:58:13.975305 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_gom1"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m17:58:14.006353 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.105 seconds
[0m17:58:14.010340 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:58:14.011342 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp175809741407'
        
      order by ordinal_position

  
[0m17:58:14.014355 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.092 seconds
[0m17:58:14.016349 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: Close
[0m17:58:14.017343 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D708C44D0>]}
[0m17:58:14.018342 [info ] [Thread-3 (]: 34 of 52 OK created sql view model dbt.trips_prep .............................. [[32mCREATE VIEW[0m in 2.02s]
[0m17:58:14.020349 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_prep
[0m17:58:14.020349 [debug] [Thread-3 (]: Began running node model.dbt_scooters.users_full
[0m17:58:14.021342 [info ] [Thread-3 (]: 36 of 52 START sql table model dbt.users_full .................................. [RUN]
[0m17:58:14.022340 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.users_full)
[0m17:58:14.023343 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.users_full
[0m17:58:14.027341 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.users_full"
[0m17:58:14.029341 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.users_full
[0m17:58:14.035341 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.users_full"
[0m17:58:14.036348 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:58:14.037311 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: BEGIN
[0m17:58:14.037311 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:58:14.044311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.068 seconds
[0m17:58:14.047336 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m17:58:14.048336 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_gom1"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m17:58:14.087537 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.075 seconds
[0m17:58:14.091537 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:58:14.092540 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:58:14.115539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.066 seconds
[0m17:58:14.117510 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m17:58:14.118509 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

    
  
  comment on view "dev_gom1"."dbt"."trips_geom" is $dbt_comment_literal_block$Trips prepared for geometry analysis$dbt_comment_literal_block$;

  
[0m17:58:14.167120 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.074 seconds
[0m17:58:14.169126 [debug] [Thread-4 (]: 
    In "dev_gom1"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:58:14.176171 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m17:58:14.178168 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:58:14.179170 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_gom1"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp175809741407"
    )


  
[0m17:58:14.185173 [debug] [Thread-1 (]: SQL status: COMMENT in 0.067 seconds
[0m17:58:14.187128 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m17:58:14.188135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m17:58:14.188135 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m17:58:14.193133 [debug] [Thread-2 (]: SQL status: BEGIN in 1.987 seconds
[0m17:58:14.193133 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:58:14.194135 [debug] [Thread-2 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_gom1"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_gom1"."dbt"."scooters"
group by
    1
  );
  
[0m17:58:14.250186 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.070 seconds
[0m17:58:14.251784 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:58:14.252781 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_concurrency" is $dbt_comment_literal_block$Number of simultaneous rides in time$dbt_comment_literal_block$;

  
[0m17:58:14.255786 [debug] [Thread-1 (]: SQL status: COMMIT in 0.067 seconds
[0m17:58:14.259384 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."trips_geom__dbt_backup"
[0m17:58:14.260385 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m17:58:14.260385 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_gom1"."dbt"."trips_geom__dbt_backup" cascade
[0m17:58:14.264389 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.070 seconds
[0m17:58:14.268350 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:58:14.268350 [debug] [Thread-2 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_gom1"."dbt"."companies" rename to "companies__dbt_backup"
[0m17:58:14.320398 [debug] [Thread-4 (]: SQL status: COMMENT in 0.067 seconds
[0m17:58:14.322402 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m17:58:14.323398 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m17:58:14.323398 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m17:58:14.331399 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.070 seconds
[0m17:58:14.333357 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: Close
[0m17:58:14.334357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D708C6CC0>]}
[0m17:58:14.335357 [info ] [Thread-1 (]: 33 of 52 OK created sql view model dbt.trips_geom .............................. [[32mCREATE VIEW[0m in 2.62s]
[0m17:58:14.335357 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.066 seconds
[0m17:58:14.337411 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_geom
[0m17:58:14.340399 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:58:14.341396 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_full
[0m17:58:14.342357 [debug] [Thread-2 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_gom1"."dbt"."companies__dbt_tmp" rename to "companies"
[0m17:58:14.343361 [info ] [Thread-1 (]: 37 of 52 START sql view model dbt.events_full .................................. [RUN]
[0m17:58:14.344361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.events_full)
[0m17:58:14.344361 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_full
[0m17:58:14.347395 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m17:58:14.349401 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_full
[0m17:58:14.352947 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m17:58:14.354980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:58:14.355975 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: BEGIN
[0m17:58:14.355975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:14.391175 [debug] [Thread-4 (]: SQL status: COMMIT in 0.067 seconds
[0m17:58:14.393165 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: Close
[0m17:58:14.394166 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6E740E60>]}
[0m17:58:14.395167 [info ] [Thread-4 (]: 32 of 52 OK created sql incremental model dbt.trips_concurrency ................ [[32mINSERT 0 0[0m in 4.66s]
[0m17:58:14.396132 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m17:58:14.397166 [debug] [Thread-4 (]: Began running node model.dbt_scooters.revenue_daily
[0m17:58:14.397166 [info ] [Thread-4 (]: 38 of 52 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m17:58:14.398168 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.revenue_daily)
[0m17:58:14.399186 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m17:58:14.403166 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m17:58:14.405171 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.revenue_daily
[0m17:58:14.431176 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:58:14.431176 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m17:58:14.432133 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
select * from (
        select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep"

group by
    2,
    3
order by
    2
    ) as __dbt_sbq
    where false
    limit 0

[0m17:58:14.434168 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:58:14.435168 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:58:14.436169 [debug] [Thread-2 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

    
  
  comment on table "dev_gom1"."dbt"."companies" is $dbt_comment_literal_block$Scooter statistics by company$dbt_comment_literal_block$;

  
[0m17:58:14.501247 [debug] [Thread-2 (]: SQL status: COMMENT in 0.064 seconds
[0m17:58:14.503283 [debug] [Thread-2 (]: On model.dbt_scooters.companies: COMMIT
[0m17:58:14.503283 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:58:14.504284 [debug] [Thread-2 (]: On model.dbt_scooters.companies: COMMIT
[0m17:58:14.570513 [debug] [Thread-2 (]: SQL status: COMMIT in 0.066 seconds
[0m17:58:14.574470 [debug] [Thread-2 (]: Applying DROP to: "dev_gom1"."dbt"."companies__dbt_backup"
[0m17:58:14.575471 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m17:58:14.575471 [debug] [Thread-2 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_gom1"."dbt"."companies__dbt_backup" cascade
[0m17:58:14.651067 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.075 seconds
[0m17:58:14.653075 [debug] [Thread-2 (]: On model.dbt_scooters.companies: Close
[0m17:58:14.654075 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D70334A40>]}
[0m17:58:14.655076 [info ] [Thread-2 (]: 35 of 52 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 2.47s]
[0m17:58:14.656079 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.companies
[0m17:58:14.657123 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat
[0m17:58:14.658117 [info ] [Thread-2 (]: 39 of 52 START sql table model dbt.trips_stat .................................. [RUN]
[0m17:58:14.659074 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.trips_stat)
[0m17:58:14.660117 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat
[0m17:58:14.663115 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m17:58:14.665077 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat
[0m17:58:14.668111 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m17:58:14.670111 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:58:14.670111 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m17:58:14.671115 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:58:15.447452 [debug] [Thread-1 (]: SQL status: BEGIN in 1.091 seconds
[0m17:58:15.448453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:58:15.448453 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_gom1"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select * from
"dev_gom1"."dbt"."events_clean" as e
left join "dev_gom1"."dbt"."event_types" as t
using (type_id)
  );
[0m17:58:15.516107 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.066 seconds
[0m17:58:15.525111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:58:15.526147 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_gom1"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m17:58:15.592166 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.065 seconds
[0m17:58:15.598162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:58:15.600164 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_gom1"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m17:58:15.665225 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.064 seconds
[0m17:58:15.669240 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:58:15.670239 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

    
  
  comment on view "dev_gom1"."dbt"."events_full" is $dbt_comment_literal_block$User events enriched with meaningful types$dbt_comment_literal_block$;

  
[0m17:58:15.735246 [debug] [Thread-1 (]: SQL status: COMMENT in 0.064 seconds
[0m17:58:15.739246 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m17:58:15.740243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:58:15.741249 [debug] [Thread-2 (]: SQL status: BEGIN in 1.070 seconds
[0m17:58:15.742247 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m17:58:15.743243 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:58:15.744253 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_gom1"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count(*) as trips,
    count(distinct user_id) as users,
    avg(duration_s) / 60 as avg_duration_min,
    sum(distance_m) / 1000 as sum_distance_km,
    sum(price_rub) as revenue_rub,
    count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from
    "dev_gom1"."dbt"."trips_prep"
  );
  
[0m17:58:15.818315 [debug] [Thread-1 (]: SQL status: COMMIT in 0.074 seconds
[0m17:58:15.822317 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."events_full__dbt_backup"
[0m17:58:15.824314 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m17:58:15.825314 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_gom1"."dbt"."events_full__dbt_backup" cascade
[0m17:58:15.910372 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.084 seconds
[0m17:58:15.913373 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: Close
[0m17:58:15.914372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D7031AC00>]}
[0m17:58:15.916373 [info ] [Thread-1 (]: 37 of 52 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 1.57s]
[0m17:58:15.918385 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_full
[0m17:58:15.919396 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m17:58:15.920382 [info ] [Thread-1 (]: 40 of 52 START sql table model dbt.trips_stat_daily ............................ [RUN]
[0m17:58:15.922389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_stat_daily)
[0m17:58:15.922389 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m17:58:15.926388 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m17:58:15.929387 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m17:58:15.935387 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m17:58:15.938391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:58:15.939390 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m17:58:15.939390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:16.077499 [debug] [Thread-3 (]: SQL status: BEGIN in 2.039 seconds
[0m17:58:16.078497 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:58:16.079498 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

  
    

  create  table "dev_gom1"."dbt"."users_full__dbt_tmp"
  
  
    as
  
  (
    select
   u.id, u.first_name ,u.last_name ,u.phone ,
   COALESCE(u.sex, fns.sex, afns.sex) as sex2,
   u.birth_date
from "dev_gom1"."scooters_raw"."users" u
left join "dev_gom1"."dbt"."first_name_sex" fns on u.first_name = fns.first_name
left join "dev_gom1"."dbt"."add_first_name_sex" afns on u.first_name =afns.first_name
  );
  
[0m17:58:16.380397 [debug] [Thread-3 (]: SQL status: SELECT 2000 in 0.299 seconds
[0m17:58:16.386399 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:58:16.387434 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_gom1"."dbt"."users_full" rename to "users_full__dbt_backup"
[0m17:58:16.478269 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m17:58:16.483261 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:58:16.484261 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_gom1"."dbt"."users_full__dbt_tmp" rename to "users_full"
[0m17:58:16.576347 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m17:58:16.580345 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:58:16.582314 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

    
  
  comment on table "dev_gom1"."dbt"."users_full" is $dbt_comment_literal_block$Users enriched with sex$dbt_comment_literal_block$;

  
[0m17:58:16.676467 [debug] [Thread-4 (]: SQL status: SELECT 0 in 2.240 seconds
[0m17:58:16.691464 [debug] [Thread-3 (]: SQL status: COMMENT in 0.108 seconds
[0m17:58:16.715485 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:58:16.719499 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: COMMIT
[0m17:58:16.721494 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
select * from (
        select
    
      
    cast(null as decimal(20, 2))
 as revenue_rub, 
      
    cast(null as date)
 as date, 
      
    cast(null as timestamptz)
 as updated_at
    ) as __dbt_sbq
    where false
    limit 0

[0m17:58:16.723495 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:58:16.725497 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: COMMIT
[0m17:58:16.882276 [debug] [Thread-3 (]: SQL status: COMMIT in 0.156 seconds
[0m17:58:16.888285 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."users_full__dbt_backup"
[0m17:58:16.890288 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m17:58:16.892286 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
drop table if exists "dev_gom1"."dbt"."users_full__dbt_backup" cascade
[0m17:58:16.974372 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.249 seconds
[0m17:58:16.987391 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.093 seconds
[0m17:58:17.006393 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: Close
[0m17:58:17.031440 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m17:58:17.033438 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6E49A720>]}
[0m17:58:17.036439 [info ] [Thread-3 (]: 36 of 52 OK created sql table model dbt.users_full ............................. [[32mSELECT 2000[0m in 3.01s]
[0m17:58:17.038453 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:58:17.040454 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.users_full
[0m17:58:17.042455 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m17:58:17.043450 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_users
[0m17:58:17.045453 [info ] [Thread-3 (]: 41 of 52 START sql incremental model dbt.trips_users ........................... [RUN]
[0m17:58:17.047468 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.users_full, now model.dbt_scooters.trips_users)
[0m17:58:17.048465 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_users
[0m17:58:17.060543 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m17:58:17.063545 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_users
[0m17:58:17.076078 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:58:17.077080 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp175817070082"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep" as t
left join
    "dev_gom1"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_gom1"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m17:58:17.079092 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:58:17.178157 [debug] [Thread-4 (]: SQL status: BEGIN in 0.133 seconds
[0m17:58:17.180161 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:58:17.181161 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
  
    

  create  table "dev_gom1"."finance"."revenue_daily"
  
  
    
  
  (
    revenue_rub decimal(20, 2),
    date date,
    updated_at timestamptz
    
    )
 ;
    insert into "dev_gom1"."finance"."revenue_daily" (
      revenue_rub, date, updated_at
    )
  
  (
    
    select revenue_rub, date, updated_at
    from (
        select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep"

group by
    2,
    3
order by
    2
    ) as model_subq
  );
  
  
[0m17:58:17.417489 [debug] [Thread-1 (]: SQL status: BEGIN in 1.478 seconds
[0m17:58:17.419490 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:58:17.420495 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_gom1"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    count(*) as trips,
    max(price_rub) as max_price_rub,
    avg(distance_m) / 1000 as avg_distance_km,
    avg(price_rub)/avg(duration_s) * 60 as avg_price_rub_per_min
from
    "dev_gom1"."dbt"."trips_prep"
group by
    1
order by
    1
  );
  
[0m17:58:20.177273 [debug] [Thread-4 (]: SQL status: INSERT 0 91 in 2.994 seconds
[0m17:58:20.195286 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:58:20.196286 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

        
            grant select on "dev_gom1"."finance"."revenue_daily" to finance;
        
    
[0m17:58:20.262855 [debug] [Thread-4 (]: SQL status: GRANT in 0.067 seconds
[0m17:58:20.265857 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:58:20.265857 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  comment on table "dev_gom1"."finance"."revenue_daily" is $dbt_comment_literal_block$Summary daily revenue$dbt_comment_literal_block$;

  
[0m17:58:20.373460 [debug] [Thread-4 (]: SQL status: COMMENT in 0.106 seconds
[0m17:58:20.377470 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:58:20.378466 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m17:58:20.574265 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.195 seconds
[0m17:58:20.576304 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:58:20.577267 [debug] [Thread-2 (]: SQL status: SELECT 1 in 4.832 seconds
[0m17:58:20.577267 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  
    
    
    comment on column "dev_gom1"."finance"."revenue_daily".revenue_rub is $dbt_comment_literal_block$Daily revenue in rubles$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."finance"."revenue_daily".date is $dbt_comment_literal_block$Unique day$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."finance"."revenue_daily".updated_at is $dbt_comment_literal_block$When row was updated last time$dbt_comment_literal_block$;
  

  
[0m17:58:20.582271 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:58:20.583272 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_gom1"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m17:58:20.647274 [debug] [Thread-4 (]: SQL status: COMMENT in 0.065 seconds
[0m17:58:20.649275 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m17:58:20.650271 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m17:58:20.651274 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m17:58:20.675293 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m17:58:20.679298 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:58:20.679298 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_gom1"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m17:58:20.716307 [debug] [Thread-4 (]: SQL status: COMMIT in 0.064 seconds
[0m17:58:20.717308 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: Close
[0m17:58:20.718307 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D7096FA70>]}
[0m17:58:20.719308 [info ] [Thread-4 (]: 38 of 52 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 91[0m in 6.32s]
[0m17:58:20.720306 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.revenue_daily
[0m17:58:20.722314 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m17:58:20.723309 [info ] [Thread-4 (]: 42 of 52 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m17:58:20.724307 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.parking_finish_stat)
[0m17:58:20.725308 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m17:58:20.730314 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m17:58:20.732314 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m17:58:20.736316 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m17:58:20.739327 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m17:58:20.739327 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m17:58:20.740326 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:58:20.773477 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m17:58:20.776436 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:58:20.776436 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_stat" is $dbt_comment_literal_block$Overall trips statistics$dbt_comment_literal_block$;

  
[0m17:58:20.873568 [debug] [Thread-2 (]: SQL status: COMMENT in 0.096 seconds
[0m17:58:20.875568 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m17:58:20.877111 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:58:20.877111 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m17:58:20.980285 [debug] [Thread-2 (]: SQL status: COMMIT in 0.102 seconds
[0m17:58:20.986239 [debug] [Thread-2 (]: Applying DROP to: "dev_gom1"."dbt"."trips_stat__dbt_backup"
[0m17:58:20.987244 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m17:58:20.988238 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_gom1"."dbt"."trips_stat__dbt_backup" cascade
[0m17:58:21.079458 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.091 seconds
[0m17:58:21.081459 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: Close
[0m17:58:21.082459 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D709C78F0>]}
[0m17:58:21.083459 [info ] [Thread-2 (]: 39 of 52 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 6.42s]
[0m17:58:21.084459 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat
[0m17:58:21.085502 [debug] [Thread-2 (]: Began running node model.dbt_scooters.parking_start_stat
[0m17:58:21.086465 [info ] [Thread-2 (]: 43 of 52 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m17:58:21.087465 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.parking_start_stat)
[0m17:58:21.087465 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m17:58:21.091501 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m17:58:21.093459 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m17:58:21.098464 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m17:58:21.100464 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m17:58:21.100464 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m17:58:21.101465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:58:21.779089 [debug] [Thread-3 (]: SQL status: SELECT 0 in 4.700 seconds
[0m17:58:21.783050 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:58:21.784050 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: BEGIN
[0m17:58:21.855057 [debug] [Thread-3 (]: SQL status: BEGIN in 0.070 seconds
[0m17:58:21.856054 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:58:21.857052 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp175817070082'
        
      order by ordinal_position

  
[0m17:58:22.083325 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.225 seconds
[0m17:58:22.089327 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:58:22.090333 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:58:22.183501 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.092 seconds
[0m17:58:22.190475 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:58:22.191477 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp175817070082'
        
      order by ordinal_position

  
[0m17:58:22.279163 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.087 seconds
[0m17:58:22.286118 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:58:22.287122 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:58:22.387479 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.099 seconds
[0m17:58:22.392515 [debug] [Thread-3 (]: 
    In "dev_gom1"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:58:22.393507 [debug] [Thread-1 (]: SQL status: SELECT 91 in 4.972 seconds
[0m17:58:22.395475 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m17:58:22.400470 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:58:22.402471 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_gom1"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m17:58:22.404473 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:58:22.405475 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_gom1"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp175817070082"
    )


  
[0m17:58:22.474124 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.068 seconds
[0m17:58:22.475122 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.072 seconds
[0m17:58:22.478124 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:58:22.482157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:58:22.483156 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_users" is $dbt_comment_literal_block$Prepared trips enriched with users data$dbt_comment_literal_block$;

  
[0m17:58:22.484121 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_gom1"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m17:58:22.552158 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.067 seconds
[0m17:58:22.553122 [debug] [Thread-3 (]: SQL status: COMMENT in 0.068 seconds
[0m17:58:22.569182 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:58:22.572182 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:58:22.573217 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    create  index if not exists
  "51187d8d8d48d4c87cf5aca16e8fb488"
  on "dev_gom1"."dbt"."trips_stat_daily" 
  (date)
  
[0m17:58:22.574218 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m17:58:22.647186 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.072 seconds
[0m17:58:22.650205 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:58:22.651182 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_stat_daily" is $dbt_comment_literal_block$Overall trips statistics per day$dbt_comment_literal_block$;

  
[0m17:58:22.707194 [debug] [Thread-4 (]: SQL status: BEGIN in 1.967 seconds
[0m17:58:22.708182 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m17:58:22.709186 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_gom1"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_gom1"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m17:58:22.719190 [debug] [Thread-1 (]: SQL status: COMMENT in 0.067 seconds
[0m17:58:22.724155 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:58:22.725156 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_stat_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:58:23.088156 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.363 seconds
[0m17:58:23.091131 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:58:23.092130 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."trips_stat_daily".date is $dbt_comment_literal_block$Trips date$dbt_comment_literal_block$;
  

  
[0m17:58:23.177323 [debug] [Thread-1 (]: SQL status: COMMENT in 0.084 seconds
[0m17:58:23.178323 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m17:58:23.179323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:58:23.180323 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m17:58:23.226323 [debug] [Thread-2 (]: SQL status: BEGIN in 2.124 seconds
[0m17:58:23.226323 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m17:58:23.228335 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_gom1"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_gom1"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m17:58:23.279218 [debug] [Thread-1 (]: SQL status: COMMIT in 0.098 seconds
[0m17:58:23.284178 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."trips_stat_daily__dbt_backup"
[0m17:58:23.285179 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m17:58:23.286181 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_gom1"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m17:58:23.383350 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.096 seconds
[0m17:58:23.385351 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m17:58:23.386351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D70A08290>]}
[0m17:58:23.387364 [info ] [Thread-1 (]: 40 of 52 OK created sql table model dbt.trips_stat_daily ....................... [[32mSELECT 91[0m in 7.46s]
[0m17:58:23.389361 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m17:58:23.390359 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies_trips
[0m17:58:23.391400 [info ] [Thread-1 (]: 44 of 52 START sql table model dbt.companies_trips ............................. [RUN]
[0m17:58:23.392393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.companies_trips)
[0m17:58:23.393403 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies_trips
[0m17:58:23.397399 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m17:58:23.399362 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies_trips
[0m17:58:23.404363 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m17:58:23.406360 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:58:23.407371 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m17:58:23.408371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:24.647187 [debug] [Thread-1 (]: SQL status: BEGIN in 1.239 seconds
[0m17:58:24.648141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:58:24.648141 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_gom1"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_gom1"."dbt"."trips_prep" as t
        join "dev_gom1"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_gom1"."dbt"."companies" as c
        using (company)
  );
  
[0m17:58:25.694337 [debug] [Thread-1 (]: SQL status: SELECT 6 in 1.045 seconds
[0m17:58:25.702347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:58:25.704349 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_gom1"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m17:58:25.775541 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.069 seconds
[0m17:58:25.785074 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:58:25.787079 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_gom1"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m17:58:25.859096 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.071 seconds
[0m17:58:25.862089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:58:25.863095 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  comment on table "dev_gom1"."dbt"."companies_trips" is $dbt_comment_literal_block$Trip statistics by company$dbt_comment_literal_block$;

  
[0m17:58:25.932153 [debug] [Thread-1 (]: SQL status: COMMENT in 0.068 seconds
[0m17:58:25.942146 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:58:25.944149 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'companies_trips'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:58:26.186438 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.241 seconds
[0m17:58:26.190449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:58:26.191485 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."companies_trips".company is $dbt_comment_literal_block$Scooters manufacturing company$dbt_comment_literal_block$;
  

  
[0m17:58:26.281267 [debug] [Thread-1 (]: SQL status: COMMENT in 0.088 seconds
[0m17:58:26.284305 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m17:58:26.284305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:58:26.285299 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m17:58:26.380477 [debug] [Thread-1 (]: SQL status: COMMIT in 0.094 seconds
[0m17:58:26.384431 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."companies_trips__dbt_backup"
[0m17:58:26.385431 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m17:58:26.386431 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_gom1"."dbt"."companies_trips__dbt_backup" cascade
[0m17:58:26.477048 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.090 seconds
[0m17:58:26.479084 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: Close
[0m17:58:26.481085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D709DC6E0>]}
[0m17:58:26.482083 [info ] [Thread-1 (]: 44 of 52 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 3.09s]
[0m17:58:26.483048 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies_trips
[0m17:58:26.484051 [debug] [Thread-1 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m17:58:26.485050 [info ] [Thread-1 (]: 45 of 52 START test events_full_is_complete .................................... [RUN]
[0m17:58:26.487083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now test.dbt_scooters.events_full_is_complete)
[0m17:58:26.487083 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m17:58:26.491082 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m17:58:26.493084 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m17:58:26.496082 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.events_full_is_complete"
[0m17:58:26.498087 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m17:58:26.499052 [debug] [Thread-1 (]: On test.dbt_scooters.events_full_is_complete: BEGIN
[0m17:58:26.500087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:28.279223 [debug] [Thread-1 (]: SQL status: BEGIN in 1.779 seconds
[0m17:58:28.280178 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m17:58:28.280178 [debug] [Thread-1 (]: On test.dbt_scooters.events_full_is_complete: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.events_full_is_complete"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with source_cte as (
    select count(*) as row_count
    from "dev_gom1"."dbt"."events_clean"
),
target_cte as (
    select count(*) as row_count
    from "dev_gom1"."dbt"."events_full"
)
select
    'Row count mismatch' as error_message,
    source_cte.row_count as source_count,
    target_cte.row_count as target_count
from
    source_cte,
    target_cte
where
    source_cte.row_count != target_cte.row_count
      
    ) dbt_internal_test
[0m17:58:29.075632 [debug] [Thread-3 (]: SQL status: ANALYZE in 6.501 seconds
[0m17:58:29.078220 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: COMMIT
[0m17:58:29.078220 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:58:29.079218 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: COMMIT
[0m17:58:29.177548 [debug] [Thread-3 (]: SQL status: COMMIT in 0.098 seconds
[0m17:58:29.178557 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:58:29.178557 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m17:58:29.277367 [debug] [Thread-3 (]: SQL status: COMMIT in 0.097 seconds
[0m17:58:29.278417 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m17:58:29.279416 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m17:58:29.779334 [debug] [Thread-3 (]: SQL status: VACUUM in 0.499 seconds
[0m17:58:29.781332 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: Close
[0m17:58:29.782330 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D70337B60>]}
[0m17:58:29.783330 [info ] [Thread-3 (]: 41 of 52 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 12.74s]
[0m17:58:29.784297 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_users
[0m17:58:29.785330 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m17:58:29.785330 [info ] [Thread-3 (]: 46 of 52 START test unique_companies_trips_company ............................. [RUN]
[0m17:58:29.786294 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m17:58:29.787330 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m17:58:29.792298 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m17:58:29.793298 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m17:58:29.796298 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m17:58:29.797292 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m17:58:29.798298 [debug] [Thread-3 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m17:58:29.798298 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:58:31.578497 [debug] [Thread-3 (]: SQL status: BEGIN in 1.780 seconds
[0m17:58:31.579470 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m17:58:31.579470 [debug] [Thread-3 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_gom1"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:31.782303 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.201 seconds
[0m17:58:31.784273 [debug] [Thread-3 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m17:58:31.991270 [debug] [Thread-3 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m17:58:31.993271 [info ] [Thread-3 (]: 46 of 52 PASS unique_companies_trips_company ................................... [[32mPASS[0m in 2.21s]
[0m17:58:31.994237 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m17:58:31.995235 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m17:58:31.995235 [info ] [Thread-3 (]: 47 of 52 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m17:58:31.996270 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0, now model.dbt_scooters.trips_age_daily)
[0m17:58:31.997234 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m17:58:32.000233 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m17:58:32.001233 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m17:58:32.007272 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m17:58:32.008272 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:58:32.009239 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m17:58:32.010271 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:58:33.592053 [debug] [Thread-3 (]: SQL status: BEGIN in 1.582 seconds
[0m17:58:33.593048 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:58:33.594050 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_gom1"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    Select "date",
       age,
       count(*) as trips,
       sum(price_rub) as revenue_rub
from
    "dev_gom1"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m17:58:35.100296 [debug] [Thread-1 (]: SQL status: SELECT 1 in 6.819 seconds
[0m17:58:35.102300 [debug] [Thread-1 (]: On test.dbt_scooters.events_full_is_complete: ROLLBACK
[0m17:58:35.175343 [debug] [Thread-1 (]: On test.dbt_scooters.events_full_is_complete: Close
[0m17:58:35.177345 [info ] [Thread-1 (]: 45 of 52 PASS events_full_is_complete .......................................... [[32mPASS[0m in 8.69s]
[0m17:58:35.177854 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m17:58:35.178865 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_group
[0m17:58:35.179863 [info ] [Thread-1 (]: 48 of 52 START sql table model dbt.trips_age_group ............................. [RUN]
[0m17:58:35.180862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.events_full_is_complete, now model.dbt_scooters.trips_age_group)
[0m17:58:35.180862 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m17:58:35.184865 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m17:58:35.187375 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_group
[0m17:58:35.191388 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m17:58:35.193388 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m17:58:35.193388 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m17:58:35.194384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:36.582839 [debug] [Thread-3 (]: SQL status: SELECT 7049 in 2.988 seconds
[0m17:58:36.585842 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:58:36.587391 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_gom1"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m17:58:36.680997 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m17:58:36.683997 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:58:36.684999 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_gom1"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m17:58:36.777162 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m17:58:36.780751 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:58:36.781716 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_age_daily" is $dbt_comment_literal_block$Daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m17:58:36.876280 [debug] [Thread-3 (]: SQL status: COMMENT in 0.094 seconds
[0m17:58:36.876280 [debug] [Thread-1 (]: SQL status: BEGIN in 1.683 seconds
[0m17:58:36.878837 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m17:58:36.879883 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m17:58:36.880890 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:58:36.881847 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_gom1"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_gom1"."dbt"."trips_users" as tu
    cross join "dev_gom1"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m17:58:36.882880 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m17:58:36.999050 [debug] [Thread-3 (]: SQL status: COMMIT in 0.115 seconds
[0m17:58:37.002041 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."trips_age_daily__dbt_backup"
[0m17:58:37.003012 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m17:58:37.003012 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_gom1"."dbt"."trips_age_daily__dbt_backup" cascade
[0m17:58:37.181851 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.178 seconds
[0m17:58:37.183851 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m17:58:37.184851 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D703192B0>]}
[0m17:58:37.185851 [info ] [Thread-3 (]: 47 of 52 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 5.19s]
[0m17:58:37.187360 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m17:58:37.188377 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_stat
[0m17:58:37.190407 [info ] [Thread-3 (]: 49 of 52 START sql table model dbt.events_stat ................................. [RUN]
[0m17:58:37.191427 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now model.dbt_scooters.events_stat)
[0m17:58:37.192409 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_stat
[0m17:58:37.195420 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m17:58:37.197401 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_stat
[0m17:58:37.203376 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m17:58:37.205368 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:58:37.206373 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: BEGIN
[0m17:58:37.206373 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:58:38.680088 [debug] [Thread-3 (]: SQL status: BEGIN in 1.473 seconds
[0m17:58:38.680088 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:58:38.681642 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_gom1"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
       count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from "dev_gom1"."dbt"."events_full"
  );
  
[0m17:58:47.880236 [debug] [Thread-3 (]: SQL status: SELECT 1 in 9.198 seconds
[0m17:58:47.884237 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:58:47.885233 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_gom1"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m17:58:47.975450 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m17:58:47.979437 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:58:47.980437 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_gom1"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m17:58:48.078442 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.098 seconds
[0m17:58:48.082444 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:58:48.083445 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."events_stat" is $dbt_comment_literal_block$Overall user events statistics$dbt_comment_literal_block$;

  
[0m17:58:48.182043 [debug] [Thread-3 (]: SQL status: COMMENT in 0.097 seconds
[0m17:58:48.184043 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: COMMIT
[0m17:58:48.184043 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:58:48.185048 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: COMMIT
[0m17:58:48.276277 [debug] [Thread-3 (]: SQL status: COMMIT in 0.090 seconds
[0m17:58:48.281278 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."events_stat__dbt_backup"
[0m17:58:48.282285 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m17:58:48.283283 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_gom1"."dbt"."events_stat__dbt_backup" cascade
[0m17:58:48.479333 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.195 seconds
[0m17:58:48.482335 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: Close
[0m17:58:48.483338 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D70A2C0B0>]}
[0m17:58:48.485338 [info ] [Thread-3 (]: 49 of 52 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 11.29s]
[0m17:58:48.487345 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_stat
[0m17:58:48.488356 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m17:58:48.490356 [info ] [Thread-3 (]: 50 of 52 START test unique_key_trips_age_daily_date__age ....................... [RUN]
[0m17:58:48.491362 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be)
[0m17:58:48.493355 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m17:58:48.502869 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m17:58:48.505872 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m17:58:48.510400 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m17:58:48.513400 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m17:58:48.514402 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: BEGIN
[0m17:58:48.515402 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:58:51.375189 [debug] [Thread-3 (]: SQL status: BEGIN in 2.860 seconds
[0m17:58:51.376186 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m17:58:51.377192 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "date"::text ||
    
        "age"::text ||
    
    ''
from
    "dev_gom1"."dbt"."trips_age_daily"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m17:58:52.281185 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.903 seconds
[0m17:58:52.284222 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: ROLLBACK
[0m17:58:52.371357 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: Close
[0m17:58:52.373395 [info ] [Thread-3 (]: 50 of 52 PASS unique_key_trips_age_daily_date__age ............................. [[32mPASS[0m in 3.88s]
[0m17:58:52.374404 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m17:58:52.375393 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m17:58:52.376356 [info ] [Thread-3 (]: 51 of 52 START test unique_trips_age_daily_date_text_age_text .................. [RUN]
[0m17:58:52.378358 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be, now test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e)
[0m17:58:52.379393 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m17:58:52.386354 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m17:58:52.388365 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m17:58:52.392399 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m17:58:52.394366 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m17:58:52.395399 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: BEGIN
[0m17:58:52.396363 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:58:54.979019 [debug] [Thread-3 (]: SQL status: BEGIN in 2.583 seconds
[0m17:58:54.980008 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m17:58:54.980983 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date::text || age::text as unique_field,
    count(*) as n_records

from "dev_gom1"."dbt"."trips_age_daily"
where date::text || age::text is not null
group by date::text || age::text
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:55.992420 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.010 seconds
[0m17:58:55.996422 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: ROLLBACK
[0m17:58:56.096030 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: Close
[0m17:58:56.098048 [info ] [Thread-3 (]: 51 of 52 PASS unique_trips_age_daily_date_text_age_text ........................ [[32mPASS[0m in 3.72s]
[0m17:58:56.100048 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m17:58:56.102051 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m17:58:56.103047 [info ] [Thread-3 (]: 52 of 52 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m17:58:56.104045 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e, now model.dbt_scooters.trips_age_daily_stat)
[0m17:58:56.105050 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m17:58:56.109568 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m17:58:56.112571 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m17:58:56.121098 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m17:58:56.124098 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:58:56.125105 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m17:58:56.126106 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:58:57.775243 [debug] [Thread-3 (]: SQL status: BEGIN in 1.650 seconds
[0m17:58:57.776246 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:58:57.777247 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_gom1"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_gom1"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m17:58:58.385424 [debug] [Thread-3 (]: SQL status: SELECT 83 in 0.608 seconds
[0m17:58:58.389427 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:58:58.389427 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_gom1"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m17:58:58.574995 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.185 seconds
[0m17:58:58.578998 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:58:58.579994 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_gom1"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m17:58:58.679064 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.098 seconds
[0m17:58:58.681062 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:58:58.682062 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_age_daily_stat" is $dbt_comment_literal_block$Aggregation of daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m17:58:58.793141 [debug] [Thread-3 (]: SQL status: COMMENT in 0.111 seconds
[0m17:58:58.795146 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m17:58:58.796145 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:58:58.796145 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m17:58:58.880212 [debug] [Thread-3 (]: SQL status: COMMIT in 0.083 seconds
[0m17:58:58.883213 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."trips_age_daily_stat__dbt_backup"
[0m17:58:58.884213 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m17:58:58.884213 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_gom1"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m17:58:58.982278 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.097 seconds
[0m17:58:58.984282 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m17:58:58.985278 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D7031A630>]}
[0m17:58:58.985278 [info ] [Thread-3 (]: 52 of 52 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 2.88s]
[0m17:58:58.987297 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m17:59:07.279381 [debug] [Thread-2 (]: SQL status: SELECT 142 in 44.050 seconds
[0m17:59:07.282380 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m17:59:07.283378 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_gom1"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m17:59:07.576218 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.293 seconds
[0m17:59:07.579224 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m17:59:07.579224 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."parking_start_stat" is $dbt_comment_literal_block$Trip start parking statistics by 500 m hexagons$dbt_comment_literal_block$;

  
[0m17:59:07.679360 [debug] [Thread-2 (]: SQL status: COMMENT in 0.099 seconds
[0m17:59:07.681359 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m17:59:07.681359 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m17:59:07.682358 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m17:59:07.775032 [debug] [Thread-2 (]: SQL status: COMMIT in 0.093 seconds
[0m17:59:07.780040 [debug] [Thread-2 (]: Applying DROP to: "dev_gom1"."dbt"."parking_start_stat__dbt_backup"
[0m17:59:07.781042 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m17:59:07.781042 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_gom1"."dbt"."parking_start_stat__dbt_backup" cascade
[0m17:59:07.876092 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.094 seconds
[0m17:59:07.877093 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: Close
[0m17:59:07.878102 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D7094F350>]}
[0m17:59:07.879099 [info ] [Thread-2 (]: 43 of 52 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 46.79s]
[0m17:59:07.880099 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m17:59:10.080079 [debug] [Thread-1 (]: SQL status: SELECT 7 in 33.196 seconds
[0m17:59:10.083079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m17:59:10.084075 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_gom1"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m17:59:10.152126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.068 seconds
[0m17:59:10.156128 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m17:59:10.156128 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_gom1"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m17:59:10.227200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.070 seconds
[0m17:59:10.229211 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m17:59:10.230210 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_age_group" is $dbt_comment_literal_block$Overall trips statistics by user age group$dbt_comment_literal_block$;

  
[0m17:59:10.300243 [debug] [Thread-1 (]: SQL status: COMMENT in 0.069 seconds
[0m17:59:10.302242 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m17:59:10.302242 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m17:59:10.303245 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m17:59:10.380311 [debug] [Thread-1 (]: SQL status: COMMIT in 0.076 seconds
[0m17:59:10.384313 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."trips_age_group__dbt_backup"
[0m17:59:10.385308 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m17:59:10.386312 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_gom1"."dbt"."trips_age_group__dbt_backup" cascade
[0m17:59:10.475381 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.088 seconds
[0m17:59:10.477390 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: Close
[0m17:59:10.478390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D709E2660>]}
[0m17:59:10.479390 [info ] [Thread-1 (]: 48 of 52 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 35.30s]
[0m17:59:10.480388 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_group
[0m17:59:13.774931 [debug] [Thread-4 (]: SQL status: SELECT 464 in 51.065 seconds
[0m17:59:13.778933 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m17:59:13.778933 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_gom1"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m17:59:13.857971 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.078 seconds
[0m17:59:13.860969 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m17:59:13.860969 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."parking_finish_stat" is $dbt_comment_literal_block$Trip finish parking statistics by 10 m hexagons$dbt_comment_literal_block$;

  
[0m17:59:13.926481 [debug] [Thread-4 (]: SQL status: COMMENT in 0.064 seconds
[0m17:59:13.927483 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m17:59:13.928482 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m17:59:13.928482 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m17:59:13.994000 [debug] [Thread-4 (]: SQL status: COMMIT in 0.065 seconds
[0m17:59:13.997002 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."parking_finish_stat__dbt_backup"
[0m17:59:13.998002 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m17:59:13.998002 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_gom1"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m17:59:14.064031 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.065 seconds
[0m17:59:14.066029 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m17:59:14.067032 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea048cfe-7f21-4b82-9d12-e438dfde72b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D70874920>]}
[0m17:59:15.127961 [debug] [Thread-4 (]: An error was encountered while trying to send an event
[0m17:59:15.128964 [info ] [Thread-4 (]: 42 of 52 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 53.34s]
[0m17:59:15.129963 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m17:59:15.131922 [info ] [MainThread]: 
[0m17:59:15.132963 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:15.133924 [debug] [MainThread]: On master: BEGIN
[0m17:59:15.133924 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:16.224529 [debug] [MainThread]: SQL status: BEGIN in 1.090 seconds
[0m17:59:16.224529 [debug] [MainThread]: On master: COMMIT
[0m17:59:16.225571 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:16.225571 [debug] [MainThread]: On master: COMMIT
[0m17:59:16.290133 [debug] [MainThread]: SQL status: COMMIT in 0.063 seconds
[0m17:59:16.292186 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m17:59:16.298172 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m17:59:16.299133 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:16.299133 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m17:59:16.367394 [debug] [MainThread]: SQL status: GRANT in 0.068 seconds
[0m17:59:16.369388 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.08s]
[0m17:59:16.370349 [debug] [MainThread]: On master: Close
[0m17:59:16.371350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:16.371350 [debug] [MainThread]: Connection 'list_dev_gom1' was properly closed.
[0m17:59:16.372348 [debug] [MainThread]: Connection 'list_dev_gom1' was properly closed.
[0m17:59:16.372348 [debug] [MainThread]: Connection 'list_dev_gom1_dbt' was properly closed.
[0m17:59:16.372348 [debug] [MainThread]: Connection 'list_dev_gom1_finance' was properly closed.
[0m17:59:16.373347 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m17:59:16.373347 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_start_stat' was properly closed.
[0m17:59:16.374347 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m17:59:16.374347 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_finish_stat' was properly closed.
[0m17:59:16.375347 [info ] [MainThread]: 
[0m17:59:16.376354 [info ] [MainThread]: Finished running 4 incremental models, 1 project hook, 4 seeds, 12 table models, 28 data tests, 4 view models in 0 hours 1 minutes and 28.47 seconds (88.47s).
[0m17:59:16.386346 [debug] [MainThread]: Command end result
[0m17:59:16.421996 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m17:59:16.425116 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m17:59:16.435116 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\run_results.json
[0m17:59:16.436116 [info ] [MainThread]: 
[0m17:59:16.437112 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m17:59:16.438112 [info ] [MainThread]: 
[0m17:59:16.438112 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models\properties.yml)[0m
[0m17:59:16.439116 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m17:59:16.440112 [info ] [MainThread]: 
[0m17:59:16.441149 [info ] [MainThread]:   compiled code at target\compiled\dbt_scooters\models\properties.yml\source_not_null_scooters_raw_users_sex.sql
[0m17:59:16.442113 [info ] [MainThread]: 
[0m17:59:16.443112 [info ] [MainThread]: Done. PASS=52 WARN=1 ERROR=0 SKIP=0 TOTAL=53
[0m17:59:16.445153 [debug] [MainThread]: Command `dbt build` succeeded at 17:59:16.444113 after 90.71 seconds
[0m17:59:16.445153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6E011250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6E010BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6E010530>]}
[0m17:59:16.446142 [debug] [MainThread]: Flushing usage events
[0m17:59:17.042926 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:12.991245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D78AB3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7838C1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7838C980>]}


============================== 18:00:12.996820 | cc55151b-6354-4ab2-8372-dac76c2ccf3a ==============================
[0m18:00:12.996820 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:00:12.998870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:00:13.316178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D78F93B00>]}
[0m18:00:13.410801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D78AB2270>]}
[0m18:00:13.412801 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:00:13.776182 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:00:14.136091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:00:14.136091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:00:14.255213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7923A300>]}
[0m18:00:14.472943 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m18:00:14.478947 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m18:00:14.523005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7A6E7230>]}
[0m18:00:14.524011 [info ] [MainThread]: Found 20 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 438 macros
[0m18:00:14.525008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7914CC80>]}
[0m18:00:14.529018 [info ] [MainThread]: 
[0m18:00:14.530016 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:00:14.531022 [info ] [MainThread]: 
[0m18:00:14.533022 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:00:14.543029 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m18:00:14.561034 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m18:00:14.695694 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m18:00:14.695694 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m18:00:14.697200 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m18:00:14.698210 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m18:00:14.699214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:14.699214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:16.891643 [debug] [ThreadPool]: SQL status: SELECT 19 in 2.192 seconds
[0m18:00:16.893636 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m18:00:17.777094 [debug] [ThreadPool]: SQL status: SELECT 19 in 3.078 seconds
[0m18:00:17.779146 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m18:00:17.782090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_finance'
[0m18:00:17.790143 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m18:00:17.790143 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_dbt'
[0m18:00:17.791134 [debug] [ThreadPool]: On list_dev_gom1_finance: BEGIN
[0m18:00:17.793648 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m18:00:17.793648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:17.794687 [debug] [ThreadPool]: On list_dev_gom1_dbt: BEGIN
[0m18:00:17.795642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:18.875096 [debug] [ThreadPool]: SQL status: BEGIN in 1.080 seconds
[0m18:00:18.876099 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m18:00:18.876099 [debug] [ThreadPool]: On list_dev_gom1_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_dbt"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m18:00:18.944970 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.069 seconds
[0m18:00:18.947017 [debug] [ThreadPool]: On list_dev_gom1_dbt: ROLLBACK
[0m18:00:19.011831 [debug] [ThreadPool]: On list_dev_gom1_dbt: Close
[0m18:00:19.808861 [debug] [ThreadPool]: SQL status: BEGIN in 2.015 seconds
[0m18:00:19.809815 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m18:00:19.809815 [debug] [ThreadPool]: On list_dev_gom1_finance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_finance"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m18:00:19.893416 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.083 seconds
[0m18:00:19.895463 [debug] [ThreadPool]: On list_dev_gom1_finance: ROLLBACK
[0m18:00:19.966021 [debug] [ThreadPool]: On list_dev_gom1_finance: Close
[0m18:00:19.972029 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:19.973028 [debug] [MainThread]: On master: BEGIN
[0m18:00:19.973028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:21.051917 [debug] [MainThread]: SQL status: BEGIN in 1.079 seconds
[0m18:00:21.052918 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:21.052918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:00:21.132101 [debug] [MainThread]: SQL status: SELECT 5 in 0.078 seconds
[0m18:00:21.134062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7AA54F50>]}
[0m18:00:21.134062 [debug] [MainThread]: On master: ROLLBACK
[0m18:00:21.203233 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:21.204233 [debug] [MainThread]: On master: BEGIN
[0m18:00:21.339102 [debug] [MainThread]: SQL status: BEGIN in 0.135 seconds
[0m18:00:21.340056 [debug] [MainThread]: On master: COMMIT
[0m18:00:21.341056 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:21.341056 [debug] [MainThread]: On master: COMMIT
[0m18:00:21.407984 [debug] [MainThread]: SQL status: COMMIT in 0.066 seconds
[0m18:00:21.408940 [debug] [MainThread]: On master: Close
[0m18:00:21.412942 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m18:00:21.413939 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_clean
[0m18:00:21.413939 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_prep
[0m18:00:21.414941 [debug] [Thread-4 (]: Began running node model.dbt_scooters.first_name_sex
[0m18:00:21.415939 [info ] [Thread-1 (]: 1 of 20 START sql table model dbt.companies .................................... [RUN]
[0m18:00:21.416942 [info ] [Thread-2 (]: 2 of 20 START sql incremental model dbt.events_clean ........................... [RUN]
[0m18:00:21.416942 [info ] [Thread-3 (]: 3 of 20 START sql view model dbt.events_prep ................................... [RUN]
[0m18:00:21.417981 [info ] [Thread-4 (]: 4 of 20 START sql table model dbt.first_name_sex ............................... [RUN]
[0m18:00:21.419941 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_scooters.companies'
[0m18:00:21.420943 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.events_clean'
[0m18:00:21.420943 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.events_prep'
[0m18:00:21.421983 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.first_name_sex'
[0m18:00:21.422941 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m18:00:21.422941 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_clean
[0m18:00:21.423941 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_prep
[0m18:00:21.423941 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.first_name_sex
[0m18:00:21.432985 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m18:00:21.445995 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m18:00:21.448993 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_prep"
[0m18:00:21.451997 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.first_name_sex"
[0m18:00:21.453961 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m18:00:21.472005 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_clean
[0m18:00:21.499080 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m18:00:21.499080 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_prep
[0m18:00:21.532126 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:00:21.533086 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.first_name_sex
[0m18:00:21.555089 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_prep"
[0m18:00:21.556092 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp180021526085"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at

from
    "dev_gom1"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_gom1"."dbt"."events_clean")
    

  );
  
  
[0m18:00:21.557127 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:00:21.561120 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.first_name_sex"
[0m18:00:21.562088 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:00:21.562088 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m18:00:21.563085 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:00:21.564120 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:00:21.565085 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: BEGIN
[0m18:00:21.566091 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m18:00:21.567085 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:00:21.567085 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: BEGIN
[0m18:00:21.568087 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:00:23.700474 [debug] [Thread-2 (]: SQL status: SELECT 0 in 2.138 seconds
[0m18:00:23.714988 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:00:23.714988 [debug] [Thread-1 (]: SQL status: BEGIN in 2.151 seconds
[0m18:00:23.715987 [debug] [Thread-3 (]: SQL status: BEGIN in 2.149 seconds
[0m18:00:23.715987 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: BEGIN
[0m18:00:23.716992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:00:23.716992 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:00:23.718042 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_gom1"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_gom1"."dbt"."scooters"
group by
    1
  );
  
[0m18:00:23.719030 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

  create view "dev_gom1"."dbt"."events_prep__dbt_tmp"
    
    
  as (
    select
    user_id,
    "timestamp",
    type_id,
    date("timestamp") as "date"
from
    "dev_gom1"."scooters_raw"."events"
  );
[0m18:00:23.739999 [debug] [Thread-4 (]: SQL status: BEGIN in 2.172 seconds
[0m18:00:23.741000 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m18:00:23.741000 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

  
    

  create  table "dev_gom1"."dbt"."first_name_sex__dbt_tmp"
  
  
    as
  
  (
    select distinct first_name, sex
from "dev_gom1"."scooters_raw"."users"
Where sex is not null
  );
  
[0m18:00:23.781044 [debug] [Thread-2 (]: SQL status: BEGIN in 0.063 seconds
[0m18:00:23.782000 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:00:23.782000 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp180021526085'
        
      order by ordinal_position

  
[0m18:00:23.786001 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.066 seconds
[0m18:00:23.793043 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:00:23.793043 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.074 seconds
[0m18:00:23.794002 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
alter table "dev_gom1"."dbt"."events_prep" rename to "events_prep__dbt_backup"
[0m18:00:23.796999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:00:23.798005 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_gom1"."dbt"."companies" rename to "companies__dbt_backup"
[0m18:00:23.816058 [debug] [Thread-4 (]: SQL status: SELECT 387 in 0.074 seconds
[0m18:00:23.820056 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m18:00:23.820056 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_gom1"."dbt"."first_name_sex" rename to "first_name_sex__dbt_backup"
[0m18:00:23.871057 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.073 seconds
[0m18:00:23.875053 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:00:23.875053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.077 seconds
[0m18:00:23.876012 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
alter table "dev_gom1"."dbt"."events_prep__dbt_tmp" rename to "events_prep"
[0m18:00:23.879012 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:00:23.880015 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_gom1"."dbt"."companies__dbt_tmp" rename to "companies"
[0m18:00:23.970875 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.188 seconds
[0m18:00:23.971827 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m18:00:23.977832 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:00:23.977832 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.097 seconds
[0m18:00:23.978833 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.158 seconds
[0m18:00:24.002465 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:00:24.003467 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:00:24.011040 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:00:24.014073 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m18:00:24.015076 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

    
  
  comment on view "dev_gom1"."dbt"."events_prep" is $dbt_comment_literal_block$User events prepared for following processing$dbt_comment_literal_block$;

  
[0m18:00:24.016038 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

    
  
  comment on table "dev_gom1"."dbt"."companies" is $dbt_comment_literal_block$Scooter statistics by company$dbt_comment_literal_block$;

  
[0m18:00:24.016038 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_gom1"."dbt"."first_name_sex__dbt_tmp" rename to "first_name_sex"
[0m18:00:24.082092 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.067 seconds
[0m18:00:24.091050 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.074 seconds
[0m18:00:24.092093 [debug] [Thread-3 (]: SQL status: COMMENT in 0.075 seconds
[0m18:00:24.092093 [debug] [Thread-1 (]: SQL status: COMMENT in 0.075 seconds
[0m18:00:24.100566 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:00:24.102607 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m18:00:24.111161 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:00:24.113124 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m18:00:24.114125 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp180021526085'
        
      order by ordinal_position

  
[0m18:00:24.114125 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

    
  
  comment on table "dev_gom1"."dbt"."first_name_sex" is $dbt_comment_literal_block$Unique name_sex glossary$dbt_comment_literal_block$;

  
[0m18:00:24.115163 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_prep'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:00:24.115163 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:00:24.117130 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m18:00:24.183175 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.067 seconds
[0m18:00:24.184131 [debug] [Thread-4 (]: SQL status: COMMENT in 0.068 seconds
[0m18:00:24.188134 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:00:24.188134 [debug] [Thread-1 (]: SQL status: COMMIT in 0.071 seconds
[0m18:00:24.190171 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m18:00:24.191130 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:00:24.198184 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."companies__dbt_backup"
[0m18:00:24.198184 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m18:00:24.204538 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:00:24.205540 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m18:00:24.205540 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_gom1"."dbt"."companies__dbt_backup" cascade
[0m18:00:24.273075 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.073 seconds
[0m18:00:24.283083 [debug] [Thread-2 (]: 
    In "dev_gom1"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:00:24.284084 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.167 seconds
[0m18:00:24.284084 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.077 seconds
[0m18:00:24.285084 [debug] [Thread-4 (]: SQL status: COMMIT in 0.078 seconds
[0m18:00:24.302606 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m18:00:24.305658 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:00:24.308172 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m18:00:24.311212 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."first_name_sex__dbt_backup"
[0m18:00:24.312172 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."events_prep".date is $dbt_comment_literal_block$Date of event derived from timestamp.
Imitates Hive-styled partitioning of events by date.
It is needed for efficient incremental processing by engines
with partitioning support (i.e. Trino).$dbt_comment_literal_block$;
  

  
[0m18:00:24.313172 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m18:00:24.314216 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:00:24.316172 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
drop table if exists "dev_gom1"."dbt"."first_name_sex__dbt_backup" cascade
[0m18:00:24.317220 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        
            delete from "dev_gom1"."dbt"."events_clean"
            using "events_clean__dbt_tmp180021526085"
            where (
                
                    "events_clean__dbt_tmp180021526085".user_id = "dev_gom1"."dbt"."events_clean".user_id
                    and 
                
                    "events_clean__dbt_tmp180021526085".timestamp = "dev_gom1"."dbt"."events_clean".timestamp
                    and 
                
                    "events_clean__dbt_tmp180021526085".type_id = "dev_gom1"."dbt"."events_clean".type_id
                    
                
                
            );
        
    

    insert into "dev_gom1"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp180021526085"
    )
  
[0m18:00:24.318179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7A940230>]}
[0m18:00:24.319181 [info ] [Thread-1 (]: 1 of 20 OK created sql table model dbt.companies ............................... [[32mSELECT 6[0m in 2.90s]
[0m18:00:24.320215 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m18:00:24.321218 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_concurrency
[0m18:00:24.322223 [info ] [Thread-1 (]: 5 of 20 START sql incremental model dbt.trips_concurrency ...................... [RUN]
[0m18:00:24.323179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.trips_concurrency)
[0m18:00:24.324223 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m18:00:24.329810 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m18:00:24.331775 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m18:00:24.335810 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:00:24.336813 [debug] [Thread-1 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp180024333808"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_gom1"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_gom1"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_gom1"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_gom1"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now()  as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m18:00:24.337774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:24.380815 [debug] [Thread-3 (]: SQL status: COMMENT in 0.065 seconds
[0m18:00:24.382809 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: COMMIT
[0m18:00:24.382809 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.065 seconds
[0m18:00:24.383814 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:00:24.385816 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:00:24.386814 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: COMMIT
[0m18:00:24.386814 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
  comment on table "dev_gom1"."dbt"."events_clean" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m18:00:24.387773 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.070 seconds
[0m18:00:24.389815 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: Close
[0m18:00:24.390813 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7A6FA9F0>]}
[0m18:00:24.391814 [info ] [Thread-4 (]: 4 of 20 OK created sql table model dbt.first_name_sex .......................... [[32mSELECT 387[0m in 2.97s]
[0m18:00:24.392772 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.first_name_sex
[0m18:00:24.393814 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_geom
[0m18:00:24.394814 [info ] [Thread-4 (]: 6 of 20 START sql view model dbt.trips_geom .................................... [RUN]
[0m18:00:24.395771 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.first_name_sex, now model.dbt_scooters.trips_geom)
[0m18:00:24.396775 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_geom
[0m18:00:24.401384 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m18:00:24.402361 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_geom
[0m18:00:24.406880 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m18:00:24.407925 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:00:24.408887 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m18:00:24.408887 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:24.454935 [debug] [Thread-3 (]: SQL status: COMMIT in 0.067 seconds
[0m18:00:24.457929 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."events_prep__dbt_backup"
[0m18:00:24.461932 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:00:24.461932 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
drop view if exists "dev_gom1"."dbt"."events_prep__dbt_backup" cascade
[0m18:00:24.463889 [debug] [Thread-2 (]: SQL status: COMMENT in 0.075 seconds
[0m18:00:24.464889 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m18:00:24.465888 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:00:24.465888 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m18:00:24.532124 [debug] [Thread-2 (]: SQL status: COMMIT in 0.065 seconds
[0m18:00:24.533075 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: Close
[0m18:00:24.534075 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.071 seconds
[0m18:00:24.536076 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: Close
[0m18:00:24.537074 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7AAE8A10>]}
[0m18:00:24.539078 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7AB5EAB0>]}
[0m18:00:24.538075 [info ] [Thread-2 (]: 2 of 20 OK created sql incremental model dbt.events_clean ...................... [[32mINSERT 0 0[0m in 3.12s]
[0m18:00:24.540077 [info ] [Thread-3 (]: 3 of 20 OK created sql view model dbt.events_prep .............................. [[32mCREATE VIEW[0m in 3.12s]
[0m18:00:24.541080 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_clean
[0m18:00:24.542074 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_prep
[0m18:00:24.543074 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_prep
[0m18:00:24.543074 [debug] [Thread-3 (]: Began running node model.dbt_scooters.users_full
[0m18:00:24.544076 [info ] [Thread-2 (]: 7 of 20 START sql view model dbt.trips_prep .................................... [RUN]
[0m18:00:24.545075 [info ] [Thread-3 (]: 8 of 20 START sql table model dbt.users_full ................................... [RUN]
[0m18:00:24.546076 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.trips_prep)
[0m18:00:24.547077 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_prep, now model.dbt_scooters.users_full)
[0m18:00:24.547077 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_prep
[0m18:00:24.548075 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.users_full
[0m18:00:24.552074 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m18:00:24.556076 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.users_full"
[0m18:00:24.558075 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_prep
[0m18:00:24.562079 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m18:00:24.562079 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.users_full
[0m18:00:24.566076 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.users_full"
[0m18:00:24.568075 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:00:24.569076 [debug] [Thread-2 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m18:00:24.569076 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:24.570077 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m18:00:24.571082 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: BEGIN
[0m18:00:24.572078 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:25.498059 [debug] [Thread-4 (]: SQL status: BEGIN in 1.089 seconds
[0m18:00:25.499046 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:00:25.499046 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_gom1"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_gom1"."scooters_raw"."trips"
  );
[0m18:00:25.566953 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.067 seconds
[0m18:00:25.570953 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:00:25.571917 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_gom1"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m18:00:25.635961 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.063 seconds
[0m18:00:25.638968 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:00:25.639966 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_gom1"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m18:00:25.655975 [debug] [Thread-2 (]: SQL status: BEGIN in 1.087 seconds
[0m18:00:25.656976 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:00:25.656976 [debug] [Thread-2 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_gom1"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select
    id,
    user_id,
    scooter_hw_id,
    started_at,
    finished_at,
    start_lat,
    start_lon,
    finish_lat,
    finish_lon,
    distance as distance_m,
    cast(price as decimal(20, 2)) / 100 as price_rub,
    extract(epoch from (finished_at - started_at)) as duration_s,
    finished_at <> started_at and price = 0 as is_free,
    
    date(started_at at time zone 'Europe/Moscow')
 as "date"
from
    "dev_gom1"."scooters_raw"."trips"
  );
[0m18:00:25.703516 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.063 seconds
[0m18:00:25.705520 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:00:25.705520 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

    
  
  comment on view "dev_gom1"."dbt"."trips_geom" is $dbt_comment_literal_block$Trips prepared for geometry analysis$dbt_comment_literal_block$;

  
[0m18:00:25.727044 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.069 seconds
[0m18:00:25.730046 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:00:25.731047 [debug] [Thread-2 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_gom1"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m18:00:25.770069 [debug] [Thread-4 (]: SQL status: COMMENT in 0.063 seconds
[0m18:00:25.771071 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m18:00:25.772068 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:00:25.773067 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m18:00:25.798091 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.066 seconds
[0m18:00:25.801610 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:00:25.801610 [debug] [Thread-2 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_gom1"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m18:00:25.837139 [debug] [Thread-4 (]: SQL status: COMMIT in 0.064 seconds
[0m18:00:25.842140 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."trips_geom__dbt_backup"
[0m18:00:25.843140 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:00:25.843140 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_gom1"."dbt"."trips_geom__dbt_backup" cascade
[0m18:00:25.870154 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.068 seconds
[0m18:00:25.872157 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:00:25.873156 [debug] [Thread-2 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

    
  
  comment on view "dev_gom1"."dbt"."trips_prep" is $dbt_comment_literal_block$Trips prepared for analysis$dbt_comment_literal_block$;

  
[0m18:00:25.912198 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.068 seconds
[0m18:00:25.914198 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: Close
[0m18:00:25.915202 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7AFC0AA0>]}
[0m18:00:25.915202 [info ] [Thread-4 (]: 6 of 20 OK created sql view model dbt.trips_geom ............................... [[32mCREATE VIEW[0m in 1.52s]
[0m18:00:25.917718 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_geom
[0m18:00:25.917718 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_full
[0m18:00:25.918720 [info ] [Thread-4 (]: 9 of 20 START sql view model dbt.events_full ................................... [RUN]
[0m18:00:25.920718 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.events_full)
[0m18:00:25.921718 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_full
[0m18:00:25.925717 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m18:00:25.926715 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_full
[0m18:00:25.930721 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m18:00:25.932725 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:00:25.932725 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: BEGIN
[0m18:00:25.933726 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:25.942731 [debug] [Thread-2 (]: SQL status: COMMENT in 0.069 seconds
[0m18:00:25.944734 [debug] [Thread-2 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m18:00:25.944734 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:00:25.945734 [debug] [Thread-2 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m18:00:26.012792 [debug] [Thread-2 (]: SQL status: COMMIT in 0.067 seconds
[0m18:00:26.016795 [debug] [Thread-2 (]: Applying DROP to: "dev_gom1"."dbt"."trips_prep__dbt_backup"
[0m18:00:26.018802 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:00:26.018802 [debug] [Thread-2 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_gom1"."dbt"."trips_prep__dbt_backup" cascade
[0m18:00:26.089845 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.070 seconds
[0m18:00:26.091848 [debug] [Thread-2 (]: On model.dbt_scooters.trips_prep: Close
[0m18:00:26.092844 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7A6EC470>]}
[0m18:00:26.093847 [info ] [Thread-2 (]: 7 of 20 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 1.55s]
[0m18:00:26.094851 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_prep
[0m18:00:26.095853 [debug] [Thread-2 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m18:00:26.096845 [info ] [Thread-2 (]: 10 of 20 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m18:00:26.097855 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.parking_finish_stat)
[0m18:00:26.098852 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m18:00:26.103370 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m18:00:26.104368 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m18:00:26.109897 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m18:00:26.111898 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:00:26.111898 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m18:00:26.112898 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:26.674834 [debug] [Thread-3 (]: SQL status: BEGIN in 2.103 seconds
[0m18:00:26.674834 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m18:00:26.675834 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

  
    

  create  table "dev_gom1"."dbt"."users_full__dbt_tmp"
  
  
    as
  
  (
    select
   u.id, u.first_name ,u.last_name ,u.phone ,
   COALESCE(u.sex, fns.sex, afns.sex) as sex2,
   u.birth_date
from "dev_gom1"."scooters_raw"."users" u
left join "dev_gom1"."dbt"."first_name_sex" fns on u.first_name = fns.first_name
left join "dev_gom1"."dbt"."add_first_name_sex" afns on u.first_name =afns.first_name
  );
  
[0m18:00:27.175749 [debug] [Thread-3 (]: SQL status: SELECT 2000 in 0.499 seconds
[0m18:00:27.178756 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m18:00:27.179756 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_gom1"."dbt"."users_full" rename to "users_full__dbt_backup"
[0m18:00:27.374931 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.195 seconds
[0m18:00:27.378945 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m18:00:27.378945 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_gom1"."dbt"."users_full__dbt_tmp" rename to "users_full"
[0m18:00:27.471019 [debug] [Thread-2 (]: SQL status: BEGIN in 1.358 seconds
[0m18:00:27.472023 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:00:27.473025 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_gom1"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_gom1"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m18:00:27.476023 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.097 seconds
[0m18:00:27.478026 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m18:00:27.479030 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

    
  
  comment on table "dev_gom1"."dbt"."users_full" is $dbt_comment_literal_block$Users enriched with sex$dbt_comment_literal_block$;

  
[0m18:00:27.576112 [debug] [Thread-3 (]: SQL status: COMMENT in 0.097 seconds
[0m18:00:27.578123 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: COMMIT
[0m18:00:27.579123 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m18:00:27.579123 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: COMMIT
[0m18:00:27.674755 [debug] [Thread-3 (]: SQL status: COMMIT in 0.095 seconds
[0m18:00:27.678773 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."users_full__dbt_backup"
[0m18:00:27.679773 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m18:00:27.680773 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
drop table if exists "dev_gom1"."dbt"."users_full__dbt_backup" cascade
[0m18:00:27.779872 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.099 seconds
[0m18:00:27.781874 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: Close
[0m18:00:27.782876 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7A6FBD40>]}
[0m18:00:27.783878 [info ] [Thread-3 (]: 8 of 20 OK created sql table model dbt.users_full .............................. [[32mSELECT 2000[0m in 3.24s]
[0m18:00:27.784874 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.users_full
[0m18:00:27.785879 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_start_stat
[0m18:00:27.786874 [info ] [Thread-3 (]: 11 of 20 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m18:00:27.787889 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.users_full, now model.dbt_scooters.parking_start_stat)
[0m18:00:27.787889 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m18:00:27.791880 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m18:00:27.793880 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m18:00:27.798889 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m18:00:27.799894 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:00:27.800895 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m18:00:27.801890 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:28.376928 [debug] [Thread-4 (]: SQL status: BEGIN in 2.443 seconds
[0m18:00:28.377936 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:00:28.378934 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_gom1"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select * from
"dev_gom1"."dbt"."events_clean" as e
left join "dev_gom1"."dbt"."event_types" as t
using (type_id)
  );
[0m18:00:28.483038 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.100 seconds
[0m18:00:28.490049 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:00:28.491050 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_gom1"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m18:00:28.597652 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.105 seconds
[0m18:00:28.661829 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:00:28.662829 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_gom1"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m18:00:28.794002 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.131 seconds
[0m18:00:28.797007 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:00:28.798008 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

    
  
  comment on view "dev_gom1"."dbt"."events_full" is $dbt_comment_literal_block$User events enriched with meaningful types$dbt_comment_literal_block$;

  
[0m18:00:28.876865 [debug] [Thread-4 (]: SQL status: COMMENT in 0.077 seconds
[0m18:00:28.878865 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m18:00:28.879836 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:00:28.879836 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m18:00:28.998087 [debug] [Thread-4 (]: SQL status: COMMIT in 0.117 seconds
[0m18:00:29.002085 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."events_full__dbt_backup"
[0m18:00:29.003599 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:00:29.003599 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_gom1"."dbt"."events_full__dbt_backup" cascade
[0m18:00:29.078839 [debug] [Thread-1 (]: SQL status: SELECT 0 in 4.741 seconds
[0m18:00:29.079841 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.075 seconds
[0m18:00:29.083839 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:00:29.085839 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: Close
[0m18:00:29.086808 [debug] [Thread-1 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m18:00:29.087807 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7AB870B0>]}
[0m18:00:29.088842 [info ] [Thread-4 (]: 9 of 20 OK created sql view model dbt.events_full .............................. [[32mCREATE VIEW[0m in 3.17s]
[0m18:00:29.089843 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_full
[0m18:00:29.090841 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies_trips
[0m18:00:29.091842 [info ] [Thread-4 (]: 12 of 20 START sql table model dbt.companies_trips ............................. [RUN]
[0m18:00:29.093808 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.companies_trips)
[0m18:00:29.094812 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies_trips
[0m18:00:29.099840 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m18:00:29.101813 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies_trips
[0m18:00:29.105336 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m18:00:29.107884 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:00:29.108885 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m18:00:29.109889 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:29.175930 [debug] [Thread-1 (]: SQL status: BEGIN in 0.088 seconds
[0m18:00:29.175930 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:00:29.176931 [debug] [Thread-1 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp180024333808'
        
      order by ordinal_position

  
[0m18:00:29.300066 [debug] [Thread-3 (]: SQL status: BEGIN in 1.498 seconds
[0m18:00:29.301055 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:00:29.301055 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_gom1"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_gom1"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m18:00:29.385159 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.208 seconds
[0m18:00:29.389678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:00:29.390673 [debug] [Thread-1 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:00:29.577868 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.187 seconds
[0m18:00:29.582864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:00:29.582864 [debug] [Thread-1 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp180024333808'
        
      order by ordinal_position

  
[0m18:00:29.711028 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.127 seconds
[0m18:00:29.715027 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:00:29.716028 [debug] [Thread-1 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:00:29.916692 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.200 seconds
[0m18:00:29.918701 [debug] [Thread-1 (]: 
    In "dev_gom1"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:00:29.927710 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m18:00:29.928710 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:00:29.929712 [debug] [Thread-1 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_gom1"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp180024333808"
    )


  
[0m18:00:30.075738 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.145 seconds
[0m18:00:30.077739 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:00:30.078742 [debug] [Thread-1 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_concurrency" is $dbt_comment_literal_block$Number of simultaneous rides in time$dbt_comment_literal_block$;

  
[0m18:00:30.190785 [debug] [Thread-1 (]: SQL status: COMMENT in 0.111 seconds
[0m18:00:30.193789 [debug] [Thread-1 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m18:00:30.193789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:00:30.194789 [debug] [Thread-1 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m18:00:30.275831 [debug] [Thread-1 (]: SQL status: COMMIT in 0.080 seconds
[0m18:00:30.277831 [debug] [Thread-1 (]: On model.dbt_scooters.trips_concurrency: Close
[0m18:00:30.278833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7AFF4860>]}
[0m18:00:30.279832 [info ] [Thread-1 (]: 5 of 20 OK created sql incremental model dbt.trips_concurrency ................. [[32mINSERT 0 0[0m in 5.96s]
[0m18:00:30.281835 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m18:00:30.282836 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m18:00:30.283829 [info ] [Thread-1 (]: 13 of 20 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m18:00:30.284830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.revenue_daily)
[0m18:00:30.285826 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m18:00:30.292829 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m18:00:30.295828 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m18:00:30.330866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:00:30.331867 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
select * from (
        select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_gom1"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
    ) as __dbt_sbq
    where false
    limit 0

[0m18:00:30.332867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:31.705178 [debug] [Thread-4 (]: SQL status: BEGIN in 2.596 seconds
[0m18:00:31.706770 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:00:31.707786 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_gom1"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_gom1"."dbt"."trips_prep" as t
        join "dev_gom1"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_gom1"."dbt"."companies" as c
        using (company)
  );
  
[0m18:00:31.970930 [debug] [Thread-1 (]: SQL status: SELECT 0 in 1.638 seconds
[0m18:00:31.992977 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:00:31.993981 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
select * from (
        select
    
      
    cast(null as decimal(20, 2))
 as revenue_rub, 
      
    cast(null as date)
 as date, 
      
    cast(null as timestamptz)
 as updated_at
    ) as __dbt_sbq
    where false
    limit 0

[0m18:00:32.176966 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.181 seconds
[0m18:00:32.185965 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:00:32.186932 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp180030298828"
  
  
    
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_gom1"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m18:00:33.971168 [debug] [Thread-4 (]: SQL status: SELECT 6 in 2.263 seconds
[0m18:00:33.980179 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:00:33.981184 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_gom1"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m18:00:34.073825 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m18:00:34.081825 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:00:34.083827 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_gom1"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m18:00:34.170930 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.086 seconds
[0m18:00:34.176933 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:00:34.178930 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  comment on table "dev_gom1"."dbt"."companies_trips" is $dbt_comment_literal_block$Trip statistics by company$dbt_comment_literal_block$;

  
[0m18:00:34.282077 [debug] [Thread-4 (]: SQL status: COMMENT in 0.102 seconds
[0m18:00:34.290085 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:00:34.292085 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'companies_trips'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:00:34.678653 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.385 seconds
[0m18:00:34.682656 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:00:34.683655 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."companies_trips".company is $dbt_comment_literal_block$Scooters manufacturing company$dbt_comment_literal_block$;
  

  
[0m18:00:34.770710 [debug] [Thread-4 (]: SQL status: COMMENT in 0.086 seconds
[0m18:00:34.772709 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m18:00:34.773707 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:00:34.774710 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m18:00:34.871760 [debug] [Thread-4 (]: SQL status: COMMIT in 0.096 seconds
[0m18:00:34.875759 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."companies_trips__dbt_backup"
[0m18:00:34.877756 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:00:34.877756 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_gom1"."dbt"."companies_trips__dbt_backup" cascade
[0m18:00:34.977801 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.099 seconds
[0m18:00:34.980806 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: Close
[0m18:00:34.981803 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7AB55EE0>]}
[0m18:00:34.983803 [info ] [Thread-4 (]: 12 of 20 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 5.89s]
[0m18:00:34.985807 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies_trips
[0m18:00:34.986806 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat
[0m18:00:34.987805 [info ] [Thread-4 (]: 14 of 20 START sql table model dbt.trips_stat .................................. [RUN]
[0m18:00:34.989801 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_stat)
[0m18:00:34.990800 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat
[0m18:00:34.994807 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m18:00:34.996805 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat
[0m18:00:35.001802 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m18:00:35.004804 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:00:35.005806 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m18:00:35.006803 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:35.771963 [debug] [Thread-1 (]: SQL status: SELECT 3 in 3.584 seconds
[0m18:00:35.776961 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:00:35.777967 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m18:00:35.876094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.097 seconds
[0m18:00:35.877104 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:00:35.877104 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp180030298828'
        
      order by ordinal_position

  
[0m18:00:36.572865 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.695 seconds
[0m18:00:36.577864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:00:36.577864 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m18:00:36.872707 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.294 seconds
[0m18:00:36.875711 [debug] [Thread-1 (]: 
    In "dev_gom1"."finance"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'revenue_rub', 'new_type': 'numeric'}]
  
[0m18:00:36.886723 [debug] [Thread-1 (]: 
    In "dev_gom1"."finance"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m18:00:36.888735 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m18:00:36.890734 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:00:36.891730 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        
            delete from "dev_gom1"."finance"."revenue_daily"
            using "revenue_daily__dbt_tmp180030298828"
            where (
                
                    "revenue_daily__dbt_tmp180030298828".date = "dev_gom1"."finance"."revenue_daily".date
                    
                
                
            );
        
    

    insert into "dev_gom1"."finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp180030298828"
    )
  
[0m18:00:37.073918 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.182 seconds
[0m18:00:37.083926 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:00:37.084926 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_gom1".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'finance'
        and table_name = 'revenue_daily'
  
[0m18:00:37.492663 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.406 seconds
[0m18:00:37.495664 [debug] [Thread-1 (]: On "dev_gom1"."finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m18:00:37.497675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:00:37.498674 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  comment on table "dev_gom1"."finance"."revenue_daily" is $dbt_comment_literal_block$Summary daily revenue$dbt_comment_literal_block$;

  
[0m18:00:37.673785 [debug] [Thread-1 (]: SQL status: COMMENT in 0.174 seconds
[0m18:00:37.681786 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:00:37.682790 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m18:00:37.870881 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.188 seconds
[0m18:00:37.873881 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:00:37.874879 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  
    
    
    comment on column "dev_gom1"."finance"."revenue_daily".revenue_rub is $dbt_comment_literal_block$Daily revenue in rubles$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."finance"."revenue_daily".date is $dbt_comment_literal_block$Unique day$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."finance"."revenue_daily".updated_at is $dbt_comment_literal_block$When row was updated last time$dbt_comment_literal_block$;
  

  
[0m18:00:37.971925 [debug] [Thread-1 (]: SQL status: COMMENT in 0.097 seconds
[0m18:00:37.974923 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m18:00:37.974923 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:00:37.975923 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m18:00:38.073965 [debug] [Thread-1 (]: SQL status: COMMIT in 0.097 seconds
[0m18:00:38.074965 [debug] [Thread-4 (]: SQL status: BEGIN in 3.068 seconds
[0m18:00:38.075964 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m18:00:38.076963 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:00:38.077966 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_gom1"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count(*) as trips,
    count(distinct user_id) as users,
    avg(duration_s) / 60 as avg_duration_min,
    sum(distance_m) / 1000 as sum_distance_km,
    sum(price_rub) as revenue_rub,
    count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from
    "dev_gom1"."dbt"."trips_prep"
  );
  
[0m18:00:38.078964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7A7670E0>]}
[0m18:00:38.079964 [info ] [Thread-1 (]: 13 of 20 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 3[0m in 7.79s]
[0m18:00:38.080964 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m18:00:38.081965 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m18:00:38.082963 [info ] [Thread-1 (]: 15 of 20 START sql table model dbt.trips_stat_daily ............................ [RUN]
[0m18:00:38.083963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_stat_daily)
[0m18:00:38.084966 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m18:00:38.088964 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m18:00:38.090964 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m18:00:38.095962 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m18:00:38.096965 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:00:38.097961 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m18:00:38.098965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:39.375973 [debug] [Thread-1 (]: SQL status: BEGIN in 1.277 seconds
[0m18:00:39.376982 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:00:39.376982 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_gom1"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    count(*) as trips,
    max(price_rub) as max_price_rub,
    avg(distance_m) / 1000 as avg_distance_km,
    avg(price_rub)/avg(duration_s) * 60 as avg_price_rub_per_min
from
    "dev_gom1"."dbt"."trips_prep"
group by
    1
order by
    1
  );
  
[0m18:00:47.685755 [debug] [Thread-4 (]: SQL status: SELECT 1 in 9.606 seconds
[0m18:00:47.689744 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:00:47.689744 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_gom1"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m18:00:47.782908 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m18:00:47.786901 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:00:47.786901 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_gom1"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m18:00:47.889737 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.102 seconds
[0m18:00:47.892769 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:00:47.893732 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_stat" is $dbt_comment_literal_block$Overall trips statistics$dbt_comment_literal_block$;

  
[0m18:00:47.985932 [debug] [Thread-4 (]: SQL status: COMMENT in 0.092 seconds
[0m18:00:47.987942 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m18:00:47.987942 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:00:47.988941 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m18:00:48.175912 [debug] [Thread-4 (]: SQL status: COMMIT in 0.186 seconds
[0m18:00:48.178917 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."trips_stat__dbt_backup"
[0m18:00:48.178917 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:00:48.179917 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_gom1"."dbt"."trips_stat__dbt_backup" cascade
[0m18:00:48.285775 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.105 seconds
[0m18:00:48.287732 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: Close
[0m18:00:48.288730 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7AFE0170>]}
[0m18:00:48.289730 [info ] [Thread-4 (]: 14 of 20 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 13.30s]
[0m18:00:48.290731 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat
[0m18:00:48.291768 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m18:00:48.292759 [info ] [Thread-4 (]: 16 of 20 START sql incremental model dbt.trips_users ........................... [RUN]
[0m18:00:48.293729 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_users)
[0m18:00:48.293729 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m18:00:48.298766 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m18:00:48.299768 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m18:00:48.304768 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:00:48.305732 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp180048302736"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep" as t
left join
    "dev_gom1"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_gom1"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m18:00:48.305732 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:50.375853 [debug] [Thread-1 (]: SQL status: SELECT 91 in 10.998 seconds
[0m18:00:50.378854 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:00:50.379853 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_gom1"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m18:00:50.486026 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.106 seconds
[0m18:00:50.489026 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:00:50.490026 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_gom1"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m18:00:50.595677 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.105 seconds
[0m18:00:50.606642 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:00:50.607649 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    create  index if not exists
  "7b0d11235b801e4e3665a9d63952bba5"
  on "dev_gom1"."dbt"."trips_stat_daily" 
  (date)
  
[0m18:00:50.777674 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.169 seconds
[0m18:00:50.779710 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:00:50.779710 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_stat_daily" is $dbt_comment_literal_block$Overall trips statistics per day$dbt_comment_literal_block$;

  
[0m18:00:50.872844 [debug] [Thread-1 (]: SQL status: COMMENT in 0.092 seconds
[0m18:00:50.877849 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:00:50.877849 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_stat_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:00:51.277007 [debug] [Thread-4 (]: SQL status: SELECT 0 in 2.971 seconds
[0m18:00:51.281004 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:00:51.281004 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m18:00:51.383078 [debug] [Thread-4 (]: SQL status: BEGIN in 0.101 seconds
[0m18:00:51.384073 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:00:51.384073 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp180048302736'
        
      order by ordinal_position

  
[0m18:00:51.477825 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.599 seconds
[0m18:00:51.479822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:00:51.480790 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."trips_stat_daily".date is $dbt_comment_literal_block$Trips date$dbt_comment_literal_block$;
  

  
[0m18:00:51.580001 [debug] [Thread-1 (]: SQL status: COMMENT in 0.099 seconds
[0m18:00:51.582001 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m18:00:51.583002 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:00:51.583002 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m18:00:51.676736 [debug] [Thread-1 (]: SQL status: COMMIT in 0.093 seconds
[0m18:00:51.679775 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."trips_stat_daily__dbt_backup"
[0m18:00:51.679775 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:00:51.680774 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_gom1"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m18:00:51.975049 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.294 seconds
[0m18:00:51.977057 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m18:00:51.978056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7A6E7920>]}
[0m18:00:51.979057 [info ] [Thread-1 (]: 15 of 20 OK created sql table model dbt.trips_stat_daily ....................... [[32mSELECT 91[0m in 13.89s]
[0m18:00:51.980057 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m18:00:51.981059 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_stat
[0m18:00:51.982095 [info ] [Thread-1 (]: 17 of 20 START sql table model dbt.events_stat ................................. [RUN]
[0m18:00:51.982095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.events_stat)
[0m18:00:51.983093 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_stat
[0m18:00:51.986056 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m18:00:51.987056 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_stat
[0m18:00:51.991092 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m18:00:51.993056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:00:51.994059 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: BEGIN
[0m18:00:51.994059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:52.275009 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.890 seconds
[0m18:00:52.279042 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:00:52.279042 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:00:52.574825 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.295 seconds
[0m18:00:52.578811 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:00:52.579778 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp180048302736'
        
      order by ordinal_position

  
[0m18:00:52.974998 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.395 seconds
[0m18:00:52.979034 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:00:52.979034 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:00:53.182975 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.203 seconds
[0m18:00:53.185977 [debug] [Thread-4 (]: 
    In "dev_gom1"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:00:53.187926 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m18:00:53.188928 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:00:53.189931 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_gom1"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp180048302736"
    )


  
[0m18:00:53.275716 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.086 seconds
[0m18:00:53.277714 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:00:53.278711 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_users" is $dbt_comment_literal_block$Prepared trips enriched with users data$dbt_comment_literal_block$;

  
[0m18:00:53.374907 [debug] [Thread-4 (]: SQL status: COMMENT in 0.096 seconds
[0m18:00:53.376899 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:00:53.377864 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m18:00:54.489755 [debug] [Thread-1 (]: SQL status: BEGIN in 2.496 seconds
[0m18:00:54.490750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:00:54.491709 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_gom1"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
       count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from "dev_gom1"."dbt"."events_full"
  );
  
[0m18:01:04.976683 [debug] [Thread-1 (]: SQL status: SELECT 1 in 10.485 seconds
[0m18:01:04.981689 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:01:04.982693 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_gom1"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m18:01:05.072788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m18:01:05.077796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:01:05.077796 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_gom1"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m18:01:05.170897 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m18:01:05.173895 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:01:05.174888 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."events_stat" is $dbt_comment_literal_block$Overall user events statistics$dbt_comment_literal_block$;

  
[0m18:01:05.271950 [debug] [Thread-1 (]: SQL status: COMMENT in 0.097 seconds
[0m18:01:05.274949 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: COMMIT
[0m18:01:05.275949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:01:05.276956 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: COMMIT
[0m18:01:05.373799 [debug] [Thread-1 (]: SQL status: COMMIT in 0.095 seconds
[0m18:01:05.376796 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."events_stat__dbt_backup"
[0m18:01:05.377794 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:01:05.378798 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_gom1"."dbt"."events_stat__dbt_backup" cascade
[0m18:01:05.476859 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.097 seconds
[0m18:01:05.479848 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: Close
[0m18:01:05.480820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7AAE0170>]}
[0m18:01:05.481815 [info ] [Thread-1 (]: 17 of 20 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 13.50s]
[0m18:01:05.483841 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_stat
[0m18:01:06.077004 [debug] [Thread-4 (]: SQL status: ANALYZE in 12.699 seconds
[0m18:01:06.079035 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m18:01:06.079035 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:01:06.080035 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m18:01:06.150999 [debug] [Thread-4 (]: SQL status: COMMIT in 0.070 seconds
[0m18:01:06.151998 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:01:06.153005 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m18:01:06.222755 [debug] [Thread-4 (]: SQL status: COMMIT in 0.069 seconds
[0m18:01:06.224751 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:01:06.225752 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m18:01:06.378832 [debug] [Thread-4 (]: SQL status: VACUUM in 0.152 seconds
[0m18:01:06.380832 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m18:01:06.381802 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7AB5F560>]}
[0m18:01:06.382835 [info ] [Thread-4 (]: 16 of 20 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 18.09s]
[0m18:01:06.384802 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m18:01:06.385801 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_daily
[0m18:01:06.386803 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_group
[0m18:01:06.387812 [info ] [Thread-1 (]: 18 of 20 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m18:01:06.388816 [info ] [Thread-4 (]: 19 of 20 START sql table model dbt.trips_age_group ............................. [RUN]
[0m18:01:06.389813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now model.dbt_scooters.trips_age_daily)
[0m18:01:06.390812 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_group)
[0m18:01:06.391811 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m18:01:06.392813 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m18:01:06.398844 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m18:01:06.402811 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m18:01:06.404813 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m18:01:06.405850 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_age_group
[0m18:01:06.410810 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m18:01:06.414849 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m18:01:06.416811 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:01:06.417812 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m18:01:06.418811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:06.418811 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:01:06.419849 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m18:01:06.420812 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:07.708703 [debug] [Thread-1 (]: SQL status: BEGIN in 1.290 seconds
[0m18:01:07.709696 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:01:07.710661 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_gom1"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    Select "date",
       age,
       count(*) as trips,
       sum(price_rub) as revenue_rub
from
    "dev_gom1"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m18:01:07.772907 [debug] [Thread-4 (]: SQL status: BEGIN in 1.351 seconds
[0m18:01:07.772907 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:01:07.773906 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_gom1"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_gom1"."dbt"."trips_users" as tu
    cross join "dev_gom1"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m18:01:08.280679 [debug] [Thread-3 (]: SQL status: SELECT 142 in 38.978 seconds
[0m18:01:08.283720 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:01:08.284718 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_gom1"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m18:01:08.374924 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.089 seconds
[0m18:01:08.377885 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:01:08.378885 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_gom1"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m18:01:08.473124 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m18:01:08.475120 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:01:08.475120 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."parking_start_stat" is $dbt_comment_literal_block$Trip start parking statistics by 500 m hexagons$dbt_comment_literal_block$;

  
[0m18:01:08.572914 [debug] [Thread-3 (]: SQL status: COMMENT in 0.097 seconds
[0m18:01:08.574909 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m18:01:08.575874 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:01:08.575874 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m18:01:08.674129 [debug] [Thread-3 (]: SQL status: COMMIT in 0.098 seconds
[0m18:01:08.676669 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."parking_start_stat__dbt_backup"
[0m18:01:08.677713 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:01:08.678706 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_gom1"."dbt"."parking_start_stat__dbt_backup" cascade
[0m18:01:08.873141 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.194 seconds
[0m18:01:08.874178 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: Close
[0m18:01:08.875176 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7B01BF50>]}
[0m18:01:08.876718 [info ] [Thread-3 (]: 11 of 20 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 41.09s]
[0m18:01:08.877729 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m18:01:09.677691 [debug] [Thread-1 (]: SQL status: SELECT 7049 in 1.967 seconds
[0m18:01:09.681687 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:01:09.681687 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_gom1"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m18:01:09.773886 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m18:01:09.777853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:01:09.777853 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_gom1"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m18:01:09.908697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.130 seconds
[0m18:01:09.910698 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:01:09.910698 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_age_daily" is $dbt_comment_literal_block$Daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m18:01:09.980921 [debug] [Thread-1 (]: SQL status: COMMENT in 0.069 seconds
[0m18:01:09.982916 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m18:01:09.982916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:01:09.983882 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m18:01:10.070963 [debug] [Thread-1 (]: SQL status: COMMIT in 0.087 seconds
[0m18:01:10.073961 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."trips_age_daily__dbt_backup"
[0m18:01:10.074964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:01:10.074964 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_gom1"."dbt"."trips_age_daily__dbt_backup" cascade
[0m18:01:10.175051 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.100 seconds
[0m18:01:10.178071 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: Close
[0m18:01:10.179064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7AFB3E30>]}
[0m18:01:10.180069 [info ] [Thread-1 (]: 18 of 20 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 3.79s]
[0m18:01:10.182070 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m18:01:10.183067 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m18:01:10.183067 [info ] [Thread-3 (]: 20 of 20 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m18:01:10.185075 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now model.dbt_scooters.trips_age_daily_stat)
[0m18:01:10.186587 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m18:01:10.191605 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m18:01:10.193607 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m18:01:10.202623 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m18:01:10.205621 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:01:10.206617 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m18:01:10.207623 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:11.574815 [debug] [Thread-3 (]: SQL status: BEGIN in 1.367 seconds
[0m18:01:11.574815 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:01:11.575816 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_gom1"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_gom1"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m18:01:11.883603 [debug] [Thread-3 (]: SQL status: SELECT 83 in 0.307 seconds
[0m18:01:11.887614 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:01:11.887614 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_gom1"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m18:01:12.072756 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.184 seconds
[0m18:01:12.076753 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:01:12.077761 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_gom1"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m18:01:12.172993 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m18:01:12.174996 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:01:12.175962 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_age_daily_stat" is $dbt_comment_literal_block$Aggregation of daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m18:01:12.275173 [debug] [Thread-3 (]: SQL status: COMMENT in 0.098 seconds
[0m18:01:12.276715 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m18:01:12.276715 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:01:12.277724 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m18:01:12.374964 [debug] [Thread-3 (]: SQL status: COMMIT in 0.097 seconds
[0m18:01:12.377958 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."trips_age_daily_stat__dbt_backup"
[0m18:01:12.378958 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:01:12.378958 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_gom1"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m18:01:12.480762 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.100 seconds
[0m18:01:12.482774 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m18:01:12.483773 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7AFA5550>]}
[0m18:01:12.483773 [info ] [Thread-3 (]: 20 of 20 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 2.30s]
[0m18:01:12.485735 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m18:01:23.884422 [debug] [Thread-2 (]: SQL status: SELECT 464 in 56.411 seconds
[0m18:01:23.888006 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:01:23.888006 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_gom1"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m18:01:23.994781 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.106 seconds
[0m18:01:23.997827 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:01:23.998788 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_gom1"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m18:01:24.075866 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.077 seconds
[0m18:01:24.077866 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:01:24.077866 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."parking_finish_stat" is $dbt_comment_literal_block$Trip finish parking statistics by 10 m hexagons$dbt_comment_literal_block$;

  
[0m18:01:24.175672 [debug] [Thread-2 (]: SQL status: COMMENT in 0.097 seconds
[0m18:01:24.177658 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m18:01:24.177658 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:01:24.178661 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m18:01:24.272853 [debug] [Thread-2 (]: SQL status: COMMIT in 0.094 seconds
[0m18:01:24.275817 [debug] [Thread-2 (]: Applying DROP to: "dev_gom1"."dbt"."parking_finish_stat__dbt_backup"
[0m18:01:24.276817 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:01:24.276817 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_gom1"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m18:01:24.372668 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.095 seconds
[0m18:01:24.374668 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m18:01:24.375666 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7AFC6870>]}
[0m18:01:24.375666 [info ] [Thread-2 (]: 10 of 20 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 58.28s]
[0m18:01:24.377633 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m18:01:25.780901 [debug] [Thread-4 (]: SQL status: SELECT 7 in 18.006 seconds
[0m18:01:25.784482 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:01:25.785473 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_gom1"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m18:01:25.864627 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.079 seconds
[0m18:01:25.867665 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:01:25.868664 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_gom1"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m18:01:25.942879 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.074 seconds
[0m18:01:25.944872 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:01:25.945868 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_age_group" is $dbt_comment_literal_block$Overall trips statistics by user age group$dbt_comment_literal_block$;

  
[0m18:01:26.015688 [debug] [Thread-4 (]: SQL status: COMMENT in 0.069 seconds
[0m18:01:26.016689 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m18:01:26.017686 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:01:26.017686 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m18:01:26.085295 [debug] [Thread-4 (]: SQL status: COMMIT in 0.067 seconds
[0m18:01:26.088891 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."trips_age_group__dbt_backup"
[0m18:01:26.089888 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:01:26.090854 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_gom1"."dbt"."trips_age_group__dbt_backup" cascade
[0m18:01:26.175854 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.085 seconds
[0m18:01:26.177889 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: Close
[0m18:01:26.178855 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc55151b-6354-4ab2-8372-dac76c2ccf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7B0047A0>]}
[0m18:01:26.179854 [info ] [Thread-4 (]: 19 of 20 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 19.79s]
[0m18:01:26.180853 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_group
[0m18:01:26.182854 [info ] [MainThread]: 
[0m18:01:26.183856 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:26.184401 [debug] [MainThread]: On master: BEGIN
[0m18:01:26.184401 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:27.357811 [debug] [MainThread]: SQL status: BEGIN in 1.173 seconds
[0m18:01:27.357811 [debug] [MainThread]: On master: COMMIT
[0m18:01:27.358775 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:27.358775 [debug] [MainThread]: On master: COMMIT
[0m18:01:27.434861 [debug] [MainThread]: SQL status: COMMIT in 0.075 seconds
[0m18:01:27.437824 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m18:01:27.442822 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m18:01:27.443823 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:27.444860 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m18:01:27.526609 [debug] [MainThread]: SQL status: GRANT in 0.081 seconds
[0m18:01:27.527574 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.09s]
[0m18:01:27.528574 [debug] [MainThread]: On master: Close
[0m18:01:27.529576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:27.530612 [debug] [MainThread]: Connection 'list_dev_gom1' was properly closed.
[0m18:01:27.531572 [debug] [MainThread]: Connection 'list_dev_gom1' was properly closed.
[0m18:01:27.531572 [debug] [MainThread]: Connection 'list_dev_gom1_finance' was properly closed.
[0m18:01:27.531572 [debug] [MainThread]: Connection 'list_dev_gom1_dbt' was properly closed.
[0m18:01:27.532575 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily' was properly closed.
[0m18:01:27.532575 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_finish_stat' was properly closed.
[0m18:01:27.533571 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m18:01:27.533571 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m18:01:27.534572 [info ] [MainThread]: 
[0m18:01:27.535574 [info ] [MainThread]: Finished running 4 incremental models, 1 project hook, 12 table models, 4 view models in 0 hours 1 minutes and 13.00 seconds (73.00s).
[0m18:01:27.541573 [debug] [MainThread]: Command end result
[0m18:01:27.581619 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m18:01:27.584617 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m18:01:27.594569 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\run_results.json
[0m18:01:27.595540 [info ] [MainThread]: 
[0m18:01:27.596539 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:27.597537 [info ] [MainThread]: 
[0m18:01:27.598541 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 TOTAL=21
[0m18:01:27.599543 [debug] [MainThread]: Command `dbt run` succeeded at 18:01:27.599543 after 74.99 seconds
[0m18:01:27.600540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7587EAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D78F644D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D78E23EF0>]}
[0m18:01:27.601538 [debug] [MainThread]: Flushing usage events
[0m18:01:28.479866 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:01:36.950600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCFFE1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCE80A7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCFFE24B0>]}


============================== 18:01:36.957611 | 9405ba88-8964-4c23-8410-4a764cd27f1f ==============================
[0m18:01:36.957611 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:01:36.959651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:01:37.299948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD0B83800>]}
[0m18:01:37.403120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD096E270>]}
[0m18:01:37.405124 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:01:37.800607 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:01:38.188577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:38.189573 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:38.314799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCDD17230>]}
[0m18:01:38.533936 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m18:01:38.541950 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m18:01:38.584992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD22B6870>]}
[0m18:01:38.584992 [info ] [MainThread]: Found 20 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 438 macros
[0m18:01:38.586505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD0B61520>]}
[0m18:01:38.591515 [info ] [MainThread]: 
[0m18:01:38.592520 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:01:38.593518 [info ] [MainThread]: 
[0m18:01:38.594516 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:01:38.602524 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m18:01:38.613576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m18:01:38.754801 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m18:01:38.755799 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m18:01:38.756810 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m18:01:38.757809 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m18:01:38.757809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:38.758808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:39.905161 [debug] [ThreadPool]: SQL status: SELECT 19 in 1.147 seconds
[0m18:01:39.905161 [debug] [ThreadPool]: SQL status: SELECT 19 in 1.148 seconds
[0m18:01:39.907743 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m18:01:39.909712 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m18:01:39.913743 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_finance'
[0m18:01:39.919719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_dbt'
[0m18:01:39.923756 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m18:01:39.925718 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m18:01:39.926719 [debug] [ThreadPool]: On list_dev_gom1_finance: BEGIN
[0m18:01:39.926719 [debug] [ThreadPool]: On list_dev_gom1_dbt: BEGIN
[0m18:01:39.927750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:39.927750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:41.230546 [debug] [ThreadPool]: SQL status: BEGIN in 1.303 seconds
[0m18:01:41.231544 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m18:01:41.232546 [debug] [ThreadPool]: On list_dev_gom1_finance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_finance"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m18:01:41.325764 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.093 seconds
[0m18:01:41.326758 [debug] [ThreadPool]: On list_dev_gom1_finance: ROLLBACK
[0m18:01:41.396811 [debug] [ThreadPool]: On list_dev_gom1_finance: Close
[0m18:01:41.946927 [debug] [ThreadPool]: SQL status: BEGIN in 2.019 seconds
[0m18:01:41.947892 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m18:01:41.947892 [debug] [ThreadPool]: On list_dev_gom1_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_dbt"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m18:01:42.021519 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.073 seconds
[0m18:01:42.023522 [debug] [ThreadPool]: On list_dev_gom1_dbt: ROLLBACK
[0m18:01:42.092519 [debug] [ThreadPool]: On list_dev_gom1_dbt: Close
[0m18:01:42.102483 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:42.102483 [debug] [MainThread]: On master: BEGIN
[0m18:01:42.103485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:43.179676 [debug] [MainThread]: SQL status: BEGIN in 1.076 seconds
[0m18:01:43.179676 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:43.180676 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:01:43.254740 [debug] [MainThread]: SQL status: SELECT 5 in 0.074 seconds
[0m18:01:43.257740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD2238EC0>]}
[0m18:01:43.258741 [debug] [MainThread]: On master: ROLLBACK
[0m18:01:43.323778 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:43.323778 [debug] [MainThread]: On master: BEGIN
[0m18:01:43.453551 [debug] [MainThread]: SQL status: BEGIN in 0.129 seconds
[0m18:01:43.454503 [debug] [MainThread]: On master: COMMIT
[0m18:01:43.455504 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:43.455504 [debug] [MainThread]: On master: COMMIT
[0m18:01:43.520761 [debug] [MainThread]: SQL status: COMMIT in 0.065 seconds
[0m18:01:43.521708 [debug] [MainThread]: On master: Close
[0m18:01:43.526709 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m18:01:43.526709 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_clean
[0m18:01:43.527707 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_prep
[0m18:01:43.528739 [debug] [Thread-4 (]: Began running node model.dbt_scooters.first_name_sex
[0m18:01:43.528739 [info ] [Thread-1 (]: 1 of 20 START sql table model dbt.companies .................................... [RUN]
[0m18:01:43.529710 [info ] [Thread-2 (]: 2 of 20 START sql incremental model dbt.events_clean ........................... [RUN]
[0m18:01:43.530707 [info ] [Thread-3 (]: 3 of 20 START sql view model dbt.events_prep ................................... [RUN]
[0m18:01:43.531710 [info ] [Thread-4 (]: 4 of 20 START sql table model dbt.first_name_sex ............................... [RUN]
[0m18:01:43.532708 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_scooters.companies'
[0m18:01:43.533706 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.events_clean'
[0m18:01:43.534709 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.events_prep'
[0m18:01:43.534709 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.first_name_sex'
[0m18:01:43.535762 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m18:01:43.536711 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_clean
[0m18:01:43.537708 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_prep
[0m18:01:43.537708 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.first_name_sex
[0m18:01:43.546738 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m18:01:43.561744 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m18:01:43.564739 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_prep"
[0m18:01:43.567750 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.first_name_sex"
[0m18:01:43.570712 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m18:01:43.571716 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_clean
[0m18:01:43.586749 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_prep
[0m18:01:43.617935 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.first_name_sex
[0m18:01:43.627930 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m18:01:43.666917 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:01:43.689527 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_prep"
[0m18:01:43.693495 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.first_name_sex"
[0m18:01:43.695495 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp180143657911"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at

from
    "dev_gom1"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_gom1"."dbt"."events_clean")
    

  );
  
  
[0m18:01:43.696497 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:01:43.697495 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:01:43.698495 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m18:01:43.698495 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:01:43.699496 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m18:01:43.700494 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:01:43.701496 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: BEGIN
[0m18:01:43.702496 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: BEGIN
[0m18:01:43.703497 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:01:43.703497 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:01:44.930784 [debug] [Thread-3 (]: SQL status: BEGIN in 1.227 seconds
[0m18:01:44.931790 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:01:44.932788 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

  create view "dev_gom1"."dbt"."events_prep__dbt_tmp"
    
    
  as (
    select
    user_id,
    "timestamp",
    type_id,
    date("timestamp") as "date"
from
    "dev_gom1"."scooters_raw"."events"
  );
[0m18:01:44.999827 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.066 seconds
[0m18:01:45.013346 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:01:45.014350 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
alter table "dev_gom1"."dbt"."events_prep" rename to "events_prep__dbt_backup"
[0m18:01:45.079912 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.065 seconds
[0m18:01:45.085917 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:01:45.086913 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
alter table "dev_gom1"."dbt"."events_prep__dbt_tmp" rename to "events_prep"
[0m18:01:45.153549 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.065 seconds
[0m18:01:45.195582 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:01:45.196579 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

    
  
  comment on view "dev_gom1"."dbt"."events_prep" is $dbt_comment_literal_block$User events prepared for following processing$dbt_comment_literal_block$;

  
[0m18:01:45.262711 [debug] [Thread-3 (]: SQL status: COMMENT in 0.065 seconds
[0m18:01:45.307784 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:01:45.308791 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_prep'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:01:45.394923 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.085 seconds
[0m18:01:45.404940 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:01:45.406462 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."events_prep".date is $dbt_comment_literal_block$Date of event derived from timestamp.
Imitates Hive-styled partitioning of events by date.
It is needed for efficient incremental processing by engines
with partitioning support (i.e. Trino).$dbt_comment_literal_block$;
  

  
[0m18:01:45.474597 [debug] [Thread-3 (]: SQL status: COMMENT in 0.066 seconds
[0m18:01:45.477609 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: COMMIT
[0m18:01:45.478608 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:01:45.478608 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: COMMIT
[0m18:01:45.545717 [debug] [Thread-3 (]: SQL status: COMMIT in 0.065 seconds
[0m18:01:45.557734 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."events_prep__dbt_backup"
[0m18:01:45.572752 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_prep"
[0m18:01:45.573753 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_prep"} */
drop view if exists "dev_gom1"."dbt"."events_prep__dbt_backup" cascade
[0m18:01:45.644878 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.069 seconds
[0m18:01:45.648889 [debug] [Thread-3 (]: On model.dbt_scooters.events_prep: Close
[0m18:01:45.653903 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCFFA16D0>]}
[0m18:01:45.655893 [info ] [Thread-3 (]: 3 of 20 OK created sql view model dbt.events_prep .............................. [[32mCREATE VIEW[0m in 2.12s]
[0m18:01:45.658909 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_prep
[0m18:01:45.659907 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m18:01:45.660909 [info ] [Thread-3 (]: 5 of 20 START sql incremental model dbt.trips_concurrency ...................... [RUN]
[0m18:01:45.662909 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_prep, now model.dbt_scooters.trips_concurrency)
[0m18:01:45.663904 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m18:01:45.672928 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m18:01:45.674924 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m18:01:45.686461 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:01:45.688474 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp180145680449"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_gom1"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_gom1"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_gom1"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_gom1"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now()  as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m18:01:45.689477 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:45.838694 [debug] [Thread-4 (]: SQL status: BEGIN in 2.135 seconds
[0m18:01:45.840691 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m18:01:45.840691 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

  
    

  create  table "dev_gom1"."dbt"."first_name_sex__dbt_tmp"
  
  
    as
  
  (
    select distinct first_name, sex
from "dev_gom1"."scooters_raw"."users"
Where sex is not null
  );
  
[0m18:01:45.870704 [debug] [Thread-1 (]: SQL status: BEGIN in 2.170 seconds
[0m18:01:45.872709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:01:45.873745 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_gom1"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_gom1"."dbt"."scooters"
group by
    1
  );
  
[0m18:01:45.976548 [debug] [Thread-4 (]: SQL status: SELECT 387 in 0.135 seconds
[0m18:01:45.981554 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m18:01:45.982560 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_gom1"."dbt"."first_name_sex" rename to "first_name_sex__dbt_backup"
[0m18:01:46.050687 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.067 seconds
[0m18:01:46.055688 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m18:01:46.056683 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_gom1"."dbt"."first_name_sex__dbt_tmp" rename to "first_name_sex"
[0m18:01:46.069713 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.195 seconds
[0m18:01:46.075708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:01:46.076707 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_gom1"."dbt"."companies" rename to "companies__dbt_backup"
[0m18:01:46.122777 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.065 seconds
[0m18:01:46.130776 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m18:01:46.131777 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

    
  
  comment on table "dev_gom1"."dbt"."first_name_sex" is $dbt_comment_literal_block$Unique name_sex glossary$dbt_comment_literal_block$;

  
[0m18:01:46.170798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m18:01:46.175796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:01:46.176804 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_gom1"."dbt"."companies__dbt_tmp" rename to "companies"
[0m18:01:46.270576 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m18:01:46.271541 [debug] [Thread-4 (]: SQL status: COMMENT in 0.138 seconds
[0m18:01:46.274577 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:01:46.276539 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m18:01:46.277550 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

    
  
  comment on table "dev_gom1"."dbt"."companies" is $dbt_comment_literal_block$Scooter statistics by company$dbt_comment_literal_block$;

  
[0m18:01:46.278548 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m18:01:46.279547 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m18:01:46.369732 [debug] [Thread-1 (]: SQL status: COMMENT in 0.090 seconds
[0m18:01:46.371763 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m18:01:46.372763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:01:46.373764 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m18:01:46.374727 [debug] [Thread-4 (]: SQL status: COMMIT in 0.094 seconds
[0m18:01:46.378768 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."first_name_sex__dbt_backup"
[0m18:01:46.383762 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m18:01:46.383762 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
drop table if exists "dev_gom1"."dbt"."first_name_sex__dbt_backup" cascade
[0m18:01:46.477563 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.092 seconds
[0m18:01:46.477563 [debug] [Thread-1 (]: SQL status: COMMIT in 0.102 seconds
[0m18:01:46.479567 [debug] [Thread-4 (]: On model.dbt_scooters.first_name_sex: Close
[0m18:01:46.483566 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."companies__dbt_backup"
[0m18:01:46.485567 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:01:46.486529 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD22C56D0>]}
[0m18:01:46.487527 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_gom1"."dbt"."companies__dbt_backup" cascade
[0m18:01:46.488527 [info ] [Thread-4 (]: 4 of 20 OK created sql table model dbt.first_name_sex .......................... [[32mSELECT 387[0m in 2.95s]
[0m18:01:46.490562 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.first_name_sex
[0m18:01:46.490562 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_geom
[0m18:01:46.492562 [info ] [Thread-4 (]: 6 of 20 START sql view model dbt.trips_geom .................................... [RUN]
[0m18:01:46.493531 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.first_name_sex, now model.dbt_scooters.trips_geom)
[0m18:01:46.493531 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_geom
[0m18:01:46.497562 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m18:01:46.500536 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_geom
[0m18:01:46.507563 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m18:01:46.509535 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:01:46.509535 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m18:01:46.510562 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:46.571847 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.083 seconds
[0m18:01:46.574813 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m18:01:46.575813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD26BAAE0>]}
[0m18:01:46.576823 [info ] [Thread-1 (]: 1 of 20 OK created sql table model dbt.companies ............................... [[32mSELECT 6[0m in 3.04s]
[0m18:01:46.578828 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m18:01:46.579843 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m18:01:46.580824 [info ] [Thread-1 (]: 7 of 20 START sql view model dbt.trips_prep .................................... [RUN]
[0m18:01:46.581820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.trips_prep)
[0m18:01:46.582848 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m18:01:46.587820 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m18:01:46.589862 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m18:01:46.595847 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m18:01:46.597856 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:01:46.598824 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m18:01:46.598824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:47.271698 [debug] [Thread-2 (]: SQL status: SELECT 0 in 3.574 seconds
[0m18:01:47.277648 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:01:47.277648 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: BEGIN
[0m18:01:47.343894 [debug] [Thread-2 (]: SQL status: BEGIN in 0.065 seconds
[0m18:01:47.344851 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:01:47.345852 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp180143657911'
        
      order by ordinal_position

  
[0m18:01:47.422469 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.076 seconds
[0m18:01:47.425469 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:01:47.426975 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:01:47.510591 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.084 seconds
[0m18:01:47.528549 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:01:47.529549 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp180143657911'
        
      order by ordinal_position

  
[0m18:01:47.601584 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.072 seconds
[0m18:01:47.605545 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:01:47.606543 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:01:47.675793 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.068 seconds
[0m18:01:47.686756 [debug] [Thread-2 (]: 
    In "dev_gom1"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:01:47.707780 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m18:01:47.709779 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:01:47.709779 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        
            delete from "dev_gom1"."dbt"."events_clean"
            using "events_clean__dbt_tmp180143657911"
            where (
                
                    "events_clean__dbt_tmp180143657911".user_id = "dev_gom1"."dbt"."events_clean".user_id
                    and 
                
                    "events_clean__dbt_tmp180143657911".timestamp = "dev_gom1"."dbt"."events_clean".timestamp
                    and 
                
                    "events_clean__dbt_tmp180143657911".type_id = "dev_gom1"."dbt"."events_clean".type_id
                    
                
                
            );
        
    

    insert into "dev_gom1"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp180143657911"
    )
  
[0m18:01:47.776585 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.066 seconds
[0m18:01:47.778583 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:01:47.779583 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
  comment on table "dev_gom1"."dbt"."events_clean" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m18:01:47.844787 [debug] [Thread-2 (]: SQL status: COMMENT in 0.065 seconds
[0m18:01:47.846757 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m18:01:47.847759 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:01:47.847759 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m18:01:47.914793 [debug] [Thread-2 (]: SQL status: COMMIT in 0.066 seconds
[0m18:01:47.915760 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: Close
[0m18:01:47.916759 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD26EE6F0>]}
[0m18:01:47.918267 [info ] [Thread-2 (]: 2 of 20 OK created sql incremental model dbt.events_clean ...................... [[32mINSERT 0 0[0m in 4.38s]
[0m18:01:47.919277 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_clean
[0m18:01:47.920285 [debug] [Thread-2 (]: Began running node model.dbt_scooters.users_full
[0m18:01:47.921275 [info ] [Thread-2 (]: 8 of 20 START sql table model dbt.users_full ................................... [RUN]
[0m18:01:47.922276 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.users_full)
[0m18:01:47.923277 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.users_full
[0m18:01:47.926858 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.users_full"
[0m18:01:47.927874 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.users_full
[0m18:01:47.932871 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.users_full"
[0m18:01:47.933873 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m18:01:47.934872 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: BEGIN
[0m18:01:47.934872 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:48.502803 [debug] [Thread-4 (]: SQL status: BEGIN in 1.992 seconds
[0m18:01:48.503809 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:01:48.503809 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_gom1"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_gom1"."scooters_raw"."trips"
  );
[0m18:01:48.603680 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.099 seconds
[0m18:01:48.607663 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:01:48.608629 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_gom1"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m18:01:48.677864 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.069 seconds
[0m18:01:48.680862 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:01:48.681860 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_gom1"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m18:01:48.750598 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.068 seconds
[0m18:01:48.752562 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:01:48.753563 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

    
  
  comment on view "dev_gom1"."dbt"."trips_geom" is $dbt_comment_literal_block$Trips prepared for geometry analysis$dbt_comment_literal_block$;

  
[0m18:01:48.822162 [debug] [Thread-4 (]: SQL status: COMMENT in 0.068 seconds
[0m18:01:48.824165 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m18:01:48.825163 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:01:48.825163 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m18:01:48.894690 [debug] [Thread-4 (]: SQL status: COMMIT in 0.069 seconds
[0m18:01:48.897722 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."trips_geom__dbt_backup"
[0m18:01:48.898688 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:01:48.898688 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_gom1"."dbt"."trips_geom__dbt_backup" cascade
[0m18:01:48.974524 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.074 seconds
[0m18:01:48.976524 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: Close
[0m18:01:48.977522 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD273C4D0>]}
[0m18:01:48.978524 [info ] [Thread-4 (]: 6 of 20 OK created sql view model dbt.trips_geom ............................... [[32mCREATE VIEW[0m in 2.48s]
[0m18:01:48.979492 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_geom
[0m18:01:48.979492 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_full
[0m18:01:48.980525 [info ] [Thread-4 (]: 9 of 20 START sql view model dbt.events_full ................................... [RUN]
[0m18:01:48.981524 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.events_full)
[0m18:01:48.982525 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_full
[0m18:01:48.985524 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m18:01:48.987488 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_full
[0m18:01:48.992524 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m18:01:48.994493 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:01:48.994493 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: BEGIN
[0m18:01:48.995506 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:49.031736 [debug] [Thread-2 (]: SQL status: BEGIN in 1.097 seconds
[0m18:01:49.032695 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m18:01:49.033695 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

  
    

  create  table "dev_gom1"."dbt"."users_full__dbt_tmp"
  
  
    as
  
  (
    select
   u.id, u.first_name ,u.last_name ,u.phone ,
   COALESCE(u.sex, fns.sex, afns.sex) as sex2,
   u.birth_date
from "dev_gom1"."scooters_raw"."users" u
left join "dev_gom1"."dbt"."first_name_sex" fns on u.first_name = fns.first_name
left join "dev_gom1"."dbt"."add_first_name_sex" afns on u.first_name =afns.first_name
  );
  
[0m18:01:49.119734 [debug] [Thread-2 (]: SQL status: SELECT 2000 in 0.085 seconds
[0m18:01:49.123251 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m18:01:49.124252 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_gom1"."dbt"."users_full" rename to "users_full__dbt_backup"
[0m18:01:49.195814 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.071 seconds
[0m18:01:49.199819 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m18:01:49.199819 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_gom1"."dbt"."users_full__dbt_tmp" rename to "users_full"
[0m18:01:49.271899 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.071 seconds
[0m18:01:49.273900 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m18:01:49.274896 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

    
  
  comment on table "dev_gom1"."dbt"."users_full" is $dbt_comment_literal_block$Users enriched with sex$dbt_comment_literal_block$;

  
[0m18:01:49.373502 [debug] [Thread-2 (]: SQL status: COMMENT in 0.098 seconds
[0m18:01:49.375502 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: COMMIT
[0m18:01:49.376502 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m18:01:49.376502 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: COMMIT
[0m18:01:49.474584 [debug] [Thread-2 (]: SQL status: COMMIT in 0.098 seconds
[0m18:01:49.477592 [debug] [Thread-2 (]: Applying DROP to: "dev_gom1"."dbt"."users_full__dbt_backup"
[0m18:01:49.478591 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m18:01:49.478591 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
drop table if exists "dev_gom1"."dbt"."users_full__dbt_backup" cascade
[0m18:01:49.578687 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.099 seconds
[0m18:01:49.580684 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: Close
[0m18:01:49.581683 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD233EF00>]}
[0m18:01:49.582684 [info ] [Thread-2 (]: 8 of 20 OK created sql table model dbt.users_full .............................. [[32mSELECT 2000[0m in 1.66s]
[0m18:01:49.583682 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.users_full
[0m18:01:49.584683 [debug] [Thread-2 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m18:01:49.585681 [info ] [Thread-2 (]: 10 of 20 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m18:01:49.586684 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.users_full, now model.dbt_scooters.parking_finish_stat)
[0m18:01:49.587700 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m18:01:49.593697 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m18:01:49.595697 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m18:01:49.600710 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m18:01:49.602709 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:01:49.603706 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m18:01:49.603706 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:49.771685 [debug] [Thread-1 (]: SQL status: BEGIN in 3.173 seconds
[0m18:01:49.772649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:01:49.772649 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_gom1"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select
    id,
    user_id,
    scooter_hw_id,
    started_at,
    finished_at,
    start_lat,
    start_lon,
    finish_lat,
    finish_lon,
    distance as distance_m,
    cast(price as decimal(20, 2)) / 100 as price_rub,
    extract(epoch from (finished_at - started_at)) as duration_s,
    finished_at <> started_at and price = 0 as is_free,
    
    date(started_at at time zone 'Europe/Moscow')
 as "date"
from
    "dev_gom1"."scooters_raw"."trips"
  );
[0m18:01:49.877833 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.104 seconds
[0m18:01:49.880868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:01:49.881866 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_gom1"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m18:01:49.969777 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.087 seconds
[0m18:01:49.973815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:01:49.974818 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_gom1"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m18:01:50.072573 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.097 seconds
[0m18:01:50.074566 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:01:50.075530 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

    
  
  comment on view "dev_gom1"."dbt"."trips_prep" is $dbt_comment_literal_block$Trips prepared for analysis$dbt_comment_literal_block$;

  
[0m18:01:50.171799 [debug] [Thread-1 (]: SQL status: COMMENT in 0.097 seconds
[0m18:01:50.173804 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m18:01:50.174801 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:01:50.174801 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m18:01:50.270613 [debug] [Thread-1 (]: SQL status: COMMIT in 0.095 seconds
[0m18:01:50.274609 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."trips_prep__dbt_backup"
[0m18:01:50.274609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:01:50.275606 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_gom1"."dbt"."trips_prep__dbt_backup" cascade
[0m18:01:50.372767 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.096 seconds
[0m18:01:50.374807 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m18:01:50.375795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD2D4C260>]}
[0m18:01:50.375795 [info ] [Thread-1 (]: 7 of 20 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 3.79s]
[0m18:01:50.377771 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m18:01:50.377771 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_start_stat
[0m18:01:50.378805 [info ] [Thread-1 (]: 11 of 20 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m18:01:50.379768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.parking_start_stat)
[0m18:01:50.380804 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m18:01:50.383807 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m18:01:50.384806 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m18:01:50.390807 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m18:01:50.391805 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:01:50.392775 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m18:01:50.392775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:50.875645 [debug] [Thread-3 (]: SQL status: SELECT 0 in 5.186 seconds
[0m18:01:50.878647 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:01:50.879652 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m18:01:50.968732 [debug] [Thread-3 (]: SQL status: BEGIN in 0.089 seconds
[0m18:01:50.969739 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:01:50.969739 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp180145680449'
        
      order by ordinal_position

  
[0m18:01:51.043801 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.073 seconds
[0m18:01:51.096840 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:01:51.096840 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:01:51.099843 [debug] [Thread-4 (]: SQL status: BEGIN in 2.105 seconds
[0m18:01:51.100842 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:01:51.100842 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_gom1"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select * from
"dev_gom1"."dbt"."events_clean" as e
left join "dev_gom1"."dbt"."event_types" as t
using (type_id)
  );
[0m18:01:51.168926 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.067 seconds
[0m18:01:51.169930 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.072 seconds
[0m18:01:51.173926 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:01:51.176930 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:01:51.177933 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_gom1"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m18:01:51.177933 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp180145680449'
        
      order by ordinal_position

  
[0m18:01:51.245501 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.066 seconds
[0m18:01:51.248501 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:01:51.249507 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_gom1"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m18:01:51.251501 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.072 seconds
[0m18:01:51.254502 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:01:51.255506 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:01:51.317586 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.067 seconds
[0m18:01:51.319586 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:01:51.320593 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

    
  
  comment on view "dev_gom1"."dbt"."events_full" is $dbt_comment_literal_block$User events enriched with meaningful types$dbt_comment_literal_block$;

  
[0m18:01:51.324092 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.068 seconds
[0m18:01:51.325097 [debug] [Thread-3 (]: 
    In "dev_gom1"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:01:51.332612 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m18:01:51.333609 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:01:51.334616 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_gom1"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp180145680449"
    )


  
[0m18:01:51.387651 [debug] [Thread-4 (]: SQL status: COMMENT in 0.066 seconds
[0m18:01:51.388652 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m18:01:51.389655 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:01:51.390651 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m18:01:51.399657 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.065 seconds
[0m18:01:51.401659 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:01:51.402656 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_concurrency" is $dbt_comment_literal_block$Number of simultaneous rides in time$dbt_comment_literal_block$;

  
[0m18:01:51.456710 [debug] [Thread-4 (]: SQL status: COMMIT in 0.065 seconds
[0m18:01:51.458714 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."events_full__dbt_backup"
[0m18:01:51.459714 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:01:51.460718 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_gom1"."dbt"."events_full__dbt_backup" cascade
[0m18:01:51.467721 [debug] [Thread-3 (]: SQL status: COMMENT in 0.065 seconds
[0m18:01:51.469721 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m18:01:51.470724 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:01:51.471722 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m18:01:51.526767 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.066 seconds
[0m18:01:51.528775 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: Close
[0m18:01:51.529777 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD25A4980>]}
[0m18:01:51.530778 [info ] [Thread-4 (]: 9 of 20 OK created sql view model dbt.events_full .............................. [[32mCREATE VIEW[0m in 2.55s]
[0m18:01:51.531775 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_full
[0m18:01:51.532779 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies_trips
[0m18:01:51.533774 [info ] [Thread-4 (]: 12 of 20 START sql table model dbt.companies_trips ............................. [RUN]
[0m18:01:51.533774 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.companies_trips)
[0m18:01:51.534776 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies_trips
[0m18:01:51.538790 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m18:01:51.538790 [debug] [Thread-3 (]: SQL status: COMMIT in 0.067 seconds
[0m18:01:51.540786 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m18:01:51.541788 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies_trips
[0m18:01:51.541788 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD2799DF0>]}
[0m18:01:51.545788 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m18:01:51.546796 [info ] [Thread-3 (]: 5 of 20 OK created sql incremental model dbt.trips_concurrency ................. [[32mINSERT 0 0[0m in 5.88s]
[0m18:01:51.548795 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m18:01:51.548795 [debug] [Thread-3 (]: Began running node model.dbt_scooters.revenue_daily
[0m18:01:51.549797 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:01:51.550793 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m18:01:51.550793 [info ] [Thread-3 (]: 13 of 20 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m18:01:51.551800 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:51.552796 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.revenue_daily)
[0m18:01:51.553797 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m18:01:51.557812 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m18:01:51.559807 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.revenue_daily
[0m18:01:51.584819 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:01:51.584819 [debug] [Thread-2 (]: SQL status: BEGIN in 1.981 seconds
[0m18:01:51.585819 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
select * from (
        select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_gom1"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
    ) as __dbt_sbq
    where false
    limit 0

[0m18:01:51.586830 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:01:51.587825 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:51.588829 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_gom1"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_gom1"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m18:01:52.670573 [debug] [Thread-1 (]: SQL status: BEGIN in 2.278 seconds
[0m18:01:52.671573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:01:52.672588 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_gom1"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_gom1"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m18:01:53.075693 [debug] [Thread-3 (]: SQL status: SELECT 0 in 1.488 seconds
[0m18:01:53.089688 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:01:53.090685 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
select * from (
        select
    
      
    cast(null as decimal(20, 2))
 as revenue_rub, 
      
    cast(null as date)
 as date, 
      
    cast(null as timestamptz)
 as updated_at
    ) as __dbt_sbq
    where false
    limit 0

[0m18:01:53.173907 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.083 seconds
[0m18:01:53.181901 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:01:53.182904 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp180151561804"
  
  
    
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_gom1"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m18:01:54.175722 [debug] [Thread-4 (]: SQL status: BEGIN in 2.624 seconds
[0m18:01:54.176723 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:01:54.177688 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_gom1"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_gom1"."dbt"."trips_prep" as t
        join "dev_gom1"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_gom1"."dbt"."companies" as c
        using (company)
  );
  
[0m18:01:55.476527 [debug] [Thread-3 (]: SQL status: SELECT 3 in 2.293 seconds
[0m18:01:55.479521 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:01:55.480520 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m18:01:55.574720 [debug] [Thread-3 (]: SQL status: BEGIN in 0.094 seconds
[0m18:01:55.575729 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:01:55.575729 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp180151561804'
        
      order by ordinal_position

  
[0m18:01:56.376868 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.800 seconds
[0m18:01:56.379865 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:01:56.380866 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m18:01:56.975607 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.594 seconds
[0m18:01:56.977641 [debug] [Thread-3 (]: 
    In "dev_gom1"."finance"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'revenue_rub', 'new_type': 'numeric'}]
  
[0m18:01:56.984641 [debug] [Thread-3 (]: 
    In "dev_gom1"."finance"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m18:01:56.985643 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m18:01:56.987605 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:01:56.987605 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        
            delete from "dev_gom1"."finance"."revenue_daily"
            using "revenue_daily__dbt_tmp180151561804"
            where (
                
                    "revenue_daily__dbt_tmp180151561804".date = "dev_gom1"."finance"."revenue_daily".date
                    
                
                
            );
        
    

    insert into "dev_gom1"."finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp180151561804"
    )
  
[0m18:01:57.074829 [debug] [Thread-3 (]: SQL status: INSERT 0 3 in 0.086 seconds
[0m18:01:57.079824 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:01:57.079824 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_gom1".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'finance'
        and table_name = 'revenue_daily'
  
[0m18:01:57.376906 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.296 seconds
[0m18:01:57.378913 [debug] [Thread-3 (]: On "dev_gom1"."finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m18:01:57.378913 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:01:57.379911 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  comment on table "dev_gom1"."finance"."revenue_daily" is $dbt_comment_literal_block$Summary daily revenue$dbt_comment_literal_block$;

  
[0m18:01:57.476687 [debug] [Thread-3 (]: SQL status: COMMENT in 0.096 seconds
[0m18:01:57.479717 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:01:57.480728 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m18:01:57.776545 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.295 seconds
[0m18:01:57.778511 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:01:57.779545 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  
    
    
    comment on column "dev_gom1"."finance"."revenue_daily".revenue_rub is $dbt_comment_literal_block$Daily revenue in rubles$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."finance"."revenue_daily".date is $dbt_comment_literal_block$Unique day$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_gom1"."finance"."revenue_daily".updated_at is $dbt_comment_literal_block$When row was updated last time$dbt_comment_literal_block$;
  

  
[0m18:01:57.875797 [debug] [Thread-3 (]: SQL status: COMMENT in 0.096 seconds
[0m18:01:57.877790 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m18:01:57.877790 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:01:57.878790 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m18:01:57.975613 [debug] [Thread-3 (]: SQL status: COMMIT in 0.096 seconds
[0m18:01:57.976605 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: Close
[0m18:01:57.977611 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD22C49B0>]}
[0m18:01:57.978593 [info ] [Thread-3 (]: 13 of 20 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 3[0m in 6.42s]
[0m18:01:57.979573 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.revenue_daily
[0m18:01:57.980575 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_stat
[0m18:01:57.980575 [info ] [Thread-3 (]: 14 of 20 START sql table model dbt.trips_stat .................................. [RUN]
[0m18:01:57.981611 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_stat)
[0m18:01:57.982610 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_stat
[0m18:01:57.985604 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m18:01:57.987575 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_stat
[0m18:01:57.990611 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m18:01:57.992575 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:01:57.992575 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m18:01:57.993610 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:58.572663 [debug] [Thread-4 (]: SQL status: SELECT 6 in 4.394 seconds
[0m18:01:58.575700 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:01:58.576691 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_gom1"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m18:01:58.646851 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.069 seconds
[0m18:01:58.649897 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:01:58.650895 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_gom1"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m18:01:58.721496 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.070 seconds
[0m18:01:58.723474 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:01:58.723474 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  comment on table "dev_gom1"."dbt"."companies_trips" is $dbt_comment_literal_block$Trip statistics by company$dbt_comment_literal_block$;

  
[0m18:01:58.793700 [debug] [Thread-4 (]: SQL status: COMMENT in 0.069 seconds
[0m18:01:58.797698 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:01:58.797698 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'companies_trips'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:01:58.981505 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.183 seconds
[0m18:01:58.983503 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:01:58.984458 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."companies_trips".company is $dbt_comment_literal_block$Scooters manufacturing company$dbt_comment_literal_block$;
  

  
[0m18:01:59.062610 [debug] [Thread-4 (]: SQL status: COMMENT in 0.078 seconds
[0m18:01:59.063608 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m18:01:59.064608 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:01:59.064608 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m18:01:59.476797 [debug] [Thread-4 (]: SQL status: COMMIT in 0.411 seconds
[0m18:01:59.480832 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."companies_trips__dbt_backup"
[0m18:01:59.481796 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:01:59.481796 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_gom1"."dbt"."companies_trips__dbt_backup" cascade
[0m18:01:59.579587 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.097 seconds
[0m18:01:59.581551 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: Close
[0m18:01:59.582586 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD279FBC0>]}
[0m18:01:59.583585 [info ] [Thread-4 (]: 12 of 20 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 8.05s]
[0m18:01:59.584548 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies_trips
[0m18:01:59.585594 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m18:01:59.587550 [info ] [Thread-4 (]: 15 of 20 START sql table model dbt.trips_stat_daily ............................ [RUN]
[0m18:01:59.588549 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_stat_daily)
[0m18:01:59.589585 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m18:01:59.593584 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m18:01:59.595549 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m18:01:59.600585 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m18:01:59.603554 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:01:59.603554 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m18:01:59.604585 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:02:00.172549 [debug] [Thread-3 (]: SQL status: BEGIN in 2.178 seconds
[0m18:02:00.172549 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:02:00.173545 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_gom1"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count(*) as trips,
    count(distinct user_id) as users,
    avg(duration_s) / 60 as avg_duration_min,
    sum(distance_m) / 1000 as sum_distance_km,
    sum(price_rub) as revenue_rub,
    count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from
    "dev_gom1"."dbt"."trips_prep"
  );
  
[0m18:02:02.913710 [debug] [Thread-4 (]: SQL status: BEGIN in 3.309 seconds
[0m18:02:02.914711 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:02:02.915708 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_gom1"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    count(*) as trips,
    max(price_rub) as max_price_rub,
    avg(distance_m) / 1000 as avg_distance_km,
    avg(price_rub)/avg(duration_s) * 60 as avg_price_rub_per_min
from
    "dev_gom1"."dbt"."trips_prep"
group by
    1
order by
    1
  );
  
[0m18:02:09.272594 [debug] [Thread-4 (]: SQL status: SELECT 91 in 6.356 seconds
[0m18:02:09.276591 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:02:09.277565 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_gom1"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m18:02:09.373691 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m18:02:09.377688 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:02:09.378690 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_gom1"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m18:02:09.472675 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m18:02:09.486715 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:02:09.487713 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    create  index if not exists
  "9e12d8f38e90d3c11b555ac53f84a970"
  on "dev_gom1"."dbt"."trips_stat_daily" 
  (date)
  
[0m18:02:09.576510 [debug] [Thread-3 (]: SQL status: SELECT 1 in 9.402 seconds
[0m18:02:09.580510 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:02:09.581478 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_gom1"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m18:02:09.582517 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.094 seconds
[0m18:02:09.584512 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:02:09.585474 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_stat_daily" is $dbt_comment_literal_block$Overall trips statistics per day$dbt_comment_literal_block$;

  
[0m18:02:09.649513 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.068 seconds
[0m18:02:09.654103 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:02:09.654103 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_gom1"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m18:02:09.655064 [debug] [Thread-4 (]: SQL status: COMMENT in 0.070 seconds
[0m18:02:09.659647 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:02:09.660617 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_stat_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:02:09.723647 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.068 seconds
[0m18:02:09.726651 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:02:09.726651 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_stat" is $dbt_comment_literal_block$Overall trips statistics$dbt_comment_literal_block$;

  
[0m18:02:09.872435 [debug] [Thread-3 (]: SQL status: COMMENT in 0.145 seconds
[0m18:02:09.874423 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m18:02:09.875428 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:02:09.876393 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m18:02:09.876393 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.216 seconds
[0m18:02:09.879395 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:02:09.880394 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  
    
    
    comment on column "dev_gom1"."dbt"."trips_stat_daily".date is $dbt_comment_literal_block$Trips date$dbt_comment_literal_block$;
  

  
[0m18:02:09.974608 [debug] [Thread-4 (]: SQL status: COMMENT in 0.094 seconds
[0m18:02:09.976609 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m18:02:09.976609 [debug] [Thread-3 (]: SQL status: COMMIT in 0.100 seconds
[0m18:02:09.977650 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:02:09.980649 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."trips_stat__dbt_backup"
[0m18:02:09.981612 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m18:02:09.981612 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:02:09.982655 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_gom1"."dbt"."trips_stat__dbt_backup" cascade
[0m18:02:10.074421 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.091 seconds
[0m18:02:10.076414 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: Close
[0m18:02:10.077416 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD2799DF0>]}
[0m18:02:10.078415 [info ] [Thread-3 (]: 14 of 20 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 12.10s]
[0m18:02:10.079405 [debug] [Thread-4 (]: SQL status: COMMIT in 0.097 seconds
[0m18:02:10.080410 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_stat
[0m18:02:10.083411 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."trips_stat_daily__dbt_backup"
[0m18:02:10.084414 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_users
[0m18:02:10.085380 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:02:10.086377 [info ] [Thread-3 (]: 16 of 20 START sql incremental model dbt.trips_users ........................... [RUN]
[0m18:02:10.087378 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_gom1"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m18:02:10.088380 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_users)
[0m18:02:10.089377 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_users
[0m18:02:10.095377 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m18:02:10.097384 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_users
[0m18:02:10.103396 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:02:10.103396 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp180210100390"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now()  as updated_at

from
    "dev_gom1"."dbt"."trips_prep" as t
left join
    "dev_gom1"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_gom1"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m18:02:10.104392 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:02:10.176549 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.088 seconds
[0m18:02:10.178511 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m18:02:10.179548 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD22B7A40>]}
[0m18:02:10.180544 [info ] [Thread-4 (]: 15 of 20 OK created sql table model dbt.trips_stat_daily ....................... [[32mSELECT 91[0m in 10.59s]
[0m18:02:10.182542 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m18:02:10.182542 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_stat
[0m18:02:10.183543 [info ] [Thread-4 (]: 17 of 20 START sql table model dbt.events_stat ................................. [RUN]
[0m18:02:10.184508 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.events_stat)
[0m18:02:10.185509 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_stat
[0m18:02:10.188544 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m18:02:10.189508 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_stat
[0m18:02:10.194510 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m18:02:10.195507 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:02:10.196510 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: BEGIN
[0m18:02:10.197518 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:02:11.872504 [debug] [Thread-4 (]: SQL status: BEGIN in 1.675 seconds
[0m18:02:11.872504 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:02:11.873503 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_gom1"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
       count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from "dev_gom1"."dbt"."events_full"
  );
  
[0m18:02:12.780516 [debug] [Thread-3 (]: SQL status: SELECT 0 in 2.676 seconds
[0m18:02:12.783555 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:02:12.784559 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: BEGIN
[0m18:02:12.873689 [debug] [Thread-3 (]: SQL status: BEGIN in 0.088 seconds
[0m18:02:12.873689 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:02:12.874723 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp180210100390'
        
      order by ordinal_position

  
[0m18:02:13.571704 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.697 seconds
[0m18:02:13.575733 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:02:13.576705 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:02:13.974771 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.398 seconds
[0m18:02:13.978766 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:02:13.979775 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp180210100390'
        
      order by ordinal_position

  
[0m18:02:14.274963 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.295 seconds
[0m18:02:14.278548 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:02:14.278548 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:02:14.688646 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.409 seconds
[0m18:02:14.691652 [debug] [Thread-3 (]: 
    In "dev_gom1"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:02:14.692651 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m18:02:14.694616 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:02:14.694616 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_gom1"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp180210100390"
    )


  
[0m18:02:14.775852 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.080 seconds
[0m18:02:14.777842 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:02:14.778838 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_users" is $dbt_comment_literal_block$Prepared trips enriched with users data$dbt_comment_literal_block$;

  
[0m18:02:14.874460 [debug] [Thread-3 (]: SQL status: COMMENT in 0.095 seconds
[0m18:02:14.876442 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:02:14.876442 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m18:02:26.272416 [debug] [Thread-4 (]: SQL status: SELECT 1 in 14.398 seconds
[0m18:02:26.277947 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:02:26.279949 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_gom1"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m18:02:26.374494 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m18:02:26.381241 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:02:26.383237 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_gom1"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m18:02:26.477388 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m18:02:26.481404 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:02:26.482407 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."events_stat" is $dbt_comment_literal_block$Overall user events statistics$dbt_comment_literal_block$;

  
[0m18:02:26.571417 [debug] [Thread-4 (]: SQL status: COMMENT in 0.087 seconds
[0m18:02:26.574447 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m18:02:26.574447 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:02:26.576412 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m18:02:26.772661 [debug] [Thread-4 (]: SQL status: COMMIT in 0.195 seconds
[0m18:02:26.776659 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."events_stat__dbt_backup"
[0m18:02:26.780091 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:02:26.781083 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_gom1"."dbt"."events_stat__dbt_backup" cascade
[0m18:02:26.883261 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.101 seconds
[0m18:02:26.885262 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: Close
[0m18:02:26.887787 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD2D9E720>]}
[0m18:02:26.889786 [info ] [Thread-4 (]: 17 of 20 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 16.70s]
[0m18:02:26.890786 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_stat
[0m18:02:31.871475 [debug] [Thread-2 (]: SQL status: SELECT 464 in 40.281 seconds
[0m18:02:31.874517 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:02:31.875514 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_gom1"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m18:02:31.970593 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m18:02:31.974633 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:02:31.975597 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_gom1"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m18:02:32.068686 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m18:02:32.071683 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:02:32.071683 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."parking_finish_stat" is $dbt_comment_literal_block$Trip finish parking statistics by 10 m hexagons$dbt_comment_literal_block$;

  
[0m18:02:32.169412 [debug] [Thread-2 (]: SQL status: COMMENT in 0.097 seconds
[0m18:02:32.171444 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m18:02:32.172413 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:02:32.172413 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m18:02:32.272559 [debug] [Thread-2 (]: SQL status: COMMIT in 0.100 seconds
[0m18:02:32.277571 [debug] [Thread-2 (]: Applying DROP to: "dev_gom1"."dbt"."parking_finish_stat__dbt_backup"
[0m18:02:32.279572 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:02:32.280571 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_gom1"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m18:02:32.371663 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.091 seconds
[0m18:02:32.373665 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m18:02:32.374665 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD2DA9790>]}
[0m18:02:32.375665 [info ] [Thread-2 (]: 10 of 20 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 42.79s]
[0m18:02:32.377680 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m18:02:32.477541 [debug] [Thread-3 (]: SQL status: ANALYZE in 17.600 seconds
[0m18:02:32.478508 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: COMMIT
[0m18:02:32.479536 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:02:32.480544 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: COMMIT
[0m18:02:32.549710 [debug] [Thread-3 (]: SQL status: COMMIT in 0.069 seconds
[0m18:02:32.550698 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:02:32.551663 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m18:02:32.672669 [debug] [Thread-3 (]: SQL status: COMMIT in 0.121 seconds
[0m18:02:32.674666 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:02:32.674666 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m18:02:32.771691 [debug] [Thread-3 (]: SQL status: VACUUM in 0.096 seconds
[0m18:02:32.772691 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: Close
[0m18:02:32.773695 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD2D6A3C0>]}
[0m18:02:32.774690 [info ] [Thread-3 (]: 16 of 20 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 22.69s]
[0m18:02:32.776658 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_users
[0m18:02:32.777658 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_daily
[0m18:02:32.777658 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_group
[0m18:02:32.778655 [info ] [Thread-4 (]: 18 of 20 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m18:02:32.779659 [info ] [Thread-2 (]: 19 of 20 START sql table model dbt.trips_age_group ............................. [RUN]
[0m18:02:32.780660 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now model.dbt_scooters.trips_age_daily)
[0m18:02:32.781655 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_finish_stat, now model.dbt_scooters.trips_age_group)
[0m18:02:32.781655 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m18:02:32.782692 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m18:02:32.785687 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m18:02:32.790050 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m18:02:32.792013 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m18:02:32.795049 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m18:02:32.796592 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_group
[0m18:02:32.800599 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m18:02:32.801599 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:02:32.802606 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m18:02:32.803604 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:02:32.803604 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:02:32.804602 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m18:02:32.805601 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:02:34.272596 [debug] [Thread-4 (]: SQL status: BEGIN in 1.469 seconds
[0m18:02:34.273601 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:02:34.273601 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_gom1"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    Select "date",
       age,
       count(*) as trips,
       sum(price_rub) as revenue_rub
from
    "dev_gom1"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m18:02:35.172958 [debug] [Thread-2 (]: SQL status: BEGIN in 2.367 seconds
[0m18:02:35.173960 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:02:35.173960 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_gom1"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_gom1"."dbt"."trips_users" as tu
    cross join "dev_gom1"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m18:02:35.874715 [debug] [Thread-4 (]: SQL status: SELECT 7049 in 1.600 seconds
[0m18:02:35.878716 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:02:35.879717 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_gom1"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m18:02:35.971750 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m18:02:35.975748 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:02:35.975748 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_gom1"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m18:02:36.070785 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m18:02:36.073784 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:02:36.073784 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_age_daily" is $dbt_comment_literal_block$Daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m18:02:36.171339 [debug] [Thread-4 (]: SQL status: COMMENT in 0.097 seconds
[0m18:02:36.174339 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m18:02:36.174339 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:02:36.175339 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m18:02:36.273376 [debug] [Thread-4 (]: SQL status: COMMIT in 0.097 seconds
[0m18:02:36.276416 [debug] [Thread-4 (]: Applying DROP to: "dev_gom1"."dbt"."trips_age_daily__dbt_backup"
[0m18:02:36.277381 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:02:36.277381 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_gom1"."dbt"."trips_age_daily__dbt_backup" cascade
[0m18:02:36.377580 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.100 seconds
[0m18:02:36.379573 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: Close
[0m18:02:36.380575 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD2601460>]}
[0m18:02:36.381574 [info ] [Thread-4 (]: 18 of 20 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 3.60s]
[0m18:02:36.382574 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m18:02:36.383568 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m18:02:36.384575 [info ] [Thread-3 (]: 20 of 20 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m18:02:36.385567 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_daily_stat)
[0m18:02:36.386570 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m18:02:36.391126 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m18:02:36.393087 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m18:02:36.398714 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m18:02:36.400680 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:02:36.401679 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m18:02:36.401679 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:02:36.668485 [debug] [Thread-1 (]: SQL status: SELECT 142 in 43.996 seconds
[0m18:02:36.672487 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:02:36.673487 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_gom1"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m18:02:36.768597 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m18:02:36.773599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:02:36.773599 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_gom1"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m18:02:36.839676 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.065 seconds
[0m18:02:36.841672 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:02:36.842671 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."parking_start_stat" is $dbt_comment_literal_block$Trip start parking statistics by 500 m hexagons$dbt_comment_literal_block$;

  
[0m18:02:36.908761 [debug] [Thread-1 (]: SQL status: COMMENT in 0.065 seconds
[0m18:02:36.910764 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m18:02:36.911767 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:02:36.912763 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m18:02:36.993880 [debug] [Thread-1 (]: SQL status: COMMIT in 0.080 seconds
[0m18:02:36.997396 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."parking_start_stat__dbt_backup"
[0m18:02:36.999398 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:02:37.000398 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_gom1"."dbt"."parking_start_stat__dbt_backup" cascade
[0m18:02:37.185632 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.184 seconds
[0m18:02:37.187639 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: Close
[0m18:02:37.189148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD0C2FD10>]}
[0m18:02:37.190190 [info ] [Thread-1 (]: 11 of 20 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 46.81s]
[0m18:02:37.192190 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m18:02:37.670659 [debug] [Thread-3 (]: SQL status: BEGIN in 1.268 seconds
[0m18:02:37.671660 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:02:37.672662 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_gom1"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_gom1"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m18:02:37.970540 [debug] [Thread-3 (]: SQL status: SELECT 83 in 0.298 seconds
[0m18:02:37.975493 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:02:37.975493 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_gom1"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m18:02:38.068531 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m18:02:38.073515 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:02:38.074484 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_gom1"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m18:02:38.169724 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m18:02:38.171719 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:02:38.172719 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_age_daily_stat" is $dbt_comment_literal_block$Aggregation of daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m18:02:38.268492 [debug] [Thread-3 (]: SQL status: COMMENT in 0.095 seconds
[0m18:02:38.270545 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m18:02:38.271525 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:02:38.272529 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m18:02:38.369738 [debug] [Thread-3 (]: SQL status: COMMIT in 0.097 seconds
[0m18:02:38.373736 [debug] [Thread-3 (]: Applying DROP to: "dev_gom1"."dbt"."trips_age_daily_stat__dbt_backup"
[0m18:02:38.374703 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:02:38.374703 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_gom1"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m18:02:38.476538 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.101 seconds
[0m18:02:38.478526 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m18:02:38.479527 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD22C5A00>]}
[0m18:02:38.480526 [info ] [Thread-3 (]: 20 of 20 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 2.09s]
[0m18:02:38.482498 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m18:02:47.773325 [debug] [Thread-2 (]: SQL status: SELECT 7 in 12.599 seconds
[0m18:02:47.778326 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:02:47.779326 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_gom1"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m18:02:47.849480 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.069 seconds
[0m18:02:47.855436 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:02:47.856440 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_gom1"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m18:02:47.940658 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.082 seconds
[0m18:02:47.944657 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:02:47.946681 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

    
  
  comment on table "dev_gom1"."dbt"."trips_age_group" is $dbt_comment_literal_block$Overall trips statistics by user age group$dbt_comment_literal_block$;

  
[0m18:02:48.017437 [debug] [Thread-2 (]: SQL status: COMMENT in 0.069 seconds
[0m18:02:48.019947 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m18:02:48.020960 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:02:48.021971 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m18:02:48.090944 [debug] [Thread-2 (]: SQL status: COMMIT in 0.068 seconds
[0m18:02:48.094960 [debug] [Thread-2 (]: Applying DROP to: "dev_gom1"."dbt"."trips_age_group__dbt_backup"
[0m18:02:48.096477 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:02:48.097492 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_gom1"."dbt"."trips_age_group__dbt_backup" cascade
[0m18:02:48.169968 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.072 seconds
[0m18:02:48.172968 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: Close
[0m18:02:48.174975 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9405ba88-8964-4c23-8410-4a764cd27f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD26EA390>]}
[0m18:02:48.176487 [info ] [Thread-2 (]: 19 of 20 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 15.39s]
[0m18:02:48.178501 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_group
[0m18:02:48.180697 [info ] [MainThread]: 
[0m18:02:48.182693 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:48.183692 [debug] [MainThread]: On master: BEGIN
[0m18:02:48.183692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:02:50.183334 [debug] [MainThread]: SQL status: BEGIN in 1.999 seconds
[0m18:02:50.184322 [debug] [MainThread]: On master: COMMIT
[0m18:02:50.184322 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:50.185325 [debug] [MainThread]: On master: COMMIT
[0m18:02:50.250497 [debug] [MainThread]: SQL status: COMMIT in 0.065 seconds
[0m18:02:50.253452 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m18:02:50.259450 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m18:02:50.260451 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:50.261451 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m18:02:50.332682 [debug] [MainThread]: SQL status: GRANT in 0.071 seconds
[0m18:02:50.334674 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.08s]
[0m18:02:50.335637 [debug] [MainThread]: On master: Close
[0m18:02:50.336642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:50.337639 [debug] [MainThread]: Connection 'list_dev_gom1' was properly closed.
[0m18:02:50.338637 [debug] [MainThread]: Connection 'list_dev_gom1' was properly closed.
[0m18:02:50.338637 [debug] [MainThread]: Connection 'list_dev_gom1_finance' was properly closed.
[0m18:02:50.339637 [debug] [MainThread]: Connection 'list_dev_gom1_dbt' was properly closed.
[0m18:02:50.339637 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_start_stat' was properly closed.
[0m18:02:50.340637 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m18:02:50.340637 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m18:02:50.341636 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily' was properly closed.
[0m18:02:50.341636 [info ] [MainThread]: 
[0m18:02:50.342638 [info ] [MainThread]: Finished running 4 incremental models, 1 project hook, 12 table models, 4 view models in 0 hours 1 minutes and 11.75 seconds (71.75s).
[0m18:02:50.348681 [debug] [MainThread]: Command end result
[0m18:02:50.389644 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m18:02:50.392643 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m18:02:50.403160 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\run_results.json
[0m18:02:50.404165 [info ] [MainThread]: 
[0m18:02:50.405164 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:02:50.405164 [info ] [MainThread]: 
[0m18:02:50.406673 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 TOTAL=21
[0m18:02:50.408685 [debug] [MainThread]: Command `dbt run` succeeded at 18:02:50.408685 after 73.75 seconds
[0m18:02:50.409719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD0260740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCFFE24B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD0DE3EC0>]}
[0m18:02:50.410717 [debug] [MainThread]: Flushing usage events
[0m18:02:51.304868 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:08:33.833471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FA3BFF3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FA31E2E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FA31E39B0>]}


============================== 15:08:33.844374 | 3349f835-13bf-4f74-932e-52e5b6ac95b3 ==============================
[0m15:08:33.844374 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:08:33.845378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m15:08:34.245176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3349f835-13bf-4f74-932e-52e5b6ac95b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FA3EBF770>]}
[0m15:08:34.353047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3349f835-13bf-4f74-932e-52e5b6ac95b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FA3BFE4E0>]}
[0m15:08:34.355048 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:08:34.755298 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:08:35.211070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:35.212570 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:35.345375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3349f835-13bf-4f74-932e-52e5b6ac95b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FA40BDC40>]}
[0m15:08:35.579044 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m15:08:35.588066 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m15:08:35.699110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3349f835-13bf-4f74-932e-52e5b6ac95b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FA5795490>]}
[0m15:08:35.700112 [info ] [MainThread]: Found 20 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 438 macros
[0m15:08:35.701111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3349f835-13bf-4f74-932e-52e5b6ac95b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FA4013290>]}
[0m15:08:35.706913 [info ] [MainThread]: 
[0m15:08:35.707932 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:08:35.708977 [info ] [MainThread]: 
[0m15:08:35.710928 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:08:35.720152 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_dbt'
[0m15:08:35.737899 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_finance'
[0m15:08:35.968222 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m15:08:35.969222 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m15:08:35.970230 [debug] [ThreadPool]: On list_dev_gom1_dbt: BEGIN
[0m15:08:35.971530 [debug] [ThreadPool]: On list_dev_gom1_finance: BEGIN
[0m15:08:35.972528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:35.973533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:38.942208 [debug] [ThreadPool]: SQL status: BEGIN in 2.968 seconds
[0m15:08:38.942208 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m15:08:38.943209 [debug] [ThreadPool]: On list_dev_gom1_finance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_finance"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m15:08:38.956009 [debug] [ThreadPool]: SQL status: BEGIN in 2.984 seconds
[0m15:08:38.957042 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m15:08:38.957042 [debug] [ThreadPool]: On list_dev_gom1_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_dbt"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m15:08:39.030961 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.087 seconds
[0m15:08:39.031911 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.073 seconds
[0m15:08:39.033188 [debug] [ThreadPool]: On list_dev_gom1_finance: ROLLBACK
[0m15:08:39.035220 [debug] [ThreadPool]: On list_dev_gom1_dbt: ROLLBACK
[0m15:08:39.109033 [debug] [ThreadPool]: On list_dev_gom1_dbt: Close
[0m15:08:39.109993 [debug] [ThreadPool]: On list_dev_gom1_finance: Close
[0m15:08:39.122200 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:39.122200 [debug] [MainThread]: On master: BEGIN
[0m15:08:39.123204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:40.225249 [debug] [MainThread]: SQL status: BEGIN in 1.102 seconds
[0m15:08:40.226757 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:40.227768 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:08:40.312129 [debug] [MainThread]: SQL status: SELECT 5 in 0.084 seconds
[0m15:08:40.315134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3349f835-13bf-4f74-932e-52e5b6ac95b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FA5718EC0>]}
[0m15:08:40.316126 [debug] [MainThread]: On master: ROLLBACK
[0m15:08:40.399155 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:40.400130 [debug] [MainThread]: On master: BEGIN
[0m15:08:40.555442 [debug] [MainThread]: SQL status: BEGIN in 0.155 seconds
[0m15:08:40.556952 [debug] [MainThread]: On master: COMMIT
[0m15:08:40.557992 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:40.558967 [debug] [MainThread]: On master: COMMIT
[0m15:08:40.632396 [debug] [MainThread]: SQL status: COMMIT in 0.073 seconds
[0m15:08:40.633396 [debug] [MainThread]: On master: Close
[0m15:08:40.639927 [debug] [Thread-1 (]: Began running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m15:08:40.639927 [debug] [Thread-2 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m15:08:40.640925 [debug] [Thread-3 (]: Began running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m15:08:40.640925 [debug] [Thread-4 (]: Began running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m15:08:40.642199 [info ] [Thread-1 (]: 1 of 28 START test accepted_values_add_first_name_sex_sex__M__F ................ [RUN]
[0m15:08:40.643201 [info ] [Thread-2 (]: 2 of 28 START test events_full_is_complete ..................................... [RUN]
[0m15:08:40.644201 [info ] [Thread-3 (]: 3 of 28 START test every_event_has_type ........................................ [RUN]
[0m15:08:40.645195 [info ] [Thread-4 (]: 4 of 28 START test every_event_has_user ........................................ [RUN]
[0m15:08:40.646198 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199'
[0m15:08:40.647212 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_scooters.events_full_is_complete'
[0m15:08:40.649209 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_scooters.every_event_has_type.1e5fc977eb'
[0m15:08:40.650207 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_scooters.every_event_has_user.7eea25f36c'
[0m15:08:40.651213 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m15:08:40.651213 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m15:08:40.652499 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m15:08:40.653465 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m15:08:40.682239 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m15:08:40.686210 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m15:08:40.701041 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m15:08:40.708878 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m15:08:40.711883 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m15:08:40.713387 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m15:08:40.725223 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m15:08:40.740065 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m15:08:40.742280 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m15:08:40.746798 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.events_full_is_complete"
[0m15:08:40.749841 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m15:08:40.753064 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m15:08:40.756030 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m15:08:40.757034 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m15:08:40.758031 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: BEGIN
[0m15:08:40.759031 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m15:08:40.760034 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: BEGIN
[0m15:08:40.760034 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m15:08:40.761891 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:40.762895 [debug] [Thread-3 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: BEGIN
[0m15:08:40.763901 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:08:40.764891 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: BEGIN
[0m15:08:40.765890 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:08:40.767903 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:08:41.857173 [debug] [Thread-1 (]: SQL status: BEGIN in 1.096 seconds
[0m15:08:41.858167 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m15:08:41.859128 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_gom1"."dbt"."add_first_name_sex"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m15:08:41.936213 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.076 seconds
[0m15:08:41.942453 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: ROLLBACK
[0m15:08:42.014174 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: Close
[0m15:08:42.015200 [info ] [Thread-1 (]: 1 of 28 PASS accepted_values_add_first_name_sex_sex__M__F ...................... [[32mPASS[0m in 1.37s]
[0m15:08:42.017174 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m15:08:42.018170 [debug] [Thread-1 (]: Began running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m15:08:42.018170 [info ] [Thread-1 (]: 5 of 28 START test every_trip_has_scooter_id ................................... [RUN]
[0m15:08:42.019200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199, now test.dbt_scooters.every_trip_has_scooter_id.e0b845a190)
[0m15:08:42.020201 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m15:08:42.030984 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m15:08:42.034220 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m15:08:42.037219 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m15:08:42.039219 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m15:08:42.039219 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: BEGIN
[0m15:08:42.040221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:43.541121 [debug] [Thread-3 (]: SQL status: BEGIN in 2.776 seconds
[0m15:08:43.542396 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m15:08:43.542396 [debug] [Thread-3 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_type.1e5fc977eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type_id as from_field
    from "dev_gom1"."scooters_raw"."events"
    where type_id is not null
),

parent as (
    select type_id as to_field
    from "dev_gom1"."dbt"."event_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:08:43.608159 [debug] [Thread-4 (]: SQL status: BEGIN in 2.841 seconds
[0m15:08:43.609152 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m15:08:43.610155 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_user.7eea25f36c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_gom1"."scooters_raw"."events"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_gom1"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:08:43.613429 [debug] [Thread-2 (]: SQL status: BEGIN in 2.849 seconds
[0m15:08:43.613429 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m15:08:43.614397 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.events_full_is_complete"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with source_cte as (
    select count(*) as row_count
    from "dev_gom1"."dbt"."events_clean"
),
target_cte as (
    select count(*) as row_count
    from "dev_gom1"."dbt"."events_full"
)
select
    'Row count mismatch' as error_message,
    source_cte.row_count as source_count,
    target_cte.row_count as target_count
from
    source_cte,
    target_cte
where
    source_cte.row_count != target_cte.row_count
      
    ) dbt_internal_test
[0m15:08:44.289118 [debug] [Thread-1 (]: SQL status: BEGIN in 2.249 seconds
[0m15:08:44.290119 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m15:08:44.291119 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select scooter_hw_id as from_field
    from "dev_gom1"."scooters_raw"."trips"
    where scooter_hw_id is not null
),

parent as (
    select hardware_id as to_field
    from "dev_gom1"."dbt"."scooters"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:08:44.991974 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.701 seconds
[0m15:08:44.994974 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: ROLLBACK
[0m15:08:45.068996 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: Close
[0m15:08:45.069999 [info ] [Thread-1 (]: 5 of 28 PASS every_trip_has_scooter_id ......................................... [[32mPASS[0m in 3.05s]
[0m15:08:45.071001 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m15:08:45.072003 [debug] [Thread-1 (]: Began running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m15:08:45.073000 [info ] [Thread-1 (]: 6 of 28 START test every_trip_has_user ......................................... [RUN]
[0m15:08:45.074006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_scooter_id.e0b845a190, now test.dbt_scooters.every_trip_has_user.6bc71135e2)
[0m15:08:45.075000 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m15:08:45.082997 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m15:08:45.085997 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m15:08:45.088996 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m15:08:45.090001 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m15:08:45.090999 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: BEGIN
[0m15:08:45.090999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:46.006219 [debug] [Thread-4 (]: SQL status: SELECT 1 in 2.395 seconds
[0m15:08:46.008221 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: ROLLBACK
[0m15:08:46.081765 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: Close
[0m15:08:46.082765 [info ] [Thread-4 (]: 4 of 28 PASS every_event_has_user .............................................. [[32mPASS[0m in 5.43s]
[0m15:08:46.084766 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m15:08:46.085767 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m15:08:46.086766 [info ] [Thread-4 (]: 7 of 28 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m15:08:46.086766 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_user.7eea25f36c, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m15:08:46.087767 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m15:08:46.093763 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m15:08:46.094763 [debug] [Thread-3 (]: SQL status: SELECT 1 in 2.552 seconds
[0m15:08:46.096766 [debug] [Thread-3 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: ROLLBACK
[0m15:08:46.097766 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m15:08:46.100760 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m15:08:46.103763 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m15:08:46.104765 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m15:08:46.105764 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:08:46.189796 [debug] [Thread-3 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: Close
[0m15:08:46.190799 [info ] [Thread-3 (]: 3 of 28 PASS every_event_has_type .............................................. [[32mPASS[0m in 5.54s]
[0m15:08:46.191799 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m15:08:46.192802 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m15:08:46.193801 [info ] [Thread-3 (]: 8 of 28 START test source_not_null_scooters_raw_events_type_id ................. [RUN]
[0m15:08:46.194801 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_type.1e5fc977eb, now test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7)
[0m15:08:46.195803 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m15:08:46.202797 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m15:08:46.203799 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m15:08:46.207798 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m15:08:46.209802 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m15:08:46.210804 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: BEGIN
[0m15:08:46.211799 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:08:47.155914 [debug] [Thread-1 (]: SQL status: BEGIN in 2.065 seconds
[0m15:08:47.156916 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m15:08:47.157918 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_user.6bc71135e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_gom1"."scooters_raw"."trips"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_gom1"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:08:47.233945 [debug] [Thread-4 (]: SQL status: BEGIN in 1.129 seconds
[0m15:08:47.234945 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m15:08:47.235947 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_gom1"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m15:08:47.487043 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.250 seconds
[0m15:08:47.489041 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m15:08:47.586074 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m15:08:47.586074 [debug] [Thread-3 (]: SQL status: BEGIN in 1.375 seconds
[0m15:08:47.587076 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m15:08:47.588075 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from "dev_gom1"."scooters_raw"."events"
where type_id is null



      
    ) dbt_internal_test
[0m15:08:47.588075 [info ] [Thread-4 (]: 7 of 28 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 1.50s]
[0m15:08:47.590079 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m15:08:47.590079 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m15:08:47.591076 [info ] [Thread-4 (]: 9 of 28 START test source_not_null_scooters_raw_events_user_id ................. [RUN]
[0m15:08:47.592077 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b)
[0m15:08:47.592077 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m15:08:47.597077 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m15:08:47.598076 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m15:08:47.602076 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m15:08:47.603076 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m15:08:47.604076 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: BEGIN
[0m15:08:47.604076 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:08:47.792139 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.634 seconds
[0m15:08:47.794142 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: ROLLBACK
[0m15:08:47.889169 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: Close
[0m15:08:47.890172 [info ] [Thread-1 (]: 6 of 28 PASS every_trip_has_user ............................................... [[32mPASS[0m in 2.82s]
[0m15:08:47.891173 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m15:08:47.892175 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m15:08:47.893172 [info ] [Thread-1 (]: 10 of 28 START test source_not_null_scooters_raw_trips_id ...................... [RUN]
[0m15:08:47.894173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_user.6bc71135e2, now test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d)
[0m15:08:47.894173 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m15:08:47.899181 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m15:08:47.901181 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m15:08:47.903180 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m15:08:47.905181 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m15:08:47.905181 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: BEGIN
[0m15:08:47.906181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:48.928981 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.340 seconds
[0m15:08:48.930983 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: ROLLBACK
[0m15:08:49.006012 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: Close
[0m15:08:49.007015 [info ] [Thread-3 (]: 8 of 28 PASS source_not_null_scooters_raw_events_type_id ....................... [[32mPASS[0m in 2.81s]
[0m15:08:49.008014 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m15:08:49.009020 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m15:08:49.010015 [info ] [Thread-3 (]: 11 of 28 START test source_not_null_scooters_raw_trips_scooter_hw_id ........... [RUN]
[0m15:08:49.011017 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7, now test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f)
[0m15:08:49.011017 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m15:08:49.016014 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m15:08:49.019014 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m15:08:49.021012 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m15:08:49.023015 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m15:08:49.023015 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: BEGIN
[0m15:08:49.024015 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:08:49.056014 [debug] [Thread-4 (]: SQL status: BEGIN in 1.451 seconds
[0m15:08:49.056014 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m15:08:49.057014 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_gom1"."scooters_raw"."events"
where user_id is null



      
    ) dbt_internal_test
[0m15:08:49.124049 [debug] [Thread-2 (]: SQL status: SELECT 1 in 5.509 seconds
[0m15:08:49.126052 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: ROLLBACK
[0m15:08:49.203078 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: Close
[0m15:08:49.204079 [info ] [Thread-2 (]: 2 of 28 PASS events_full_is_complete ........................................... [[32mPASS[0m in 8.56s]
[0m15:08:49.206083 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m15:08:49.207085 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m15:08:49.208078 [info ] [Thread-2 (]: 12 of 28 START test source_not_null_scooters_raw_trips_user_id ................. [RUN]
[0m15:08:49.209084 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.events_full_is_complete, now test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62)
[0m15:08:49.210084 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m15:08:49.214082 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m15:08:49.216083 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m15:08:49.219098 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m15:08:49.221099 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m15:08:49.222098 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: BEGIN
[0m15:08:49.222098 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:08:49.587211 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.530 seconds
[0m15:08:49.589212 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: ROLLBACK
[0m15:08:49.657733 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: Close
[0m15:08:49.658735 [info ] [Thread-4 (]: 9 of 28 PASS source_not_null_scooters_raw_events_user_id ....................... [[32mPASS[0m in 2.07s]
[0m15:08:49.660736 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m15:08:49.662739 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m15:08:49.663736 [info ] [Thread-4 (]: 13 of 28 START test source_not_null_scooters_raw_users_id ...................... [RUN]
[0m15:08:49.664737 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b, now test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d)
[0m15:08:49.665738 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m15:08:49.669254 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m15:08:49.671255 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m15:08:49.673254 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m15:08:49.675255 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m15:08:49.676253 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: BEGIN
[0m15:08:49.677252 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:08:49.990855 [debug] [Thread-1 (]: SQL status: BEGIN in 2.085 seconds
[0m15:08:49.991857 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m15:08:49.991857 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_gom1"."scooters_raw"."trips"
where id is null



      
    ) dbt_internal_test
[0m15:08:50.073369 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.080 seconds
[0m15:08:50.075368 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: ROLLBACK
[0m15:08:50.142890 [debug] [Thread-3 (]: SQL status: BEGIN in 1.119 seconds
[0m15:08:50.143891 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m15:08:50.143891 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select scooter_hw_id
from "dev_gom1"."scooters_raw"."trips"
where scooter_hw_id is null



      
    ) dbt_internal_test
[0m15:08:50.148884 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: Close
[0m15:08:50.149885 [info ] [Thread-1 (]: 10 of 28 PASS source_not_null_scooters_raw_trips_id ............................ [[32mPASS[0m in 2.26s]
[0m15:08:50.151890 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m15:08:50.152893 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m15:08:50.152893 [info ] [Thread-1 (]: 14 of 28 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m15:08:50.153888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m15:08:50.154889 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m15:08:50.159927 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m15:08:50.161887 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m15:08:50.163922 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m15:08:50.166930 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m15:08:50.168424 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m15:08:50.168424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:50.293909 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.149 seconds
[0m15:08:50.295865 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: ROLLBACK
[0m15:08:50.372523 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: Close
[0m15:08:50.373480 [info ] [Thread-3 (]: 11 of 28 PASS source_not_null_scooters_raw_trips_scooter_hw_id ................. [[32mPASS[0m in 1.36s]
[0m15:08:50.375478 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m15:08:50.375478 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m15:08:50.376992 [info ] [Thread-3 (]: 15 of 28 START test source_unique_scooters_raw_trips_id ........................ [RUN]
[0m15:08:50.378005 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f, now test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4)
[0m15:08:50.379006 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m15:08:50.389019 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m15:08:50.391013 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m15:08:50.393017 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m15:08:50.395016 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m15:08:50.396018 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: BEGIN
[0m15:08:50.396018 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:08:50.756918 [debug] [Thread-4 (]: SQL status: BEGIN in 1.079 seconds
[0m15:08:50.756918 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m15:08:50.757925 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_gom1"."scooters_raw"."users"
where id is null



      
    ) dbt_internal_test
[0m15:08:50.828105 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.070 seconds
[0m15:08:50.830144 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: ROLLBACK
[0m15:08:50.900778 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: Close
[0m15:08:50.901746 [info ] [Thread-4 (]: 13 of 28 PASS source_not_null_scooters_raw_users_id ............................ [[32mPASS[0m in 1.24s]
[0m15:08:50.902762 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m15:08:50.903770 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m15:08:50.904763 [info ] [Thread-4 (]: 16 of 28 START test source_unique_scooters_raw_users_id ........................ [RUN]
[0m15:08:50.905722 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d, now test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf)
[0m15:08:50.906725 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m15:08:50.913762 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m15:08:50.916725 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m15:08:50.918756 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m15:08:50.920758 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m15:08:50.921756 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: BEGIN
[0m15:08:50.921756 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:08:51.138770 [debug] [Thread-2 (]: SQL status: BEGIN in 1.916 seconds
[0m15:08:51.139771 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m15:08:51.139771 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_gom1"."scooters_raw"."trips"
where user_id is null



      
    ) dbt_internal_test
[0m15:08:51.217018 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.077 seconds
[0m15:08:51.219974 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: ROLLBACK
[0m15:08:51.288867 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: Close
[0m15:08:51.289866 [info ] [Thread-2 (]: 12 of 28 PASS source_not_null_scooters_raw_trips_user_id ....................... [[32mPASS[0m in 2.08s]
[0m15:08:51.291827 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m15:08:51.291827 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m15:08:51.292864 [info ] [Thread-2 (]: 17 of 28 START test unique_companies_trips_company ............................. [RUN]
[0m15:08:51.293827 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m15:08:51.294827 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m15:08:51.298828 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m15:08:51.300825 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m15:08:51.302858 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m15:08:51.304827 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m15:08:51.305825 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m15:08:51.305825 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:08:51.509894 [debug] [Thread-3 (]: SQL status: BEGIN in 1.113 seconds
[0m15:08:51.510852 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m15:08:51.510852 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_gom1"."scooters_raw"."trips"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:08:52.294871 [debug] [Thread-1 (]: SQL status: BEGIN in 2.126 seconds
[0m15:08:52.295824 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m15:08:52.296840 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sex
from "dev_gom1"."scooters_raw"."users"
where sex is null



      
    ) dbt_internal_test
[0m15:08:52.393068 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.096 seconds
[0m15:08:52.396028 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m15:08:52.489088 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m15:08:52.490088 [warn ] [Thread-1 (]: 14 of 28 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 2.34s]
[0m15:08:52.492092 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m15:08:52.493089 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m15:08:52.494129 [info ] [Thread-1 (]: 18 of 28 START test unique_key_scooters_company__model__hardware_id ............ [RUN]
[0m15:08:52.495088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e)
[0m15:08:52.496090 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m15:08:52.508099 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m15:08:52.510101 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m15:08:52.514102 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m15:08:52.516097 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m15:08:52.517104 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: BEGIN
[0m15:08:52.518108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:52.543118 [debug] [Thread-2 (]: SQL status: BEGIN in 1.237 seconds
[0m15:08:52.544116 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m15:08:52.545116 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_gom1"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



      
    ) dbt_internal_test
[0m15:08:52.705797 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.160 seconds
[0m15:08:52.707804 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m15:08:52.709806 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.198 seconds
[0m15:08:52.711805 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: ROLLBACK
[0m15:08:52.779869 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m15:08:52.779869 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: Close
[0m15:08:52.780866 [info ] [Thread-2 (]: 17 of 28 PASS unique_companies_trips_company ................................... [[32mPASS[0m in 1.49s]
[0m15:08:52.781867 [info ] [Thread-3 (]: 15 of 28 PASS source_unique_scooters_raw_trips_id .............................. [[32mPASS[0m in 2.40s]
[0m15:08:52.783868 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m15:08:52.784867 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m15:08:52.785870 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m15:08:52.785870 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m15:08:52.786870 [info ] [Thread-2 (]: 19 of 28 START test unique_key_trips_age_daily_date__age ....................... [RUN]
[0m15:08:52.786870 [info ] [Thread-3 (]: 20 of 28 START test unique_not_null_add_first_name_sex_first_name .............. [RUN]
[0m15:08:52.787876 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0, now test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be)
[0m15:08:52.788879 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4, now test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f)
[0m15:08:52.789877 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m15:08:52.790883 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m15:08:52.797890 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m15:08:52.802891 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m15:08:52.806895 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m15:08:52.806895 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m15:08:52.809899 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m15:08:52.811904 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m15:08:52.813908 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m15:08:52.813908 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m15:08:52.814901 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: BEGIN
[0m15:08:52.815900 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: BEGIN
[0m15:08:52.815900 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:08:52.816905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:08:52.935013 [debug] [Thread-4 (]: SQL status: BEGIN in 2.013 seconds
[0m15:08:52.936015 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m15:08:52.936015 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_gom1"."scooters_raw"."users"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:08:53.011092 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.074 seconds
[0m15:08:53.013094 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: ROLLBACK
[0m15:08:53.085165 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: Close
[0m15:08:53.086161 [info ] [Thread-4 (]: 16 of 28 PASS source_unique_scooters_raw_users_id .............................. [[32mPASS[0m in 2.18s]
[0m15:08:53.087167 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m15:08:53.088175 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m15:08:53.089172 [info ] [Thread-4 (]: 21 of 28 START test unique_not_null_age_groups_age_end ......................... [RUN]
[0m15:08:53.090169 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf, now test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac)
[0m15:08:53.090169 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m15:08:53.096171 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m15:08:53.100186 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m15:08:53.102183 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m15:08:53.104180 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m15:08:53.105181 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: BEGIN
[0m15:08:53.105181 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:08:53.985940 [debug] [Thread-3 (]: SQL status: BEGIN in 1.169 seconds
[0m15:08:53.986941 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m15:08:53.987947 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "first_name"
from
    "dev_gom1"."dbt"."add_first_name_sex"
group by
    1
having
    count(*) > 1 or "first_name" is null


      
    ) dbt_internal_test
[0m15:08:54.059989 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.072 seconds
[0m15:08:54.061996 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: ROLLBACK
[0m15:08:54.134058 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: Close
[0m15:08:54.135063 [info ] [Thread-3 (]: 20 of 28 PASS unique_not_null_add_first_name_sex_first_name .................... [[32mPASS[0m in 1.35s]
[0m15:08:54.137067 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m15:08:54.137067 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m15:08:54.138064 [info ] [Thread-3 (]: 22 of 28 START test unique_not_null_age_groups_age_start ....................... [RUN]
[0m15:08:54.139065 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f, now test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b)
[0m15:08:54.140068 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m15:08:54.144070 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m15:08:54.148076 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m15:08:54.152075 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m15:08:54.154075 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m15:08:54.155081 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: BEGIN
[0m15:08:54.156076 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:08:54.268187 [debug] [Thread-4 (]: SQL status: BEGIN in 1.162 seconds
[0m15:08:54.269194 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m15:08:54.269194 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_end"
from
    "dev_gom1"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_end" is null


      
    ) dbt_internal_test
[0m15:08:54.342755 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.073 seconds
[0m15:08:54.344754 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: ROLLBACK
[0m15:08:54.426797 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: Close
[0m15:08:54.428801 [info ] [Thread-4 (]: 21 of 28 PASS unique_not_null_age_groups_age_end ............................... [[32mPASS[0m in 1.34s]
[0m15:08:54.429807 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m15:08:54.430803 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m15:08:54.430803 [info ] [Thread-4 (]: 23 of 28 START test unique_not_null_age_groups_group ........................... [RUN]
[0m15:08:54.431798 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac, now test.dbt_scooters.unique_not_null_age_groups_group.39342291f1)
[0m15:08:54.432801 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m15:08:54.436799 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m15:08:54.437799 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m15:08:54.440798 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m15:08:54.441798 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m15:08:54.442800 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: BEGIN
[0m15:08:54.442800 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:08:54.734911 [debug] [Thread-2 (]: SQL status: BEGIN in 1.919 seconds
[0m15:08:54.735913 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m15:08:54.736913 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "date"::text ||
    
        "age"::text ||
    
    ''
from
    "dev_gom1"."dbt"."trips_age_daily"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m15:08:54.816938 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.080 seconds
[0m15:08:54.818938 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: ROLLBACK
[0m15:08:54.886971 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: Close
[0m15:08:54.887972 [info ] [Thread-2 (]: 19 of 28 PASS unique_key_trips_age_daily_date__age ............................. [[32mPASS[0m in 2.10s]
[0m15:08:54.889974 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m15:08:54.889974 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m15:08:54.890974 [info ] [Thread-2 (]: 24 of 28 START test unique_not_null_event_types_type ........................... [RUN]
[0m15:08:54.891973 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be, now test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1)
[0m15:08:54.892976 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m15:08:54.896971 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m15:08:54.897971 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m15:08:54.900971 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m15:08:54.901971 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m15:08:54.901971 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: BEGIN
[0m15:08:54.902973 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:08:55.312949 [debug] [Thread-1 (]: SQL status: BEGIN in 2.794 seconds
[0m15:08:55.313949 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m15:08:55.315950 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "company"::text ||
    
        "model"::text ||
    
        "hardware_id"::text ||
    
    ''
from
    "dev_gom1"."dbt"."scooters"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m15:08:55.406100 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.089 seconds
[0m15:08:55.411112 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: ROLLBACK
[0m15:08:55.497779 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: Close
[0m15:08:55.500771 [info ] [Thread-1 (]: 18 of 28 PASS unique_key_scooters_company__model__hardware_id .................. [[32mPASS[0m in 3.00s]
[0m15:08:55.502774 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m15:08:55.504779 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m15:08:55.505779 [info ] [Thread-1 (]: 25 of 28 START test unique_not_null_event_types_type_id ........................ [RUN]
[0m15:08:55.507781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e, now test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85)
[0m15:08:55.508781 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m15:08:55.518782 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m15:08:55.522780 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m15:08:55.528773 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m15:08:55.531775 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m15:08:55.533778 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: BEGIN
[0m15:08:55.534780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:55.624895 [debug] [Thread-4 (]: SQL status: BEGIN in 1.181 seconds
[0m15:08:55.625894 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m15:08:55.626895 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "group"
from
    "dev_gom1"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "group" is null


      
    ) dbt_internal_test
[0m15:08:55.697962 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.070 seconds
[0m15:08:55.700956 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: ROLLBACK
[0m15:08:55.775505 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: Close
[0m15:08:55.778033 [info ] [Thread-4 (]: 23 of 28 PASS unique_not_null_age_groups_group ................................. [[32mPASS[0m in 1.35s]
[0m15:08:55.780038 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m15:08:55.782040 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m15:08:55.784039 [info ] [Thread-4 (]: 26 of 28 START test unique_not_null_scooters_hardware_id ....................... [RUN]
[0m15:08:55.786034 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_group.39342291f1, now test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d)
[0m15:08:55.788040 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m15:08:55.795041 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m15:08:55.800054 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m15:08:55.806051 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m15:08:55.809053 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m15:08:55.811052 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: BEGIN
[0m15:08:55.812051 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:08:56.040674 [debug] [Thread-2 (]: SQL status: BEGIN in 1.137 seconds
[0m15:08:56.041674 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m15:08:56.042675 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type"
from
    "dev_gom1"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type" is null


      
    ) dbt_internal_test
[0m15:08:56.109735 [debug] [Thread-3 (]: SQL status: BEGIN in 1.954 seconds
[0m15:08:56.110735 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m15:08:56.112741 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_start"
from
    "dev_gom1"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_start" is null


      
    ) dbt_internal_test
[0m15:08:56.116739 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.073 seconds
[0m15:08:56.120737 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: ROLLBACK
[0m15:08:56.187785 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.074 seconds
[0m15:08:56.191785 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: ROLLBACK
[0m15:08:56.193788 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: Close
[0m15:08:56.195791 [info ] [Thread-2 (]: 24 of 28 PASS unique_not_null_event_types_type ................................. [[32mPASS[0m in 1.30s]
[0m15:08:56.197790 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m15:08:56.198790 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m15:08:56.199788 [info ] [Thread-2 (]: 27 of 28 START test unique_not_null_scooters_model ............................. [RUN]
[0m15:08:56.200784 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1, now test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc)
[0m15:08:56.201791 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m15:08:56.213784 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m15:08:56.216788 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m15:08:56.293863 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: Close
[0m15:08:56.294864 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m15:08:56.296865 [info ] [Thread-3 (]: 22 of 28 PASS unique_not_null_age_groups_age_start ............................. [[32mPASS[0m in 2.16s]
[0m15:08:56.298866 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m15:08:56.299863 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m15:08:56.301863 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m15:08:56.302865 [info ] [Thread-3 (]: 28 of 28 START test unique_trips_age_daily_date_text_age_text .................. [RUN]
[0m15:08:56.303866 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: BEGIN
[0m15:08:56.304866 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b, now test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e)
[0m15:08:56.305865 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:08:56.306864 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m15:08:56.313867 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m15:08:56.316865 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m15:08:56.322867 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m15:08:56.325869 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m15:08:56.326865 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: BEGIN
[0m15:08:56.327866 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:08:56.631012 [debug] [Thread-1 (]: SQL status: BEGIN in 1.096 seconds
[0m15:08:56.632012 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m15:08:56.633014 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type_id"
from
    "dev_gom1"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type_id" is null


      
    ) dbt_internal_test
[0m15:08:56.706051 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.072 seconds
[0m15:08:56.709050 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: ROLLBACK
[0m15:08:56.777089 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: Close
[0m15:08:56.779104 [info ] [Thread-1 (]: 25 of 28 PASS unique_not_null_event_types_type_id .............................. [[32mPASS[0m in 1.27s]
[0m15:08:56.781103 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m15:08:57.405840 [debug] [Thread-2 (]: SQL status: BEGIN in 1.099 seconds
[0m15:08:57.406842 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m15:08:57.406842 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "model"
from
    "dev_gom1"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "model" is null


      
    ) dbt_internal_test
[0m15:08:57.480873 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.073 seconds
[0m15:08:57.482872 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: ROLLBACK
[0m15:08:57.556873 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: Close
[0m15:08:57.557875 [info ] [Thread-2 (]: 27 of 28 PASS unique_not_null_scooters_model ................................... [[32mPASS[0m in 1.36s]
[0m15:08:57.558874 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m15:08:57.800962 [debug] [Thread-4 (]: SQL status: BEGIN in 1.989 seconds
[0m15:08:57.801964 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m15:08:57.802964 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "hardware_id"
from
    "dev_gom1"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "hardware_id" is null


      
    ) dbt_internal_test
[0m15:08:57.886991 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.084 seconds
[0m15:08:57.888992 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: ROLLBACK
[0m15:08:57.962993 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: Close
[0m15:08:57.963995 [info ] [Thread-4 (]: 26 of 28 PASS unique_not_null_scooters_hardware_id ............................. [[32mPASS[0m in 2.18s]
[0m15:08:57.964993 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m15:08:58.251087 [debug] [Thread-3 (]: SQL status: BEGIN in 1.923 seconds
[0m15:08:58.252089 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m15:08:58.252089 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date::text || age::text as unique_field,
    count(*) as n_records

from "dev_gom1"."dbt"."trips_age_daily"
where date::text || age::text is not null
group by date::text || age::text
having count(*) > 1



      
    ) dbt_internal_test
[0m15:08:58.351114 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.099 seconds
[0m15:08:58.353116 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: ROLLBACK
[0m15:08:58.422144 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: Close
[0m15:08:58.423145 [info ] [Thread-3 (]: 28 of 28 PASS unique_trips_age_daily_date_text_age_text ........................ [[32mPASS[0m in 2.12s]
[0m15:08:58.425150 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m15:08:58.427142 [info ] [MainThread]: 
[0m15:08:58.428148 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:58.429144 [debug] [MainThread]: On master: BEGIN
[0m15:08:58.430147 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:59.807099 [debug] [MainThread]: SQL status: BEGIN in 1.377 seconds
[0m15:08:59.807099 [debug] [MainThread]: On master: COMMIT
[0m15:08:59.808100 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:59.808100 [debug] [MainThread]: On master: COMMIT
[0m15:08:59.877118 [debug] [MainThread]: SQL status: COMMIT in 0.068 seconds
[0m15:08:59.880130 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m15:08:59.885127 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m15:08:59.887131 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:59.888129 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m15:08:59.957134 [debug] [MainThread]: SQL status: GRANT in 0.069 seconds
[0m15:08:59.959137 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.08s]
[0m15:08:59.960146 [debug] [MainThread]: On master: Close
[0m15:08:59.961138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:59.963137 [debug] [MainThread]: Connection 'list_dev_gom1_dbt' was properly closed.
[0m15:08:59.964139 [debug] [MainThread]: Connection 'list_dev_gom1_finance' was properly closed.
[0m15:08:59.965138 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85' was properly closed.
[0m15:08:59.965138 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc' was properly closed.
[0m15:08:59.966140 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e' was properly closed.
[0m15:08:59.966140 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d' was properly closed.
[0m15:08:59.968137 [info ] [MainThread]: 
[0m15:08:59.969136 [info ] [MainThread]: Finished running 1 project hook, 28 data tests in 0 hours 0 minutes and 24.26 seconds (24.26s).
[0m15:08:59.978194 [debug] [MainThread]: Command end result
[0m15:09:00.016714 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m15:09:00.019715 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m15:09:00.029718 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\run_results.json
[0m15:09:00.030714 [info ] [MainThread]: 
[0m15:09:00.031713 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m15:09:00.032711 [info ] [MainThread]: 
[0m15:09:00.033716 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models\properties.yml)[0m
[0m15:09:00.034715 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m15:09:00.035716 [info ] [MainThread]: 
[0m15:09:00.037718 [info ] [MainThread]:   compiled code at target\compiled\dbt_scooters\models\properties.yml\source_not_null_scooters_raw_users_sex.sql
[0m15:09:00.038716 [info ] [MainThread]: 
[0m15:09:00.039715 [info ] [MainThread]: Done. PASS=28 WARN=1 ERROR=0 SKIP=0 TOTAL=29
[0m15:09:00.041713 [debug] [MainThread]: Command `dbt test` succeeded at 15:09:00.041713 after 26.65 seconds
[0m15:09:00.042711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FA3233EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FA5D8DA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FA5D8DCD0>]}
[0m15:09:00.043711 [debug] [MainThread]: Flushing usage events
[0m15:09:00.771684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:32:25.473022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226350E0D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226379D1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263858A4E0>]}


============================== 15:32:25.478990 | 52e66f36-0de7-47bd-b5ac-f08739b7a96d ==============================
[0m15:32:25.478990 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:32:25.480991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': "dbt show --inline select {{ select_first_value('select 111') }} * 2 as result", 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:32:25.780022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52e66f36-0de7-47bd-b5ac-f08739b7a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022637ECC230>]}
[0m15:32:25.873450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52e66f36-0de7-47bd-b5ac-f08739b7a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022638C40050>]}
[0m15:32:25.917994 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:32:26.271719 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:32:26.635497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m15:32:26.636463 [debug] [MainThread]: Partial parsing: added file: dbt_scooters://models\events_clean_v2.sql
[0m15:32:26.637478 [debug] [MainThread]: Partial parsing: added file: dbt_scooters://macros\select_first_value.sql
[0m15:32:26.638460 [debug] [MainThread]: Partial parsing: updated file: dbt_scooters://macros\properties.yml
[0m15:32:27.176890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52e66f36-0de7-47bd-b5ac-f08739b7a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263A289700>]}
[0m15:32:27.377045 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m15:32:27.382794 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m15:32:27.584819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52e66f36-0de7-47bd-b5ac-f08739b7a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022637E6DF10>]}
[0m15:32:27.585818 [info ] [MainThread]: Found 21 models, 28 data tests, 4 seeds, 1 operation, 1 sql operation, 3 sources, 1 exposure, 439 macros
[0m15:32:27.586819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52e66f36-0de7-47bd-b5ac-f08739b7a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263A338680>]}
[0m15:32:27.590818 [info ] [MainThread]: 
[0m15:32:27.592144 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:32:27.593144 [info ] [MainThread]: 
[0m15:32:27.595154 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:32:27.602946 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_dbt'
[0m15:32:27.617853 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_finance'
[0m15:32:27.746987 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m15:32:27.747994 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m15:32:27.747994 [debug] [ThreadPool]: On list_dev_gom1_dbt: BEGIN
[0m15:32:27.748991 [debug] [ThreadPool]: On list_dev_gom1_finance: BEGIN
[0m15:32:27.749997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:27.750997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:29.035478 [debug] [ThreadPool]: SQL status: BEGIN in 1.285 seconds
[0m15:32:29.036441 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m15:32:29.036441 [debug] [ThreadPool]: On list_dev_gom1_finance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_finance"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m15:32:29.114996 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.077 seconds
[0m15:32:29.116997 [debug] [ThreadPool]: On list_dev_gom1_finance: ROLLBACK
[0m15:32:29.187061 [debug] [ThreadPool]: On list_dev_gom1_finance: Close
[0m15:32:29.815947 [debug] [ThreadPool]: SQL status: BEGIN in 2.066 seconds
[0m15:32:29.815947 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m15:32:29.816981 [debug] [ThreadPool]: On list_dev_gom1_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_dbt"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m15:32:29.896706 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.079 seconds
[0m15:32:29.898749 [debug] [ThreadPool]: On list_dev_gom1_dbt: ROLLBACK
[0m15:32:29.969891 [debug] [ThreadPool]: On list_dev_gom1_dbt: Close
[0m15:32:29.979626 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:29.980633 [debug] [MainThread]: On master: BEGIN
[0m15:32:29.980633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:32:31.908684 [debug] [MainThread]: SQL status: BEGIN in 1.928 seconds
[0m15:32:31.909726 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:31.909726 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:32:31.992919 [debug] [MainThread]: SQL status: SELECT 5 in 0.082 seconds
[0m15:32:31.994924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52e66f36-0de7-47bd-b5ac-f08739b7a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263A486270>]}
[0m15:32:31.995962 [debug] [MainThread]: On master: ROLLBACK
[0m15:32:32.069663 [debug] [MainThread]: On master: Close
[0m15:32:32.073839 [debug] [Thread-1 (]: Began running node sql_operation.dbt_scooters.inline_query
[0m15:32:32.074841 [debug] [Thread-1 (]: Acquiring new postgres connection 'sql_operation.dbt_scooters.inline_query'
[0m15:32:32.074841 [debug] [Thread-1 (]: Began compiling node sql_operation.dbt_scooters.inline_query
[0m15:32:32.084609 [debug] [Thread-1 (]: Using postgres connection "sql_operation.dbt_scooters.inline_query"
[0m15:32:32.084609 [debug] [Thread-1 (]: On sql_operation.dbt_scooters.inline_query: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "sql_operation.dbt_scooters.inline_query"} */

    select 111
  
[0m15:32:32.085573 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:32:33.164993 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.079 seconds
[0m15:32:33.166986 [debug] [Thread-1 (]: Writing injected SQL for node "sql_operation.dbt_scooters.inline_query"
[0m15:32:33.170949 [debug] [Thread-1 (]: Began executing node sql_operation.dbt_scooters.inline_query
[0m15:32:33.178744 [debug] [Thread-1 (]: Using postgres connection "sql_operation.dbt_scooters.inline_query"
[0m15:32:33.178744 [debug] [Thread-1 (]: On sql_operation.dbt_scooters.inline_query: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "sql_operation.dbt_scooters.inline_query"} */

  
  select 111 * 2 as result
  
  limit 5

[0m15:32:33.252801 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.073 seconds
[0m15:32:33.255843 [debug] [Thread-1 (]: On sql_operation.dbt_scooters.inline_query: Close
[0m15:32:33.256842 [debug] [Thread-1 (]: Finished running node sql_operation.dbt_scooters.inline_query
[0m15:32:33.258806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:33.258806 [debug] [MainThread]: Connection 'list_dev_gom1_dbt' was properly closed.
[0m15:32:33.259843 [debug] [MainThread]: Connection 'list_dev_gom1_finance' was properly closed.
[0m15:32:33.259843 [debug] [MainThread]: Connection 'sql_operation.dbt_scooters.inline_query' was properly closed.
[0m15:32:33.260811 [debug] [MainThread]: Command end result
[0m15:32:33.294900 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m15:32:33.298894 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m15:32:33.306773 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\run_results.json
[0m15:32:33.306773 [info ] [MainThread]: Previewing inline node:
| result |
| ------ |
|    222 |

[0m15:32:33.308744 [debug] [MainThread]: Command `dbt show` succeeded at 15:32:33.307741 after 8.19 seconds
[0m15:32:33.308744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226385F3020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226385F2900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226385F3440>]}
[0m15:32:33.309780 [debug] [MainThread]: Flushing usage events
[0m15:32:33.893629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:15:18.719860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113D604D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113FE7C110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113FE7C9E0>]}


============================== 16:15:18.725696 | 060ba72e-488e-4f84-a650-7515da7ddd35 ==============================
[0m16:15:18.725696 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:15:18.727662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build -s events_clean_v2', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:15:19.018931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '060ba72e-488e-4f84-a650-7515da7ddd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211405B82C0>]}
[0m16:15:19.110278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '060ba72e-488e-4f84-a650-7515da7ddd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021140543380>]}
[0m16:15:19.112595 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:15:19.434543 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:15:19.790715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 3 files changed.
[0m16:15:19.791729 [debug] [MainThread]: Partial parsing: added file: dbt_scooters://macros\incremental_date_condition.sql
[0m16:15:19.793153 [debug] [MainThread]: Partial parsing: added file: dbt_scooters://macros\get_meta_value.sql
[0m16:15:19.794435 [debug] [MainThread]: Partial parsing: updated file: dbt_scooters://models\properties.yml
[0m16:15:19.795468 [debug] [MainThread]: Partial parsing: updated file: dbt_scooters://macros\properties.yml
[0m16:15:19.796431 [debug] [MainThread]: Partial parsing: updated file: dbt_scooters://models\events_clean_v2.sql
[0m16:15:20.461295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '060ba72e-488e-4f84-a650-7515da7ddd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211406B2A50>]}
[0m16:15:20.664520 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m16:15:20.671487 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m16:15:20.745274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '060ba72e-488e-4f84-a650-7515da7ddd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021141D54CB0>]}
[0m16:15:20.746271 [info ] [MainThread]: Found 21 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 442 macros
[0m16:15:20.751245 [info ] [MainThread]: 
[0m16:15:20.752482 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:15:20.753481 [info ] [MainThread]: 
[0m16:15:20.754480 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:15:20.756514 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m16:15:20.897673 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m16:15:20.898672 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m16:15:20.899673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:22.991619 [debug] [ThreadPool]: SQL status: SELECT 19 in 2.093 seconds
[0m16:15:22.993899 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m16:15:23.000865 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_dbt'
[0m16:15:23.007635 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m16:15:23.008630 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_finance'
[0m16:15:23.008630 [debug] [ThreadPool]: On list_dev_gom1_dbt: BEGIN
[0m16:15:23.010635 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m16:15:23.011634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:23.011634 [debug] [ThreadPool]: On list_dev_gom1_finance: BEGIN
[0m16:15:23.012829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:24.073924 [debug] [ThreadPool]: SQL status: BEGIN in 1.061 seconds
[0m16:15:24.074918 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m16:15:24.074918 [debug] [ThreadPool]: On list_dev_gom1_finance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_finance"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m16:15:24.147157 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.072 seconds
[0m16:15:24.149208 [debug] [ThreadPool]: On list_dev_gom1_finance: ROLLBACK
[0m16:15:24.217791 [debug] [ThreadPool]: On list_dev_gom1_finance: Close
[0m16:15:24.929555 [debug] [ThreadPool]: SQL status: BEGIN in 1.917 seconds
[0m16:15:24.929555 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m16:15:24.930590 [debug] [ThreadPool]: On list_dev_gom1_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_dbt"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:15:25.008453 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.078 seconds
[0m16:15:25.010488 [debug] [ThreadPool]: On list_dev_gom1_dbt: ROLLBACK
[0m16:15:25.081794 [debug] [ThreadPool]: On list_dev_gom1_dbt: Close
[0m16:15:25.092500 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:25.092500 [debug] [MainThread]: On master: BEGIN
[0m16:15:25.093533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:26.200559 [debug] [MainThread]: SQL status: BEGIN in 1.108 seconds
[0m16:15:26.201559 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:26.201559 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:15:26.278572 [debug] [MainThread]: SQL status: SELECT 5 in 0.076 seconds
[0m16:15:26.280573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '060ba72e-488e-4f84-a650-7515da7ddd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021141D3F320>]}
[0m16:15:26.281824 [debug] [MainThread]: On master: ROLLBACK
[0m16:15:26.350926 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:26.350926 [debug] [MainThread]: On master: BEGIN
[0m16:15:26.488279 [debug] [MainThread]: SQL status: BEGIN in 0.136 seconds
[0m16:15:26.489279 [debug] [MainThread]: On master: COMMIT
[0m16:15:26.490279 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:26.490279 [debug] [MainThread]: On master: COMMIT
[0m16:15:26.558440 [debug] [MainThread]: SQL status: COMMIT in 0.067 seconds
[0m16:15:26.559443 [debug] [MainThread]: On master: Close
[0m16:15:26.564235 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean_v2
[0m16:15:26.565237 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.events_clean_v2 ......................... [RUN]
[0m16:15:26.566238 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_scooters.events_clean_v2'
[0m16:15:26.566238 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean_v2
[0m16:15:26.580484 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean_v2"
[0m16:15:26.581740 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean_v2
[0m16:15:26.646329 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean_v2"
[0m16:15:26.647328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m16:15:26.648434 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: BEGIN
[0m16:15:26.648434 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:15:27.802756 [debug] [Thread-1 (]: SQL status: BEGIN in 1.154 seconds
[0m16:15:27.803715 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m16:15:27.804715 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

      
  
    

  create  table "dev_gom1"."dbt"."events_clean_v2"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at
,
    "date"
from
    "dev_gom1"."dbt"."events_prep"
where
    "date" >= date '2023-06-01'
    and "date" < date '2023-06-01' + interval '60 day'
    and "date" <= current_date - interval '1 day'
  );
  
  
[0m16:15:33.418654 [debug] [Thread-1 (]: SQL status: SELECT 219231 in 5.613 seconds
[0m16:15:33.443230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m16:15:33.443230 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

    
  
  comment on table "dev_gom1"."dbt"."events_clean_v2" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m16:15:33.511986 [debug] [Thread-1 (]: SQL status: COMMENT in 0.068 seconds
[0m16:15:33.517537 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: COMMIT
[0m16:15:33.518541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m16:15:33.519501 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: COMMIT
[0m16:15:33.590901 [debug] [Thread-1 (]: SQL status: COMMIT in 0.071 seconds
[0m16:15:33.593652 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: Close
[0m16:15:33.598659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '060ba72e-488e-4f84-a650-7515da7ddd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113D708950>]}
[0m16:15:33.599704 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.events_clean_v2 .................... [[32mSELECT 219231[0m in 7.03s]
[0m16:15:33.600661 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean_v2
[0m16:15:33.601658 [info ] [MainThread]: 
[0m16:15:33.602882 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:33.603877 [debug] [MainThread]: On master: BEGIN
[0m16:15:33.603877 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:15:35.556027 [debug] [MainThread]: SQL status: BEGIN in 1.952 seconds
[0m16:15:35.557022 [debug] [MainThread]: On master: COMMIT
[0m16:15:35.558028 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:35.558028 [debug] [MainThread]: On master: COMMIT
[0m16:15:35.630602 [debug] [MainThread]: SQL status: COMMIT in 0.072 seconds
[0m16:15:35.632883 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m16:15:35.638882 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m16:15:35.639881 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:35.640882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m16:15:35.718741 [debug] [MainThread]: SQL status: GRANT in 0.077 seconds
[0m16:15:35.719738 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.09s]
[0m16:15:35.720734 [debug] [MainThread]: On master: Close
[0m16:15:35.721696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:35.721696 [debug] [MainThread]: Connection 'list_dev_gom1' was properly closed.
[0m16:15:35.723483 [debug] [MainThread]: Connection 'list_dev_gom1_dbt' was properly closed.
[0m16:15:35.723483 [debug] [MainThread]: Connection 'list_dev_gom1_finance' was properly closed.
[0m16:15:35.723483 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean_v2' was properly closed.
[0m16:15:35.724491 [info ] [MainThread]: 
[0m16:15:35.725493 [info ] [MainThread]: Finished running 1 incremental model, 1 project hook in 0 hours 0 minutes and 14.97 seconds (14.97s).
[0m16:15:35.726492 [debug] [MainThread]: Command end result
[0m16:15:35.760254 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m16:15:35.763539 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m16:15:35.770497 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\run_results.json
[0m16:15:35.770497 [info ] [MainThread]: 
[0m16:15:35.771713 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:15:35.773221 [info ] [MainThread]: 
[0m16:15:35.774234 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:15:35.776235 [debug] [MainThread]: Command `dbt build` succeeded at 16:15:35.775231 after 17.72 seconds
[0m16:15:35.776235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113F880260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021141917440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021141D3EF00>]}
[0m16:15:35.777230 [debug] [MainThread]: Flushing usage events
[0m16:15:36.471597 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:44.054763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BBA5E87A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BB7410290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BBA935D30>]}


============================== 16:20:44.060763 | 2261b3d5-cde0-4fa4-809a-0108ad06ffc1 ==============================
[0m16:20:44.060763 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:20:44.060763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -s events_clean_v2', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:20:44.370737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2261b3d5-cde0-4fa4-809a-0108ad06ffc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BBACB5700>]}
[0m16:20:44.467695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2261b3d5-cde0-4fa4-809a-0108ad06ffc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BB9C935F0>]}
[0m16:20:44.468663 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:20:44.826754 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:20:45.187618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:45.188618 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:45.307470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2261b3d5-cde0-4fa4-809a-0108ad06ffc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BBAE1BE90>]}
[0m16:20:45.514407 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m16:20:45.520408 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m16:20:45.588725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2261b3d5-cde0-4fa4-809a-0108ad06ffc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BBC4F7650>]}
[0m16:20:45.589727 [info ] [MainThread]: Found 21 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 442 macros
[0m16:20:45.595518 [info ] [MainThread]: 
[0m16:20:45.596527 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:20:45.597524 [info ] [MainThread]: 
[0m16:20:45.598523 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:45.600521 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m16:20:45.743547 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m16:20:45.744545 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m16:20:45.745545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:47.901369 [debug] [ThreadPool]: SQL status: SELECT 19 in 2.156 seconds
[0m16:20:47.903586 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m16:20:47.909546 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_dbt'
[0m16:20:47.916799 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m16:20:47.916799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_finance'
[0m16:20:47.917800 [debug] [ThreadPool]: On list_dev_gom1_dbt: BEGIN
[0m16:20:47.919798 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m16:20:47.919798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:47.920811 [debug] [ThreadPool]: On list_dev_gom1_finance: BEGIN
[0m16:20:47.920811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:49.060725 [debug] [ThreadPool]: SQL status: BEGIN in 1.140 seconds
[0m16:20:49.062229 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m16:20:49.062229 [debug] [ThreadPool]: On list_dev_gom1_finance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_finance"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m16:20:49.141339 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.077 seconds
[0m16:20:49.142594 [debug] [ThreadPool]: On list_dev_gom1_finance: ROLLBACK
[0m16:20:49.216738 [debug] [ThreadPool]: On list_dev_gom1_finance: Close
[0m16:20:50.714636 [debug] [ThreadPool]: SQL status: BEGIN in 2.794 seconds
[0m16:20:50.714636 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m16:20:50.715639 [debug] [ThreadPool]: On list_dev_gom1_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_dbt"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:20:50.792462 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.076 seconds
[0m16:20:50.794509 [debug] [ThreadPool]: On list_dev_gom1_dbt: ROLLBACK
[0m16:20:50.866816 [debug] [ThreadPool]: On list_dev_gom1_dbt: Close
[0m16:20:50.878472 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:50.879477 [debug] [MainThread]: On master: BEGIN
[0m16:20:50.879477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:52.815312 [debug] [MainThread]: SQL status: BEGIN in 1.935 seconds
[0m16:20:52.816361 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:52.816361 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:52.897682 [debug] [MainThread]: SQL status: SELECT 5 in 0.080 seconds
[0m16:20:52.900645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2261b3d5-cde0-4fa4-809a-0108ad06ffc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BBCB32480>]}
[0m16:20:52.900645 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:52.972429 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:52.973475 [debug] [MainThread]: On master: BEGIN
[0m16:20:53.118364 [debug] [MainThread]: SQL status: BEGIN in 0.144 seconds
[0m16:20:53.118364 [debug] [MainThread]: On master: COMMIT
[0m16:20:53.119405 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:53.119405 [debug] [MainThread]: On master: COMMIT
[0m16:20:53.192622 [debug] [MainThread]: SQL status: COMMIT in 0.073 seconds
[0m16:20:53.193663 [debug] [MainThread]: On master: Close
[0m16:20:53.197622 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean_v2
[0m16:20:53.198664 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.events_clean_v2 ......................... [RUN]
[0m16:20:53.199623 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_scooters.events_clean_v2'
[0m16:20:53.200622 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean_v2
[0m16:20:53.231344 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m16:20:53.231344 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

    select max("date") + interval '1 day' from "dev_gom1"."dbt"."events_clean_v2"
  
[0m16:20:53.232609 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:20:54.635753 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.403 seconds
[0m16:20:54.636753 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean_v2"
[0m16:20:54.638715 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean_v2
[0m16:20:54.698651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m16:20:54.698651 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

    
  
    

  create temporary table "events_clean_v2__dbt_tmp162054672329"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at
,
    "date"
from
    "dev_gom1"."dbt"."events_prep"
where
    "date" >= date '2023-07-31 00:00:00'
    and "date" < date '2023-07-31 00:00:00' + interval '60 day'
    and "date" <= current_date - interval '1 day'
  );
  
  
[0m16:20:57.028509 [debug] [Thread-1 (]: SQL status: SELECT 103516 in 2.329 seconds
[0m16:20:57.046551 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m16:20:57.047523 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: BEGIN
[0m16:20:57.117504 [debug] [Thread-1 (]: SQL status: BEGIN in 0.069 seconds
[0m16:20:57.118460 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m16:20:57.119459 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean_v2__dbt_tmp162054672329'
        
      order by ordinal_position

  
[0m16:20:57.200260 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.080 seconds
[0m16:20:57.206526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m16:20:57.207487 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean_v2'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:20:57.284461 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.077 seconds
[0m16:20:57.305538 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m16:20:57.306496 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean_v2__dbt_tmp162054672329'
        
      order by ordinal_position

  
[0m16:20:57.402410 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.096 seconds
[0m16:20:57.406418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m16:20:57.407457 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean_v2'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:20:57.493407 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.085 seconds
[0m16:20:57.504585 [debug] [Thread-1 (]: 
    In "dev_gom1"."dbt"."events_clean_v2":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:20:57.526534 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean_v2"
[0m16:20:57.527538 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m16:20:57.528540 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

      
        
            delete from "dev_gom1"."dbt"."events_clean_v2"
            using "events_clean_v2__dbt_tmp162054672329"
            where (
                
                    "events_clean_v2__dbt_tmp162054672329".user_id = "dev_gom1"."dbt"."events_clean_v2".user_id
                    and 
                
                    "events_clean_v2__dbt_tmp162054672329".timestamp = "dev_gom1"."dbt"."events_clean_v2".timestamp
                    and 
                
                    "events_clean_v2__dbt_tmp162054672329".type_id = "dev_gom1"."dbt"."events_clean_v2".type_id
                    
                
                
            );
        
    

    insert into "dev_gom1"."dbt"."events_clean_v2" ("user_id", "timestamp", "type_id", "updated_at", "date")
    (
        select "user_id", "timestamp", "type_id", "updated_at", "date"
        from "events_clean_v2__dbt_tmp162054672329"
    )
  
[0m16:21:00.600968 [debug] [Thread-1 (]: SQL status: INSERT 0 103516 in 3.071 seconds
[0m16:21:00.622657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m16:21:00.623657 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

    
  
  comment on table "dev_gom1"."dbt"."events_clean_v2" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m16:21:00.694751 [debug] [Thread-1 (]: SQL status: COMMENT in 0.071 seconds
[0m16:21:00.696754 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: COMMIT
[0m16:21:00.697747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m16:21:00.697747 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: COMMIT
[0m16:21:00.838453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.140 seconds
[0m16:21:00.841411 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: Close
[0m16:21:00.843747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2261b3d5-cde0-4fa4-809a-0108ad06ffc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BB7F68950>]}
[0m16:21:00.844749 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.events_clean_v2 .................... [[32mINSERT 0 103516[0m in 7.64s]
[0m16:21:00.846710 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean_v2
[0m16:21:00.848710 [info ] [MainThread]: 
[0m16:21:00.849708 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:00.849708 [debug] [MainThread]: On master: BEGIN
[0m16:21:00.850709 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:02.760964 [debug] [MainThread]: SQL status: BEGIN in 1.911 seconds
[0m16:21:02.762472 [debug] [MainThread]: On master: COMMIT
[0m16:21:02.762472 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:02.763744 [debug] [MainThread]: On master: COMMIT
[0m16:21:02.834393 [debug] [MainThread]: SQL status: COMMIT in 0.070 seconds
[0m16:21:02.836394 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m16:21:02.843647 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m16:21:02.844614 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:02.844614 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m16:21:02.916640 [debug] [MainThread]: SQL status: GRANT in 0.071 seconds
[0m16:21:02.917641 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.08s]
[0m16:21:02.918640 [debug] [MainThread]: On master: Close
[0m16:21:02.919642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:02.920641 [debug] [MainThread]: Connection 'list_dev_gom1' was properly closed.
[0m16:21:02.920641 [debug] [MainThread]: Connection 'list_dev_gom1_dbt' was properly closed.
[0m16:21:02.920641 [debug] [MainThread]: Connection 'list_dev_gom1_finance' was properly closed.
[0m16:21:02.922149 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean_v2' was properly closed.
[0m16:21:02.922149 [info ] [MainThread]: 
[0m16:21:02.923395 [info ] [MainThread]: Finished running 1 incremental model, 1 project hook in 0 hours 0 minutes and 17.32 seconds (17.32s).
[0m16:21:02.925370 [debug] [MainThread]: Command end result
[0m16:21:02.968476 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m16:21:02.971782 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m16:21:02.980748 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\run_results.json
[0m16:21:02.980748 [info ] [MainThread]: 
[0m16:21:02.980748 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:21:02.982404 [info ] [MainThread]: 
[0m16:21:02.984414 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:21:02.985420 [debug] [MainThread]: Command `dbt build` succeeded at 16:21:02.985420 after 19.31 seconds
[0m16:21:02.986420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BB9C148F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BBA5C21B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BB756AC60>]}
[0m16:21:02.987419 [debug] [MainThread]: Flushing usage events
[0m16:21:03.719763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:06.367861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025036454E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250390075C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025039004E30>]}


============================== 17:50:06.374082 | 0677ab6b-5bb8-4e4e-8b0e-8dcb79992556 ==============================
[0m17:50:06.374082 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:50:06.375590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -s events_clean_v2 --vars {start_date: 2023-07-01, days_max: 31}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:50:06.694801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0677ab6b-5bb8-4e4e-8b0e-8dcb79992556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025039273D10>]}
[0m17:50:06.796902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0677ab6b-5bb8-4e4e-8b0e-8dcb79992556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250386D0EC0>]}
[0m17:50:06.798905 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:50:07.146614 [debug] [MainThread]: checksum: bf1612b036eb6d931b30490d4e56e54075eae3a474d972264a6576f7240b6a5e, vars: {'days_max': 31, 'start_date': datetime.date(2023, 7, 1)}, profile: , target: , version: 1.9.2
[0m17:50:07.380833 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:50:07.382158 [debug] [MainThread]: previous checksum: bf1612b036eb6d931b30490d4e56e54075eae3a474d972264a6576f7240b6a5e, current checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18
[0m17:50:07.383123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0677ab6b-5bb8-4e4e-8b0e-8dcb79992556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002503A7CE210>]}
[0m17:50:10.376466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0677ab6b-5bb8-4e4e-8b0e-8dcb79992556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002503A9CAE70>]}
[0m17:50:10.578837 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m17:50:10.643150 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m17:50:10.714720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0677ab6b-5bb8-4e4e-8b0e-8dcb79992556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002503A9CD280>]}
[0m17:50:10.715718 [info ] [MainThread]: Found 21 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 442 macros
[0m17:50:10.720259 [info ] [MainThread]: 
[0m17:50:10.721268 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:50:10.722470 [info ] [MainThread]: 
[0m17:50:10.723471 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:50:10.725504 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m17:50:10.922102 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m17:50:10.923310 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m17:50:10.923310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:12.665521 [debug] [ThreadPool]: SQL status: SELECT 19 in 1.742 seconds
[0m17:50:12.667569 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m17:50:12.674735 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_finance'
[0m17:50:12.680778 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m17:50:12.682064 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_dbt'
[0m17:50:12.683059 [debug] [ThreadPool]: On list_dev_gom1_finance: BEGIN
[0m17:50:12.684069 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m17:50:12.685615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:12.686621 [debug] [ThreadPool]: On list_dev_gom1_dbt: BEGIN
[0m17:50:12.686621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:14.764714 [debug] [ThreadPool]: SQL status: BEGIN in 2.078 seconds
[0m17:50:14.765678 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m17:50:14.766677 [debug] [ThreadPool]: On list_dev_gom1_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_dbt"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m17:50:14.865862 [debug] [ThreadPool]: SQL status: BEGIN in 2.180 seconds
[0m17:50:14.866861 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m17:50:14.867860 [debug] [ThreadPool]: On list_dev_gom1_finance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_finance"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m17:50:14.888613 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.122 seconds
[0m17:50:14.890611 [debug] [ThreadPool]: On list_dev_gom1_dbt: ROLLBACK
[0m17:50:14.973793 [debug] [ThreadPool]: On list_dev_gom1_dbt: Close
[0m17:50:14.978794 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.111 seconds
[0m17:50:14.980791 [debug] [ThreadPool]: On list_dev_gom1_finance: ROLLBACK
[0m17:50:15.055474 [debug] [ThreadPool]: On list_dev_gom1_finance: Close
[0m17:50:15.062731 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:15.062731 [debug] [MainThread]: On master: BEGIN
[0m17:50:15.063693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:16.159809 [debug] [MainThread]: SQL status: BEGIN in 1.096 seconds
[0m17:50:16.160810 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:16.160810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:50:16.285626 [debug] [MainThread]: SQL status: SELECT 5 in 0.123 seconds
[0m17:50:16.287673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0677ab6b-5bb8-4e4e-8b0e-8dcb79992556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002503AC6B5C0>]}
[0m17:50:16.288666 [debug] [MainThread]: On master: ROLLBACK
[0m17:50:16.363681 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:16.364680 [debug] [MainThread]: On master: BEGIN
[0m17:50:16.508839 [debug] [MainThread]: SQL status: BEGIN in 0.143 seconds
[0m17:50:16.508839 [debug] [MainThread]: On master: COMMIT
[0m17:50:16.509840 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:16.509840 [debug] [MainThread]: On master: COMMIT
[0m17:50:16.583999 [debug] [MainThread]: SQL status: COMMIT in 0.074 seconds
[0m17:50:16.585506 [debug] [MainThread]: On master: Close
[0m17:50:16.590516 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean_v2
[0m17:50:16.592772 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.events_clean_v2 ......................... [RUN]
[0m17:50:16.594732 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_scooters.events_clean_v2'
[0m17:50:16.595735 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean_v2
[0m17:50:16.606617 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean_v2"
[0m17:50:16.607576 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean_v2
[0m17:50:16.679698 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:50:16.680696 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

    
  
    

  create temporary table "events_clean_v2__dbt_tmp175016645655"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at
,
    "date"
from
    "dev_gom1"."dbt"."events_prep"
where
    "date" >= date '2023-07-01'
    and "date" < date '2023-07-01' + interval '31 day'
    and "date" <= current_date - interval '1 day'
  );
  
  
[0m17:50:16.681699 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:50:21.392895 [debug] [Thread-1 (]: SQL status: SELECT 109117 in 4.711 seconds
[0m17:50:21.406656 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:50:21.407659 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: BEGIN
[0m17:50:21.480847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m17:50:21.480847 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:50:21.482111 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean_v2__dbt_tmp175016645655'
        
      order by ordinal_position

  
[0m17:50:21.561970 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.079 seconds
[0m17:50:21.568535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:50:21.568535 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean_v2'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:50:21.643857 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.074 seconds
[0m17:50:21.657631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:50:21.658630 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean_v2__dbt_tmp175016645655'
        
      order by ordinal_position

  
[0m17:50:21.740971 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.081 seconds
[0m17:50:21.744105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:50:21.744105 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean_v2'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:50:21.823196 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.078 seconds
[0m17:50:21.832537 [debug] [Thread-1 (]: 
    In "dev_gom1"."dbt"."events_clean_v2":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:50:21.850679 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean_v2"
[0m17:50:21.853895 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:50:21.853895 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

      
        
            delete from "dev_gom1"."dbt"."events_clean_v2"
            using "events_clean_v2__dbt_tmp175016645655"
            where (
                
                    "events_clean_v2__dbt_tmp175016645655".user_id = "dev_gom1"."dbt"."events_clean_v2".user_id
                    and 
                
                    "events_clean_v2__dbt_tmp175016645655".timestamp = "dev_gom1"."dbt"."events_clean_v2".timestamp
                    and 
                
                    "events_clean_v2__dbt_tmp175016645655".type_id = "dev_gom1"."dbt"."events_clean_v2".type_id
                    
                
                
            );
        
    

    insert into "dev_gom1"."dbt"."events_clean_v2" ("user_id", "timestamp", "type_id", "updated_at", "date")
    (
        select "user_id", "timestamp", "type_id", "updated_at", "date"
        from "events_clean_v2__dbt_tmp175016645655"
    )
  
[0m17:50:26.798806 [debug] [Thread-1 (]: SQL status: INSERT 0 109117 in 4.944 seconds
[0m17:50:26.821411 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:50:26.821411 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

    
  
  comment on table "dev_gom1"."dbt"."events_clean_v2" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m17:50:26.894789 [debug] [Thread-1 (]: SQL status: COMMENT in 0.073 seconds
[0m17:50:26.896780 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: COMMIT
[0m17:50:26.897780 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:50:26.897780 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: COMMIT
[0m17:50:26.975477 [debug] [Thread-1 (]: SQL status: COMMIT in 0.077 seconds
[0m17:50:26.977525 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: Close
[0m17:50:26.980524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0677ab6b-5bb8-4e4e-8b0e-8dcb79992556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025036558BF0>]}
[0m17:50:26.981800 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.events_clean_v2 .................... [[32mINSERT 0 109117[0m in 10.38s]
[0m17:50:26.982800 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean_v2
[0m17:50:26.984805 [info ] [MainThread]: 
[0m17:50:26.985801 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:26.985801 [debug] [MainThread]: On master: BEGIN
[0m17:50:26.986800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:28.171561 [debug] [MainThread]: SQL status: BEGIN in 1.185 seconds
[0m17:50:28.172764 [debug] [MainThread]: On master: COMMIT
[0m17:50:28.172764 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:28.173764 [debug] [MainThread]: On master: COMMIT
[0m17:50:28.245621 [debug] [MainThread]: SQL status: COMMIT in 0.072 seconds
[0m17:50:28.249576 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m17:50:28.256789 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m17:50:28.257790 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:28.257790 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m17:50:28.331599 [debug] [MainThread]: SQL status: GRANT in 0.073 seconds
[0m17:50:28.332776 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.08s]
[0m17:50:28.333807 [debug] [MainThread]: On master: Close
[0m17:50:28.335315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:28.335315 [debug] [MainThread]: Connection 'list_dev_gom1' was properly closed.
[0m17:50:28.335315 [debug] [MainThread]: Connection 'list_dev_gom1_finance' was properly closed.
[0m17:50:28.336324 [debug] [MainThread]: Connection 'list_dev_gom1_dbt' was properly closed.
[0m17:50:28.337325 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean_v2' was properly closed.
[0m17:50:28.337325 [info ] [MainThread]: 
[0m17:50:28.338327 [info ] [MainThread]: Finished running 1 incremental model, 1 project hook in 0 hours 0 minutes and 17.61 seconds (17.61s).
[0m17:50:28.340361 [debug] [MainThread]: Command end result
[0m17:50:28.376742 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m17:50:28.379779 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m17:50:28.387461 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\run_results.json
[0m17:50:28.388463 [info ] [MainThread]: 
[0m17:50:28.389467 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:28.390461 [info ] [MainThread]: 
[0m17:50:28.391462 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:50:28.392666 [debug] [MainThread]: Command `dbt build` succeeded at 17:50:28.392666 after 22.39 seconds
[0m17:50:28.393666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025036454E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025039134260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025039134C50>]}
[0m17:50:28.393666 [debug] [MainThread]: Flushing usage events
[0m17:50:29.006753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:52:17.549089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480AE38830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480AD7C440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480ABC8680>]}


============================== 17:52:17.554381 | b7b5b410-0666-460b-8a91-2b9675d62da4 ==============================
[0m17:52:17.554381 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:52:17.556414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build -s events_clean_v2 --vars date: 2023-08-30', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:52:17.860402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7b5b410-0666-460b-8a91-2b9675d62da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480B6E1280>]}
[0m17:52:17.951543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7b5b410-0666-460b-8a91-2b9675d62da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480B5A4410>]}
[0m17:52:17.953841 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:52:18.285218 [debug] [MainThread]: checksum: 5cf6d216e2ad153ab7d1a1a0099223ded061616e138a6e2ed704bf28e9386a31, vars: {'date': datetime.date(2023, 8, 30)}, profile: , target: , version: 1.9.2
[0m17:52:18.518197 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:52:18.519155 [debug] [MainThread]: previous checksum: 5cf6d216e2ad153ab7d1a1a0099223ded061616e138a6e2ed704bf28e9386a31, current checksum: bf1612b036eb6d931b30490d4e56e54075eae3a474d972264a6576f7240b6a5e
[0m17:52:18.520194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b7b5b410-0666-460b-8a91-2b9675d62da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480CCB5B80>]}
[0m17:52:21.435281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7b5b410-0666-460b-8a91-2b9675d62da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480CEC3770>]}
[0m17:52:21.630177 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m17:52:21.636428 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m17:52:21.702485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7b5b410-0666-460b-8a91-2b9675d62da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480CB58B90>]}
[0m17:52:21.703454 [info ] [MainThread]: Found 21 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 442 macros
[0m17:52:21.707482 [info ] [MainThread]: 
[0m17:52:21.709450 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:52:21.709450 [info ] [MainThread]: 
[0m17:52:21.710450 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:52:21.712715 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m17:52:21.846573 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m17:52:21.847557 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m17:52:21.847557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:23.011701 [debug] [ThreadPool]: SQL status: SELECT 19 in 1.164 seconds
[0m17:52:23.013693 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m17:52:23.021213 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_finance'
[0m17:52:23.028028 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m17:52:23.029030 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_dbt'
[0m17:52:23.029030 [debug] [ThreadPool]: On list_dev_gom1_finance: BEGIN
[0m17:52:23.031063 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m17:52:23.032355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:23.032355 [debug] [ThreadPool]: On list_dev_gom1_dbt: BEGIN
[0m17:52:23.033314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:24.758370 [debug] [ThreadPool]: SQL status: BEGIN in 1.726 seconds
[0m17:52:24.759369 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m17:52:24.759369 [debug] [ThreadPool]: On list_dev_gom1_finance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_finance"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m17:52:24.837366 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.077 seconds
[0m17:52:24.839364 [debug] [ThreadPool]: On list_dev_gom1_finance: ROLLBACK
[0m17:52:24.912660 [debug] [ThreadPool]: On list_dev_gom1_finance: Close
[0m17:52:25.042189 [debug] [ThreadPool]: SQL status: BEGIN in 2.009 seconds
[0m17:52:25.043185 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m17:52:25.044142 [debug] [ThreadPool]: On list_dev_gom1_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_dbt"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m17:52:25.119428 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.075 seconds
[0m17:52:25.122032 [debug] [ThreadPool]: On list_dev_gom1_dbt: ROLLBACK
[0m17:52:25.193646 [debug] [ThreadPool]: On list_dev_gom1_dbt: Close
[0m17:52:25.204360 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:25.204360 [debug] [MainThread]: On master: BEGIN
[0m17:52:25.205399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:26.271240 [debug] [MainThread]: SQL status: BEGIN in 1.066 seconds
[0m17:52:26.271240 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:26.272435 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:52:26.348269 [debug] [MainThread]: SQL status: SELECT 5 in 0.075 seconds
[0m17:52:26.350227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7b5b410-0666-460b-8a91-2b9675d62da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480D851880>]}
[0m17:52:26.351226 [debug] [MainThread]: On master: ROLLBACK
[0m17:52:26.419424 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:26.420375 [debug] [MainThread]: On master: BEGIN
[0m17:52:26.558107 [debug] [MainThread]: SQL status: BEGIN in 0.138 seconds
[0m17:52:26.559101 [debug] [MainThread]: On master: COMMIT
[0m17:52:26.560101 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:26.560101 [debug] [MainThread]: On master: COMMIT
[0m17:52:26.629173 [debug] [MainThread]: SQL status: COMMIT in 0.069 seconds
[0m17:52:26.630171 [debug] [MainThread]: On master: Close
[0m17:52:26.634373 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean_v2
[0m17:52:26.636374 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.events_clean_v2 ......................... [RUN]
[0m17:52:26.637377 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_scooters.events_clean_v2'
[0m17:52:26.638415 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean_v2
[0m17:52:26.648290 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean_v2"
[0m17:52:26.650254 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean_v2
[0m17:52:26.712436 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:52:26.713393 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

    
  
    

  create temporary table "events_clean_v2__dbt_tmp175226683101"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at
,
    "date"
from
    "dev_gom1"."dbt"."events_prep"
where
    "date" = date '2023-08-30'
  );
  
  
[0m17:52:26.713393 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:52:30.027250 [debug] [Thread-1 (]: SQL status: SELECT 3768 in 3.314 seconds
[0m17:52:30.041169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:52:30.042459 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: BEGIN
[0m17:52:30.112445 [debug] [Thread-1 (]: SQL status: BEGIN in 0.070 seconds
[0m17:52:30.113441 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:52:30.113441 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean_v2__dbt_tmp175226683101'
        
      order by ordinal_position

  
[0m17:52:30.217287 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.103 seconds
[0m17:52:30.222584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:52:30.223586 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean_v2'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:52:30.297306 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.073 seconds
[0m17:52:30.311210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:52:30.312484 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean_v2__dbt_tmp175226683101'
        
      order by ordinal_position

  
[0m17:52:30.393454 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.081 seconds
[0m17:52:30.398012 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:52:30.398012 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_gom1".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean_v2'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m17:52:30.473624 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.075 seconds
[0m17:52:30.484348 [debug] [Thread-1 (]: 
    In "dev_gom1"."dbt"."events_clean_v2":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:52:30.502558 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean_v2"
[0m17:52:30.503516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:52:30.505023 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

      
        
            delete from "dev_gom1"."dbt"."events_clean_v2"
            using "events_clean_v2__dbt_tmp175226683101"
            where (
                
                    "events_clean_v2__dbt_tmp175226683101".user_id = "dev_gom1"."dbt"."events_clean_v2".user_id
                    and 
                
                    "events_clean_v2__dbt_tmp175226683101".timestamp = "dev_gom1"."dbt"."events_clean_v2".timestamp
                    and 
                
                    "events_clean_v2__dbt_tmp175226683101".type_id = "dev_gom1"."dbt"."events_clean_v2".type_id
                    
                
                
            );
        
    

    insert into "dev_gom1"."dbt"."events_clean_v2" ("user_id", "timestamp", "type_id", "updated_at", "date")
    (
        select "user_id", "timestamp", "type_id", "updated_at", "date"
        from "events_clean_v2__dbt_tmp175226683101"
    )
  
[0m17:52:32.290373 [debug] [Thread-1 (]: SQL status: INSERT 0 3768 in 1.785 seconds
[0m17:52:32.313379 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:52:32.314336 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean_v2"} */

    
  
  comment on table "dev_gom1"."dbt"."events_clean_v2" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m17:52:32.382666 [debug] [Thread-1 (]: SQL status: COMMENT in 0.068 seconds
[0m17:52:32.385209 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: COMMIT
[0m17:52:32.385209 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean_v2"
[0m17:52:32.386214 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: COMMIT
[0m17:52:32.459122 [debug] [Thread-1 (]: SQL status: COMMIT in 0.073 seconds
[0m17:52:32.461119 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean_v2: Close
[0m17:52:32.464356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b5b410-0666-460b-8a91-2b9675d62da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248089C8AA0>]}
[0m17:52:32.465396 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.events_clean_v2 .................... [[32mINSERT 0 3768[0m in 5.83s]
[0m17:52:32.466421 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean_v2
[0m17:52:32.468353 [info ] [MainThread]: 
[0m17:52:32.469395 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:32.470355 [debug] [MainThread]: On master: BEGIN
[0m17:52:32.470355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:52:33.558526 [debug] [MainThread]: SQL status: BEGIN in 1.088 seconds
[0m17:52:33.559479 [debug] [MainThread]: On master: COMMIT
[0m17:52:33.559479 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:33.560479 [debug] [MainThread]: On master: COMMIT
[0m17:52:33.629310 [debug] [MainThread]: SQL status: COMMIT in 0.069 seconds
[0m17:52:33.631262 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m17:52:33.638096 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m17:52:33.639096 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:33.640091 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m17:52:33.710245 [debug] [MainThread]: SQL status: GRANT in 0.069 seconds
[0m17:52:33.712434 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.08s]
[0m17:52:33.712434 [debug] [MainThread]: On master: Close
[0m17:52:33.713433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:33.714937 [debug] [MainThread]: Connection 'list_dev_gom1' was properly closed.
[0m17:52:33.715947 [debug] [MainThread]: Connection 'list_dev_gom1_finance' was properly closed.
[0m17:52:33.716948 [debug] [MainThread]: Connection 'list_dev_gom1_dbt' was properly closed.
[0m17:52:33.716948 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean_v2' was properly closed.
[0m17:52:33.716948 [info ] [MainThread]: 
[0m17:52:33.717947 [info ] [MainThread]: Finished running 1 incremental model, 1 project hook in 0 hours 0 minutes and 12.01 seconds (12.01s).
[0m17:52:33.719985 [debug] [MainThread]: Command end result
[0m17:52:33.754187 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m17:52:33.758194 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m17:52:33.764989 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\run_results.json
[0m17:52:33.766001 [info ] [MainThread]: 
[0m17:52:33.767001 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:52:33.768002 [info ] [MainThread]: 
[0m17:52:33.769000 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:52:33.770002 [debug] [MainThread]: Command `dbt build` succeeded at 17:52:33.770002 after 16.57 seconds
[0m17:52:33.771004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480B0CD130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480AE208F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480928A540>]}
[0m17:52:33.772197 [debug] [MainThread]: Flushing usage events
[0m17:52:34.466282 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:57.500415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AB1BA660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150ABD025D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150ABD03530>]}


============================== 18:05:57.505650 | ad4d0404-ea13-4ea8-8c4b-27524c075551 ==============================
[0m18:05:57.505650 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:05:57.507619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -s events_full', 'send_anonymous_usage_stats': 'True'}
[0m18:05:57.816428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad4d0404-ea13-4ea8-8c4b-27524c075551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150ABEA5310>]}
[0m18:05:57.909722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad4d0404-ea13-4ea8-8c4b-27524c075551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AB2D2540>]}
[0m18:05:57.910722 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:05:58.244152 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:05:58.473730 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:05:58.474722 [debug] [MainThread]: previous checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, current checksum: 5cf6d216e2ad153ab7d1a1a0099223ded061616e138a6e2ed704bf28e9386a31
[0m18:05:58.475686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ad4d0404-ea13-4ea8-8c4b-27524c075551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AC0ABE00>]}
[0m18:06:01.894354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad4d0404-ea13-4ea8-8c4b-27524c075551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AD879610>]}
[0m18:06:02.130651 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m18:06:02.137550 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m18:06:02.217591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad4d0404-ea13-4ea8-8c4b-27524c075551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AD6123C0>]}
[0m18:06:02.219589 [info ] [MainThread]: Found 21 models, 29 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 443 macros
[0m18:06:02.226475 [info ] [MainThread]: 
[0m18:06:02.227484 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:06:02.228484 [info ] [MainThread]: 
[0m18:06:02.230813 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:06:02.233815 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m18:06:02.416387 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m18:06:02.416387 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m18:06:02.417390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:05.630566 [debug] [ThreadPool]: SQL status: SELECT 19 in 3.212 seconds
[0m18:06:05.632122 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m18:06:05.638382 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_finance'
[0m18:06:05.645678 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m18:06:05.646633 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_dbt'
[0m18:06:05.646633 [debug] [ThreadPool]: On list_dev_gom1_finance: BEGIN
[0m18:06:05.648672 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m18:06:05.649674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:05.650674 [debug] [ThreadPool]: On list_dev_gom1_dbt: BEGIN
[0m18:06:05.650674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:06.729409 [debug] [ThreadPool]: SQL status: BEGIN in 1.079 seconds
[0m18:06:06.730364 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m18:06:06.730364 [debug] [ThreadPool]: On list_dev_gom1_finance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_finance"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m18:06:06.789474 [debug] [ThreadPool]: SQL status: BEGIN in 1.138 seconds
[0m18:06:06.790430 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m18:06:06.790430 [debug] [ThreadPool]: On list_dev_gom1_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_dbt"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m18:06:06.802448 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.071 seconds
[0m18:06:06.803457 [debug] [ThreadPool]: On list_dev_gom1_finance: ROLLBACK
[0m18:06:06.867651 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.077 seconds
[0m18:06:06.869697 [debug] [ThreadPool]: On list_dev_gom1_dbt: ROLLBACK
[0m18:06:06.873545 [debug] [ThreadPool]: On list_dev_gom1_finance: Close
[0m18:06:06.940680 [debug] [ThreadPool]: On list_dev_gom1_dbt: Close
[0m18:06:06.952608 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:06.953571 [debug] [MainThread]: On master: BEGIN
[0m18:06:06.954084 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:08.946540 [debug] [MainThread]: SQL status: BEGIN in 1.992 seconds
[0m18:06:08.946540 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:08.947541 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:06:09.022415 [debug] [MainThread]: SQL status: SELECT 5 in 0.075 seconds
[0m18:06:09.025424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad4d0404-ea13-4ea8-8c4b-27524c075551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AD9603B0>]}
[0m18:06:09.025424 [debug] [MainThread]: On master: ROLLBACK
[0m18:06:09.094323 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:09.094323 [debug] [MainThread]: On master: BEGIN
[0m18:06:09.249369 [debug] [MainThread]: SQL status: BEGIN in 0.155 seconds
[0m18:06:09.250321 [debug] [MainThread]: On master: COMMIT
[0m18:06:09.251322 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:09.251322 [debug] [MainThread]: On master: COMMIT
[0m18:06:09.321434 [debug] [MainThread]: SQL status: COMMIT in 0.069 seconds
[0m18:06:09.321434 [debug] [MainThread]: On master: Close
[0m18:06:09.327683 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_full
[0m18:06:09.328671 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt.events_full .................................... [RUN]
[0m18:06:09.329669 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_scooters.events_full'
[0m18:06:09.330669 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_full
[0m18:06:09.338473 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m18:06:09.340440 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_full
[0m18:06:09.377743 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m18:06:09.379729 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:06:09.380717 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: BEGIN
[0m18:06:09.380717 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:06:10.467544 [debug] [Thread-1 (]: SQL status: BEGIN in 1.086 seconds
[0m18:06:10.467544 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:06:10.468541 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_gom1"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select *, date("timestamp") as "date" from
"dev_gom1"."dbt"."events_clean" as e
left join "dev_gom1"."dbt"."event_types" as t
using (type_id)
  );
[0m18:06:10.545330 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.076 seconds
[0m18:06:10.552529 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:06:10.553525 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_gom1"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m18:06:10.625519 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.072 seconds
[0m18:06:10.629513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:06:10.629513 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_gom1"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m18:06:10.703468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.073 seconds
[0m18:06:10.729514 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:06:10.729514 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

    
  
  comment on view "dev_gom1"."dbt"."events_full" is $dbt_comment_literal_block$User events enriched with meaningful types$dbt_comment_literal_block$;

  
[0m18:06:10.800652 [debug] [Thread-1 (]: SQL status: COMMENT in 0.071 seconds
[0m18:06:10.803423 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m18:06:10.804385 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:06:10.805386 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m18:06:10.879658 [debug] [Thread-1 (]: SQL status: COMMIT in 0.073 seconds
[0m18:06:10.888338 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."events_full__dbt_backup"
[0m18:06:10.895616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:06:10.896616 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_gom1"."dbt"."events_full__dbt_backup" cascade
[0m18:06:10.972593 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.075 seconds
[0m18:06:10.976595 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: Close
[0m18:06:10.978587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad4d0404-ea13-4ea8-8c4b-27524c075551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150A9158DA0>]}
[0m18:06:10.979591 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt.events_full ............................... [[32mCREATE VIEW[0m in 1.65s]
[0m18:06:10.980566 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_full
[0m18:06:10.982305 [debug] [Thread-3 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m18:06:10.983316 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49
[0m18:06:10.983316 [info ] [Thread-3 (]: 2 of 3 START test events_full_is_complete ...................................... [RUN]
[0m18:06:10.984316 [info ] [Thread-4 (]: 3 of 3 START test unique_key_meta_events_full_ ................................. [RUN]
[0m18:06:10.986318 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_scooters.events_full_is_complete'
[0m18:06:10.986318 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49'
[0m18:06:10.987315 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m18:06:10.988316 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49
[0m18:06:10.991313 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m18:06:10.998482 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49"
[0m18:06:10.999487 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49"} */

    select max(date) - interval '60 day' from "dev_gom1"."dbt"."events_full"
  
[0m18:06:11.000484 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:06:11.001656 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m18:06:11.025749 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.events_full_is_complete"
[0m18:06:11.026784 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m18:06:11.027784 [debug] [Thread-3 (]: On test.dbt_scooters.events_full_is_complete: BEGIN
[0m18:06:11.027784 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:06:13.219425 [debug] [Thread-3 (]: SQL status: BEGIN in 2.191 seconds
[0m18:06:13.221392 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m18:06:13.221392 [debug] [Thread-3 (]: On test.dbt_scooters.events_full_is_complete: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.events_full_is_complete"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with source_cte as (
    select count(*) as row_count
    from "dev_gom1"."dbt"."events_clean"
),
target_cte as (
    select count(*) as row_count
    from "dev_gom1"."dbt"."events_full"
)
select
    'Row count mismatch' as error_message,
    source_cte.row_count as source_count,
    target_cte.row_count as target_count
from
    source_cte,
    target_cte
where
    source_cte.row_count != target_cte.row_count
      
    ) dbt_internal_test
[0m18:06:17.607501 [debug] [Thread-3 (]: SQL status: SELECT 1 in 4.384 seconds
[0m18:06:17.612269 [debug] [Thread-3 (]: On test.dbt_scooters.events_full_is_complete: ROLLBACK
[0m18:06:17.916534 [debug] [Thread-3 (]: On test.dbt_scooters.events_full_is_complete: Close
[0m18:06:17.918483 [info ] [Thread-3 (]: 2 of 3 PASS events_full_is_complete ............................................ [[32mPASS[0m in 6.93s]
[0m18:06:17.919485 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m18:06:18.481420 [debug] [Thread-4 (]: SQL status: SELECT 1 in 7.481 seconds
[0m18:06:18.482687 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49"
[0m18:06:18.484688 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49
[0m18:06:18.487691 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49"
[0m18:06:18.489653 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49"
[0m18:06:18.489653 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49: BEGIN
[0m18:06:18.589392 [debug] [Thread-4 (]: SQL status: BEGIN in 0.098 seconds
[0m18:06:18.590395 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49"
[0m18:06:18.590395 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    with validation_errors as (
        select
            user_id, timestamp, type_id
        from "dev_gom1"."dbt"."events_full"
        where date >= date '2023-07-01 00:00:00'
        group by user_id, timestamp, type_id
        having count(*) > 1
    )
    select *
    from validation_errors

      
    ) dbt_internal_test
[0m18:06:25.110472 [debug] [Thread-4 (]: SQL status: SELECT 1 in 6.519 seconds
[0m18:06:25.112302 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49: ROLLBACK
[0m18:06:25.185474 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49: Close
[0m18:06:25.187474 [info ] [Thread-4 (]: 3 of 3 PASS unique_key_meta_events_full_ ....................................... [[32mPASS[0m in 14.20s]
[0m18:06:25.188479 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49
[0m18:06:25.190899 [info ] [MainThread]: 
[0m18:06:25.192409 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:25.193423 [debug] [MainThread]: On master: BEGIN
[0m18:06:25.193423 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:26.285458 [debug] [MainThread]: SQL status: BEGIN in 1.091 seconds
[0m18:06:26.285458 [debug] [MainThread]: On master: COMMIT
[0m18:06:26.286458 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:26.286458 [debug] [MainThread]: On master: COMMIT
[0m18:06:26.356518 [debug] [MainThread]: SQL status: COMMIT in 0.069 seconds
[0m18:06:26.358518 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m18:06:26.363325 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m18:06:26.365287 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:26.365287 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m18:06:26.435546 [debug] [MainThread]: SQL status: GRANT in 0.070 seconds
[0m18:06:26.437504 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.08s]
[0m18:06:26.438505 [debug] [MainThread]: On master: Close
[0m18:06:26.439512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:26.439512 [debug] [MainThread]: Connection 'list_dev_gom1' was properly closed.
[0m18:06:26.440511 [debug] [MainThread]: Connection 'list_dev_gom1_finance' was properly closed.
[0m18:06:26.440511 [debug] [MainThread]: Connection 'list_dev_gom1_dbt' was properly closed.
[0m18:06:26.440511 [debug] [MainThread]: Connection 'model.dbt_scooters.events_full' was properly closed.
[0m18:06:26.440511 [debug] [MainThread]: Connection 'test.dbt_scooters.events_full_is_complete' was properly closed.
[0m18:06:26.442310 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_key_meta_events_full_.18e6d8cc49' was properly closed.
[0m18:06:26.443327 [info ] [MainThread]: 
[0m18:06:26.444319 [info ] [MainThread]: Finished running 1 project hook, 2 data tests, 1 view model in 0 hours 0 minutes and 24.21 seconds (24.21s).
[0m18:06:26.445319 [debug] [MainThread]: Command end result
[0m18:06:26.541328 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m18:06:26.544585 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m18:06:26.552286 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\run_results.json
[0m18:06:26.552286 [info ] [MainThread]: 
[0m18:06:26.553297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:26.554296 [info ] [MainThread]: 
[0m18:06:26.555299 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:06:26.556296 [debug] [MainThread]: Command `dbt build` succeeded at 18:06:26.556296 after 29.44 seconds
[0m18:06:26.557302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150ABC5D130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AD9EBCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AB2D2510>]}
[0m18:06:26.558299 [debug] [MainThread]: Flushing usage events
[0m18:06:27.292653 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:40:48.604880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD7ECA0D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD023BC5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD023BC770>]}


============================== 18:40:48.610849 | f29427f8-5fbe-45c1-a35b-80ba3df06d49 ==============================
[0m18:40:48.610849 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:40:48.611850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:40:48.900781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f29427f8-5fbe-45c1-a35b-80ba3df06d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD02203BC0>]}
[0m18:40:49.006963 [debug] [MainThread]: Set downloads directory='C:\Users\C523~1\AppData\Local\Temp\dbt-downloads-phj60ga8'
[0m18:40:49.007961 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:40:49.306729 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:40:49.308763 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:40:49.429861 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:40:49.449935 [info ] [MainThread]: Updating lock file in file path: C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters/package-lock.yml
[0m18:40:49.457916 [debug] [MainThread]: Set downloads directory='C:\Users\C523~1\AppData\Local\Temp\dbt-downloads-kcc1r2ji'
[0m18:40:49.463921 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:40:50.470942 [info ] [MainThread]: Installed from version 1.3.0
[0m18:40:50.471942 [info ] [MainThread]: Up to date!
[0m18:40:50.472943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f29427f8-5fbe-45c1-a35b-80ba3df06d49', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD02021100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD023BC770>]}
[0m18:40:50.475953 [debug] [MainThread]: Command `dbt deps` succeeded at 18:40:50.474951 after 2.30 seconds
[0m18:40:50.476953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD02189D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD019E8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD019E8680>]}
[0m18:40:50.476953 [debug] [MainThread]: Flushing usage events
[0m18:40:51.243099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:49:46.000384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002161478C8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002161483C2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002161478D640>]}


============================== 18:49:46.006193 | 0069dd49-f410-4fc4-aa2d-60be09bcc48b ==============================
[0m18:49:46.006193 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:49:46.007195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build -s sex_age_pivot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:49:46.326621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0069dd49-f410-4fc4-aa2d-60be09bcc48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002161408E090>]}
[0m18:49:46.428637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0069dd49-f410-4fc4-aa2d-60be09bcc48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021613FBB680>]}
[0m18:49:46.430642 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:49:46.794439 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:49:47.024793 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m18:49:47.026313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0069dd49-f410-4fc4-aa2d-60be09bcc48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002161478D0D0>]}
[0m18:49:50.423357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0069dd49-f410-4fc4-aa2d-60be09bcc48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021614C1FB30>]}
[0m18:49:50.625729 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m18:49:50.633509 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m18:49:50.700205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0069dd49-f410-4fc4-aa2d-60be09bcc48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021616872D80>]}
[0m18:49:50.701238 [info ] [MainThread]: Found 22 models, 29 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 559 macros
[0m18:49:50.706051 [info ] [MainThread]: 
[0m18:49:50.707019 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:49:50.708019 [info ] [MainThread]: 
[0m18:49:50.709049 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:49:50.710050 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1'
[0m18:49:50.919091 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1"
[0m18:49:50.920057 [debug] [ThreadPool]: On list_dev_gom1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1"} */

    select distinct nspname from pg_namespace
  
[0m18:49:50.920057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:52.085402 [debug] [ThreadPool]: SQL status: SELECT 19 in 1.165 seconds
[0m18:49:52.087398 [debug] [ThreadPool]: On list_dev_gom1: Close
[0m18:49:52.095157 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_finance'
[0m18:49:52.102459 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m18:49:52.102459 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_dbt'
[0m18:49:52.103497 [debug] [ThreadPool]: On list_dev_gom1_finance: BEGIN
[0m18:49:52.106497 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m18:49:52.106497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:52.107461 [debug] [ThreadPool]: On list_dev_gom1_dbt: BEGIN
[0m18:49:52.108460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:54.299328 [debug] [ThreadPool]: SQL status: BEGIN in 2.192 seconds
[0m18:49:54.300284 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m18:49:54.300284 [debug] [ThreadPool]: On list_dev_gom1_finance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_finance"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m18:49:54.330215 [debug] [ThreadPool]: SQL status: BEGIN in 2.222 seconds
[0m18:49:54.331222 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m18:49:54.331222 [debug] [ThreadPool]: On list_dev_gom1_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_dbt"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m18:49:54.381168 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.081 seconds
[0m18:49:54.383930 [debug] [ThreadPool]: On list_dev_gom1_finance: ROLLBACK
[0m18:49:54.411679 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.080 seconds
[0m18:49:54.413668 [debug] [ThreadPool]: On list_dev_gom1_dbt: ROLLBACK
[0m18:49:54.460016 [debug] [ThreadPool]: On list_dev_gom1_finance: Close
[0m18:49:54.484292 [debug] [ThreadPool]: On list_dev_gom1_dbt: Close
[0m18:49:54.495167 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:54.495167 [debug] [MainThread]: On master: BEGIN
[0m18:49:54.496125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:49:55.803014 [debug] [MainThread]: SQL status: BEGIN in 1.307 seconds
[0m18:49:55.804022 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:55.804022 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:49:55.888337 [debug] [MainThread]: SQL status: SELECT 5 in 0.083 seconds
[0m18:49:55.890337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0069dd49-f410-4fc4-aa2d-60be09bcc48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002161700FCE0>]}
[0m18:49:55.890337 [debug] [MainThread]: On master: ROLLBACK
[0m18:49:55.964015 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:55.964015 [debug] [MainThread]: On master: BEGIN
[0m18:49:56.110039 [debug] [MainThread]: SQL status: BEGIN in 0.145 seconds
[0m18:49:56.111042 [debug] [MainThread]: On master: COMMIT
[0m18:49:56.111042 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:56.112277 [debug] [MainThread]: On master: COMMIT
[0m18:49:56.185349 [debug] [MainThread]: SQL status: COMMIT in 0.073 seconds
[0m18:49:56.186298 [debug] [MainThread]: On master: Close
[0m18:49:56.190296 [debug] [Thread-1 (]: Began running node model.dbt_scooters.sex_age_pivot
[0m18:49:56.191337 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.sex_age_pivot ................................. [RUN]
[0m18:49:56.191337 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_scooters.sex_age_pivot'
[0m18:49:56.193145 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.sex_age_pivot
[0m18:49:56.202445 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.sex_age_pivot"
[0m18:49:56.204407 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.sex_age_pivot
[0m18:49:56.246708 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.sex_age_pivot"
[0m18:49:56.250706 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.sex_age_pivot"
[0m18:49:56.250706 [debug] [Thread-1 (]: On model.dbt_scooters.sex_age_pivot: BEGIN
[0m18:49:56.251864 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:49:58.198351 [debug] [Thread-1 (]: SQL status: BEGIN in 1.946 seconds
[0m18:49:58.199351 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.sex_age_pivot"
[0m18:49:58.199351 [debug] [Thread-1 (]: On model.dbt_scooters.sex_age_pivot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.sex_age_pivot"} */

  
    

  create  table "dev_gom1"."dbt"."sex_age_pivot__dbt_tmp"
  
  
    as
  
  (
    select
  age,
  
  
    sum(
      
      case
      when sex = 'M'
        then 1
      else 0
      end
    )
    
      
            as "M"
      
    
    ,
  
    sum(
      
      case
      when sex = 'F'
        then 1
      else 0
      end
    )
    
      
            as "F"
      
    
    
  

from "dev_gom1"."dbt"."trips_users"
group by age
order by age
  );
  
[0m18:49:58.726123 [debug] [Thread-1 (]: SQL status: SELECT 83 in 0.526 seconds
[0m18:49:58.735838 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.sex_age_pivot"
[0m18:49:58.736838 [debug] [Thread-1 (]: On model.dbt_scooters.sex_age_pivot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.sex_age_pivot"} */
alter table "dev_gom1"."dbt"."sex_age_pivot__dbt_tmp" rename to "sex_age_pivot"
[0m18:49:58.811297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.073 seconds
[0m18:49:58.839930 [debug] [Thread-1 (]: On model.dbt_scooters.sex_age_pivot: COMMIT
[0m18:49:58.840932 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.sex_age_pivot"
[0m18:49:58.840932 [debug] [Thread-1 (]: On model.dbt_scooters.sex_age_pivot: COMMIT
[0m18:49:58.914831 [debug] [Thread-1 (]: SQL status: COMMIT in 0.073 seconds
[0m18:49:58.923132 [debug] [Thread-1 (]: Applying DROP to: "dev_gom1"."dbt"."sex_age_pivot__dbt_backup"
[0m18:49:58.931135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.sex_age_pivot"
[0m18:49:58.931135 [debug] [Thread-1 (]: On model.dbt_scooters.sex_age_pivot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.sex_age_pivot"} */
drop table if exists "dev_gom1"."dbt"."sex_age_pivot__dbt_backup" cascade
[0m18:49:59.004676 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.073 seconds
[0m18:49:59.008677 [debug] [Thread-1 (]: On model.dbt_scooters.sex_age_pivot: Close
[0m18:49:59.011939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0069dd49-f410-4fc4-aa2d-60be09bcc48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216167CD520>]}
[0m18:49:59.012981 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt.sex_age_pivot ............................ [[32mSELECT 83[0m in 2.82s]
[0m18:49:59.013939 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.sex_age_pivot
[0m18:49:59.015943 [info ] [MainThread]: 
[0m18:49:59.016941 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:59.017978 [debug] [MainThread]: On master: BEGIN
[0m18:49:59.018971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:00.591248 [debug] [MainThread]: SQL status: BEGIN in 1.574 seconds
[0m18:50:00.592987 [debug] [MainThread]: On master: COMMIT
[0m18:50:00.593995 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:00.593995 [debug] [MainThread]: On master: COMMIT
[0m18:50:00.663119 [debug] [MainThread]: SQL status: COMMIT in 0.068 seconds
[0m18:50:00.666174 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m18:50:00.672453 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m18:50:00.673455 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:00.674418 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m18:50:00.744289 [debug] [MainThread]: SQL status: GRANT in 0.070 seconds
[0m18:50:00.746240 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.08s]
[0m18:50:00.747238 [debug] [MainThread]: On master: Close
[0m18:50:00.748239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:00.748239 [debug] [MainThread]: Connection 'list_dev_gom1' was properly closed.
[0m18:50:00.749239 [debug] [MainThread]: Connection 'list_dev_gom1_finance' was properly closed.
[0m18:50:00.749239 [debug] [MainThread]: Connection 'list_dev_gom1_dbt' was properly closed.
[0m18:50:00.750239 [debug] [MainThread]: Connection 'model.dbt_scooters.sex_age_pivot' was properly closed.
[0m18:50:00.751240 [info ] [MainThread]: 
[0m18:50:00.751240 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 10.04 seconds (10.04s).
[0m18:50:00.754068 [debug] [MainThread]: Command end result
[0m18:50:00.803338 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m18:50:00.806366 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m18:50:00.815181 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\run_results.json
[0m18:50:00.816189 [info ] [MainThread]: 
[0m18:50:00.817185 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:50:00.818181 [info ] [MainThread]: 
[0m18:50:00.819187 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:50:00.821188 [debug] [MainThread]: Command `dbt build` succeeded at 18:50:00.821188 after 15.18 seconds
[0m18:50:00.821188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021616846DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021614B34320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021614757320>]}
[0m18:50:00.822957 [debug] [MainThread]: Flushing usage events
[0m18:50:01.536614 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:03:13.207521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A72279D7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A720535AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7206CCF80>]}


============================== 19:03:13.214282 | 3db6cbd1-906d-42ce-a0d2-4927f1b54c09 ==============================
[0m19:03:13.214282 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:03:13.215250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --add-package calogica/dbt_expectations@0.10.4', 'send_anonymous_usage_stats': 'True'}
[0m19:03:13.437993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3db6cbd1-906d-42ce-a0d2-4927f1b54c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A722E25070>]}
[0m19:03:13.478382 [info ] [MainThread]: Added new package calogica/dbt_expectations@0.10.4 to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters/dependencies.yml
[0m19:03:13.486257 [debug] [MainThread]: Set downloads directory='C:\Users\C523~1\AppData\Local\Temp\dbt-downloads-ufnjthdc'
[0m19:03:13.487257 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:03:13.744394 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:03:13.745393 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:03:13.870206 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:03:13.878514 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m19:03:13.976367 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m19:03:13.978378 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m19:03:13.979338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3db6cbd1-906d-42ce-a0d2-4927f1b54c09', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7233D52E0>]}
[0m19:03:13.983747 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m19:03:14.078574 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m19:03:14.095289 [info ] [MainThread]: Updating lock file in file path: C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters/package-lock.yml
[0m19:03:14.194406 [debug] [MainThread]: Set downloads directory='C:\Users\C523~1\AppData\Local\Temp\dbt-downloads-4vj_m2vm'
[0m19:03:14.205307 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:03:14.692518 [info ] [MainThread]: Installed from version 1.3.0
[0m19:03:14.693519 [info ] [MainThread]: Up to date!
[0m19:03:14.694519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3db6cbd1-906d-42ce-a0d2-4927f1b54c09', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A72334C320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A722EC0650>]}
[0m19:03:14.695519 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m19:03:15.353179 [info ] [MainThread]: Installed from version 0.10.4
[0m19:03:15.354176 [info ] [MainThread]: Up to date!
[0m19:03:15.355174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3db6cbd1-906d-42ce-a0d2-4927f1b54c09', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A723546960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A723546E10>]}
[0m19:03:15.356173 [info ] [MainThread]: Installing calogica/dbt_date
[0m19:03:15.636159 [info ] [MainThread]: Installed from version 0.10.1
[0m19:03:15.637158 [info ] [MainThread]: Up to date!
[0m19:03:15.638159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3db6cbd1-906d-42ce-a0d2-4927f1b54c09', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A722801010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A722A80EC0>]}
[0m19:03:15.642919 [debug] [MainThread]: Command `dbt deps` succeeded at 19:03:15.642919 after 2.83 seconds
[0m19:03:15.643919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A720535AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A723264E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7224008F0>]}
[0m19:03:15.644877 [debug] [MainThread]: Flushing usage events
[0m19:03:16.372309 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:14:46.028592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CC8D4EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CF0211C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CF022240>]}


============================== 19:14:46.036349 | 49fc3181-896c-43f6-9c31-ba2f87162576 ==============================
[0m19:14:46.036349 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:14:46.037857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test -s trips_prep', 'send_anonymous_usage_stats': 'True'}
[0m19:14:46.420857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49fc3181-896c-43f6-9c31-ba2f87162576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CF6DF920>]}
[0m19:14:46.550422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49fc3181-896c-43f6-9c31-ba2f87162576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CF0812B0>]}
[0m19:14:46.552821 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:14:47.053812 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:14:47.351747 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m19:14:47.352748 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:14:47.353747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49fc3181-896c-43f6-9c31-ba2f87162576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CF1F8FE0>]}
[0m19:14:51.757501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49fc3181-896c-43f6-9c31-ba2f87162576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D14060C0>]}
[0m19:14:51.970461 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m19:14:51.976725 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m19:14:52.042081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49fc3181-896c-43f6-9c31-ba2f87162576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D1109130>]}
[0m19:14:52.043080 [info ] [MainThread]: Found 22 models, 33 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 827 macros
[0m19:14:52.044076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49fc3181-896c-43f6-9c31-ba2f87162576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D1114A10>]}
[0m19:14:52.048601 [info ] [MainThread]: 
[0m19:14:52.050603 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:14:52.051601 [info ] [MainThread]: 
[0m19:14:52.052903 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:14:52.060421 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_dbt'
[0m19:14:52.077531 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_gom1_finance'
[0m19:14:52.202914 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m19:14:52.202914 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m19:14:52.203921 [debug] [ThreadPool]: On list_dev_gom1_dbt: BEGIN
[0m19:14:52.204913 [debug] [ThreadPool]: On list_dev_gom1_finance: BEGIN
[0m19:14:52.205944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:52.205944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:53.489591 [debug] [ThreadPool]: SQL status: BEGIN in 1.283 seconds
[0m19:14:53.489591 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_finance"
[0m19:14:53.490590 [debug] [ThreadPool]: On list_dev_gom1_finance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_finance"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m19:14:53.566064 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.076 seconds
[0m19:14:53.568588 [debug] [ThreadPool]: On list_dev_gom1_finance: ROLLBACK
[0m19:14:53.638556 [debug] [ThreadPool]: On list_dev_gom1_finance: Close
[0m19:14:54.472778 [debug] [ThreadPool]: SQL status: BEGIN in 2.267 seconds
[0m19:14:54.472778 [debug] [ThreadPool]: Using postgres connection "list_dev_gom1_dbt"
[0m19:14:54.473778 [debug] [ThreadPool]: On list_dev_gom1_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_gom1_dbt"} */
select
      'dev_gom1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_gom1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m19:14:54.632739 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.158 seconds
[0m19:14:54.634782 [debug] [ThreadPool]: On list_dev_gom1_dbt: ROLLBACK
[0m19:14:54.784113 [debug] [ThreadPool]: On list_dev_gom1_dbt: Close
[0m19:14:54.795017 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:54.796011 [debug] [MainThread]: On master: BEGIN
[0m19:14:54.796011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:14:55.982745 [debug] [MainThread]: SQL status: BEGIN in 1.186 seconds
[0m19:14:55.983739 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:55.983739 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:14:56.064932 [debug] [MainThread]: SQL status: SELECT 5 in 0.080 seconds
[0m19:14:56.067483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49fc3181-896c-43f6-9c31-ba2f87162576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CD3683E0>]}
[0m19:14:56.067483 [debug] [MainThread]: On master: ROLLBACK
[0m19:14:56.143895 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:56.144860 [debug] [MainThread]: On master: BEGIN
[0m19:14:56.288848 [debug] [MainThread]: SQL status: BEGIN in 0.144 seconds
[0m19:14:56.289849 [debug] [MainThread]: On master: COMMIT
[0m19:14:56.290838 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:56.291152 [debug] [MainThread]: On master: COMMIT
[0m19:14:56.364099 [debug] [MainThread]: SQL status: COMMIT in 0.073 seconds
[0m19:14:56.365102 [debug] [MainThread]: On master: Close
[0m19:14:56.369574 [debug] [Thread-1 (]: Began running node test.dbt_scooters.row_count_equal_trips_prep_source_scooters_raw_trips_.8355c78599
[0m19:14:56.370575 [info ] [Thread-1 (]: 1 of 1 START test row_count_equal_trips_prep_source_scooters_raw_trips_ ........ [RUN]
[0m19:14:56.371575 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_scooters.row_count_equal_trips_prep_source_scooters_raw_trips_.8355c78599'
[0m19:14:56.372779 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.row_count_equal_trips_prep_source_scooters_raw_trips_.8355c78599
[0m19:14:56.383999 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.row_count_equal_trips_prep_source_scooters_raw_trips_.8355c78599"
[0m19:14:56.385962 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.row_count_equal_trips_prep_source_scooters_raw_trips_.8355c78599
[0m19:14:56.411548 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.row_count_equal_trips_prep_source_scooters_raw_trips_.8355c78599"
[0m19:14:56.412792 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.row_count_equal_trips_prep_source_scooters_raw_trips_.8355c78599"
[0m19:14:56.414753 [debug] [Thread-1 (]: On test.dbt_scooters.row_count_equal_trips_prep_source_scooters_raw_trips_.8355c78599: BEGIN
[0m19:14:56.414753 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:14:58.378642 [debug] [Thread-1 (]: SQL status: BEGIN in 1.963 seconds
[0m19:14:58.378642 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.row_count_equal_trips_prep_source_scooters_raw_trips_.8355c78599"
[0m19:14:58.379643 [debug] [Thread-1 (]: On test.dbt_scooters.row_count_equal_trips_prep_source_scooters_raw_trips_.8355c78599: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.row_count_equal_trips_prep_source_scooters_raw_trips_.8355c78599"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        "dev_gom1"."dbt"."trips_prep"
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        "dev_gom1"."scooters_raw"."trips"
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        


      
    ) dbt_internal_test
[0m19:14:58.692726 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.312 seconds
[0m19:14:58.698729 [debug] [Thread-1 (]: On test.dbt_scooters.row_count_equal_trips_prep_source_scooters_raw_trips_.8355c78599: ROLLBACK
[0m19:14:58.770487 [debug] [Thread-1 (]: On test.dbt_scooters.row_count_equal_trips_prep_source_scooters_raw_trips_.8355c78599: Close
[0m19:14:58.771484 [info ] [Thread-1 (]: 1 of 1 PASS row_count_equal_trips_prep_source_scooters_raw_trips_ .............. [[32mPASS[0m in 2.40s]
[0m19:14:58.772726 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.row_count_equal_trips_prep_source_scooters_raw_trips_.8355c78599
[0m19:14:58.774723 [info ] [MainThread]: 
[0m19:14:58.775725 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:58.775725 [debug] [MainThread]: On master: BEGIN
[0m19:14:58.776725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:14:59.890628 [debug] [MainThread]: SQL status: BEGIN in 1.114 seconds
[0m19:14:59.890628 [debug] [MainThread]: On master: COMMIT
[0m19:14:59.891661 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:59.891977 [debug] [MainThread]: On master: COMMIT
[0m19:15:00.327545 [debug] [MainThread]: SQL status: COMMIT in 0.435 seconds
[0m19:15:00.330552 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m19:15:00.335789 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m19:15:00.336761 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:00.337756 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m19:15:00.527545 [debug] [MainThread]: SQL status: GRANT in 0.189 seconds
[0m19:15:00.528589 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.20s]
[0m19:15:00.529556 [debug] [MainThread]: On master: Close
[0m19:15:00.530553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:00.530553 [debug] [MainThread]: Connection 'list_dev_gom1_dbt' was properly closed.
[0m19:15:00.531553 [debug] [MainThread]: Connection 'list_dev_gom1_finance' was properly closed.
[0m19:15:00.531553 [debug] [MainThread]: Connection 'test.dbt_scooters.row_count_equal_trips_prep_source_scooters_raw_trips_.8355c78599' was properly closed.
[0m19:15:00.532761 [info ] [MainThread]: 
[0m19:15:00.532761 [info ] [MainThread]: Finished running 1 project hook, 1 test in 0 hours 0 minutes and 8.48 seconds (8.48s).
[0m19:15:00.534761 [debug] [MainThread]: Command end result
[0m19:15:00.587617 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\manifest.json
[0m19:15:00.591628 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\semantic_manifest.json
[0m19:15:00.599399 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\run_results.json
[0m19:15:00.600403 [info ] [MainThread]: 
[0m19:15:00.601397 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:00.601397 [info ] [MainThread]: 
[0m19:15:00.602633 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:15:00.604632 [debug] [MainThread]: Command `dbt test` succeeded at 19:15:00.603632 after 15.04 seconds
[0m19:15:00.604632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D13F1D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D118A7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CCCB3F50>]}
[0m19:15:00.605630 [debug] [MainThread]: Flushing usage events
[0m19:15:01.309685 [debug] [MainThread]: An error was encountered while trying to flush usage events
