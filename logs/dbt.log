[0m11:04:02.356911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010ABC222120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010ABB2DE8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010ABB2DE600>]}


============================== 11:04:02.419917 | 9da2e87a-5434-44d2-8653-190dde384209 ==============================
[0m11:04:02.419917 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:04:02.421922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt init', 'send_anonymous_usage_stats': 'True'}
[0m11:04:02.802035 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse dict {'dir': WindowsPath('C:/Users/–ö–∏—Ä–∏–ª–ª/.dbt')}
[0m11:04:02.804035 [info ] [MainThread]: Creating dbt configuration folder at 
[0m11:04:35.722112 [debug] [MainThread]: Starter project path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\include\starter_project
[0m11:04:35.738888 [info ] [MainThread]: 
Your new dbt project "dbt_example" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m11:04:35.738888 [info ] [MainThread]: Setting up your profile.
[0m13:52:05.296074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C316FF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C35077230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C35075310>]}


============================== 13:52:05.302902 | 1797bbf4-1a27-4fdf-baf8-6ddf26e5af10 ==============================
[0m13:52:05.302902 [info ] [MainThread]: Running with dbt=1.8.8
[0m13:52:05.303902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt init dbt_scooters', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:05.351345 [debug] [MainThread]: Starter project path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\include\starter_project
[0m13:52:05.370357 [info ] [MainThread]: 
Your new dbt project "dbt_scooters" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m13:52:05.372349 [info ] [MainThread]: Setting up your profile.
[0m13:52:19.887444 [error] [MainThread]: Encountered an error:
list index out of range
[0m13:52:19.894453 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\cli\main.py", line 470, in init
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\task\init.py", line 347, in run
    self.setup_profile(profile_name)
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\task\init.py", line 262, in setup_profile
    adapter = self.ask_for_adapter_choice()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\task\init.py", line 244, in ask_for_adapter_choice
    return available_adapters[numeric_choice - 1]
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
IndexError: list index out of range

[0m13:52:19.897449 [debug] [MainThread]: Command `dbt init` failed at 13:52:19.897449 after 14.81 seconds
[0m13:52:19.898451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C316FF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C35C403B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C35DDDC70>]}
[0m13:52:19.899450 [debug] [MainThread]: Flushing usage events
[0m13:52:36.509231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78A558B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7B8D9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7B8DB530>]}


============================== 13:52:36.513199 | 6b5932c2-a5a4-4b90-9665-2b92e0a42070 ==============================
[0m13:52:36.513199 [info ] [MainThread]: Running with dbt=1.8.8
[0m13:52:36.514396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt init dbt_scooters', 'send_anonymous_usage_stats': 'True'}
[0m13:52:36.542436 [info ] [MainThread]: A project called dbt_scooters already exists here.
[0m13:52:36.544444 [debug] [MainThread]: Command `dbt init` succeeded at 13:52:36.543420 after 0.14 seconds
[0m13:52:36.544444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78A558B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7CEDE1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7C9E1400>]}
[0m13:52:36.544444 [debug] [MainThread]: Flushing usage events
[0m13:57:20.326411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283694F05C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028368555910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002836C80B140>]}


============================== 13:57:20.331441 | cf7e9a90-ba58-485d-8038-a260a8e17681 ==============================
[0m13:57:20.331441 [info ] [MainThread]: Running with dbt=1.8.8
[0m13:57:20.332411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt init dbt_scooters', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:20.366986 [debug] [MainThread]: Starter project path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\include\starter_project
[0m13:57:20.385971 [info ] [MainThread]: 
Your new dbt project "dbt_scooters" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m13:57:20.386969 [info ] [MainThread]: Setting up your profile.
[0m14:00:38.164711 [info ] [MainThread]: Profile dbt_scooters written to C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m14:00:38.165738 [debug] [MainThread]: Command `dbt init` succeeded at 14:00:38.165738 after 197.96 seconds
[0m14:00:38.166744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002836C7CE930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002836CCA66F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002836B11DDC0>]}
[0m14:00:38.166744 [debug] [MainThread]: Flushing usage events
[0m14:07:27.602164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55E897C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55902570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55BAFE60>]}


============================== 14:07:27.607198 | 78ce7fe7-202c-48d3-8566-e8ec45270dac ==============================
[0m14:07:27.607198 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:07:27.607198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init dbt_scooters', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:27.641778 [debug] [MainThread]: Starter project path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\include\starter_project
[0m14:07:27.660555 [info ] [MainThread]: 
Your new dbt project "dbt_scooters" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m14:07:27.660555 [info ] [MainThread]: Setting up your profile.
[0m14:10:08.368522 [info ] [MainThread]: Profile dbt_scooters written to C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m14:10:08.370107 [debug] [MainThread]: Command `dbt init` succeeded at 14:10:08.370107 after 160.96 seconds
[0m14:10:08.370107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55BE01A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55BE0CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55A05DF0>]}
[0m14:10:08.371105 [debug] [MainThread]: Flushing usage events
[0m14:06:25.280447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119F1507BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119F1705D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119F0B65CD0>]}


============================== 14:06:25.292455 | 8bd29f6d-ecbd-4961-bb80-15509b7a103c ==============================
[0m14:06:25.292455 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:06:25.294456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'log_path': 'logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:25.384597 [info ] [MainThread]: dbt version: 1.8.8
[0m14:06:25.386638 [info ] [MainThread]: python version: 3.12.4
[0m14:06:25.388639 [info ] [MainThread]: python path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\python.exe
[0m14:06:25.390597 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m14:06:25.616436 [info ] [MainThread]: Using profiles dir at C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt
[0m14:06:25.617392 [info ] [MainThread]: Using profiles.yml file at C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt\profiles.yml
[0m14:06:25.619394 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml
[0m14:06:25.624451 [info ] [MainThread]: adapter type: postgres
[0m14:06:25.625444 [info ] [MainThread]: adapter version: 1.8.2
[0m14:06:25.627407 [info ] [MainThread]: Configuration:
[0m14:06:25.628403 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:06:25.630408 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:06:25.631405 [info ] [MainThread]: Required dependencies:
[0m14:06:25.633409 [debug] [MainThread]: Executing "git --help"
[0m14:06:25.706545 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:06:25.707545 [debug] [MainThread]: STDERR: "b''"
[0m14:06:25.708552 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:06:25.710563 [info ] [MainThread]: Connection:
[0m14:06:25.712566 [info ] [MainThread]:   host: dpg-cstl32lumphs73fqdrj0-a.oregon-postgres.render.com
[0m14:06:25.713573 [info ] [MainThread]:   port: 5432
[0m14:06:25.715564 [info ] [MainThread]:   user: admin
[0m14:06:25.716562 [info ] [MainThread]:   database: dev_oovf
[0m14:06:25.718563 [info ] [MainThread]:   schema: dbt
[0m14:06:25.720594 [info ] [MainThread]:   connect_timeout: 10
[0m14:06:25.721582 [info ] [MainThread]:   role: None
[0m14:06:25.723583 [info ] [MainThread]:   search_path: None
[0m14:06:25.724587 [info ] [MainThread]:   keepalives_idle: 0
[0m14:06:25.725584 [info ] [MainThread]:   sslmode: None
[0m14:06:25.726587 [info ] [MainThread]:   sslcert: None
[0m14:06:25.727590 [info ] [MainThread]:   sslkey: None
[0m14:06:25.729593 [info ] [MainThread]:   sslrootcert: None
[0m14:06:25.731610 [info ] [MainThread]:   application_name: dbt
[0m14:06:25.733606 [info ] [MainThread]:   retries: 1
[0m14:06:25.735603 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:06:25.737604 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:06:26.717455 [debug] [MainThread]: Using postgres connection "debug"
[0m14:06:26.718421 [debug] [MainThread]: On debug: select 1 as id
[0m14:06:26.718421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:27.667587 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "dpg-cstl32lumphs73fqdrj0-a.oregon-postgres.render.com" (35.227.164.209), port 5432 failed: SSL connection has been closed unexpectedly

[0m14:06:28.444921 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:06:28.445922 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:06:28.445922 [debug] [MainThread]: On debug: No close available on handle
[0m14:06:28.446922 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:06:28.447923 [info ] [MainThread]: [31m2 checks failed:[0m
[0m14:06:28.449434 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml> not found

[0m14:06:28.451443 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "dpg-cstl32lumphs73fqdrj0-a.oregon-postgres.render.com" (35.227.164.209), port 5432 failed: SSL connection has been closed unexpectedly
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:06:28.453443 [debug] [MainThread]: Command `dbt debug` failed at 14:06:28.453443 after 3.61 seconds
[0m14:06:28.454441 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:06:28.455443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119F149AF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119EF51F5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119F09BD610>]}
[0m14:06:28.456442 [debug] [MainThread]: Flushing usage events
[0m14:16:57.604435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C81EC4D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C816914C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C8441DD30>]}


============================== 14:16:57.609961 | 8beaa279-1c05-4f87-bf9a-96aa32e339ac ==============================
[0m14:16:57.609961 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:16:57.610962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:16:57.637036 [info ] [MainThread]: dbt version: 1.8.8
[0m14:16:57.638057 [info ] [MainThread]: python version: 3.12.4
[0m14:16:57.639051 [info ] [MainThread]: python path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\python.exe
[0m14:16:57.640052 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m14:16:57.765191 [info ] [MainThread]: Using profiles dir at C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt
[0m14:16:57.766186 [info ] [MainThread]: Using profiles.yml file at C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt\profiles.yml
[0m14:16:57.767191 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml
[0m14:16:57.769205 [info ] [MainThread]: adapter type: postgres
[0m14:16:57.770198 [info ] [MainThread]: adapter version: 1.8.2
[0m14:16:57.771204 [info ] [MainThread]: Configuration:
[0m14:16:57.772202 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:16:57.773201 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:16:57.774201 [info ] [MainThread]: Required dependencies:
[0m14:16:57.775208 [debug] [MainThread]: Executing "git --help"
[0m14:16:57.828278 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:16:57.829791 [debug] [MainThread]: STDERR: "b''"
[0m14:16:57.830803 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:16:57.831797 [info ] [MainThread]: Connection:
[0m14:16:57.832803 [info ] [MainThread]:   host: dpg-cu4f49rtq21c73cqam00-a.oregon-postgres.render.com
[0m14:16:57.833806 [info ] [MainThread]:   port: 5432
[0m14:16:57.834808 [info ] [MainThread]:   user: admin
[0m14:16:57.835807 [info ] [MainThread]:   database: dev_3lcu
[0m14:16:57.837324 [info ] [MainThread]:   schema: dbt
[0m14:16:57.838336 [info ] [MainThread]:   connect_timeout: 10
[0m14:16:57.840338 [info ] [MainThread]:   role: None
[0m14:16:57.841341 [info ] [MainThread]:   search_path: None
[0m14:16:57.842345 [info ] [MainThread]:   keepalives_idle: 0
[0m14:16:57.843341 [info ] [MainThread]:   sslmode: None
[0m14:16:57.844339 [info ] [MainThread]:   sslcert: None
[0m14:16:57.845346 [info ] [MainThread]:   sslkey: None
[0m14:16:57.846344 [info ] [MainThread]:   sslrootcert: None
[0m14:16:57.847355 [info ] [MainThread]:   application_name: dbt
[0m14:16:57.848360 [info ] [MainThread]:   retries: 1
[0m14:16:57.849354 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:16:57.851362 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:16:57.983018 [debug] [MainThread]: Using postgres connection "debug"
[0m14:16:57.984019 [debug] [MainThread]: On debug: select 1 as id
[0m14:16:57.984019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:01.726035 [debug] [MainThread]: SQL status: SELECT 1 in 3.741 seconds
[0m14:17:01.727035 [debug] [MainThread]: On debug: Close
[0m14:17:01.728069 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:17:01.729032 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:17:01.730036 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml> not found

[0m14:17:01.732034 [debug] [MainThread]: Command `dbt debug` failed at 14:17:01.731036 after 4.44 seconds
[0m14:17:01.732034 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:17:01.733071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C8441DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C84BBF500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C839E4D40>]}
[0m14:17:01.734034 [debug] [MainThread]: Flushing usage events
[0m16:50:57.531694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990A452000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990C6585C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990C659190>]}


============================== 16:50:57.538706 | 20fdb56c-b56b-4f9b-b172-9784803d7d2e ==============================
[0m16:50:57.538706 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:50:57.539704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s trips_stat', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:50:57.541739 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:50:57.543703 [debug] [MainThread]: Command `dbt run` failed at 16:50:57.543703 after 0.36 seconds
[0m16:50:57.544706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990CE5FA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990A452000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990CCED460>]}
[0m16:50:57.545706 [debug] [MainThread]: Flushing usage events
[0m17:23:11.143983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C1F87D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C1F87F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C1F87500>]}


============================== 17:23:11.151054 | 7ae652cd-8b06-49fb-9ac9-52c9dd338b07 ==============================
[0m17:23:11.151054 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:23:11.152008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:23:11.153011 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m17:23:11.155008 [debug] [MainThread]: Command `dbt seed` failed at 17:23:11.155008 after 0.35 seconds
[0m17:23:11.156013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C216C5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C2145EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C23B4740>]}
[0m17:23:11.157425 [debug] [MainThread]: Flushing usage events
[0m22:31:50.720835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293134C5FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029316AA6CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029313625A60>]}


============================== 22:31:50.730845 | ea7bb894-dacf-4e9c-9513-b072bff12f0a ==============================
[0m22:31:50.730845 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:31:50.731850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\pythonProject1\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:31:51.088874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293171B4B60>]}
[0m22:31:51.179005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029314AA6B10>]}
[0m22:31:51.183014 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:31:51.547293 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:31:51.760987 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m22:31:51.761986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293166F17C0>]}
[0m22:31:54.535006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293186541A0>]}
[0m22:31:54.814695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029317006CC0>]}
[0m22:31:54.816697 [info ] [MainThread]: Found 19 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 437 macros
[0m22:31:54.828695 [info ] [MainThread]: 
[0m22:31:54.830701 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:31:54.839700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m22:31:54.856085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m22:31:55.126900 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m22:31:55.127899 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m22:31:55.128908 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m22:31:55.128908 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m22:31:55.129907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:55.130903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:58.057976 [debug] [ThreadPool]: SQL status: SELECT 21 in 2.927 seconds
[0m22:31:58.059939 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m22:31:58.245780 [debug] [ThreadPool]: SQL status: SELECT 21 in 3.116 seconds
[0m22:31:58.247281 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m22:31:58.251848 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_dbt'
[0m22:31:58.257887 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m22:31:58.258852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_finance'
[0m22:31:58.258852 [debug] [ThreadPool]: On list_dev_3lcu_dbt: BEGIN
[0m22:31:58.260899 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m22:31:58.261890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:58.262852 [debug] [ThreadPool]: On list_dev_3lcu_finance: BEGIN
[0m22:31:58.262852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:01.031073 [debug] [ThreadPool]: SQL status: BEGIN in 2.769 seconds
[0m22:32:01.032067 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m22:32:01.033054 [debug] [ThreadPool]: On list_dev_3lcu_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_dbt"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m22:32:01.374993 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.342 seconds
[0m22:32:01.376988 [debug] [ThreadPool]: On list_dev_3lcu_dbt: ROLLBACK
[0m22:32:01.714123 [debug] [ThreadPool]: On list_dev_3lcu_dbt: Close
[0m22:32:02.261241 [debug] [ThreadPool]: SQL status: BEGIN in 3.998 seconds
[0m22:32:02.262241 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m22:32:02.262241 [debug] [ThreadPool]: On list_dev_3lcu_finance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_finance"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m22:32:02.649914 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.387 seconds
[0m22:32:02.651953 [debug] [ThreadPool]: On list_dev_3lcu_finance: ROLLBACK
[0m22:32:03.013025 [debug] [ThreadPool]: On list_dev_3lcu_finance: Close
[0m22:32:03.019971 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:03.019971 [debug] [MainThread]: On master: BEGIN
[0m22:32:03.020971 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:32:06.772165 [debug] [MainThread]: SQL status: BEGIN in 3.751 seconds
[0m22:32:06.773118 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:06.773118 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:32:07.239755 [debug] [MainThread]: SQL status: SELECT 4 in 0.465 seconds
[0m22:32:07.241757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293186D2A80>]}
[0m22:32:07.242754 [debug] [MainThread]: On master: ROLLBACK
[0m22:32:07.579668 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:07.579668 [debug] [MainThread]: On master: BEGIN
[0m22:32:08.257861 [debug] [MainThread]: SQL status: BEGIN in 0.677 seconds
[0m22:32:08.258814 [debug] [MainThread]: On master: COMMIT
[0m22:32:08.258814 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:08.259814 [debug] [MainThread]: On master: COMMIT
[0m22:32:08.608727 [debug] [MainThread]: SQL status: COMMIT in 0.349 seconds
[0m22:32:08.609721 [debug] [MainThread]: On master: Close
[0m22:32:08.610685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:32:08.611680 [info ] [MainThread]: 
[0m22:32:08.619680 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.add_first_name_sex
[0m22:32:08.620690 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m22:32:08.620690 [debug] [Thread-3 (]: Began running node seed.dbt_scooters.event_types
[0m22:32:08.621697 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.scooters
[0m22:32:08.622688 [info ] [Thread-1 (]: 1 of 51 START seed file dbt.add_first_name_sex ................................. [RUN]
[0m22:32:08.623687 [info ] [Thread-2 (]: 2 of 51 START seed file dbt.age_groups ......................................... [RUN]
[0m22:32:08.624690 [info ] [Thread-3 (]: 3 of 51 START seed file dbt.event_types ........................................ [RUN]
[0m22:32:08.625688 [info ] [Thread-4 (]: 4 of 51 START seed file dbt.scooters ........................................... [RUN]
[0m22:32:08.625688 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.dbt_scooters.add_first_name_sex'
[0m22:32:08.626694 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.dbt_scooters.age_groups'
[0m22:32:08.627725 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.dbt_scooters.event_types'
[0m22:32:08.628687 [debug] [Thread-4 (]: Acquiring new postgres connection 'seed.dbt_scooters.scooters'
[0m22:32:08.628687 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.add_first_name_sex
[0m22:32:08.629725 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m22:32:08.629725 [debug] [Thread-3 (]: Began compiling node seed.dbt_scooters.event_types
[0m22:32:08.630730 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.scooters
[0m22:32:08.630730 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.add_first_name_sex
[0m22:32:08.631687 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m22:32:08.631687 [debug] [Thread-3 (]: Began executing node seed.dbt_scooters.event_types
[0m22:32:08.632689 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.scooters
[0m22:32:08.667211 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:08.671728 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:08.679730 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:08.680739 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: BEGIN
[0m22:32:08.684739 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:08.685737 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m22:32:08.685737 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: BEGIN
[0m22:32:08.686737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:32:08.686737 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: BEGIN
[0m22:32:08.687735 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:32:08.688739 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:32:08.689738 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:32:11.392783 [debug] [Thread-1 (]: SQL status: BEGIN in 2.706 seconds
[0m22:32:11.393741 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:11.393741 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */
truncate table "dev_3lcu"."dbt"."add_first_name_sex"
[0m22:32:11.467794 [debug] [Thread-3 (]: SQL status: BEGIN in 2.779 seconds
[0m22:32:11.468343 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:11.468343 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_3lcu"."dbt"."event_types"
[0m22:32:11.469891 [debug] [Thread-2 (]: SQL status: BEGIN in 2.782 seconds
[0m22:32:11.469891 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:11.470941 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_3lcu"."dbt"."age_groups"
[0m22:32:11.492897 [debug] [Thread-4 (]: SQL status: BEGIN in 2.803 seconds
[0m22:32:11.493900 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:11.493900 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_3lcu"."dbt"."scooters"
[0m22:32:11.737836 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.343 seconds
[0m22:32:11.753836 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:11.754838 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: 
          insert into "dev_3lcu"."dbt"."add_first_name_sex" ("first_name", "sex") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m22:32:11.814703 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.346 seconds
[0m22:32:11.817696 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:11.817696 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_3lcu"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m22:32:11.834660 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.363 seconds
[0m22:32:11.837699 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:11.838698 [debug] [Thread-4 (]: SQL status: TRUNCATE TABLE in 0.344 seconds
[0m22:32:11.838698 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_3lcu"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m22:32:11.842697 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:11.843696 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_3lcu"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m22:32:12.096055 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.341 seconds
[0m22:32:12.102020 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.add_first_name_sex"
[0m22:32:12.127039 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:12.128039 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  comment on table "dev_3lcu"."dbt"."add_first_name_sex" is $dbt_comment_literal_block$additional name_sex glossary$dbt_comment_literal_block$;

  
[0m22:32:12.157081 [debug] [Thread-3 (]: SQL status: INSERT 0 4 in 0.339 seconds
[0m22:32:12.158079 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m22:32:12.161080 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:12.162079 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  comment on table "dev_3lcu"."dbt"."event_types" is $dbt_comment_literal_block$Table provides a mapping between unique event type identifiers (`type_id`) and their descriptive names (`type`). It is essential for converting numerical codes from user activity logs into readable descriptions for analysis of user interactions with application features.

The table is crucial for analytics and reporting, allowing for the decoding of event identifiers in user activity datasets. By joining with event logs, it facilitates intuitive reporting and dashboarding of user interactions. The mapping enables effective segmentation and analysis of user activities, such as:

- **start_search**: Represents the initiation of a search process by a user.
- **book_scooter**: Indicates that a user has booked a scooter.
- **release_scooter**: Signifies that a user has released a previously booked scooter.
- **cancel_search**: Denotes the cancellation of a search process by a user.$dbt_comment_literal_block$;

  
[0m22:32:12.185709 [debug] [Thread-4 (]: SQL status: INSERT 0 10 in 0.341 seconds
[0m22:32:12.186710 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m22:32:12.189705 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:12.189705 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  comment on table "dev_3lcu"."dbt"."scooters" is $dbt_comment_literal_block$Scooter models information and park statistics by model. Includes information about the manufacturing company. Data received from the service team and uploaded by Mark. Data is current as of summer 2023.
$dbt_comment_literal_block$;

  
[0m22:32:12.191712 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.348 seconds
[0m22:32:12.192712 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m22:32:12.194713 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:12.195712 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  comment on table "dev_3lcu"."dbt"."age_groups" is $dbt_comment_literal_block$Age groups to split users for analysis$dbt_comment_literal_block$;

  
[0m22:32:12.465970 [debug] [Thread-1 (]: SQL status: COMMENT in 0.338 seconds
[0m22:32:12.488953 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:12.488953 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'add_first_name_sex'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:12.498965 [debug] [Thread-3 (]: SQL status: COMMENT in 0.336 seconds
[0m22:32:12.502002 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:12.503000 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'event_types'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:12.526958 [debug] [Thread-4 (]: SQL status: COMMENT in 0.337 seconds
[0m22:32:12.530959 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:12.531962 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'scooters'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:12.531962 [debug] [Thread-2 (]: SQL status: COMMENT in 0.336 seconds
[0m22:32:12.534959 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:12.535959 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'age_groups'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:12.843711 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.353 seconds
[0m22:32:12.847711 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:12.848712 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."add_first_name_sex".first_name is $dbt_comment_literal_block$First name of user$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."add_first_name_sex".sex is $dbt_comment_literal_block$user gender$dbt_comment_literal_block$;
  

  
[0m22:32:12.936943 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.404 seconds
[0m22:32:12.938908 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:12.939945 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".company is $dbt_comment_literal_block$Scooter company model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".model is $dbt_comment_literal_block$Scooter model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".hardware_id is $dbt_comment_literal_block$scooter model id$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".scooters is $dbt_comment_literal_block$Count of scooters$dbt_comment_literal_block$;
  

  
[0m22:32:13.040692 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.537 seconds
[0m22:32:13.040692 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.505 seconds
[0m22:32:13.042741 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:13.045734 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:13.045734 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."event_types".type_id is $dbt_comment_literal_block$An integer serving as a unique identifier for each event type. It is used in user event tables as a foreign key to link events to their descriptions
$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."event_types".type is $dbt_comment_literal_block$A string describing the event type, enhancing the interpretability of event data by providing a human-readable label
$dbt_comment_literal_block$;
  

  
[0m22:32:13.046730 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".group is $dbt_comment_literal_block$Age group name for report$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".age_start is $dbt_comment_literal_block$Start age of group$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".age_end is $dbt_comment_literal_block$End age of group$dbt_comment_literal_block$;
  

  
[0m22:32:13.187112 [debug] [Thread-1 (]: SQL status: COMMENT in 0.338 seconds
[0m22:32:13.189068 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m22:32:13.190075 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:13.190075 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m22:32:13.275324 [debug] [Thread-4 (]: SQL status: COMMENT in 0.335 seconds
[0m22:32:13.276325 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m22:32:13.277328 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:13.277328 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m22:32:13.463047 [debug] [Thread-3 (]: SQL status: COMMENT in 0.415 seconds
[0m22:32:13.465044 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m22:32:13.465044 [debug] [Thread-2 (]: SQL status: COMMENT in 0.418 seconds
[0m22:32:13.466042 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:13.467049 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m22:32:13.468042 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m22:32:13.469011 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:13.469011 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m22:32:13.530028 [debug] [Thread-1 (]: SQL status: COMMIT in 0.339 seconds
[0m22:32:13.532029 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: Close
[0m22:32:13.534031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319297230>]}
[0m22:32:13.535029 [info ] [Thread-1 (]: 1 of 51 OK loaded seed file dbt.add_first_name_sex ............................. [[32mINSERT 5[0m in 4.91s]
[0m22:32:13.536034 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.add_first_name_sex
[0m22:32:13.537034 [debug] [Thread-1 (]: Began running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m22:32:13.538030 [info ] [Thread-1 (]: 5 of 51 START test every_event_has_user ........................................ [RUN]
[0m22:32:13.538030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.add_first_name_sex, now test.dbt_scooters.every_event_has_user.7eea25f36c)
[0m22:32:13.539032 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m22:32:13.550047 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m22:32:13.551051 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m22:32:13.569566 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m22:32:13.571573 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m22:32:13.571573 [debug] [Thread-1 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: BEGIN
[0m22:32:13.572575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:13.613613 [debug] [Thread-4 (]: SQL status: COMMIT in 0.336 seconds
[0m22:32:13.615611 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: Close
[0m22:32:13.616611 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293191587D0>]}
[0m22:32:13.616611 [info ] [Thread-4 (]: 4 of 51 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 4.99s]
[0m22:32:13.618612 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.scooters
[0m22:32:13.618612 [debug] [Thread-4 (]: Began running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m22:32:13.619615 [info ] [Thread-4 (]: 6 of 51 START test every_trip_has_user ......................................... [RUN]
[0m22:32:13.620623 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now test.dbt_scooters.every_trip_has_user.6bc71135e2)
[0m22:32:13.621623 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m22:32:13.627626 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m22:32:13.629626 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m22:32:13.631631 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m22:32:13.632631 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m22:32:13.633639 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: BEGIN
[0m22:32:13.634639 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:14.011943 [debug] [Thread-3 (]: SQL status: COMMIT in 0.542 seconds
[0m22:32:14.012943 [debug] [Thread-2 (]: SQL status: COMMIT in 0.542 seconds
[0m22:32:14.013982 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: Close
[0m22:32:14.014983 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m22:32:14.015940 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931915B050>]}
[0m22:32:14.015940 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931926FDA0>]}
[0m22:32:14.016993 [info ] [Thread-3 (]: 3 of 51 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 5.39s]
[0m22:32:14.017944 [info ] [Thread-2 (]: 2 of 51 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 5.39s]
[0m22:32:14.019943 [debug] [Thread-3 (]: Finished running node seed.dbt_scooters.event_types
[0m22:32:14.020942 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m22:32:14.021942 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:32:14.022943 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m22:32:14.023940 [info ] [Thread-3 (]: 7 of 51 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m22:32:14.024946 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m22:32:14.023940 [info ] [Thread-2 (]: 8 of 51 START test source_not_null_scooters_raw_events_type_id ................. [RUN]
[0m22:32:14.025950 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:32:14.026948 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7)
[0m22:32:14.031979 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:32:14.032942 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m22:32:14.042981 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m22:32:14.043982 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:32:14.046939 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:32:14.047945 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m22:32:14.049949 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m22:32:14.050953 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:32:14.051951 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m22:32:14.051951 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:14.052955 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m22:32:14.053953 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: BEGIN
[0m22:32:14.053953 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:16.351767 [debug] [Thread-4 (]: SQL status: BEGIN in 2.718 seconds
[0m22:32:16.352766 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m22:32:16.353768 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_user.6bc71135e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:32:16.369773 [debug] [Thread-1 (]: SQL status: BEGIN in 2.797 seconds
[0m22:32:16.369773 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m22:32:16.369773 [debug] [Thread-1 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_user.7eea25f36c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:32:16.935691 [debug] [Thread-2 (]: SQL status: BEGIN in 2.882 seconds
[0m22:32:16.936692 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m22:32:16.937692 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from "dev_3lcu"."scooters_raw"."events"
where type_id is null



      
    ) dbt_internal_test
[0m22:32:16.937692 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.584 seconds
[0m22:32:16.941701 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: ROLLBACK
[0m22:32:16.966705 [debug] [Thread-3 (]: SQL status: BEGIN in 2.915 seconds
[0m22:32:16.967710 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:32:16.967710 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m22:32:17.342020 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: Close
[0m22:32:17.344023 [info ] [Thread-4 (]: 6 of 51 PASS every_trip_has_user ............................................... [[32mPASS[0m in 3.72s]
[0m22:32:17.345025 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m22:32:17.345025 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m22:32:17.346028 [info ] [Thread-4 (]: 9 of 51 START test source_not_null_scooters_raw_events_user_id ................. [RUN]
[0m22:32:17.347021 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_user.6bc71135e2, now test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b)
[0m22:32:17.348022 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m22:32:17.352026 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m22:32:17.353028 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m22:32:17.356029 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m22:32:17.358028 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m22:32:17.358028 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: BEGIN
[0m22:32:17.359027 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:17.370038 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.401 seconds
[0m22:32:17.372037 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m22:32:17.741857 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m22:32:17.742859 [info ] [Thread-3 (]: 7 of 51 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 3.72s]
[0m22:32:17.743861 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:32:17.744862 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m22:32:17.745859 [info ] [Thread-3 (]: 10 of 51 START test source_not_null_scooters_raw_trips_id ...................... [RUN]
[0m22:32:17.745859 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d)
[0m22:32:17.746865 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m22:32:17.750866 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m22:32:17.753870 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m22:32:17.756867 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m22:32:17.757867 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m22:32:17.758873 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: BEGIN
[0m22:32:17.758873 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:18.142707 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.771 seconds
[0m22:32:18.144712 [debug] [Thread-1 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: ROLLBACK
[0m22:32:18.251804 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.313 seconds
[0m22:32:18.253811 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: ROLLBACK
[0m22:32:18.485002 [debug] [Thread-1 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: Close
[0m22:32:18.486004 [info ] [Thread-1 (]: 5 of 51 PASS every_event_has_user .............................................. [[32mPASS[0m in 4.95s]
[0m22:32:18.487004 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m22:32:18.488011 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m22:32:18.489012 [info ] [Thread-1 (]: 11 of 51 START test source_not_null_scooters_raw_trips_scooter_hw_id ........... [RUN]
[0m22:32:18.490003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_user.7eea25f36c, now test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f)
[0m22:32:18.490003 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m22:32:18.495050 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m22:32:18.496005 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m22:32:18.499008 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m22:32:18.501042 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m22:32:18.501042 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: BEGIN
[0m22:32:18.502047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:18.595612 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: Close
[0m22:32:18.596615 [info ] [Thread-2 (]: 8 of 51 PASS source_not_null_scooters_raw_events_type_id ....................... [[32mPASS[0m in 4.57s]
[0m22:32:18.597613 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m22:32:18.598653 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m22:32:18.599653 [info ] [Thread-2 (]: 12 of 51 START test source_not_null_scooters_raw_trips_user_id ................. [RUN]
[0m22:32:18.600615 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7, now test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62)
[0m22:32:18.601647 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m22:32:18.605609 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m22:32:18.607612 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m22:32:18.609647 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m22:32:18.611614 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m22:32:18.611614 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: BEGIN
[0m22:32:18.612611 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:20.949709 [debug] [Thread-4 (]: SQL status: BEGIN in 3.590 seconds
[0m22:32:20.949709 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m22:32:20.950720 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."events"
where user_id is null



      
    ) dbt_internal_test
[0m22:32:21.211931 [debug] [Thread-1 (]: SQL status: BEGIN in 2.710 seconds
[0m22:32:21.211931 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m22:32:21.212934 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select scooter_hw_id
from "dev_3lcu"."scooters_raw"."trips"
where scooter_hw_id is null



      
    ) dbt_internal_test
[0m22:32:21.337006 [debug] [Thread-2 (]: SQL status: BEGIN in 2.725 seconds
[0m22:32:21.338006 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m22:32:21.339008 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."trips"
where user_id is null



      
    ) dbt_internal_test
[0m22:32:21.390067 [debug] [Thread-3 (]: SQL status: BEGIN in 3.631 seconds
[0m22:32:21.391065 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m22:32:21.391065 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."trips"
where id is null



      
    ) dbt_internal_test
[0m22:32:21.540690 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.590 seconds
[0m22:32:21.542691 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: ROLLBACK
[0m22:32:21.654765 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.442 seconds
[0m22:32:21.656764 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: ROLLBACK
[0m22:32:21.839911 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.448 seconds
[0m22:32:21.841913 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: ROLLBACK
[0m22:32:21.841913 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.503 seconds
[0m22:32:21.843908 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: ROLLBACK
[0m22:32:21.933977 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: Close
[0m22:32:21.934982 [info ] [Thread-4 (]: 9 of 51 PASS source_not_null_scooters_raw_events_user_id ....................... [[32mPASS[0m in 4.59s]
[0m22:32:21.936981 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m22:32:21.936981 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m22:32:21.937983 [info ] [Thread-4 (]: 13 of 51 START test source_not_null_scooters_raw_users_id ...................... [RUN]
[0m22:32:21.938980 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b, now test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d)
[0m22:32:21.938980 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m22:32:21.943984 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m22:32:21.944985 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m22:32:21.949996 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m22:32:21.952002 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m22:32:21.952002 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: BEGIN
[0m22:32:21.952996 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:21.996040 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: Close
[0m22:32:21.997046 [info ] [Thread-1 (]: 11 of 51 PASS source_not_null_scooters_raw_trips_scooter_hw_id ................. [[32mPASS[0m in 3.51s]
[0m22:32:21.999050 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m22:32:22.000059 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:32:22.000059 [info ] [Thread-1 (]: 14 of 51 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m22:32:22.001061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m22:32:22.002058 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:32:22.063619 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:32:22.064618 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:32:22.067616 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:32:22.068615 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:32:22.069622 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m22:32:22.069622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:22.182736 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: Close
[0m22:32:22.183738 [info ] [Thread-2 (]: 12 of 51 PASS source_not_null_scooters_raw_trips_user_id ....................... [[32mPASS[0m in 3.58s]
[0m22:32:22.184737 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m22:32:22.185741 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m22:32:22.186733 [info ] [Thread-2 (]: 15 of 51 START test source_unique_scooters_raw_trips_id ........................ [RUN]
[0m22:32:22.187737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62, now test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4)
[0m22:32:22.187737 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m22:32:22.194743 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m22:32:22.195744 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m22:32:22.198745 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m22:32:22.200760 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m22:32:22.200760 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: BEGIN
[0m22:32:22.201748 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:22.203752 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: Close
[0m22:32:22.204749 [info ] [Thread-3 (]: 10 of 51 PASS source_not_null_scooters_raw_trips_id ............................ [[32mPASS[0m in 4.46s]
[0m22:32:22.205751 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m22:32:22.206752 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m22:32:22.207750 [info ] [Thread-3 (]: 16 of 51 START test source_unique_scooters_raw_users_id ........................ [RUN]
[0m22:32:22.207750 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d, now test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf)
[0m22:32:22.208751 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m22:32:22.212755 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m22:32:22.213754 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m22:32:22.216753 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m22:32:22.218763 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m22:32:22.219755 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: BEGIN
[0m22:32:22.219755 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:24.802925 [debug] [Thread-1 (]: SQL status: BEGIN in 2.733 seconds
[0m22:32:24.803931 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:32:24.803931 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sex
from "dev_3lcu"."scooters_raw"."users"
where sex is null



      
    ) dbt_internal_test
[0m22:32:24.810934 [debug] [Thread-4 (]: SQL status: BEGIN in 2.858 seconds
[0m22:32:24.811937 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m22:32:24.811937 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."users"
where id is null



      
    ) dbt_internal_test
[0m22:32:25.172018 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.367 seconds
[0m22:32:25.174019 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m22:32:25.178021 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.365 seconds
[0m22:32:25.180536 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: ROLLBACK
[0m22:32:25.301604 [debug] [Thread-2 (]: SQL status: BEGIN in 3.100 seconds
[0m22:32:25.301604 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m22:32:25.302606 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."trips"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:32:25.582172 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: Close
[0m22:32:25.583175 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m22:32:25.583175 [info ] [Thread-4 (]: 13 of 51 PASS source_not_null_scooters_raw_users_id ............................ [[32mPASS[0m in 3.64s]
[0m22:32:25.584172 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m22:32:25.586175 [debug] [Thread-4 (]: Began running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m22:32:25.585176 [warn ] [Thread-1 (]: 14 of 51 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 3.58s]
[0m22:32:25.588178 [info ] [Thread-4 (]: 17 of 51 START test accepted_values_add_first_name_sex_sex__M__F ............... [RUN]
[0m22:32:25.588178 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:32:25.589686 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d, now test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199)
[0m22:32:25.590697 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m22:32:25.592699 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m22:32:25.592699 [info ] [Thread-1 (]: 18 of 51 START test unique_not_null_add_first_name_sex_first_name .............. [RUN]
[0m22:32:25.597693 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m22:32:25.597693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f)
[0m22:32:25.598697 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m22:32:25.603694 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m22:32:25.604698 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m22:32:25.606699 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m22:32:25.607698 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m22:32:25.611693 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m22:32:25.611693 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m22:32:25.612696 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: BEGIN
[0m22:32:25.613696 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:25.614697 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m22:32:25.614697 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: BEGIN
[0m22:32:25.615698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:25.835792 [debug] [Thread-3 (]: SQL status: BEGIN in 3.616 seconds
[0m22:32:25.836796 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m22:32:25.837806 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."users"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:32:26.237781 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.400 seconds
[0m22:32:26.239775 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: ROLLBACK
[0m22:32:26.578803 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: Close
[0m22:32:26.580924 [info ] [Thread-3 (]: 16 of 51 PASS source_unique_scooters_raw_users_id .............................. [[32mPASS[0m in 4.37s]
[0m22:32:26.581923 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m22:32:26.582925 [debug] [Thread-3 (]: Began running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m22:32:26.583922 [info ] [Thread-3 (]: 19 of 51 START test every_trip_has_scooter_id .................................. [RUN]
[0m22:32:26.583922 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf, now test.dbt_scooters.every_trip_has_scooter_id.e0b845a190)
[0m22:32:26.584965 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m22:32:26.589962 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m22:32:26.591924 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m22:32:26.594961 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m22:32:26.596924 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m22:32:26.596924 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: BEGIN
[0m22:32:26.597959 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:26.646924 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.344 seconds
[0m22:32:26.649930 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: ROLLBACK
[0m22:32:26.986250 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: Close
[0m22:32:26.988218 [info ] [Thread-2 (]: 15 of 51 PASS source_unique_scooters_raw_trips_id .............................. [[32mPASS[0m in 4.80s]
[0m22:32:26.989763 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m22:32:26.990772 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m22:32:26.991771 [info ] [Thread-2 (]: 20 of 51 START test unique_key_scooters_company__model__hardware_id ............ [RUN]
[0m22:32:26.992772 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4, now test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e)
[0m22:32:26.993772 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m22:32:26.999772 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m22:32:27.001782 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m22:32:27.004785 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m22:32:27.007785 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m22:32:27.007785 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: BEGIN
[0m22:32:27.008780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:28.325890 [debug] [Thread-4 (]: SQL status: BEGIN in 2.712 seconds
[0m22:32:28.326891 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m22:32:28.327889 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."dbt"."add_first_name_sex"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m22:32:28.331903 [debug] [Thread-1 (]: SQL status: BEGIN in 2.716 seconds
[0m22:32:28.332911 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m22:32:28.333905 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "first_name"
from
    "dev_3lcu"."dbt"."add_first_name_sex"
group by
    1
having
    count(*) > 1 or "first_name" is null


      
    ) dbt_internal_test
[0m22:32:28.668630 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.339 seconds
[0m22:32:28.671629 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: ROLLBACK
[0m22:32:28.672636 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.338 seconds
[0m22:32:28.675633 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: ROLLBACK
[0m22:32:29.012939 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: Close
[0m22:32:29.013943 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: Close
[0m22:32:29.014944 [info ] [Thread-4 (]: 17 of 51 PASS accepted_values_add_first_name_sex_sex__M__F ..................... [[32mPASS[0m in 3.43s]
[0m22:32:29.016940 [info ] [Thread-1 (]: 18 of 51 PASS unique_not_null_add_first_name_sex_first_name .................... [[32mPASS[0m in 3.42s]
[0m22:32:29.018941 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m22:32:29.020953 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m22:32:29.021952 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m22:32:29.022949 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m22:32:29.023949 [info ] [Thread-4 (]: 21 of 51 START test unique_not_null_scooters_hardware_id ....................... [RUN]
[0m22:32:29.024952 [info ] [Thread-1 (]: 22 of 51 START test unique_not_null_scooters_model ............................. [RUN]
[0m22:32:29.025950 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199, now test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d)
[0m22:32:29.026951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f, now test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc)
[0m22:32:29.027949 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m22:32:29.028952 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m22:32:29.037960 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m22:32:29.043974 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m22:32:29.045971 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m22:32:29.047971 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m22:32:29.050979 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m22:32:29.054977 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m22:32:29.057978 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m22:32:29.058980 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m22:32:29.058980 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: BEGIN
[0m22:32:29.060991 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: BEGIN
[0m22:32:29.061996 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:29.062991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:29.671875 [debug] [Thread-2 (]: SQL status: BEGIN in 2.662 seconds
[0m22:32:29.671875 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m22:32:29.672875 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "company"::text ||
    
        "model"::text ||
    
        "hardware_id"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m22:32:30.032776 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.359 seconds
[0m22:32:30.035770 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: ROLLBACK
[0m22:32:30.372517 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: Close
[0m22:32:30.374516 [info ] [Thread-2 (]: 20 of 51 PASS unique_key_scooters_company__model__hardware_id .................. [[32mPASS[0m in 3.38s]
[0m22:32:30.375516 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m22:32:30.376517 [debug] [Thread-2 (]: Began running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m22:32:30.377516 [info ] [Thread-2 (]: 23 of 51 START test every_event_has_type ....................................... [RUN]
[0m22:32:30.379524 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e, now test.dbt_scooters.every_event_has_type.1e5fc977eb)
[0m22:32:30.380520 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m22:32:30.392541 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m22:32:30.394546 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m22:32:30.399548 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m22:32:30.402546 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m22:32:30.403552 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: BEGIN
[0m22:32:30.403552 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:30.467543 [debug] [Thread-3 (]: SQL status: BEGIN in 3.869 seconds
[0m22:32:30.468549 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m22:32:30.469572 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select scooter_hw_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where scooter_hw_id is not null
),

parent as (
    select hardware_id as to_field
    from "dev_3lcu"."dbt"."scooters"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:32:31.038756 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.568 seconds
[0m22:32:31.041763 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: ROLLBACK
[0m22:32:31.383612 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: Close
[0m22:32:31.384610 [info ] [Thread-3 (]: 19 of 51 PASS every_trip_has_scooter_id ........................................ [[32mPASS[0m in 4.80s]
[0m22:32:31.386116 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m22:32:31.387125 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m22:32:31.388128 [info ] [Thread-3 (]: 24 of 51 START test unique_not_null_event_types_type ........................... [RUN]
[0m22:32:31.388128 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_scooter_id.e0b845a190, now test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1)
[0m22:32:31.389635 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m22:32:31.394644 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m22:32:31.396650 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m22:32:31.399647 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m22:32:31.401659 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m22:32:31.402661 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: BEGIN
[0m22:32:31.402661 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:31.756787 [debug] [Thread-4 (]: SQL status: BEGIN in 2.695 seconds
[0m22:32:31.758792 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m22:32:31.759787 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "hardware_id"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "hardware_id" is null


      
    ) dbt_internal_test
[0m22:32:31.806940 [debug] [Thread-1 (]: SQL status: BEGIN in 2.744 seconds
[0m22:32:31.807942 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m22:32:31.808942 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "model"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "model" is null


      
    ) dbt_internal_test
[0m22:32:32.100787 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.341 seconds
[0m22:32:32.103785 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: ROLLBACK
[0m22:32:32.147815 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.338 seconds
[0m22:32:32.150826 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: ROLLBACK
[0m22:32:32.452796 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: Close
[0m22:32:32.455799 [info ] [Thread-4 (]: 21 of 51 PASS unique_not_null_scooters_hardware_id ............................. [[32mPASS[0m in 3.43s]
[0m22:32:32.459796 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m22:32:32.461811 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m22:32:32.463809 [info ] [Thread-4 (]: 25 of 51 START test unique_not_null_event_types_type_id ........................ [RUN]
[0m22:32:32.465806 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d, now test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85)
[0m22:32:32.467809 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m22:32:32.477806 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m22:32:32.480827 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m22:32:32.485832 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m22:32:32.487335 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m22:32:32.488347 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: BEGIN
[0m22:32:32.489856 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:32.525901 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: Close
[0m22:32:32.527903 [info ] [Thread-1 (]: 22 of 51 PASS unique_not_null_scooters_model ................................... [[32mPASS[0m in 3.50s]
[0m22:32:32.530919 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m22:32:32.532914 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m22:32:32.533911 [info ] [Thread-1 (]: 26 of 51 START test unique_not_null_age_groups_age_end ......................... [RUN]
[0m22:32:32.535915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc, now test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac)
[0m22:32:32.536914 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m22:32:32.547923 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m22:32:32.550926 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m22:32:32.554927 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m22:32:32.557928 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m22:32:32.559940 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: BEGIN
[0m22:32:32.560939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:33.141745 [debug] [Thread-2 (]: SQL status: BEGIN in 2.737 seconds
[0m22:32:33.142781 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m22:32:33.143782 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_type.1e5fc977eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where type_id is not null
),

parent as (
    select type_id as to_field
    from "dev_3lcu"."dbt"."event_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:32:34.153778 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.009 seconds
[0m22:32:34.156783 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: ROLLBACK
[0m22:32:34.237859 [debug] [Thread-3 (]: SQL status: BEGIN in 2.835 seconds
[0m22:32:34.238860 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m22:32:34.239871 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type" is null


      
    ) dbt_internal_test
[0m22:32:34.546701 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: Close
[0m22:32:34.547702 [info ] [Thread-2 (]: 23 of 51 PASS every_event_has_type ............................................. [[32mPASS[0m in 4.17s]
[0m22:32:34.549707 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m22:32:34.549707 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m22:32:34.550718 [info ] [Thread-2 (]: 27 of 51 START test unique_not_null_age_groups_age_start ....................... [RUN]
[0m22:32:34.551720 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_type.1e5fc977eb, now test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b)
[0m22:32:34.552716 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m22:32:34.558721 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m22:32:34.559719 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m22:32:34.562725 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m22:32:34.564726 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m22:32:34.564726 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: BEGIN
[0m22:32:34.565731 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:34.598269 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.358 seconds
[0m22:32:34.600798 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: ROLLBACK
[0m22:32:34.941632 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: Close
[0m22:32:34.943634 [info ] [Thread-3 (]: 24 of 51 PASS unique_not_null_event_types_type ................................. [[32mPASS[0m in 3.55s]
[0m22:32:34.944637 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m22:32:34.945640 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m22:32:34.945640 [info ] [Thread-3 (]: 28 of 51 START test unique_not_null_age_groups_group ........................... [RUN]
[0m22:32:34.947637 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1, now test.dbt_scooters.unique_not_null_age_groups_group.39342291f1)
[0m22:32:34.947637 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m22:32:34.954655 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m22:32:34.956650 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m22:32:34.959648 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m22:32:34.961666 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m22:32:34.962665 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: BEGIN
[0m22:32:34.962665 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:35.268581 [debug] [Thread-4 (]: SQL status: BEGIN in 2.779 seconds
[0m22:32:35.269562 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m22:32:35.270568 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type_id"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type_id" is null


      
    ) dbt_internal_test
[0m22:32:35.614706 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.344 seconds
[0m22:32:35.617671 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: ROLLBACK
[0m22:32:35.956668 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: Close
[0m22:32:35.957669 [info ] [Thread-4 (]: 25 of 51 PASS unique_not_null_event_types_type_id .............................. [[32mPASS[0m in 3.49s]
[0m22:32:35.959709 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m22:32:35.960670 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_clean
[0m22:32:35.961704 [info ] [Thread-4 (]: 29 of 51 START sql incremental model dbt.events_clean .......................... [RUN]
[0m22:32:35.962670 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85, now model.dbt_scooters.events_clean)
[0m22:32:35.963710 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_clean
[0m22:32:35.968695 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m22:32:35.970665 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_clean
[0m22:32:36.036804 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:36.037802 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp223236008807"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at

from
    "dev_3lcu"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."events_clean")
    

  );
  
  
[0m22:32:36.038803 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:36.202988 [debug] [Thread-1 (]: SQL status: BEGIN in 3.642 seconds
[0m22:32:36.203987 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m22:32:36.203987 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_end"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_end" is null


      
    ) dbt_internal_test
[0m22:32:36.546813 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.342 seconds
[0m22:32:36.548794 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: ROLLBACK
[0m22:32:36.884690 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: Close
[0m22:32:36.885691 [info ] [Thread-1 (]: 26 of 51 PASS unique_not_null_age_groups_age_end ............................... [[32mPASS[0m in 4.35s]
[0m22:32:36.886692 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m22:32:36.887698 [debug] [Thread-1 (]: Began running node model.dbt_scooters.first_name_sex
[0m22:32:36.888691 [info ] [Thread-1 (]: 30 of 51 START sql table model dbt.first_name_sex .............................. [RUN]
[0m22:32:36.889691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac, now model.dbt_scooters.first_name_sex)
[0m22:32:36.889691 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.first_name_sex
[0m22:32:36.893274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.first_name_sex"
[0m22:32:36.895279 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.first_name_sex
[0m22:32:36.911874 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.first_name_sex"
[0m22:32:36.914844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:36.915848 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: BEGIN
[0m22:32:36.916843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:37.326662 [debug] [Thread-2 (]: SQL status: BEGIN in 2.761 seconds
[0m22:32:37.327666 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m22:32:37.327666 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_start"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_start" is null


      
    ) dbt_internal_test
[0m22:32:37.666883 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.338 seconds
[0m22:32:37.669895 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: ROLLBACK
[0m22:32:37.699940 [debug] [Thread-3 (]: SQL status: BEGIN in 2.737 seconds
[0m22:32:37.700951 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m22:32:37.700951 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "group"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "group" is null


      
    ) dbt_internal_test
[0m22:32:38.009779 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: Close
[0m22:32:38.010784 [info ] [Thread-2 (]: 27 of 51 PASS unique_not_null_age_groups_age_start ............................. [[32mPASS[0m in 3.46s]
[0m22:32:38.012792 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m22:32:38.012792 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_concurrency
[0m22:32:38.013789 [info ] [Thread-2 (]: 31 of 51 START sql incremental model dbt.trips_concurrency ..................... [RUN]
[0m22:32:38.014783 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b, now model.dbt_scooters.trips_concurrency)
[0m22:32:38.015785 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m22:32:38.021792 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m22:32:38.022793 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m22:32:38.027798 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:38.028796 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp223238025793"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_3lcu"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_3lcu"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now()  as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m22:32:38.029797 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:38.066826 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.365 seconds
[0m22:32:38.068826 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: ROLLBACK
[0m22:32:38.408729 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: Close
[0m22:32:38.409731 [info ] [Thread-3 (]: 28 of 51 PASS unique_not_null_age_groups_group ................................. [[32mPASS[0m in 3.46s]
[0m22:32:38.412740 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m22:32:38.413744 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_geom
[0m22:32:38.414739 [info ] [Thread-3 (]: 32 of 51 START sql view model dbt.trips_geom ................................... [RUN]
[0m22:32:38.415743 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_group.39342291f1, now model.dbt_scooters.trips_geom)
[0m22:32:38.415743 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_geom
[0m22:32:38.419739 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m22:32:38.421749 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_geom
[0m22:32:38.444769 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m22:32:38.445773 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:38.446771 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m22:32:38.447772 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:39.638845 [debug] [Thread-4 (]: SQL status: SELECT 0 in 3.600 seconds
[0m22:32:39.642852 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:39.642852 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: BEGIN
[0m22:32:39.982612 [debug] [Thread-4 (]: SQL status: BEGIN in 0.339 seconds
[0m22:32:39.983613 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:39.983613 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp223236008807'
        
      order by ordinal_position

  
[0m22:32:40.215794 [debug] [Thread-1 (]: SQL status: BEGIN in 3.299 seconds
[0m22:32:40.216795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:40.216795 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

  
    

  create  table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp"
  
  
    as
  
  (
    select distinct first_name, sex
from "dev_3lcu"."scooters_raw"."users"
Where sex is not null
  );
  
[0m22:32:40.336889 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.352 seconds
[0m22:32:40.339896 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:40.340895 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:40.564555 [debug] [Thread-1 (]: SQL status: SELECT 387 in 0.347 seconds
[0m22:32:40.572561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:40.572561 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex" rename to "first_name_sex__dbt_backup"
[0m22:32:40.680646 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.339 seconds
[0m22:32:40.694653 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:40.695647 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp223236008807'
        
      order by ordinal_position

  
[0m22:32:40.941870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.368 seconds
[0m22:32:40.944876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:40.945871 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp" rename to "first_name_sex"
[0m22:32:41.035948 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.340 seconds
[0m22:32:41.040957 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:41.041955 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:41.334702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.388 seconds
[0m22:32:41.342708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:41.342708 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

    
  
  comment on table "dev_3lcu"."dbt"."first_name_sex" is $dbt_comment_literal_block$Unique name_sex glossary$dbt_comment_literal_block$;

  
[0m22:32:41.535855 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.494 seconds
[0m22:32:41.545859 [debug] [Thread-4 (]: 
    In "dev_3lcu"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:41.562873 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m22:32:41.564873 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:41.564873 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        
            delete from "dev_3lcu"."dbt"."events_clean"
            using "events_clean__dbt_tmp223236008807"
            where (
                
                    "events_clean__dbt_tmp223236008807".user_id = "dev_3lcu"."dbt"."events_clean".user_id
                    and 
                
                    "events_clean__dbt_tmp223236008807".timestamp = "dev_3lcu"."dbt"."events_clean".timestamp
                    and 
                
                    "events_clean__dbt_tmp223236008807".type_id = "dev_3lcu"."dbt"."events_clean".type_id
                    
                
                
            );
        
    

    insert into "dev_3lcu"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp223236008807"
    )
  
[0m22:32:41.686957 [debug] [Thread-1 (]: SQL status: COMMENT in 0.343 seconds
[0m22:32:41.687958 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m22:32:41.688955 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:41.688955 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m22:32:41.917638 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.352 seconds
[0m22:32:41.919638 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:41.920650 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_clean" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m22:32:42.034797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.345 seconds
[0m22:32:42.041838 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."first_name_sex__dbt_backup"
[0m22:32:42.047835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:42.047835 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
drop table if exists "dev_3lcu"."dbt"."first_name_sex__dbt_backup" cascade
[0m22:32:42.218852 [debug] [Thread-3 (]: SQL status: BEGIN in 3.771 seconds
[0m22:32:42.219894 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:42.219894 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_3lcu"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m22:32:42.264899 [debug] [Thread-4 (]: SQL status: COMMENT in 0.344 seconds
[0m22:32:42.266888 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: COMMIT
[0m22:32:42.267852 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:42.267852 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: COMMIT
[0m22:32:42.362757 [debug] [Thread-2 (]: SQL status: SELECT 0 in 4.333 seconds
[0m22:32:42.365758 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:42.366757 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m22:32:42.398308 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.350 seconds
[0m22:32:42.399881 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: Close
[0m22:32:42.400889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293187392E0>]}
[0m22:32:42.401890 [info ] [Thread-1 (]: 30 of 51 OK created sql table model dbt.first_name_sex ......................... [[32mSELECT 387[0m in 5.51s]
[0m22:32:42.402890 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.first_name_sex
[0m22:32:42.403893 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m22:32:42.403893 [info ] [Thread-1 (]: 33 of 51 START sql view model dbt.trips_prep ................................... [RUN]
[0m22:32:42.404890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.first_name_sex, now model.dbt_scooters.trips_prep)
[0m22:32:42.405932 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m22:32:42.408894 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m22:32:42.409937 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m22:32:42.414894 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m22:32:42.415927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:42.416935 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m22:32:42.416935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:42.558765 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.338 seconds
[0m22:32:42.561804 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:42.562809 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m22:32:42.620691 [debug] [Thread-4 (]: SQL status: COMMIT in 0.353 seconds
[0m22:32:42.622697 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: Close
[0m22:32:42.623689 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931968BFB0>]}
[0m22:32:42.623689 [info ] [Thread-4 (]: 29 of 51 OK created sql incremental model dbt.events_clean ..................... [[32mINSERT 0 0[0m in 6.66s]
[0m22:32:42.625651 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_clean
[0m22:32:42.625651 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies
[0m22:32:42.626688 [info ] [Thread-4 (]: 34 of 51 START sql table model dbt.companies ................................... [RUN]
[0m22:32:42.627688 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.companies)
[0m22:32:42.628670 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies
[0m22:32:42.631686 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m22:32:42.632689 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies
[0m22:32:42.636646 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m22:32:42.638646 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:42.639647 [debug] [Thread-4 (]: On model.dbt_scooters.companies: BEGIN
[0m22:32:42.639647 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:42.701955 [debug] [Thread-2 (]: SQL status: BEGIN in 0.334 seconds
[0m22:32:42.701955 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:42.702952 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp223238025793'
        
      order by ordinal_position

  
[0m22:32:42.898387 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.335 seconds
[0m22:32:42.902002 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:42.903001 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m22:32:43.056862 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.353 seconds
[0m22:32:43.059858 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:43.060857 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:43.243862 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.341 seconds
[0m22:32:43.247851 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:43.248805 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_geom" is $dbt_comment_literal_block$Trips prepared for geometry analysis$dbt_comment_literal_block$;

  
[0m22:32:43.408018 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.346 seconds
[0m22:32:43.411617 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:43.412578 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp223238025793'
        
      order by ordinal_position

  
[0m22:32:43.602210 [debug] [Thread-3 (]: SQL status: COMMENT in 0.353 seconds
[0m22:32:43.603211 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m22:32:43.604251 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:43.604251 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m22:32:43.761737 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.349 seconds
[0m22:32:43.764744 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:43.765744 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:43.945902 [debug] [Thread-3 (]: SQL status: COMMIT in 0.341 seconds
[0m22:32:43.948855 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_geom__dbt_backup"
[0m22:32:43.951895 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:43.952899 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_3lcu"."dbt"."trips_geom__dbt_backup" cascade
[0m22:32:44.123632 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.357 seconds
[0m22:32:44.125630 [debug] [Thread-2 (]: 
    In "dev_3lcu"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:44.131628 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m22:32:44.133630 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:44.134590 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_3lcu"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp223238025793"
    )


  
[0m22:32:44.290840 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.338 seconds
[0m22:32:44.292842 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: Close
[0m22:32:44.293841 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029318766E10>]}
[0m22:32:44.294884 [info ] [Thread-3 (]: 32 of 51 OK created sql view model dbt.trips_geom .............................. [[32mCREATE VIEW[0m in 5.88s]
[0m22:32:44.295847 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_geom
[0m22:32:44.296888 [debug] [Thread-3 (]: Began running node model.dbt_scooters.users_full
[0m22:32:44.296888 [info ] [Thread-3 (]: 35 of 51 START sql table model dbt.users_full .................................. [RUN]
[0m22:32:44.298399 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.users_full)
[0m22:32:44.298399 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.users_full
[0m22:32:44.302966 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.users_full"
[0m22:32:44.304967 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.users_full
[0m22:32:44.308970 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.users_full"
[0m22:32:44.309964 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:44.310964 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: BEGIN
[0m22:32:44.310964 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:44.534757 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.400 seconds
[0m22:32:44.536757 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:44.536757 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_concurrency" is $dbt_comment_literal_block$Number of simultaneous rides in time$dbt_comment_literal_block$;

  
[0m22:32:44.900231 [debug] [Thread-2 (]: SQL status: COMMENT in 0.362 seconds
[0m22:32:44.902231 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m22:32:44.902231 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:44.903220 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m22:32:45.202858 [debug] [Thread-1 (]: SQL status: BEGIN in 2.785 seconds
[0m22:32:45.203860 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:45.203860 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_3lcu"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select
    id,
    user_id,
    scooter_hw_id,
    started_at,
    finished_at,
    start_lat,
    start_lon,
    finish_lat,
    finish_lon,
    distance as distance_m,
    cast(price as decimal(20, 2)) / 100 as price_rub,
    extract(epoch from (finished_at - started_at)) as duration_s,
    finished_at <> started_at and price = 0 as is_free,
    
    date(started_at at time zone 'Europe/Moscow')
 as "date"
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m22:32:45.239861 [debug] [Thread-2 (]: SQL status: COMMIT in 0.337 seconds
[0m22:32:45.242860 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: Close
[0m22:32:45.243858 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293189D0B60>]}
[0m22:32:45.245861 [info ] [Thread-2 (]: 31 of 51 OK created sql incremental model dbt.trips_concurrency ................ [[32mINSERT 0 0[0m in 7.23s]
[0m22:32:45.246863 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m22:32:45.247862 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_full
[0m22:32:45.248862 [info ] [Thread-2 (]: 36 of 51 START sql view model dbt.events_full .................................. [RUN]
[0m22:32:45.249863 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.events_full)
[0m22:32:45.249863 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_full
[0m22:32:45.253859 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m22:32:45.254861 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_full
[0m22:32:45.258862 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m22:32:45.260863 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:45.261863 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: BEGIN
[0m22:32:45.261863 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:45.467775 [debug] [Thread-4 (]: SQL status: BEGIN in 2.827 seconds
[0m22:32:45.467775 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:45.468742 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_3lcu"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
  );
  
[0m22:32:45.550897 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.346 seconds
[0m22:32:45.554898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:45.555901 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m22:32:45.813090 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.344 seconds
[0m22:32:45.817084 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:45.818095 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies" rename to "companies__dbt_backup"
[0m22:32:45.891697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.335 seconds
[0m22:32:45.895657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:45.895657 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m22:32:46.163652 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.345 seconds
[0m22:32:46.168649 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:46.169649 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies__dbt_tmp" rename to "companies"
[0m22:32:46.230818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.334 seconds
[0m22:32:46.232765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:46.233765 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_prep" is $dbt_comment_literal_block$Trips prepared for analysis$dbt_comment_literal_block$;

  
[0m22:32:46.506456 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m22:32:46.508452 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:46.509957 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies" is $dbt_comment_literal_block$Scooter statistics by company$dbt_comment_literal_block$;

  
[0m22:32:46.571577 [debug] [Thread-1 (]: SQL status: COMMENT in 0.337 seconds
[0m22:32:46.573578 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m22:32:46.573578 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:46.574577 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m22:32:46.847560 [debug] [Thread-4 (]: SQL status: COMMENT in 0.337 seconds
[0m22:32:46.848559 [debug] [Thread-4 (]: On model.dbt_scooters.companies: COMMIT
[0m22:32:46.849561 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:46.850525 [debug] [Thread-4 (]: On model.dbt_scooters.companies: COMMIT
[0m22:32:46.909718 [debug] [Thread-1 (]: SQL status: COMMIT in 0.335 seconds
[0m22:32:46.912726 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_prep__dbt_backup"
[0m22:32:46.913726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:46.914725 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_3lcu"."dbt"."trips_prep__dbt_backup" cascade
[0m22:32:47.009914 [debug] [Thread-3 (]: SQL status: BEGIN in 2.699 seconds
[0m22:32:47.010959 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:47.011924 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

  
    

  create  table "dev_3lcu"."dbt"."users_full__dbt_tmp"
  
  
    as
  
  (
    select
   u.id, u.first_name ,u.last_name ,u.phone ,
   COALESCE(u.sex, fns.sex, afns.sex) as sex2,
   u.birth_date
from "dev_3lcu"."scooters_raw"."users" u
left join "dev_3lcu"."dbt"."first_name_sex" fns on u.first_name = fns.first_name
left join "dev_3lcu"."dbt"."add_first_name_sex" afns on u.first_name =afns.first_name
  );
  
[0m22:32:47.190571 [debug] [Thread-4 (]: SQL status: COMMIT in 0.340 seconds
[0m22:32:47.193567 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."companies__dbt_backup"
[0m22:32:47.194530 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:47.194530 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_3lcu"."dbt"."companies__dbt_backup" cascade
[0m22:32:47.251737 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.336 seconds
[0m22:32:47.252738 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m22:32:47.253737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319179DC0>]}
[0m22:32:47.254738 [info ] [Thread-1 (]: 33 of 51 OK created sql view model dbt.trips_prep .............................. [[32mCREATE VIEW[0m in 4.85s]
[0m22:32:47.255740 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m22:32:47.256779 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m22:32:47.257738 [info ] [Thread-1 (]: 37 of 51 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m22:32:47.258739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.parking_finish_stat)
[0m22:32:47.258739 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m22:32:47.261777 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m22:32:47.263765 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m22:32:47.267785 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m22:32:47.269771 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:32:47.269771 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m22:32:47.270740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:47.361603 [debug] [Thread-3 (]: SQL status: SELECT 2000 in 0.350 seconds
[0m22:32:47.365598 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:47.366558 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full" rename to "users_full__dbt_backup"
[0m22:32:47.536937 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.342 seconds
[0m22:32:47.539928 [debug] [Thread-4 (]: On model.dbt_scooters.companies: Close
[0m22:32:47.540927 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319179B20>]}
[0m22:32:47.540927 [info ] [Thread-4 (]: 34 of 51 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 4.91s]
[0m22:32:47.542887 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies
[0m22:32:47.542887 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_start_stat
[0m22:32:47.543925 [info ] [Thread-4 (]: 38 of 51 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m22:32:47.544889 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.parking_start_stat)
[0m22:32:47.545889 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m22:32:47.548890 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m22:32:47.550886 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m22:32:47.555914 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m22:32:47.556926 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:32:47.557886 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m22:32:47.557886 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:47.705146 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m22:32:47.708106 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:47.709615 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full__dbt_tmp" rename to "users_full"
[0m22:32:47.994664 [debug] [Thread-2 (]: SQL status: BEGIN in 2.733 seconds
[0m22:32:47.995661 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:47.995661 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_3lcu"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select * from
"dev_3lcu"."dbt"."events_clean" as e
left join "dev_3lcu"."dbt"."event_types" as t
using (type_id)
  );
[0m22:32:48.049876 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.340 seconds
[0m22:32:48.051876 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:48.052873 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

    
  
  comment on table "dev_3lcu"."dbt"."users_full" is $dbt_comment_literal_block$Users enriched with sex$dbt_comment_literal_block$;

  
[0m22:32:48.349649 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.353 seconds
[0m22:32:48.353638 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:48.354637 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m22:32:48.391650 [debug] [Thread-3 (]: SQL status: COMMENT in 0.339 seconds
[0m22:32:48.393640 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: COMMIT
[0m22:32:48.394640 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:48.394640 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: COMMIT
[0m22:32:48.691532 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.336 seconds
[0m22:32:48.697487 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:48.698487 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m22:32:48.735640 [debug] [Thread-3 (]: SQL status: COMMIT in 0.340 seconds
[0m22:32:48.738641 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."users_full__dbt_backup"
[0m22:32:48.739681 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:48.739681 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
drop table if exists "dev_3lcu"."dbt"."users_full__dbt_backup" cascade
[0m22:32:49.035707 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m22:32:49.037701 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:49.038699 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

    
  
  comment on view "dev_3lcu"."dbt"."events_full" is $dbt_comment_literal_block$User events enriched with meaningful types$dbt_comment_literal_block$;

  
[0m22:32:49.083716 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.343 seconds
[0m22:32:49.085725 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: Close
[0m22:32:49.086701 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293189F0200>]}
[0m22:32:49.087704 [info ] [Thread-3 (]: 35 of 51 OK created sql table model dbt.users_full ............................. [[32mSELECT 2000[0m in 4.79s]
[0m22:32:49.088718 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.users_full
[0m22:32:49.089704 [debug] [Thread-3 (]: Began running node model.dbt_scooters.revenue_daily
[0m22:32:49.089704 [info ] [Thread-3 (]: 39 of 51 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m22:32:49.090741 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.users_full, now model.dbt_scooters.revenue_daily)
[0m22:32:49.091745 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m22:32:49.095740 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m22:32:49.097704 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.revenue_daily
[0m22:32:49.101735 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:49.102736 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp223249099738"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_3lcu"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m22:32:49.102736 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:49.374757 [debug] [Thread-2 (]: SQL status: COMMENT in 0.336 seconds
[0m22:32:49.376789 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: COMMIT
[0m22:32:49.376789 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:49.377757 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: COMMIT
[0m22:32:49.718836 [debug] [Thread-2 (]: SQL status: COMMIT in 0.340 seconds
[0m22:32:49.721873 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."events_full__dbt_backup"
[0m22:32:49.722833 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:49.722833 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_3lcu"."dbt"."events_full__dbt_backup" cascade
[0m22:32:50.060949 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.337 seconds
[0m22:32:50.062955 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: Close
[0m22:32:50.063911 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931972F8F0>]}
[0m22:32:50.064951 [info ] [Thread-2 (]: 36 of 51 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 4.81s]
[0m22:32:50.065912 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_full
[0m22:32:50.066915 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat
[0m22:32:50.067912 [info ] [Thread-2 (]: 40 of 51 START sql table model dbt.trips_stat .................................. [RUN]
[0m22:32:50.068913 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_stat)
[0m22:32:50.068913 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat
[0m22:32:50.071952 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m22:32:50.073908 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat
[0m22:32:50.077947 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m22:32:50.078913 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:32:50.079946 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m22:32:50.079946 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:50.227798 [debug] [Thread-1 (]: SQL status: BEGIN in 2.957 seconds
[0m22:32:50.228763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:32:50.228763 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m22:32:51.335845 [debug] [Thread-4 (]: SQL status: BEGIN in 3.778 seconds
[0m22:32:51.336843 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:32:51.336843 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m22:32:53.835702 [debug] [Thread-2 (]: SQL status: BEGIN in 3.755 seconds
[0m22:32:53.835702 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:32:53.836654 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count(*) as trips,
    count(distinct user_id) as users,
    avg(duration_s) / 60 as avg_duration_min,
    sum(distance_m) / 1000 as sum_distance_km,
    sum(price_rub) as revenue_rub,
    count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from
    "dev_3lcu"."dbt"."trips_prep"
  );
  
[0m22:32:55.268524 [debug] [Thread-3 (]: SQL status: SELECT 3 in 6.166 seconds
[0m22:32:55.272537 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:55.272537 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m22:32:55.642872 [debug] [Thread-3 (]: SQL status: BEGIN in 0.369 seconds
[0m22:32:55.642872 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:55.643910 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp223249099738'
        
      order by ordinal_position

  
[0m22:32:56.535585 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.891 seconds
[0m22:32:56.539577 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:56.540581 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m22:32:57.049561 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.508 seconds
[0m22:32:57.053609 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:57.053609 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp223249099738'
        
      order by ordinal_position

  
[0m22:32:57.537953 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.483 seconds
[0m22:32:57.541547 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:57.542505 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m22:32:57.938613 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.395 seconds
[0m22:32:57.940643 [debug] [Thread-3 (]: 
    In "dev_3lcu"."finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:57.941643 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m22:32:57.942646 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:57.943612 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        
            delete from "dev_3lcu"."finance"."revenue_daily"
            using "revenue_daily__dbt_tmp223249099738"
            where (
                
                    "revenue_daily__dbt_tmp223249099738".date = "dev_3lcu"."finance"."revenue_daily".date
                    
                
                
            );
        
    

    insert into "dev_3lcu"."finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp223249099738"
    )
  
[0m22:32:58.334000 [debug] [Thread-3 (]: SQL status: INSERT 0 3 in 0.390 seconds
[0m22:32:58.341592 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:58.342588 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_3lcu".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'finance'
        and table_name = 'revenue_daily'
  
[0m22:32:58.740634 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.397 seconds
[0m22:32:58.741633 [debug] [Thread-3 (]: On "dev_3lcu"."finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m22:32:58.742643 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:58.743633 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  comment on table "dev_3lcu"."finance"."revenue_daily" is $dbt_comment_literal_block$Summary daily revenue$dbt_comment_literal_block$;

  
[0m22:32:59.136999 [debug] [Thread-3 (]: SQL status: COMMENT in 0.394 seconds
[0m22:32:59.139538 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m22:32:59.139538 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:59.140578 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m22:32:59.540670 [debug] [Thread-3 (]: SQL status: COMMIT in 0.400 seconds
[0m22:32:59.541665 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: Close
[0m22:32:59.542673 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319765160>]}
[0m22:32:59.543622 [info ] [Thread-3 (]: 39 of 51 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 3[0m in 10.45s]
[0m22:32:59.544665 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.revenue_daily
[0m22:32:59.545666 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m22:32:59.546625 [info ] [Thread-3 (]: 41 of 51 START sql table model dbt.trips_stat_daily ............................ [RUN]
[0m22:32:59.547622 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_stat_daily)
[0m22:32:59.548629 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m22:32:59.551663 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m22:32:59.552621 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m22:32:59.556668 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m22:32:59.557625 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:32:59.558628 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m22:32:59.558628 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:02.238682 [debug] [Thread-2 (]: SQL status: SELECT 1 in 8.402 seconds
[0m22:33:02.242717 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:33:02.243721 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m22:33:02.633660 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.390 seconds
[0m22:33:02.637659 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:33:02.637659 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m22:33:03.036561 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.398 seconds
[0m22:33:03.038562 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:33:03.039558 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat" is $dbt_comment_literal_block$Overall trips statistics$dbt_comment_literal_block$;

  
[0m22:33:03.155678 [debug] [Thread-3 (]: SQL status: BEGIN in 3.597 seconds
[0m22:33:03.156679 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:03.157680 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    count(*) as trips,
    max(price_rub) as max_price_rub,
    avg(distance_m) / 1000 as avg_distance_km,
    avg(price_rub)/avg(duration_s) * 60 as avg_price_rub_per_min
from
    "dev_3lcu"."dbt"."trips_prep"
group by
    1
order by
    1
  );
  
[0m22:33:03.433903 [debug] [Thread-2 (]: SQL status: COMMENT in 0.394 seconds
[0m22:33:03.434904 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m22:33:03.435904 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:33:03.435904 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m22:33:03.838710 [debug] [Thread-2 (]: SQL status: COMMIT in 0.402 seconds
[0m22:33:03.840715 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat__dbt_backup"
[0m22:33:03.842715 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:33:03.842715 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat__dbt_backup" cascade
[0m22:33:04.244491 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.401 seconds
[0m22:33:04.246494 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: Close
[0m22:33:04.247495 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029318736FF0>]}
[0m22:33:04.248497 [info ] [Thread-2 (]: 40 of 51 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 14.18s]
[0m22:33:04.249498 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat
[0m22:33:04.250504 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_users
[0m22:33:04.250504 [info ] [Thread-2 (]: 42 of 51 START sql incremental model dbt.trips_users ........................... [RUN]
[0m22:33:04.251507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_users)
[0m22:33:04.252508 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_users
[0m22:33:04.256503 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m22:33:04.257507 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_users
[0m22:33:04.261514 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:04.262511 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp223304259506"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep" as t
left join
    "dev_3lcu"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_3lcu"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m22:33:04.262511 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:10.237210 [debug] [Thread-2 (]: SQL status: SELECT 0 in 5.974 seconds
[0m22:33:10.240731 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:10.240731 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: BEGIN
[0m22:33:10.638319 [debug] [Thread-2 (]: SQL status: BEGIN in 0.397 seconds
[0m22:33:10.639831 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:10.639831 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp223304259506'
        
      order by ordinal_position

  
[0m22:33:11.936380 [debug] [Thread-2 (]: SQL status: SELECT 17 in 1.295 seconds
[0m22:33:11.939970 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:11.941020 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:33:12.641858 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.700 seconds
[0m22:33:12.645863 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:12.646858 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp223304259506'
        
      order by ordinal_position

  
[0m22:33:13.332493 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.685 seconds
[0m22:33:13.338051 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:13.339559 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:33:14.042287 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.702 seconds
[0m22:33:14.050895 [debug] [Thread-2 (]: 
    In "dev_3lcu"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:33:14.053063 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m22:33:14.055601 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:14.058028 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_3lcu"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp223304259506"
    )


  
[0m22:33:14.465793 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.406 seconds
[0m22:33:14.468945 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:14.469941 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_users" is $dbt_comment_literal_block$Prepared trips enriched with users data$dbt_comment_literal_block$;

  
[0m22:33:14.833924 [debug] [Thread-2 (]: SQL status: COMMENT in 0.364 seconds
[0m22:33:14.837475 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:14.837475 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m22:33:15.244919 [debug] [Thread-3 (]: SQL status: SELECT 91 in 12.087 seconds
[0m22:33:15.250536 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:15.252537 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m22:33:15.635594 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.382 seconds
[0m22:33:15.642031 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:15.643416 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m22:33:16.064553 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.420 seconds
[0m22:33:16.089552 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:16.090560 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    create  index if not exists
  "cd40d69f91be17b7427948c8179e5a5c"
  on "dev_3lcu"."dbt"."trips_stat_daily" 
  (date)
  
[0m22:33:16.552525 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.461 seconds
[0m22:33:16.558529 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:16.559531 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat_daily" is $dbt_comment_literal_block$Overall trips statistics per day$dbt_comment_literal_block$;

  
[0m22:33:16.934090 [debug] [Thread-3 (]: SQL status: COMMENT in 0.373 seconds
[0m22:33:16.943408 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:16.945408 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_stat_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:33:17.877231 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.931 seconds
[0m22:33:17.881508 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:17.882511 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."trips_stat_daily".date is $dbt_comment_literal_block$Trips date$dbt_comment_literal_block$;
  

  
[0m22:33:18.315855 [debug] [Thread-3 (]: SQL status: COMMENT in 0.433 seconds
[0m22:33:18.318485 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m22:33:18.319505 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:18.320786 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m22:33:18.666320 [debug] [Thread-3 (]: SQL status: COMMIT in 0.345 seconds
[0m22:33:18.674672 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup"
[0m22:33:18.676672 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:18.677673 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m22:33:19.064466 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.386 seconds
[0m22:33:19.068469 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m22:33:19.070468 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293192384A0>]}
[0m22:33:19.071468 [info ] [Thread-3 (]: 41 of 51 OK created sql table model dbt.trips_stat_daily ....................... [[32mSELECT 91[0m in 19.52s]
[0m22:33:19.074474 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m22:33:19.075464 [debug] [Thread-3 (]: Began running node model.dbt_scooters.companies_trips
[0m22:33:19.076474 [info ] [Thread-3 (]: 43 of 51 START sql table model dbt.companies_trips ............................. [RUN]
[0m22:33:19.078466 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.companies_trips)
[0m22:33:19.079466 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.companies_trips
[0m22:33:19.085467 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m22:33:19.087466 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.companies_trips
[0m22:33:19.094465 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m22:33:19.097468 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:19.098472 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m22:33:19.099469 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:22.432792 [debug] [Thread-3 (]: SQL status: BEGIN in 3.332 seconds
[0m22:33:22.433794 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:22.434793 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_3lcu"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_3lcu"."dbt"."trips_prep" as t
        join "dev_3lcu"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_3lcu"."dbt"."companies" as c
        using (company)
  );
  
[0m22:33:26.842530 [debug] [Thread-3 (]: SQL status: SELECT 6 in 4.407 seconds
[0m22:33:26.845526 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:26.847071 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m22:33:27.141797 [debug] [Thread-2 (]: SQL status: ANALYZE in 12.303 seconds
[0m22:33:27.143797 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m22:33:27.143797 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:27.144796 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m22:33:27.236433 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.389 seconds
[0m22:33:27.239433 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:27.240439 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m22:33:27.539743 [debug] [Thread-2 (]: SQL status: COMMIT in 0.395 seconds
[0m22:33:27.540742 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:27.541741 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m22:33:27.634419 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.394 seconds
[0m22:33:27.637450 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:27.637450 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies_trips" is $dbt_comment_literal_block$Trip statistics by company$dbt_comment_literal_block$;

  
[0m22:33:27.931652 [debug] [Thread-2 (]: SQL status: COMMIT in 0.390 seconds
[0m22:33:27.933649 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:27.933649 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m22:33:28.035817 [debug] [Thread-3 (]: SQL status: COMMENT in 0.397 seconds
[0m22:33:28.039823 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:28.040783 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'companies_trips'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:33:28.343526 [debug] [Thread-2 (]: SQL status: VACUUM in 0.409 seconds
[0m22:33:28.345566 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: Close
[0m22:33:28.346529 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319755640>]}
[0m22:33:28.347530 [info ] [Thread-2 (]: 42 of 51 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 24.10s]
[0m22:33:28.349072 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_users
[0m22:33:28.349072 [debug] [Thread-2 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m22:33:28.350119 [info ] [Thread-2 (]: 44 of 51 START test events_full_is_complete .................................... [RUN]
[0m22:33:28.351113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now test.dbt_scooters.events_full_is_complete)
[0m22:33:28.352113 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m22:33:28.358082 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m22:33:28.359590 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m22:33:28.362599 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.events_full_is_complete"
[0m22:33:28.364600 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m22:33:28.364600 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: BEGIN
[0m22:33:28.365600 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:28.735692 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.694 seconds
[0m22:33:28.738661 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:28.739692 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."companies_trips".company is $dbt_comment_literal_block$Scooters manufacturing company$dbt_comment_literal_block$;
  

  
[0m22:33:29.147808 [debug] [Thread-3 (]: SQL status: COMMENT in 0.408 seconds
[0m22:33:29.151372 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m22:33:29.152397 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:29.153396 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m22:33:29.535617 [debug] [Thread-3 (]: SQL status: COMMIT in 0.381 seconds
[0m22:33:29.538601 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."companies_trips__dbt_backup"
[0m22:33:29.539616 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:29.540578 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_3lcu"."dbt"."companies_trips__dbt_backup" cascade
[0m22:33:29.887643 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.347 seconds
[0m22:33:29.889639 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: Close
[0m22:33:29.890642 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931975C290>]}
[0m22:33:29.891639 [info ] [Thread-3 (]: 43 of 51 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 10.81s]
[0m22:33:29.892636 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.companies_trips
[0m22:33:29.893641 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m22:33:29.894632 [info ] [Thread-3 (]: 45 of 51 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m22:33:29.895614 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_age_daily)
[0m22:33:29.896640 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m22:33:29.899600 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m22:33:29.901605 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m22:33:29.907638 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m22:33:29.910615 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:29.911620 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m22:33:29.912619 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:30.637684 [debug] [Thread-1 (]: SQL status: SELECT 464 in 40.408 seconds
[0m22:33:30.641696 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:33:30.642699 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m22:33:31.035632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.393 seconds
[0m22:33:31.039627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:33:31.039627 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m22:33:31.337493 [debug] [Thread-2 (]: SQL status: BEGIN in 2.972 seconds
[0m22:33:31.338450 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m22:33:31.338450 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.events_full_is_complete"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with source_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_clean"
),
target_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_full"
)
select
    'Row count mismatch' as error_message,
    source_cte.row_count as source_count,
    target_cte.row_count as target_count
from
    source_cte,
    target_cte
where
    source_cte.row_count != target_cte.row_count
      
    ) dbt_internal_test
[0m22:33:31.435416 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.394 seconds
[0m22:33:31.437416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:33:31.438416 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_finish_stat" is $dbt_comment_literal_block$Trip finish parking statistics by 10 m hexagons$dbt_comment_literal_block$;

  
[0m22:33:31.834593 [debug] [Thread-1 (]: SQL status: COMMENT in 0.396 seconds
[0m22:33:31.836591 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m22:33:31.836591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:33:31.837591 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m22:33:32.235683 [debug] [Thread-1 (]: SQL status: COMMIT in 0.398 seconds
[0m22:33:32.238682 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup"
[0m22:33:32.239689 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:33:32.240689 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m22:33:32.635641 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.394 seconds
[0m22:33:32.637641 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m22:33:32.638641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293191780B0>]}
[0m22:33:32.639642 [info ] [Thread-1 (]: 37 of 51 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 45.38s]
[0m22:33:32.640649 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m22:33:32.641652 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_group
[0m22:33:32.641652 [info ] [Thread-1 (]: 46 of 51 START sql table model dbt.trips_age_group ............................. [RUN]
[0m22:33:32.643653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_finish_stat, now model.dbt_scooters.trips_age_group)
[0m22:33:32.643653 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m22:33:32.647649 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m22:33:32.648649 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_group
[0m22:33:32.653690 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m22:33:32.655269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:32.656268 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m22:33:32.656268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:32.835576 [debug] [Thread-3 (]: SQL status: BEGIN in 2.923 seconds
[0m22:33:32.835576 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:32.836576 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    Select "date",
       age,
       count(*) as trips,
       sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m22:33:33.047550 [debug] [Thread-4 (]: SQL status: SELECT 142 in 41.710 seconds
[0m22:33:33.052543 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:33:33.053534 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m22:33:33.394378 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.340 seconds
[0m22:33:33.399379 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:33:33.401383 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m22:33:33.834610 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.433 seconds
[0m22:33:33.839612 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:33:33.840602 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_start_stat" is $dbt_comment_literal_block$Trip start parking statistics by 500 m hexagons$dbt_comment_literal_block$;

  
[0m22:33:34.035585 [debug] [Thread-2 (]: SQL status: SELECT 1 in 2.696 seconds
[0m22:33:34.038582 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: ROLLBACK
[0m22:33:34.183378 [debug] [Thread-4 (]: SQL status: COMMENT in 0.342 seconds
[0m22:33:34.186371 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m22:33:34.186371 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:33:34.187371 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m22:33:34.434361 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: Close
[0m22:33:34.435360 [info ] [Thread-2 (]: 44 of 51 PASS events_full_is_complete .......................................... [[32mPASS[0m in 6.08s]
[0m22:33:34.437362 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m22:33:34.438361 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:33:34.438361 [info ] [Thread-2 (]: 47 of 51 START test unique_companies_trips_company ............................. [RUN]
[0m22:33:34.439359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.events_full_is_complete, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m22:33:34.440397 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:33:34.445392 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:33:34.447396 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:33:34.452361 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:33:34.455364 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:33:34.456363 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m22:33:34.456363 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:34.642551 [debug] [Thread-3 (]: SQL status: SELECT 7049 in 1.806 seconds
[0m22:33:34.643556 [debug] [Thread-4 (]: SQL status: COMMIT in 0.455 seconds
[0m22:33:34.648558 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:34.653552 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_start_stat__dbt_backup"
[0m22:33:34.654552 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m22:33:34.656555 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:33:34.657063 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_start_stat__dbt_backup" cascade
[0m22:33:34.994395 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m22:33:34.998401 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:34.999400 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.341 seconds
[0m22:33:35.000367 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m22:33:35.004395 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: Close
[0m22:33:35.005361 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931971D790>]}
[0m22:33:35.006362 [info ] [Thread-4 (]: 38 of 51 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 47.46s]
[0m22:33:35.008396 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m22:33:35.009398 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_stat
[0m22:33:35.010395 [info ] [Thread-4 (]: 48 of 51 START sql table model dbt.events_stat ................................. [RUN]
[0m22:33:35.011368 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now model.dbt_scooters.events_stat)
[0m22:33:35.012399 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_stat
[0m22:33:35.016362 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m22:33:35.019368 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_stat
[0m22:33:35.024367 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m22:33:35.025369 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:35.026368 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: BEGIN
[0m22:33:35.027369 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:33:35.342378 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m22:33:35.345410 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:35.346381 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily" is $dbt_comment_literal_block$Daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m22:33:35.656658 [debug] [Thread-1 (]: SQL status: BEGIN in 3.000 seconds
[0m22:33:35.657648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:35.658623 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users" as tu
    cross join "dev_3lcu"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m22:33:35.684698 [debug] [Thread-3 (]: SQL status: COMMENT in 0.338 seconds
[0m22:33:35.686733 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m22:33:35.687733 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:35.688700 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m22:33:36.027703 [debug] [Thread-3 (]: SQL status: COMMIT in 0.339 seconds
[0m22:33:36.031710 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily__dbt_backup"
[0m22:33:36.032711 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:36.034715 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily__dbt_backup" cascade
[0m22:33:36.375872 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.340 seconds
[0m22:33:36.377870 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m22:33:36.379378 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319178920>]}
[0m22:33:36.380389 [info ] [Thread-3 (]: 45 of 51 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 6.48s]
[0m22:33:36.381386 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m22:33:36.383397 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m22:33:36.384392 [info ] [Thread-3 (]: 49 of 51 START test unique_key_trips_age_daily_date__age ....................... [RUN]
[0m22:33:36.385390 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be)
[0m22:33:36.386422 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m22:33:36.392420 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m22:33:36.393421 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m22:33:36.396425 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m22:33:36.398421 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m22:33:36.400389 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: BEGIN
[0m22:33:36.401394 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:37.972950 [debug] [Thread-4 (]: SQL status: BEGIN in 2.946 seconds
[0m22:33:37.973943 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:37.974912 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
       count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from "dev_3lcu"."dbt"."events_full"
  );
  
[0m22:33:38.273371 [debug] [Thread-2 (]: SQL status: BEGIN in 3.817 seconds
[0m22:33:38.274369 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:33:38.274369 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



      
    ) dbt_internal_test
[0m22:33:38.617720 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.342 seconds
[0m22:33:38.620747 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m22:33:39.041538 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m22:33:39.043529 [info ] [Thread-2 (]: 47 of 51 PASS unique_companies_trips_company ................................... [[32mPASS[0m in 4.60s]
[0m22:33:39.044491 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:33:39.045495 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m22:33:39.045495 [info ] [Thread-2 (]: 50 of 51 START test unique_trips_age_daily_date_text_age_text .................. [RUN]
[0m22:33:39.046530 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0, now test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e)
[0m22:33:39.047535 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m22:33:39.053498 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m22:33:39.055501 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m22:33:39.060497 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m22:33:39.061497 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m22:33:39.062500 [debug] [Thread-2 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: BEGIN
[0m22:33:39.062500 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:39.536291 [debug] [Thread-3 (]: SQL status: BEGIN in 3.135 seconds
[0m22:33:39.536291 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m22:33:39.537291 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "date"::text ||
    
        "age"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m22:33:40.251773 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.714 seconds
[0m22:33:40.253767 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: ROLLBACK
[0m22:33:40.634447 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: Close
[0m22:33:40.635509 [info ] [Thread-3 (]: 49 of 51 PASS unique_key_trips_age_daily_date__age ............................. [[32mPASS[0m in 4.25s]
[0m22:33:40.636486 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m22:33:41.741760 [debug] [Thread-4 (]: SQL status: SELECT 1 in 3.766 seconds
[0m22:33:41.744760 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:41.745759 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m22:33:42.134344 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.388 seconds
[0m22:33:42.138343 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:42.139340 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m22:33:42.532678 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.393 seconds
[0m22:33:42.535677 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:42.536675 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_stat" is $dbt_comment_literal_block$Overall user events statistics$dbt_comment_literal_block$;

  
[0m22:33:42.884504 [debug] [Thread-4 (]: SQL status: COMMENT in 0.347 seconds
[0m22:33:42.886495 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m22:33:42.886495 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:42.887499 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m22:33:42.891502 [debug] [Thread-2 (]: SQL status: BEGIN in 3.828 seconds
[0m22:33:42.891502 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m22:33:42.892503 [debug] [Thread-2 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date::text || age::text as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."trips_age_daily"
where date::text || age::text is not null
group by date::text || age::text
having count(*) > 1



      
    ) dbt_internal_test
[0m22:33:43.365402 [debug] [Thread-4 (]: SQL status: COMMIT in 0.478 seconds
[0m22:33:43.369915 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."events_stat__dbt_backup"
[0m22:33:43.370921 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:43.370921 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_3lcu"."dbt"."events_stat__dbt_backup" cascade
[0m22:33:43.738706 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.846 seconds
[0m22:33:43.740712 [debug] [Thread-2 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: ROLLBACK
[0m22:33:43.747711 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.376 seconds
[0m22:33:43.748712 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: Close
[0m22:33:43.750729 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931971E930>]}
[0m22:33:43.751724 [info ] [Thread-4 (]: 48 of 51 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 8.74s]
[0m22:33:43.753721 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_stat
[0m22:33:44.078229 [debug] [Thread-2 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: Close
[0m22:33:44.079737 [info ] [Thread-2 (]: 50 of 51 PASS unique_trips_age_daily_date_text_age_text ........................ [[32mPASS[0m in 5.03s]
[0m22:33:44.080749 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m22:33:44.081750 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m22:33:44.083750 [info ] [Thread-3 (]: 51 of 51 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m22:33:44.084750 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be, now model.dbt_scooters.trips_age_daily_stat)
[0m22:33:44.085749 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m22:33:44.088749 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:44.090749 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m22:33:44.094747 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:44.095749 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:44.096749 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m22:33:44.097750 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:48.137345 [debug] [Thread-3 (]: SQL status: BEGIN in 4.040 seconds
[0m22:33:48.138342 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:48.138342 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m22:33:48.835493 [debug] [Thread-3 (]: SQL status: SELECT 83 in 0.696 seconds
[0m22:33:48.839492 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:48.840451 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m22:33:49.235681 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.395 seconds
[0m22:33:49.238684 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:49.239725 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m22:33:49.342526 [debug] [Thread-1 (]: SQL status: SELECT 7 in 13.683 seconds
[0m22:33:49.345574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:49.346564 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m22:33:49.578474 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m22:33:49.580073 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:49.581073 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily_stat" is $dbt_comment_literal_block$Aggregation of daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m22:33:49.684236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m22:33:49.688269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:49.688269 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m22:33:49.918405 [debug] [Thread-3 (]: SQL status: COMMENT in 0.336 seconds
[0m22:33:49.920400 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m22:33:49.921436 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:49.922435 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m22:33:50.030663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.341 seconds
[0m22:33:50.032663 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:50.033666 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_group" is $dbt_comment_literal_block$Overall trips statistics by user age group$dbt_comment_literal_block$;

  
[0m22:33:50.263582 [debug] [Thread-3 (]: SQL status: COMMIT in 0.341 seconds
[0m22:33:50.267542 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup"
[0m22:33:50.268535 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:50.268535 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m22:33:50.372366 [debug] [Thread-1 (]: SQL status: COMMENT in 0.337 seconds
[0m22:33:50.373366 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m22:33:50.374366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:50.374366 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m22:33:50.609633 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.340 seconds
[0m22:33:50.611673 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m22:33:50.612668 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319179730>]}
[0m22:33:50.613628 [info ] [Thread-3 (]: 51 of 51 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 6.53s]
[0m22:33:50.614628 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m22:33:50.713453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.338 seconds
[0m22:33:50.720412 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_group__dbt_backup"
[0m22:33:50.721413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:50.721413 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_group__dbt_backup" cascade
[0m22:33:51.068615 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.346 seconds
[0m22:33:51.069660 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: Close
[0m22:33:51.070660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319824F80>]}
[0m22:33:52.009655 [info ] [Thread-1 (]: 46 of 51 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 18.43s]
[0m22:33:52.010654 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_group
[0m22:33:52.012657 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:52.013661 [debug] [MainThread]: On master: BEGIN
[0m22:33:52.013661 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:33:54.791479 [debug] [MainThread]: SQL status: BEGIN in 2.777 seconds
[0m22:33:54.792463 [debug] [MainThread]: On master: COMMIT
[0m22:33:54.792463 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:54.793462 [debug] [MainThread]: On master: COMMIT
[0m22:33:55.151525 [debug] [MainThread]: SQL status: COMMIT in 0.358 seconds
[0m22:33:55.151525 [info ] [MainThread]: 
[0m22:33:55.152524 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:33:55.155559 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m22:33:55.160558 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m22:33:55.161527 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:55.162522 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m22:33:55.505713 [debug] [MainThread]: SQL status: GRANT in 0.343 seconds
[0m22:33:55.507716 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mGRANT[0m in 0.35s]
[0m22:33:55.507716 [info ] [MainThread]: 
[0m22:33:55.508717 [debug] [MainThread]: On master: Close
[0m22:33:55.509730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:33:55.510731 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m22:33:55.510731 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m22:33:55.511732 [debug] [MainThread]: Connection 'list_dev_3lcu_dbt' was properly closed.
[0m22:33:55.511732 [debug] [MainThread]: Connection 'list_dev_3lcu_finance' was properly closed.
[0m22:33:55.512732 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m22:33:55.512732 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e' was properly closed.
[0m22:33:55.513730 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m22:33:55.513730 [debug] [MainThread]: Connection 'model.dbt_scooters.events_stat' was properly closed.
[0m22:33:55.514731 [info ] [MainThread]: 
[0m22:33:55.515727 [info ] [MainThread]: Finished running 4 seeds, 28 data tests, 12 table models, 4 incremental models, 3 view models, 1 project hook in 0 hours 2 minutes and 0.69 seconds (120.69s).
[0m22:33:55.527760 [debug] [MainThread]: Command end result
[0m22:33:55.663425 [info ] [MainThread]: 
[0m22:33:55.664387 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m22:33:55.665386 [info ] [MainThread]: 
[0m22:33:55.667392 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models\properties.yml)[0m
[0m22:33:55.668388 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m22:33:55.670393 [info ] [MainThread]: 
[0m22:33:55.671392 [info ] [MainThread]:   compiled code at target\compiled\dbt_scooters\models\properties.yml\source_not_null_scooters_raw_users_sex.sql
[0m22:33:55.672388 [info ] [MainThread]: 
[0m22:33:55.673387 [info ] [MainThread]: Done. PASS=50 WARN=1 ERROR=0 SKIP=0 TOTAL=51
[0m22:33:55.675389 [debug] [MainThread]: Command `dbt build` succeeded at 22:33:55.675389 after 125.72 seconds
[0m22:33:55.675389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029316DEC3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931641A360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029316419340>]}
[0m22:33:55.676388 [debug] [MainThread]: Flushing usage events
[0m10:44:04.532300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077C255C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077B6ACEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077E811DC0>]}


============================== 10:44:04.541325 | 2e7f7a10-1ebf-44ba-86ba-a51899df3d6d ==============================
[0m10:44:04.541325 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:44:04.542298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:44:04.876367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e7f7a10-1ebf-44ba-86ba-a51899df3d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077E0955E0>]}
[0m10:44:04.947534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e7f7a10-1ebf-44ba-86ba-a51899df3d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077F20EA20>]}
[0m10:44:04.949535 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:44:05.240381 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:44:05.242385 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:44:05.242385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2e7f7a10-1ebf-44ba-86ba-a51899df3d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077F1EF350>]}
[0m10:44:07.508362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e7f7a10-1ebf-44ba-86ba-a51899df3d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077F70DCD0>]}
[0m10:44:07.740548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e7f7a10-1ebf-44ba-86ba-a51899df3d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077F728C50>]}
[0m10:44:07.741547 [info ] [MainThread]: Found 19 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 437 macros
[0m10:44:07.741547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7f7a10-1ebf-44ba-86ba-a51899df3d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077F8A4C80>]}
[0m10:44:07.746579 [info ] [MainThread]: 
[0m10:44:07.747541 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:44:07.753539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_dbt'
[0m10:44:07.766547 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_finance'
[0m10:44:08.012248 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m10:44:08.013248 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m10:44:08.013248 [debug] [ThreadPool]: On list_dev_3lcu_dbt: BEGIN
[0m10:44:08.014247 [debug] [ThreadPool]: On list_dev_3lcu_finance: BEGIN
[0m10:44:08.014247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:08.015249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:10.859410 [debug] [ThreadPool]: SQL status: BEGIN in 2.844 seconds
[0m10:44:10.859410 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m10:44:10.860410 [debug] [ThreadPool]: On list_dev_3lcu_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_dbt"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m10:44:10.860410 [debug] [ThreadPool]: SQL status: BEGIN in 2.846 seconds
[0m10:44:10.861433 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m10:44:10.861433 [debug] [ThreadPool]: On list_dev_3lcu_finance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_finance"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m10:44:11.199508 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.339 seconds
[0m10:44:11.201461 [debug] [ThreadPool]: On list_dev_3lcu_dbt: ROLLBACK
[0m10:44:11.208690 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.346 seconds
[0m10:44:11.210641 [debug] [ThreadPool]: On list_dev_3lcu_finance: ROLLBACK
[0m10:44:11.537351 [debug] [ThreadPool]: On list_dev_3lcu_dbt: Close
[0m10:44:11.545316 [debug] [ThreadPool]: On list_dev_3lcu_finance: Close
[0m10:44:11.552337 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:11.552337 [debug] [MainThread]: On master: BEGIN
[0m10:44:11.553307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:14.567239 [debug] [MainThread]: SQL status: BEGIN in 3.014 seconds
[0m10:44:14.568237 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:14.568237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:44:15.110128 [debug] [MainThread]: SQL status: SELECT 4 in 0.541 seconds
[0m10:44:15.112154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7f7a10-1ebf-44ba-86ba-a51899df3d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077F1EF3B0>]}
[0m10:44:15.112154 [debug] [MainThread]: On master: ROLLBACK
[0m10:44:15.451205 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:15.452197 [debug] [MainThread]: On master: BEGIN
[0m10:44:16.146315 [debug] [MainThread]: SQL status: BEGIN in 0.694 seconds
[0m10:44:16.146315 [debug] [MainThread]: On master: COMMIT
[0m10:44:16.147277 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:16.147277 [debug] [MainThread]: On master: COMMIT
[0m10:44:16.484626 [debug] [MainThread]: SQL status: COMMIT in 0.337 seconds
[0m10:44:16.485580 [debug] [MainThread]: On master: Close
[0m10:44:16.486605 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:44:16.486605 [info ] [MainThread]: 
[0m10:44:16.493582 [debug] [Thread-1 (]: Began running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m10:44:16.494617 [debug] [Thread-2 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m10:44:16.495581 [debug] [Thread-3 (]: Began running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m10:44:16.495581 [debug] [Thread-4 (]: Began running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m10:44:16.496582 [info ] [Thread-1 (]: 1 of 28 START test accepted_values_add_first_name_sex_sex__M__F ................ [RUN]
[0m10:44:16.496582 [info ] [Thread-2 (]: 2 of 28 START test events_full_is_complete ..................................... [RUN]
[0m10:44:16.497582 [info ] [Thread-3 (]: 3 of 28 START test every_event_has_type ........................................ [RUN]
[0m10:44:16.498581 [info ] [Thread-4 (]: 4 of 28 START test every_event_has_user ........................................ [RUN]
[0m10:44:16.499582 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199'
[0m10:44:16.500581 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_scooters.events_full_is_complete'
[0m10:44:16.500581 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_scooters.every_event_has_type.1e5fc977eb'
[0m10:44:16.501608 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_scooters.every_event_has_user.7eea25f36c'
[0m10:44:16.501608 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m10:44:16.502580 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m10:44:16.503585 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m10:44:16.504583 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m10:44:16.512781 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m10:44:16.516254 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m10:44:16.522315 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m10:44:16.527270 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m10:44:16.530270 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m10:44:16.531271 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m10:44:16.546311 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m10:44:16.547317 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m10:44:16.548272 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m10:44:16.550272 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.events_full_is_complete"
[0m10:44:16.553297 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m10:44:16.556298 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m10:44:16.557270 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m10:44:16.558272 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m10:44:16.559272 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: BEGIN
[0m10:44:16.560272 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m10:44:16.560272 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: BEGIN
[0m10:44:16.561271 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m10:44:16.561271 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:44:16.562305 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: BEGIN
[0m10:44:16.562305 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:44:16.563273 [debug] [Thread-3 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: BEGIN
[0m10:44:16.564271 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:44:16.564271 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:44:19.296511 [debug] [Thread-2 (]: SQL status: BEGIN in 2.734 seconds
[0m10:44:19.296511 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m10:44:19.297512 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.events_full_is_complete"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with source_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_clean"
),
target_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_full"
)
select
    'Row count mismatch' as error_message,
    source_cte.row_count as source_count,
    target_cte.row_count as target_count
from
    source_cte,
    target_cte
where
    source_cte.row_count != target_cte.row_count
      
    ) dbt_internal_test
[0m10:44:19.366378 [debug] [Thread-1 (]: SQL status: BEGIN in 2.805 seconds
[0m10:44:19.367365 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m10:44:19.367365 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."dbt"."add_first_name_sex"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m10:44:19.711357 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.343 seconds
[0m10:44:19.714868 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: ROLLBACK
[0m10:44:19.824636 [debug] [Thread-3 (]: SQL status: BEGIN in 3.260 seconds
[0m10:44:19.824636 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m10:44:19.825596 [debug] [Thread-3 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_type.1e5fc977eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where type_id is not null
),

parent as (
    select type_id as to_field
    from "dev_3lcu"."dbt"."event_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:44:20.110327 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: Close
[0m10:44:20.111332 [info ] [Thread-1 (]: 1 of 28 PASS accepted_values_add_first_name_sex_sex__M__F ...................... [[32mPASS[0m in 3.61s]
[0m10:44:20.113328 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m10:44:20.113328 [debug] [Thread-1 (]: Began running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m10:44:20.114334 [info ] [Thread-1 (]: 5 of 28 START test every_trip_has_scooter_id ................................... [RUN]
[0m10:44:20.115360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199, now test.dbt_scooters.every_trip_has_scooter_id.e0b845a190)
[0m10:44:20.115360 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m10:44:20.120365 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m10:44:20.123367 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m10:44:20.126386 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m10:44:20.128367 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m10:44:20.129367 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: BEGIN
[0m10:44:20.129367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:21.418988 [debug] [Thread-2 (]: SQL status: SELECT 1 in 2.121 seconds
[0m10:44:21.420985 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: ROLLBACK
[0m10:44:21.719813 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.893 seconds
[0m10:44:21.720814 [debug] [Thread-3 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: ROLLBACK
[0m10:44:21.793417 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: Close
[0m10:44:21.794417 [info ] [Thread-2 (]: 2 of 28 PASS events_full_is_complete ........................................... [[32mPASS[0m in 5.29s]
[0m10:44:21.795417 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m10:44:21.796421 [debug] [Thread-2 (]: Began running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m10:44:21.797429 [info ] [Thread-2 (]: 6 of 28 START test every_trip_has_user ......................................... [RUN]
[0m10:44:21.797429 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.events_full_is_complete, now test.dbt_scooters.every_trip_has_user.6bc71135e2)
[0m10:44:21.798430 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m10:44:21.803433 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m10:44:21.804429 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m10:44:21.807442 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m10:44:21.809440 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m10:44:21.809440 [debug] [Thread-2 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: BEGIN
[0m10:44:21.810440 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:44:21.847204 [debug] [Thread-4 (]: SQL status: BEGIN in 5.283 seconds
[0m10:44:21.847204 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m10:44:21.848231 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_user.7eea25f36c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:44:22.057274 [debug] [Thread-3 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: Close
[0m10:44:22.059230 [info ] [Thread-3 (]: 3 of 28 PASS every_event_has_type .............................................. [[32mPASS[0m in 5.56s]
[0m10:44:22.060229 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m10:44:22.061231 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m10:44:22.061231 [info ] [Thread-3 (]: 7 of 28 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m10:44:22.062264 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_type.1e5fc977eb, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m10:44:22.063235 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m10:44:22.067264 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m10:44:22.069230 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m10:44:22.071266 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m10:44:22.072229 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m10:44:22.073230 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m10:44:22.073230 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:44:23.021963 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.173 seconds
[0m10:44:23.023959 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: ROLLBACK
[0m10:44:23.362533 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: Close
[0m10:44:23.364535 [info ] [Thread-4 (]: 4 of 28 PASS every_event_has_user .............................................. [[32mPASS[0m in 6.86s]
[0m10:44:23.365532 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m10:44:23.366537 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m10:44:23.367533 [info ] [Thread-4 (]: 8 of 28 START test source_not_null_scooters_raw_events_type_id ................. [RUN]
[0m10:44:23.369535 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_user.7eea25f36c, now test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7)
[0m10:44:23.370533 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m10:44:23.380531 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m10:44:23.382538 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m10:44:23.386544 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m10:44:23.388543 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m10:44:23.389545 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: BEGIN
[0m10:44:23.390541 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:44:24.056101 [debug] [Thread-1 (]: SQL status: BEGIN in 3.926 seconds
[0m10:44:24.056101 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m10:44:24.057139 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select scooter_hw_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where scooter_hw_id is not null
),

parent as (
    select hardware_id as to_field
    from "dev_3lcu"."dbt"."scooters"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:44:24.524814 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.467 seconds
[0m10:44:24.527328 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: ROLLBACK
[0m10:44:24.620342 [debug] [Thread-2 (]: SQL status: BEGIN in 2.810 seconds
[0m10:44:24.621341 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m10:44:24.622344 [debug] [Thread-2 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_user.6bc71135e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:44:24.848170 [debug] [Thread-3 (]: SQL status: BEGIN in 2.775 seconds
[0m10:44:24.849164 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m10:44:24.849164 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m10:44:24.865168 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: Close
[0m10:44:24.867125 [info ] [Thread-1 (]: 5 of 28 PASS every_trip_has_scooter_id ......................................... [[32mPASS[0m in 4.75s]
[0m10:44:24.868125 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m10:44:24.869129 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m10:44:24.869129 [info ] [Thread-1 (]: 9 of 28 START test source_not_null_scooters_raw_events_user_id ................. [RUN]
[0m10:44:24.870159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_scooter_id.e0b845a190, now test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b)
[0m10:44:24.871127 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m10:44:24.876125 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m10:44:24.877133 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m10:44:24.880131 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m10:44:24.882131 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m10:44:24.882131 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: BEGIN
[0m10:44:24.883133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:25.120328 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.497 seconds
[0m10:44:25.121329 [debug] [Thread-2 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: ROLLBACK
[0m10:44:25.257310 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.407 seconds
[0m10:44:25.259305 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m10:44:25.461535 [debug] [Thread-2 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: Close
[0m10:44:25.462534 [info ] [Thread-2 (]: 6 of 28 PASS every_trip_has_user ............................................... [[32mPASS[0m in 3.67s]
[0m10:44:25.464538 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m10:44:25.465536 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m10:44:25.466545 [info ] [Thread-2 (]: 10 of 28 START test source_not_null_scooters_raw_trips_id ...................... [RUN]
[0m10:44:25.467545 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_user.6bc71135e2, now test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d)
[0m10:44:25.468552 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m10:44:25.473548 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m10:44:25.475549 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m10:44:25.479548 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m10:44:25.481545 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m10:44:25.481545 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: BEGIN
[0m10:44:25.482550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:44:25.597201 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m10:44:25.598157 [info ] [Thread-3 (]: 7 of 28 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 3.54s]
[0m10:44:25.600187 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m10:44:25.601161 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m10:44:25.602160 [info ] [Thread-3 (]: 11 of 28 START test source_not_null_scooters_raw_trips_scooter_hw_id ........... [RUN]
[0m10:44:25.603158 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f)
[0m10:44:25.603158 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m10:44:25.607194 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m10:44:25.609197 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m10:44:25.611193 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m10:44:25.613205 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m10:44:25.614157 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: BEGIN
[0m10:44:25.615160 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:44:26.329338 [debug] [Thread-4 (]: SQL status: BEGIN in 2.939 seconds
[0m10:44:26.330379 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m10:44:26.330379 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from "dev_3lcu"."scooters_raw"."events"
where type_id is null



      
    ) dbt_internal_test
[0m10:44:27.102214 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.771 seconds
[0m10:44:27.104206 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: ROLLBACK
[0m10:44:27.438348 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: Close
[0m10:44:27.439350 [info ] [Thread-4 (]: 8 of 28 PASS source_not_null_scooters_raw_events_type_id ....................... [[32mPASS[0m in 4.07s]
[0m10:44:27.440350 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m10:44:27.441354 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m10:44:27.442351 [info ] [Thread-4 (]: 12 of 28 START test source_not_null_scooters_raw_trips_user_id ................. [RUN]
[0m10:44:27.444354 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7, now test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62)
[0m10:44:27.444354 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m10:44:27.450348 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m10:44:27.452357 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m10:44:27.455356 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m10:44:27.457352 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m10:44:27.458348 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: BEGIN
[0m10:44:27.458348 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:44:28.429839 [debug] [Thread-2 (]: SQL status: BEGIN in 2.947 seconds
[0m10:44:28.429839 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m10:44:28.430841 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."trips"
where id is null



      
    ) dbt_internal_test
[0m10:44:28.778350 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.347 seconds
[0m10:44:28.780296 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: ROLLBACK
[0m10:44:28.997314 [debug] [Thread-1 (]: SQL status: BEGIN in 4.114 seconds
[0m10:44:28.997314 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m10:44:28.998354 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."events"
where user_id is null



      
    ) dbt_internal_test
[0m10:44:29.118510 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: Close
[0m10:44:29.120466 [info ] [Thread-2 (]: 10 of 28 PASS source_not_null_scooters_raw_trips_id ............................ [[32mPASS[0m in 3.65s]
[0m10:44:29.121468 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m10:44:29.121468 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m10:44:29.122469 [info ] [Thread-2 (]: 13 of 28 START test source_not_null_scooters_raw_users_id ...................... [RUN]
[0m10:44:29.123464 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d, now test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d)
[0m10:44:29.124466 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m10:44:29.127975 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m10:44:29.129982 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m10:44:29.131985 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m10:44:29.133983 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m10:44:29.134983 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: BEGIN
[0m10:44:29.134983 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:44:29.390539 [debug] [Thread-3 (]: SQL status: BEGIN in 3.776 seconds
[0m10:44:29.391496 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m10:44:29.392497 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select scooter_hw_id
from "dev_3lcu"."scooters_raw"."trips"
where scooter_hw_id is null



      
    ) dbt_internal_test
[0m10:44:29.711303 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.712 seconds
[0m10:44:29.712303 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: ROLLBACK
[0m10:44:29.744514 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.352 seconds
[0m10:44:29.746502 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: ROLLBACK
[0m10:44:30.049296 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: Close
[0m10:44:30.051287 [info ] [Thread-1 (]: 9 of 28 PASS source_not_null_scooters_raw_events_user_id ....................... [[32mPASS[0m in 5.18s]
[0m10:44:30.052253 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m10:44:30.053255 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m10:44:30.053255 [info ] [Thread-1 (]: 14 of 28 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m10:44:30.054253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m10:44:30.055250 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m10:44:30.060278 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m10:44:30.061252 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m10:44:30.064282 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m10:44:30.065254 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m10:44:30.066252 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m10:44:30.066252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:30.085248 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: Close
[0m10:44:30.086254 [info ] [Thread-3 (]: 11 of 28 PASS source_not_null_scooters_raw_trips_scooter_hw_id ................. [[32mPASS[0m in 4.48s]
[0m10:44:30.087251 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m10:44:30.088255 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m10:44:30.089250 [info ] [Thread-3 (]: 15 of 28 START test source_unique_scooters_raw_trips_id ........................ [RUN]
[0m10:44:30.090252 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f, now test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4)
[0m10:44:30.090252 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m10:44:30.096285 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m10:44:30.098249 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m10:44:30.100289 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m10:44:30.101275 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m10:44:30.101275 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: BEGIN
[0m10:44:30.102252 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:44:30.157462 [debug] [Thread-4 (]: SQL status: BEGIN in 2.699 seconds
[0m10:44:30.158463 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m10:44:30.158463 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."trips"
where user_id is null



      
    ) dbt_internal_test
[0m10:44:30.511316 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.352 seconds
[0m10:44:30.513308 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: ROLLBACK
[0m10:44:30.851267 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: Close
[0m10:44:30.852261 [info ] [Thread-4 (]: 12 of 28 PASS source_not_null_scooters_raw_trips_user_id ....................... [[32mPASS[0m in 3.41s]
[0m10:44:30.853259 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m10:44:30.854262 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m10:44:30.855261 [info ] [Thread-4 (]: 16 of 28 START test source_unique_scooters_raw_users_id ........................ [RUN]
[0m10:44:30.856263 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62, now test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf)
[0m10:44:30.857263 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m10:44:30.862259 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m10:44:30.863259 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m10:44:30.865261 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m10:44:30.867267 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m10:44:30.867267 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: BEGIN
[0m10:44:30.868267 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:44:31.853287 [debug] [Thread-2 (]: SQL status: BEGIN in 2.718 seconds
[0m10:44:31.853287 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m10:44:31.854327 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."users"
where id is null



      
    ) dbt_internal_test
[0m10:44:32.191364 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.337 seconds
[0m10:44:32.193305 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: ROLLBACK
[0m10:44:32.530492 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: Close
[0m10:44:32.531443 [info ] [Thread-2 (]: 13 of 28 PASS source_not_null_scooters_raw_users_id ............................ [[32mPASS[0m in 3.41s]
[0m10:44:32.533446 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m10:44:32.533955 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m10:44:32.534971 [info ] [Thread-2 (]: 17 of 28 START test unique_companies_trips_company ............................. [RUN]
[0m10:44:32.534971 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m10:44:32.536486 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m10:44:32.540499 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m10:44:32.543511 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m10:44:32.545492 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m10:44:32.547499 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m10:44:32.547499 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m10:44:32.548504 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:44:32.759307 [debug] [Thread-1 (]: SQL status: BEGIN in 2.692 seconds
[0m10:44:32.759307 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m10:44:32.760347 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sex
from "dev_3lcu"."scooters_raw"."users"
where sex is null



      
    ) dbt_internal_test
[0m10:44:32.803360 [debug] [Thread-3 (]: SQL status: BEGIN in 2.701 seconds
[0m10:44:32.804346 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m10:44:32.804346 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."trips"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:44:33.098292 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.338 seconds
[0m10:44:33.100254 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m10:44:33.510543 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m10:44:33.511542 [warn ] [Thread-1 (]: 14 of 28 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 3.46s]
[0m10:44:33.512587 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m10:44:33.513546 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m10:44:33.514546 [info ] [Thread-1 (]: 18 of 28 START test unique_key_scooters_company__model__hardware_id ............ [RUN]
[0m10:44:33.515542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e)
[0m10:44:33.516580 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m10:44:33.521570 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m10:44:33.526543 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m10:44:33.528570 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m10:44:33.530545 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m10:44:33.531580 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: BEGIN
[0m10:44:33.531580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:33.612293 [debug] [Thread-4 (]: SQL status: BEGIN in 2.745 seconds
[0m10:44:33.613294 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m10:44:33.614294 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."users"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:44:34.110394 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.496 seconds
[0m10:44:34.112382 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: ROLLBACK
[0m10:44:34.411333 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.606 seconds
[0m10:44:34.413334 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: ROLLBACK
[0m10:44:34.448362 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: Close
[0m10:44:34.449360 [info ] [Thread-4 (]: 16 of 28 PASS source_unique_scooters_raw_users_id .............................. [[32mPASS[0m in 3.59s]
[0m10:44:34.450360 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m10:44:34.451367 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m10:44:34.452362 [info ] [Thread-4 (]: 19 of 28 START test unique_key_trips_age_daily_date__age ....................... [RUN]
[0m10:44:34.452362 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf, now test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be)
[0m10:44:34.453362 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m10:44:34.457358 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m10:44:34.458376 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m10:44:34.460359 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m10:44:34.462361 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m10:44:34.462361 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: BEGIN
[0m10:44:34.463360 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:44:34.748334 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: Close
[0m10:44:34.749338 [info ] [Thread-3 (]: 15 of 28 PASS source_unique_scooters_raw_trips_id .............................. [[32mPASS[0m in 4.66s]
[0m10:44:34.750337 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m10:44:34.751338 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m10:44:34.752341 [info ] [Thread-3 (]: 20 of 28 START test unique_not_null_add_first_name_sex_first_name .............. [RUN]
[0m10:44:34.753341 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4, now test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f)
[0m10:44:34.753341 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m10:44:34.757336 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m10:44:34.758336 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m10:44:34.760336 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m10:44:34.762339 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m10:44:34.762339 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: BEGIN
[0m10:44:34.763338 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:44:35.331074 [debug] [Thread-2 (]: SQL status: BEGIN in 2.783 seconds
[0m10:44:35.332072 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m10:44:35.333074 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



      
    ) dbt_internal_test
[0m10:44:35.670051 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.336 seconds
[0m10:44:35.672054 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m10:44:36.008505 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m10:44:36.009504 [info ] [Thread-2 (]: 17 of 28 PASS unique_companies_trips_company ................................... [[32mPASS[0m in 3.47s]
[0m10:44:36.010502 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m10:44:36.011512 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m10:44:36.012504 [info ] [Thread-2 (]: 21 of 28 START test unique_not_null_age_groups_age_end ......................... [RUN]
[0m10:44:36.012504 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0, now test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac)
[0m10:44:36.013507 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m10:44:36.017512 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m10:44:36.019514 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m10:44:36.021513 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m10:44:36.023512 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m10:44:36.023512 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: BEGIN
[0m10:44:36.024512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:44:37.138278 [debug] [Thread-1 (]: SQL status: BEGIN in 3.607 seconds
[0m10:44:37.139760 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m10:44:37.139760 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "company"::text ||
    
        "model"::text ||
    
        "hardware_id"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m10:44:37.209326 [debug] [Thread-4 (]: SQL status: BEGIN in 2.746 seconds
[0m10:44:37.209326 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m10:44:37.210363 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "date"::text ||
    
        "age"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m10:44:37.450399 [debug] [Thread-3 (]: SQL status: BEGIN in 2.688 seconds
[0m10:44:37.451353 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m10:44:37.452361 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "first_name"
from
    "dev_3lcu"."dbt"."add_first_name_sex"
group by
    1
having
    count(*) > 1 or "first_name" is null


      
    ) dbt_internal_test
[0m10:44:37.479400 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.339 seconds
[0m10:44:37.481352 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: ROLLBACK
[0m10:44:37.565200 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.354 seconds
[0m10:44:37.567241 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: ROLLBACK
[0m10:44:37.789553 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.337 seconds
[0m10:44:37.791592 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: ROLLBACK
[0m10:44:37.820601 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: Close
[0m10:44:37.822554 [info ] [Thread-1 (]: 18 of 28 PASS unique_key_scooters_company__model__hardware_id .................. [[32mPASS[0m in 4.31s]
[0m10:44:37.823554 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m10:44:37.823554 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m10:44:37.824558 [info ] [Thread-1 (]: 22 of 28 START test unique_not_null_age_groups_age_start ....................... [RUN]
[0m10:44:37.825552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e, now test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b)
[0m10:44:37.826554 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m10:44:37.832561 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m10:44:37.833556 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m10:44:37.835557 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m10:44:37.837557 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m10:44:37.837557 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: BEGIN
[0m10:44:37.838558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:37.916108 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: Close
[0m10:44:37.917107 [info ] [Thread-4 (]: 19 of 28 PASS unique_key_trips_age_daily_date__age ............................. [[32mPASS[0m in 3.46s]
[0m10:44:37.918107 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m10:44:37.919106 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m10:44:37.920106 [info ] [Thread-4 (]: 23 of 28 START test unique_not_null_age_groups_group ........................... [RUN]
[0m10:44:37.920106 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be, now test.dbt_scooters.unique_not_null_age_groups_group.39342291f1)
[0m10:44:37.921108 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m10:44:37.927104 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m10:44:37.929107 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m10:44:37.932104 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m10:44:37.934111 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m10:44:37.935112 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: BEGIN
[0m10:44:37.936109 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:44:38.128465 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: Close
[0m10:44:38.129415 [info ] [Thread-3 (]: 20 of 28 PASS unique_not_null_add_first_name_sex_first_name .................... [[32mPASS[0m in 3.38s]
[0m10:44:38.131416 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m10:44:38.132421 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m10:44:38.133416 [info ] [Thread-3 (]: 24 of 28 START test unique_not_null_event_types_type ........................... [RUN]
[0m10:44:38.135414 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f, now test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1)
[0m10:44:38.135414 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m10:44:38.139961 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m10:44:38.140968 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m10:44:38.144004 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m10:44:38.144972 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m10:44:38.144972 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: BEGIN
[0m10:44:38.146508 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:44:38.738276 [debug] [Thread-2 (]: SQL status: BEGIN in 2.714 seconds
[0m10:44:38.739274 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m10:44:38.739274 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_end"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_end" is null


      
    ) dbt_internal_test
[0m10:44:39.092074 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.352 seconds
[0m10:44:39.094075 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: ROLLBACK
[0m10:44:39.432210 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: Close
[0m10:44:39.433214 [info ] [Thread-2 (]: 21 of 28 PASS unique_not_null_age_groups_age_end ............................... [[32mPASS[0m in 3.42s]
[0m10:44:39.434215 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m10:44:39.435211 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m10:44:39.436217 [info ] [Thread-2 (]: 25 of 28 START test unique_not_null_event_types_type_id ........................ [RUN]
[0m10:44:39.437215 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac, now test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85)
[0m10:44:39.437215 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m10:44:39.441726 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m10:44:39.443731 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m10:44:39.444730 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m10:44:39.447246 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m10:44:39.447246 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: BEGIN
[0m10:44:39.448246 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:44:40.526463 [debug] [Thread-1 (]: SQL status: BEGIN in 2.688 seconds
[0m10:44:40.527467 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m10:44:40.527467 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_start"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_start" is null


      
    ) dbt_internal_test
[0m10:44:40.836234 [debug] [Thread-4 (]: SQL status: BEGIN in 2.901 seconds
[0m10:44:40.837242 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m10:44:40.837242 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "group"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "group" is null


      
    ) dbt_internal_test
[0m10:44:40.866264 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.338 seconds
[0m10:44:40.868267 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: ROLLBACK
[0m10:44:40.959353 [debug] [Thread-3 (]: SQL status: BEGIN in 2.813 seconds
[0m10:44:40.960354 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m10:44:40.960354 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type" is null


      
    ) dbt_internal_test
[0m10:44:41.193515 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.355 seconds
[0m10:44:41.195516 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: ROLLBACK
[0m10:44:41.208525 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: Close
[0m10:44:41.209535 [info ] [Thread-1 (]: 22 of 28 PASS unique_not_null_age_groups_age_start ............................. [[32mPASS[0m in 3.38s]
[0m10:44:41.211532 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m10:44:41.211532 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m10:44:41.212529 [info ] [Thread-1 (]: 26 of 28 START test unique_not_null_scooters_hardware_id ....................... [RUN]
[0m10:44:41.213531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b, now test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d)
[0m10:44:41.214530 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m10:44:41.217531 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m10:44:41.219535 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m10:44:41.221535 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m10:44:41.222531 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m10:44:41.223532 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: BEGIN
[0m10:44:41.224542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:41.317115 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.356 seconds
[0m10:44:41.319114 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: ROLLBACK
[0m10:44:41.567294 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: Close
[0m10:44:41.569296 [info ] [Thread-4 (]: 23 of 28 PASS unique_not_null_age_groups_group ................................. [[32mPASS[0m in 3.65s]
[0m10:44:41.570306 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m10:44:41.571318 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m10:44:41.572295 [info ] [Thread-4 (]: 27 of 28 START test unique_not_null_scooters_model ............................. [RUN]
[0m10:44:41.573299 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_group.39342291f1, now test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc)
[0m10:44:41.574297 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m10:44:41.577301 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m10:44:41.579305 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m10:44:41.581301 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m10:44:41.582304 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m10:44:41.583304 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: BEGIN
[0m10:44:41.583304 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:44:41.674379 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: Close
[0m10:44:41.675382 [info ] [Thread-3 (]: 24 of 28 PASS unique_not_null_event_types_type ................................. [[32mPASS[0m in 3.54s]
[0m10:44:41.676401 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m10:44:41.677409 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m10:44:41.678414 [info ] [Thread-3 (]: 28 of 28 START test unique_trips_age_daily_date_text_age_text .................. [RUN]
[0m10:44:41.678414 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1, now test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e)
[0m10:44:41.679413 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m10:44:41.684408 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m10:44:41.686412 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m10:44:41.742993 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m10:44:41.745008 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m10:44:41.745008 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: BEGIN
[0m10:44:41.745008 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:44:43.096486 [debug] [Thread-2 (]: SQL status: BEGIN in 3.649 seconds
[0m10:44:43.097441 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m10:44:43.098445 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type_id"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type_id" is null


      
    ) dbt_internal_test
[0m10:44:43.457445 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.359 seconds
[0m10:44:43.459393 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: ROLLBACK
[0m10:44:43.817450 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: Close
[0m10:44:43.818450 [info ] [Thread-2 (]: 25 of 28 PASS unique_not_null_event_types_type_id .............................. [[32mPASS[0m in 4.38s]
[0m10:44:43.819448 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m10:44:44.305154 [debug] [Thread-4 (]: SQL status: BEGIN in 2.721 seconds
[0m10:44:44.306157 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m10:44:44.306157 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "model"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "model" is null


      
    ) dbt_internal_test
[0m10:44:44.490095 [debug] [Thread-3 (]: SQL status: BEGIN in 2.744 seconds
[0m10:44:44.490095 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m10:44:44.491098 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date::text || age::text as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."trips_age_daily"
where date::text || age::text is not null
group by date::text || age::text
having count(*) > 1



      
    ) dbt_internal_test
[0m10:44:44.652923 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.346 seconds
[0m10:44:44.654955 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: ROLLBACK
[0m10:44:44.841056 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.349 seconds
[0m10:44:44.843089 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: ROLLBACK
[0m10:44:44.867254 [debug] [Thread-1 (]: SQL status: BEGIN in 3.643 seconds
[0m10:44:44.868249 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m10:44:44.868249 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "hardware_id"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "hardware_id" is null


      
    ) dbt_internal_test
[0m10:44:45.002453 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: Close
[0m10:44:45.003453 [info ] [Thread-4 (]: 27 of 28 PASS unique_not_null_scooters_model ................................... [[32mPASS[0m in 3.43s]
[0m10:44:45.004451 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m10:44:45.177420 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: Close
[0m10:44:45.178407 [info ] [Thread-3 (]: 28 of 28 PASS unique_trips_age_daily_date_text_age_text ........................ [[32mPASS[0m in 3.50s]
[0m10:44:45.180377 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m10:44:45.212414 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.344 seconds
[0m10:44:45.214373 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: ROLLBACK
[0m10:44:45.558510 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: Close
[0m10:44:45.560464 [info ] [Thread-1 (]: 26 of 28 PASS unique_not_null_scooters_hardware_id ............................. [[32mPASS[0m in 4.35s]
[0m10:44:45.561464 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m10:44:45.563463 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:45.564466 [debug] [MainThread]: On master: BEGIN
[0m10:44:45.564466 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:44:48.310204 [debug] [MainThread]: SQL status: BEGIN in 2.746 seconds
[0m10:44:48.311189 [debug] [MainThread]: On master: COMMIT
[0m10:44:48.311189 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:48.311189 [debug] [MainThread]: On master: COMMIT
[0m10:44:48.662318 [debug] [MainThread]: SQL status: COMMIT in 0.350 seconds
[0m10:44:48.663319 [info ] [MainThread]: 
[0m10:44:48.664319 [info ] [MainThread]: Running 1 on-run-end hook
[0m10:44:48.666321 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m10:44:48.671319 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m10:44:48.672320 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:48.672320 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m10:44:49.010396 [debug] [MainThread]: SQL status: GRANT in 0.337 seconds
[0m10:44:49.011397 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mGRANT[0m in 0.34s]
[0m10:44:49.012396 [info ] [MainThread]: 
[0m10:44:49.013405 [debug] [MainThread]: On master: Close
[0m10:44:49.014401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:49.014401 [debug] [MainThread]: Connection 'list_dev_3lcu_dbt' was properly closed.
[0m10:44:49.015397 [debug] [MainThread]: Connection 'list_dev_3lcu_finance' was properly closed.
[0m10:44:49.015397 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d' was properly closed.
[0m10:44:49.015397 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85' was properly closed.
[0m10:44:49.016396 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e' was properly closed.
[0m10:44:49.017405 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc' was properly closed.
[0m10:44:49.017405 [info ] [MainThread]: 
[0m10:44:49.018398 [info ] [MainThread]: Finished running 28 data tests, 1 project hook in 0 hours 0 minutes and 41.27 seconds (41.27s).
[0m10:44:49.023395 [debug] [MainThread]: Command end result
[0m10:44:49.067050 [info ] [MainThread]: 
[0m10:44:49.068050 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m10:44:49.069096 [info ] [MainThread]: 
[0m10:44:49.070051 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models\properties.yml)[0m
[0m10:44:49.071054 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m10:44:49.072055 [info ] [MainThread]: 
[0m10:44:49.073055 [info ] [MainThread]:   compiled code at target\compiled\dbt_scooters\models\properties.yml\source_not_null_scooters_raw_users_sex.sql
[0m10:44:49.074054 [info ] [MainThread]: 
[0m10:44:49.075054 [info ] [MainThread]: Done. PASS=27 WARN=1 ERROR=0 SKIP=0 TOTAL=28
[0m10:44:49.077060 [debug] [MainThread]: Command `dbt test` succeeded at 10:44:49.076052 after 44.84 seconds
[0m10:44:49.077060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077EE98140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077EDCF560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077AB81880>]}
[0m10:44:49.078099 [debug] [MainThread]: Flushing usage events
[0m10:45:03.097354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E712D03AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E713478B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E712D00A10>]}


============================== 10:45:03.102353 | d159cb8a-8159-41d5-91f9-0166b05c3e0f ==============================
[0m10:45:03.102353 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:45:03.103320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:45:03.356259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7136BA570>]}
[0m10:45:03.424415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7132AC3B0>]}
[0m10:45:03.426415 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:45:03.684089 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:45:03.929424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:45:03.930423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:45:04.013423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E713910E00>]}
[0m10:45:04.224023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E713930DA0>]}
[0m10:45:04.225027 [info ] [MainThread]: Found 19 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 437 macros
[0m10:45:04.232023 [info ] [MainThread]: 
[0m10:45:04.233024 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:45:04.239029 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m10:45:04.254056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m10:45:04.353193 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m10:45:04.353193 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m10:45:04.354159 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m10:45:04.355155 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m10:45:04.355155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:04.356164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:07.090335 [debug] [ThreadPool]: SQL status: SELECT 23 in 2.735 seconds
[0m10:45:07.092341 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m10:45:07.106339 [debug] [ThreadPool]: SQL status: SELECT 23 in 2.751 seconds
[0m10:45:07.109348 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m10:45:07.113344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_finance'
[0m10:45:07.119351 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m10:45:07.119351 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_dbt'
[0m10:45:07.120350 [debug] [ThreadPool]: On list_dev_3lcu_finance: BEGIN
[0m10:45:07.122351 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m10:45:07.122351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:07.123352 [debug] [ThreadPool]: On list_dev_3lcu_dbt: BEGIN
[0m10:45:07.124352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:09.887328 [debug] [ThreadPool]: SQL status: BEGIN in 2.763 seconds
[0m10:45:09.888331 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m10:45:09.888331 [debug] [ThreadPool]: On list_dev_3lcu_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_dbt"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m10:45:09.950334 [debug] [ThreadPool]: SQL status: BEGIN in 2.827 seconds
[0m10:45:09.951335 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m10:45:09.951335 [debug] [ThreadPool]: On list_dev_3lcu_finance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_finance"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m10:45:10.232426 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.343 seconds
[0m10:45:10.234425 [debug] [ThreadPool]: On list_dev_3lcu_dbt: ROLLBACK
[0m10:45:10.296027 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.344 seconds
[0m10:45:10.298013 [debug] [ThreadPool]: On list_dev_3lcu_finance: ROLLBACK
[0m10:45:10.569124 [debug] [ThreadPool]: On list_dev_3lcu_dbt: Close
[0m10:45:10.635256 [debug] [ThreadPool]: On list_dev_3lcu_finance: Close
[0m10:45:10.641254 [debug] [MainThread]: Using postgres connection "master"
[0m10:45:10.642254 [debug] [MainThread]: On master: BEGIN
[0m10:45:10.642254 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:45:13.322091 [debug] [MainThread]: SQL status: BEGIN in 2.680 seconds
[0m10:45:13.323114 [debug] [MainThread]: Using postgres connection "master"
[0m10:45:13.323114 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:45:14.211961 [debug] [MainThread]: SQL status: SELECT 4 in 0.888 seconds
[0m10:45:14.213997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7110FDD00>]}
[0m10:45:14.213997 [debug] [MainThread]: On master: ROLLBACK
[0m10:45:14.551982 [debug] [MainThread]: Using postgres connection "master"
[0m10:45:14.552982 [debug] [MainThread]: On master: BEGIN
[0m10:45:15.230168 [debug] [MainThread]: SQL status: BEGIN in 0.677 seconds
[0m10:45:15.230168 [debug] [MainThread]: On master: COMMIT
[0m10:45:15.231129 [debug] [MainThread]: Using postgres connection "master"
[0m10:45:15.231129 [debug] [MainThread]: On master: COMMIT
[0m10:45:15.571272 [debug] [MainThread]: SQL status: COMMIT in 0.339 seconds
[0m10:45:15.572316 [debug] [MainThread]: On master: Close
[0m10:45:15.572316 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:45:15.573276 [info ] [MainThread]: 
[0m10:45:15.579308 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.add_first_name_sex
[0m10:45:15.580274 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m10:45:15.580274 [debug] [Thread-3 (]: Began running node seed.dbt_scooters.event_types
[0m10:45:15.580274 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.scooters
[0m10:45:15.581277 [info ] [Thread-1 (]: 1 of 51 START seed file dbt.add_first_name_sex ................................. [RUN]
[0m10:45:15.582278 [info ] [Thread-2 (]: 2 of 51 START seed file dbt.age_groups ......................................... [RUN]
[0m10:45:15.583276 [info ] [Thread-3 (]: 3 of 51 START seed file dbt.event_types ........................................ [RUN]
[0m10:45:15.584311 [info ] [Thread-4 (]: 4 of 51 START seed file dbt.scooters ........................................... [RUN]
[0m10:45:15.585309 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.dbt_scooters.add_first_name_sex'
[0m10:45:15.586316 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.dbt_scooters.age_groups'
[0m10:45:15.587322 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.dbt_scooters.event_types'
[0m10:45:15.588317 [debug] [Thread-4 (]: Acquiring new postgres connection 'seed.dbt_scooters.scooters'
[0m10:45:15.589321 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.add_first_name_sex
[0m10:45:15.589321 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m10:45:15.590316 [debug] [Thread-3 (]: Began compiling node seed.dbt_scooters.event_types
[0m10:45:15.590316 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.scooters
[0m10:45:15.591321 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.add_first_name_sex
[0m10:45:15.591321 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m10:45:15.592351 [debug] [Thread-3 (]: Began executing node seed.dbt_scooters.event_types
[0m10:45:15.592351 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.scooters
[0m10:45:15.624357 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m10:45:15.629361 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:45:15.631321 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:45:15.634322 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: BEGIN
[0m10:45:15.638358 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:45:15.638358 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m10:45:15.639356 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: BEGIN
[0m10:45:15.639356 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:45:15.640357 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: BEGIN
[0m10:45:15.640357 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:45:15.641356 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:45:15.642325 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:45:18.313063 [debug] [Thread-2 (]: SQL status: BEGIN in 2.672 seconds
[0m10:45:18.314065 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:45:18.314065 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_3lcu"."dbt"."age_groups"
[0m10:45:18.317107 [debug] [Thread-3 (]: SQL status: BEGIN in 2.676 seconds
[0m10:45:18.318062 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:45:18.318062 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_3lcu"."dbt"."event_types"
[0m10:45:18.653192 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.338 seconds
[0m10:45:18.669224 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:45:18.670189 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.351 seconds
[0m10:45:18.670189 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_3lcu"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m10:45:18.672223 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:45:18.673224 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_3lcu"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m10:45:19.006338 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.333 seconds
[0m10:45:19.011335 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m10:45:19.012335 [debug] [Thread-3 (]: SQL status: INSERT 0 4 in 0.338 seconds
[0m10:45:19.014339 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m10:45:19.034342 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:45:19.035342 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  comment on table "dev_3lcu"."dbt"."age_groups" is $dbt_comment_literal_block$Age groups to split users for analysis$dbt_comment_literal_block$;

  
[0m10:45:19.037376 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:45:19.037376 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  comment on table "dev_3lcu"."dbt"."event_types" is $dbt_comment_literal_block$Table provides a mapping between unique event type identifiers (`type_id`) and their descriptive names (`type`). It is essential for converting numerical codes from user activity logs into readable descriptions for analysis of user interactions with application features.

The table is crucial for analytics and reporting, allowing for the decoding of event identifiers in user activity datasets. By joining with event logs, it facilitates intuitive reporting and dashboarding of user interactions. The mapping enables effective segmentation and analysis of user activities, such as:

- **start_search**: Represents the initiation of a search process by a user.
- **book_scooter**: Indicates that a user has booked a scooter.
- **release_scooter**: Signifies that a user has released a previously booked scooter.
- **cancel_search**: Denotes the cancellation of a search process by a user.$dbt_comment_literal_block$;

  
[0m10:45:19.238216 [debug] [Thread-4 (]: SQL status: BEGIN in 3.596 seconds
[0m10:45:19.239171 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:45:19.239171 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_3lcu"."dbt"."scooters"
[0m10:45:19.240172 [debug] [Thread-1 (]: SQL status: BEGIN in 3.600 seconds
[0m10:45:19.241170 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m10:45:19.241170 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */
truncate table "dev_3lcu"."dbt"."add_first_name_sex"
[0m10:45:19.369406 [debug] [Thread-2 (]: SQL status: COMMENT in 0.333 seconds
[0m10:45:19.386420 [debug] [Thread-3 (]: SQL status: COMMENT in 0.348 seconds
[0m10:45:19.393919 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:45:19.396454 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:45:19.397488 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'age_groups'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:45:19.398465 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'event_types'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:45:19.581318 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.340 seconds
[0m10:45:19.584305 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m10:45:19.584305 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: 
          insert into "dev_3lcu"."dbt"."add_first_name_sex" ("first_name", "sex") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m10:45:19.587323 [debug] [Thread-4 (]: SQL status: TRUNCATE TABLE in 0.347 seconds
[0m10:45:19.591891 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:45:19.591891 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_3lcu"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m10:45:19.813087 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.414 seconds
[0m10:45:19.813087 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.415 seconds
[0m10:45:19.817122 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:45:19.819109 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:45:19.820127 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".group is $dbt_comment_literal_block$Age group name for report$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".age_start is $dbt_comment_literal_block$Start age of group$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".age_end is $dbt_comment_literal_block$End age of group$dbt_comment_literal_block$;
  

  
[0m10:45:19.820127 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."event_types".type_id is $dbt_comment_literal_block$An integer serving as a unique identifier for each event type. It is used in user event tables as a foreign key to link events to their descriptions
$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."event_types".type is $dbt_comment_literal_block$A string describing the event type, enhancing the interpretability of event data by providing a human-readable label
$dbt_comment_literal_block$;
  

  
[0m10:45:19.923311 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.338 seconds
[0m10:45:19.924311 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.add_first_name_sex"
[0m10:45:19.928346 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m10:45:19.929314 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  comment on table "dev_3lcu"."dbt"."add_first_name_sex" is $dbt_comment_literal_block$additional name_sex glossary$dbt_comment_literal_block$;

  
[0m10:45:19.933355 [debug] [Thread-4 (]: SQL status: INSERT 0 10 in 0.341 seconds
[0m10:45:19.934315 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m10:45:19.937316 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:45:19.937316 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  comment on table "dev_3lcu"."dbt"."scooters" is $dbt_comment_literal_block$Scooter models information and park statistics by model. Includes information about the manufacturing company. Data received from the service team and uploaded by Mark. Data is current as of summer 2023.
$dbt_comment_literal_block$;

  
[0m10:45:20.154435 [debug] [Thread-2 (]: SQL status: COMMENT in 0.333 seconds
[0m10:45:20.155402 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m10:45:20.156434 [debug] [Thread-3 (]: SQL status: COMMENT in 0.335 seconds
[0m10:45:20.156434 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:45:20.158434 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m10:45:20.158434 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m10:45:20.159435 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:45:20.159435 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m10:45:20.266330 [debug] [Thread-1 (]: SQL status: COMMENT in 0.337 seconds
[0m10:45:20.269319 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m10:45:20.270317 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'add_first_name_sex'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:45:20.279329 [debug] [Thread-4 (]: SQL status: COMMENT in 0.341 seconds
[0m10:45:20.282320 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:45:20.282320 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'scooters'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:45:20.493993 [debug] [Thread-2 (]: SQL status: COMMIT in 0.334 seconds
[0m10:45:20.495949 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m10:45:20.496983 [debug] [Thread-3 (]: SQL status: COMMIT in 0.337 seconds
[0m10:45:20.497952 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: Close
[0m10:45:20.498949 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E711098E90>]}
[0m10:45:20.500949 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71546C380>]}
[0m10:45:20.499984 [info ] [Thread-2 (]: 2 of 51 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 4.91s]
[0m10:45:20.502988 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m10:45:20.501948 [info ] [Thread-3 (]: 3 of 51 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 4.91s]
[0m10:45:20.503949 [debug] [Thread-2 (]: Began running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m10:45:20.504948 [debug] [Thread-3 (]: Finished running node seed.dbt_scooters.event_types
[0m10:45:20.507462 [debug] [Thread-3 (]: Began running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m10:45:20.506454 [info ] [Thread-2 (]: 5 of 51 START test every_event_has_user ........................................ [RUN]
[0m10:45:20.508490 [info ] [Thread-3 (]: 6 of 51 START test every_trip_has_user ......................................... [RUN]
[0m10:45:20.508490 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now test.dbt_scooters.every_event_has_user.7eea25f36c)
[0m10:45:20.509487 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now test.dbt_scooters.every_trip_has_user.6bc71135e2)
[0m10:45:20.510462 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m10:45:20.510462 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m10:45:20.529048 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m10:45:20.534011 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m10:45:20.536012 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m10:45:20.537021 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m10:45:20.556021 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m10:45:20.559018 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m10:45:20.561017 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m10:45:20.561017 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m10:45:20.562017 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: BEGIN
[0m10:45:20.562017 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: BEGIN
[0m10:45:20.563017 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:20.563017 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:20.625242 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.354 seconds
[0m10:45:20.627289 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m10:45:20.627289 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."add_first_name_sex".first_name is $dbt_comment_literal_block$First name of user$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."add_first_name_sex".sex is $dbt_comment_literal_block$user gender$dbt_comment_literal_block$;
  

  
[0m10:45:20.718369 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.435 seconds
[0m10:45:20.720370 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:45:20.720370 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".company is $dbt_comment_literal_block$Scooter company model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".model is $dbt_comment_literal_block$Scooter model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".hardware_id is $dbt_comment_literal_block$scooter model id$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".scooters is $dbt_comment_literal_block$Count of scooters$dbt_comment_literal_block$;
  

  
[0m10:45:20.963196 [debug] [Thread-1 (]: SQL status: COMMENT in 0.335 seconds
[0m10:45:20.964196 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m10:45:20.965194 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m10:45:20.965194 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m10:45:21.063376 [debug] [Thread-4 (]: SQL status: COMMENT in 0.342 seconds
[0m10:45:21.064377 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m10:45:21.065377 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:45:21.065377 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m10:45:21.303440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.337 seconds
[0m10:45:21.304435 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: Close
[0m10:45:21.304435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71597D700>]}
[0m10:45:21.305942 [info ] [Thread-1 (]: 1 of 51 OK loaded seed file dbt.add_first_name_sex ............................. [[32mINSERT 5[0m in 5.72s]
[0m10:45:21.306948 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.add_first_name_sex
[0m10:45:21.307971 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m10:45:21.308950 [info ] [Thread-1 (]: 7 of 51 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m10:45:21.308950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.add_first_name_sex, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m10:45:21.309951 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m10:45:21.318980 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m10:45:21.319955 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m10:45:21.322977 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m10:45:21.323950 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m10:45:21.324951 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m10:45:21.324951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:21.408117 [debug] [Thread-4 (]: SQL status: COMMIT in 0.342 seconds
[0m10:45:21.409121 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: Close
[0m10:45:21.410121 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715502EA0>]}
[0m10:45:21.410121 [info ] [Thread-4 (]: 4 of 51 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 5.82s]
[0m10:45:21.412118 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.scooters
[0m10:45:21.413120 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m10:45:21.414118 [info ] [Thread-4 (]: 8 of 51 START test source_not_null_scooters_raw_events_type_id ................. [RUN]
[0m10:45:21.415116 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7)
[0m10:45:21.416119 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m10:45:21.422129 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m10:45:21.423130 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m10:45:21.425127 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m10:45:21.426132 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m10:45:21.427131 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: BEGIN
[0m10:45:21.428132 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:23.244064 [debug] [Thread-3 (]: SQL status: BEGIN in 2.680 seconds
[0m10:45:23.244064 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m10:45:23.245066 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_user.6bc71135e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:45:23.323355 [debug] [Thread-2 (]: SQL status: BEGIN in 2.760 seconds
[0m10:45:23.324336 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m10:45:23.324336 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_user.7eea25f36c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:45:23.714476 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.469 seconds
[0m10:45:23.717991 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: ROLLBACK
[0m10:45:24.108430 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: Close
[0m10:45:24.109425 [info ] [Thread-3 (]: 6 of 51 PASS every_trip_has_user ............................................... [[32mPASS[0m in 3.60s]
[0m10:45:24.110424 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m10:45:24.111428 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m10:45:24.112425 [debug] [Thread-1 (]: SQL status: BEGIN in 2.787 seconds
[0m10:45:24.113428 [info ] [Thread-3 (]: 9 of 51 START test source_not_null_scooters_raw_events_user_id ................. [RUN]
[0m10:45:24.113428 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m10:45:24.114428 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_user.6bc71135e2, now test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b)
[0m10:45:24.115425 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m10:45:24.115425 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m10:45:24.119460 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m10:45:24.121424 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m10:45:24.123427 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m10:45:24.124475 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m10:45:24.124475 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: BEGIN
[0m10:45:24.126008 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:24.708449 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.592 seconds
[0m10:45:24.710437 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m10:45:25.109206 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.784 seconds
[0m10:45:25.110206 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: ROLLBACK
[0m10:45:25.137261 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m10:45:25.138239 [info ] [Thread-1 (]: 7 of 51 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 3.83s]
[0m10:45:25.140208 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m10:45:25.141220 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m10:45:25.141220 [info ] [Thread-1 (]: 10 of 51 START test source_not_null_scooters_raw_trips_id ...................... [RUN]
[0m10:45:25.142209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d)
[0m10:45:25.143208 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m10:45:25.146206 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m10:45:25.147211 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m10:45:25.149212 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m10:45:25.151212 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m10:45:25.151212 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: BEGIN
[0m10:45:25.152212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:25.351027 [debug] [Thread-4 (]: SQL status: BEGIN in 3.924 seconds
[0m10:45:25.351986 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m10:45:25.351986 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from "dev_3lcu"."scooters_raw"."events"
where type_id is null



      
    ) dbt_internal_test
[0m10:45:25.447198 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: Close
[0m10:45:25.449201 [info ] [Thread-2 (]: 5 of 51 PASS every_event_has_user .............................................. [[32mPASS[0m in 4.94s]
[0m10:45:25.450198 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m10:45:25.451202 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m10:45:25.451202 [info ] [Thread-2 (]: 11 of 51 START test source_not_null_scooters_raw_trips_scooter_hw_id ........... [RUN]
[0m10:45:25.452200 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_user.7eea25f36c, now test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f)
[0m10:45:25.453203 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m10:45:25.456200 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m10:45:25.458200 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m10:45:25.460200 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m10:45:25.461200 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m10:45:25.461200 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: BEGIN
[0m10:45:25.462200 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:26.120238 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.767 seconds
[0m10:45:26.121238 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: ROLLBACK
[0m10:45:26.469076 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: Close
[0m10:45:26.470071 [info ] [Thread-4 (]: 8 of 51 PASS source_not_null_scooters_raw_events_type_id ....................... [[32mPASS[0m in 5.05s]
[0m10:45:26.471077 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m10:45:26.472093 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m10:45:26.473076 [info ] [Thread-4 (]: 12 of 51 START test source_not_null_scooters_raw_trips_user_id ................. [RUN]
[0m10:45:26.473076 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7, now test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62)
[0m10:45:26.474079 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m10:45:26.479076 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m10:45:26.480076 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m10:45:26.482076 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m10:45:26.483083 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m10:45:26.484078 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: BEGIN
[0m10:45:26.484078 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:27.034130 [debug] [Thread-3 (]: SQL status: BEGIN in 2.908 seconds
[0m10:45:27.035081 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m10:45:27.036082 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."events"
where user_id is null



      
    ) dbt_internal_test
[0m10:45:27.615275 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.579 seconds
[0m10:45:27.617314 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: ROLLBACK
[0m10:45:27.949079 [debug] [Thread-1 (]: SQL status: BEGIN in 2.797 seconds
[0m10:45:27.949079 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m10:45:27.950081 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."trips"
where id is null



      
    ) dbt_internal_test
[0m10:45:27.958081 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: Close
[0m10:45:27.959079 [info ] [Thread-3 (]: 9 of 51 PASS source_not_null_scooters_raw_events_user_id ....................... [[32mPASS[0m in 3.84s]
[0m10:45:27.960079 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m10:45:27.961120 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m10:45:27.962079 [info ] [Thread-3 (]: 13 of 51 START test source_not_null_scooters_raw_users_id ...................... [RUN]
[0m10:45:27.962079 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b, now test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d)
[0m10:45:27.963081 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m10:45:27.966079 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m10:45:27.968086 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m10:45:27.970085 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m10:45:27.972087 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m10:45:27.973087 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: BEGIN
[0m10:45:27.973087 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:28.311968 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.362 seconds
[0m10:45:28.313968 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: ROLLBACK
[0m10:45:28.654045 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: Close
[0m10:45:28.656002 [info ] [Thread-1 (]: 10 of 51 PASS source_not_null_scooters_raw_trips_id ............................ [[32mPASS[0m in 3.51s]
[0m10:45:28.657001 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m10:45:28.658003 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m10:45:28.658003 [info ] [Thread-1 (]: 14 of 51 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m10:45:28.659040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m10:45:28.660002 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m10:45:28.663999 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m10:45:28.664999 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m10:45:28.668007 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m10:45:28.669007 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m10:45:28.670007 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m10:45:28.670007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:29.080263 [debug] [Thread-2 (]: SQL status: BEGIN in 3.618 seconds
[0m10:45:29.081226 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m10:45:29.082226 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select scooter_hw_id
from "dev_3lcu"."scooters_raw"."trips"
where scooter_hw_id is null



      
    ) dbt_internal_test
[0m10:45:29.171959 [debug] [Thread-4 (]: SQL status: BEGIN in 2.687 seconds
[0m10:45:29.171959 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m10:45:29.172960 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."trips"
where user_id is null



      
    ) dbt_internal_test
[0m10:45:29.442031 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.359 seconds
[0m10:45:29.444031 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: ROLLBACK
[0m10:45:29.517238 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.344 seconds
[0m10:45:29.519243 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: ROLLBACK
[0m10:45:29.795283 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: Close
[0m10:45:29.797282 [info ] [Thread-2 (]: 11 of 51 PASS source_not_null_scooters_raw_trips_scooter_hw_id ................. [[32mPASS[0m in 4.34s]
[0m10:45:29.799284 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m10:45:29.800285 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m10:45:29.801279 [info ] [Thread-2 (]: 15 of 51 START test source_unique_scooters_raw_trips_id ........................ [RUN]
[0m10:45:29.802282 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f, now test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4)
[0m10:45:29.803280 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m10:45:29.809291 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m10:45:29.811291 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m10:45:29.813294 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m10:45:29.815291 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m10:45:29.815291 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: BEGIN
[0m10:45:29.816298 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:29.873303 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: Close
[0m10:45:29.874307 [info ] [Thread-4 (]: 12 of 51 PASS source_not_null_scooters_raw_trips_user_id ....................... [[32mPASS[0m in 3.40s]
[0m10:45:29.875298 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m10:45:29.876307 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m10:45:29.877309 [info ] [Thread-4 (]: 16 of 51 START test source_unique_scooters_raw_users_id ........................ [RUN]
[0m10:45:29.878307 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62, now test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf)
[0m10:45:29.878307 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m10:45:29.882341 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m10:45:29.884310 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m10:45:29.886348 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m10:45:29.887351 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m10:45:29.888315 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: BEGIN
[0m10:45:29.888315 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:31.382137 [debug] [Thread-1 (]: SQL status: BEGIN in 2.712 seconds
[0m10:45:31.383143 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m10:45:31.383143 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sex
from "dev_3lcu"."scooters_raw"."users"
where sex is null



      
    ) dbt_internal_test
[0m10:45:31.539346 [debug] [Thread-3 (]: SQL status: BEGIN in 3.566 seconds
[0m10:45:31.540346 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m10:45:31.541346 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."users"
where id is null



      
    ) dbt_internal_test
[0m10:45:31.725965 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.342 seconds
[0m10:45:31.728013 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m10:45:31.883197 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.340 seconds
[0m10:45:31.884198 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: ROLLBACK
[0m10:45:32.069194 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m10:45:32.071193 [warn ] [Thread-1 (]: 14 of 51 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 3.41s]
[0m10:45:32.072197 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m10:45:32.073197 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m10:45:32.074194 [info ] [Thread-1 (]: 17 of 51 START test unique_not_null_age_groups_age_end ......................... [RUN]
[0m10:45:32.075195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac)
[0m10:45:32.076196 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m10:45:32.083194 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m10:45:32.085193 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m10:45:32.088194 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m10:45:32.090195 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m10:45:32.091195 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: BEGIN
[0m10:45:32.091195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:32.225940 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: Close
[0m10:45:32.226893 [info ] [Thread-3 (]: 13 of 51 PASS source_not_null_scooters_raw_users_id ............................ [[32mPASS[0m in 4.26s]
[0m10:45:32.228894 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m10:45:32.229894 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m10:45:32.230895 [info ] [Thread-3 (]: 18 of 51 START test unique_not_null_age_groups_age_start ....................... [RUN]
[0m10:45:32.231893 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d, now test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b)
[0m10:45:32.231893 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m10:45:32.237935 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m10:45:32.238930 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m10:45:32.240934 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m10:45:32.242891 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m10:45:32.242891 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: BEGIN
[0m10:45:32.243897 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:32.459350 [debug] [Thread-2 (]: SQL status: BEGIN in 2.643 seconds
[0m10:45:32.459350 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m10:45:32.460349 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."trips"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:45:32.534974 [debug] [Thread-4 (]: SQL status: BEGIN in 2.646 seconds
[0m10:45:32.535922 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m10:45:32.535922 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."users"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:45:32.912839 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.376 seconds
[0m10:45:32.914807 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: ROLLBACK
[0m10:45:33.315960 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: Close
[0m10:45:33.316972 [info ] [Thread-4 (]: 16 of 51 PASS source_unique_scooters_raw_users_id .............................. [[32mPASS[0m in 3.44s]
[0m10:45:33.317971 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m10:45:33.318974 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m10:45:33.318974 [info ] [Thread-4 (]: 19 of 51 START test unique_not_null_age_groups_group ........................... [RUN]
[0m10:45:33.320008 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf, now test.dbt_scooters.unique_not_null_age_groups_group.39342291f1)
[0m10:45:33.321009 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m10:45:33.325007 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m10:45:33.326006 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m10:45:33.328002 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m10:45:33.329971 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m10:45:33.329971 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: BEGIN
[0m10:45:33.331002 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:33.517428 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.056 seconds
[0m10:45:33.518431 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: ROLLBACK
[0m10:45:33.907337 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: Close
[0m10:45:33.908299 [info ] [Thread-2 (]: 15 of 51 PASS source_unique_scooters_raw_trips_id .............................. [[32mPASS[0m in 4.11s]
[0m10:45:33.909362 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m10:45:33.911303 [debug] [Thread-2 (]: Began running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m10:45:33.911303 [info ] [Thread-2 (]: 20 of 51 START test every_event_has_type ....................................... [RUN]
[0m10:45:33.912339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4, now test.dbt_scooters.every_event_has_type.1e5fc977eb)
[0m10:45:33.913491 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m10:45:33.920011 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m10:45:33.921012 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m10:45:33.923011 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m10:45:33.924011 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m10:45:33.925010 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: BEGIN
[0m10:45:33.925010 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:34.949319 [debug] [Thread-1 (]: SQL status: BEGIN in 2.857 seconds
[0m10:45:34.949319 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m10:45:34.950319 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_end"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_end" is null


      
    ) dbt_internal_test
[0m10:45:35.026340 [debug] [Thread-3 (]: SQL status: BEGIN in 2.783 seconds
[0m10:45:35.027343 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m10:45:35.027343 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_start"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_start" is null


      
    ) dbt_internal_test
[0m10:45:35.309010 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.358 seconds
[0m10:45:35.312010 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: ROLLBACK
[0m10:45:35.384068 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.356 seconds
[0m10:45:35.386070 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: ROLLBACK
[0m10:45:35.666294 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: Close
[0m10:45:35.668306 [info ] [Thread-1 (]: 17 of 51 PASS unique_not_null_age_groups_age_end ............................... [[32mPASS[0m in 3.59s]
[0m10:45:35.669294 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m10:45:35.670298 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m10:45:35.671298 [info ] [Thread-1 (]: 21 of 51 START test unique_not_null_event_types_type ........................... [RUN]
[0m10:45:35.672299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac, now test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1)
[0m10:45:35.672299 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m10:45:35.676305 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m10:45:35.677308 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m10:45:35.679308 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m10:45:35.681308 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m10:45:35.681308 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: BEGIN
[0m10:45:35.682309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:35.728364 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: Close
[0m10:45:35.729378 [info ] [Thread-3 (]: 18 of 51 PASS unique_not_null_age_groups_age_start ............................. [[32mPASS[0m in 3.50s]
[0m10:45:35.730382 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m10:45:35.731366 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m10:45:35.732367 [info ] [Thread-3 (]: 22 of 51 START test unique_not_null_event_types_type_id ........................ [RUN]
[0m10:45:35.732367 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b, now test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85)
[0m10:45:35.733368 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m10:45:35.736371 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m10:45:35.738371 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m10:45:35.740374 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m10:45:35.741372 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m10:45:35.741372 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: BEGIN
[0m10:45:35.742372 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:36.098133 [debug] [Thread-4 (]: SQL status: BEGIN in 2.768 seconds
[0m10:45:36.099138 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m10:45:36.100134 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "group"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "group" is null


      
    ) dbt_internal_test
[0m10:45:36.452925 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.352 seconds
[0m10:45:36.455927 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: ROLLBACK
[0m10:45:36.624192 [debug] [Thread-2 (]: SQL status: BEGIN in 2.699 seconds
[0m10:45:36.625207 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m10:45:36.626216 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_type.1e5fc977eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where type_id is not null
),

parent as (
    select type_id as to_field
    from "dev_3lcu"."dbt"."event_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:45:36.809904 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: Close
[0m10:45:36.810907 [info ] [Thread-4 (]: 19 of 51 PASS unique_not_null_age_groups_group ................................. [[32mPASS[0m in 3.49s]
[0m10:45:36.812907 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m10:45:36.812907 [debug] [Thread-4 (]: Began running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m10:45:36.813907 [info ] [Thread-4 (]: 23 of 51 START test accepted_values_add_first_name_sex_sex__M__F ............... [RUN]
[0m10:45:36.814905 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_group.39342291f1, now test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199)
[0m10:45:36.815420 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m10:45:36.818426 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m10:45:36.820429 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m10:45:36.822425 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m10:45:36.823448 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m10:45:36.823448 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: BEGIN
[0m10:45:36.824426 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:37.816742 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.190 seconds
[0m10:45:37.819782 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: ROLLBACK
[0m10:45:38.156343 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: Close
[0m10:45:38.157343 [info ] [Thread-2 (]: 20 of 51 PASS every_event_has_type ............................................. [[32mPASS[0m in 4.25s]
[0m10:45:38.158342 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m10:45:38.159378 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m10:45:38.160345 [info ] [Thread-2 (]: 24 of 51 START test unique_not_null_add_first_name_sex_first_name .............. [RUN]
[0m10:45:38.161344 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_type.1e5fc977eb, now test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f)
[0m10:45:38.161344 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m10:45:38.168379 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m10:45:38.169344 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m10:45:38.224923 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m10:45:38.226434 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m10:45:38.227446 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: BEGIN
[0m10:45:38.227446 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:38.627070 [debug] [Thread-3 (]: SQL status: BEGIN in 2.885 seconds
[0m10:45:38.628069 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m10:45:38.628069 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type_id"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type_id" is null


      
    ) dbt_internal_test
[0m10:45:38.745159 [debug] [Thread-1 (]: SQL status: BEGIN in 3.063 seconds
[0m10:45:38.746164 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m10:45:38.746164 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type" is null


      
    ) dbt_internal_test
[0m10:45:38.968284 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.339 seconds
[0m10:45:38.970284 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: ROLLBACK
[0m10:45:39.095029 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.348 seconds
[0m10:45:39.097052 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: ROLLBACK
[0m10:45:39.311039 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: Close
[0m10:45:39.311992 [info ] [Thread-3 (]: 22 of 51 PASS unique_not_null_event_types_type_id .............................. [[32mPASS[0m in 3.58s]
[0m10:45:39.313036 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m10:45:39.314001 [debug] [Thread-3 (]: Began running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m10:45:39.314992 [info ] [Thread-3 (]: 25 of 51 START test every_trip_has_scooter_id .................................. [RUN]
[0m10:45:39.315995 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85, now test.dbt_scooters.every_trip_has_scooter_id.e0b845a190)
[0m10:45:39.315995 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m10:45:39.321503 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m10:45:39.322503 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m10:45:39.324508 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m10:45:39.327029 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m10:45:39.327029 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: BEGIN
[0m10:45:39.328029 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:39.438287 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: Close
[0m10:45:39.439284 [info ] [Thread-1 (]: 21 of 51 PASS unique_not_null_event_types_type ................................. [[32mPASS[0m in 3.77s]
[0m10:45:39.440238 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m10:45:39.441242 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m10:45:39.442240 [info ] [Thread-1 (]: 26 of 51 START test unique_key_scooters_company__model__hardware_id ............ [RUN]
[0m10:45:39.443238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1, now test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e)
[0m10:45:39.443238 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m10:45:39.450267 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m10:45:39.451268 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m10:45:39.453237 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m10:45:39.455242 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m10:45:39.456242 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: BEGIN
[0m10:45:39.456242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:40.419877 [debug] [Thread-4 (]: SQL status: BEGIN in 3.595 seconds
[0m10:45:40.419877 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m10:45:40.419877 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."dbt"."add_first_name_sex"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m10:45:40.765248 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.344 seconds
[0m10:45:40.767250 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: ROLLBACK
[0m10:45:40.934095 [debug] [Thread-2 (]: SQL status: BEGIN in 2.706 seconds
[0m10:45:40.935095 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m10:45:40.935095 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "first_name"
from
    "dev_3lcu"."dbt"."add_first_name_sex"
group by
    1
having
    count(*) > 1 or "first_name" is null


      
    ) dbt_internal_test
[0m10:45:41.117297 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: Close
[0m10:45:41.118300 [info ] [Thread-4 (]: 23 of 51 PASS accepted_values_add_first_name_sex_sex__M__F ..................... [[32mPASS[0m in 4.30s]
[0m10:45:41.119298 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m10:45:41.120299 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m10:45:41.120299 [info ] [Thread-4 (]: 27 of 51 START test unique_not_null_scooters_hardware_id ....................... [RUN]
[0m10:45:41.121299 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199, now test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d)
[0m10:45:41.122809 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m10:45:41.126332 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m10:45:41.127343 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m10:45:41.129342 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m10:45:41.130342 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m10:45:41.131343 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: BEGIN
[0m10:45:41.131343 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:41.273170 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.337 seconds
[0m10:45:41.275170 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: ROLLBACK
[0m10:45:41.616107 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: Close
[0m10:45:41.617126 [info ] [Thread-2 (]: 24 of 51 PASS unique_not_null_add_first_name_sex_first_name .................... [[32mPASS[0m in 3.46s]
[0m10:45:41.618156 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m10:45:41.619115 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m10:45:41.620115 [info ] [Thread-2 (]: 28 of 51 START test unique_not_null_scooters_model ............................. [RUN]
[0m10:45:41.621110 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f, now test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc)
[0m10:45:41.621110 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m10:45:41.624621 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m10:45:41.626126 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m10:45:41.628135 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m10:45:41.629135 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m10:45:41.630135 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: BEGIN
[0m10:45:41.630135 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:42.060241 [debug] [Thread-3 (]: SQL status: BEGIN in 2.733 seconds
[0m10:45:42.061192 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m10:45:42.062242 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select scooter_hw_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where scooter_hw_id is not null
),

parent as (
    select hardware_id as to_field
    from "dev_3lcu"."dbt"."scooters"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:45:42.126336 [debug] [Thread-1 (]: SQL status: BEGIN in 2.670 seconds
[0m10:45:42.127346 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m10:45:42.127346 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "company"::text ||
    
        "model"::text ||
    
        "hardware_id"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m10:45:42.522912 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.395 seconds
[0m10:45:42.523912 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: ROLLBACK
[0m10:45:42.657231 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.595 seconds
[0m10:45:42.659236 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: ROLLBACK
[0m10:45:42.868234 [debug] [Thread-1 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: Close
[0m10:45:42.869216 [info ] [Thread-1 (]: 26 of 51 PASS unique_key_scooters_company__model__hardware_id .................. [[32mPASS[0m in 3.43s]
[0m10:45:42.871178 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m10:45:42.871178 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m10:45:42.872214 [info ] [Thread-1 (]: 29 of 51 START sql incremental model dbt.events_clean .......................... [RUN]
[0m10:45:42.873177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e, now model.dbt_scooters.events_clean)
[0m10:45:42.873177 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m10:45:42.881212 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m10:45:42.882180 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m10:45:42.939345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:42.940346 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp104542919179"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at

from
    "dev_3lcu"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."events_clean")
    

  );
  
  
[0m10:45:42.941347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:43.008957 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: Close
[0m10:45:43.010961 [info ] [Thread-3 (]: 25 of 51 PASS every_trip_has_scooter_id ........................................ [[32mPASS[0m in 3.69s]
[0m10:45:43.011960 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m10:45:43.012960 [debug] [Thread-3 (]: Began running node model.dbt_scooters.first_name_sex
[0m10:45:43.012960 [info ] [Thread-3 (]: 30 of 51 START sql table model dbt.first_name_sex .............................. [RUN]
[0m10:45:43.013958 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_scooter_id.e0b845a190, now model.dbt_scooters.first_name_sex)
[0m10:45:43.014960 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.first_name_sex
[0m10:45:43.016964 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.first_name_sex"
[0m10:45:43.019963 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.first_name_sex
[0m10:45:43.032479 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.first_name_sex"
[0m10:45:43.034479 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m10:45:43.034479 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: BEGIN
[0m10:45:43.035987 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:43.882295 [debug] [Thread-4 (]: SQL status: BEGIN in 2.750 seconds
[0m10:45:43.882295 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m10:45:43.883297 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "hardware_id"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "hardware_id" is null


      
    ) dbt_internal_test
[0m10:45:44.230535 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.347 seconds
[0m10:45:44.232493 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: ROLLBACK
[0m10:45:44.357972 [debug] [Thread-2 (]: SQL status: BEGIN in 2.728 seconds
[0m10:45:44.358966 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m10:45:44.358966 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "model"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "model" is null


      
    ) dbt_internal_test
[0m10:45:44.579016 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: Close
[0m10:45:44.580024 [info ] [Thread-4 (]: 27 of 51 PASS unique_not_null_scooters_hardware_id ............................. [[32mPASS[0m in 3.46s]
[0m10:45:44.581022 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m10:45:44.582021 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_concurrency
[0m10:45:44.583024 [info ] [Thread-4 (]: 31 of 51 START sql incremental model dbt.trips_concurrency ..................... [RUN]
[0m10:45:44.584024 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d, now model.dbt_scooters.trips_concurrency)
[0m10:45:44.584024 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m10:45:44.588022 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m10:45:44.590026 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m10:45:44.594022 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:44.594022 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp104544592022"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_3lcu"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_3lcu"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now()  as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m10:45:44.595039 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:44.709248 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.350 seconds
[0m10:45:44.711229 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: ROLLBACK
[0m10:45:45.055126 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: Close
[0m10:45:45.057127 [info ] [Thread-2 (]: 28 of 51 PASS unique_not_null_scooters_model ................................... [[32mPASS[0m in 3.44s]
[0m10:45:45.058135 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m10:45:45.059133 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_geom
[0m10:45:45.060134 [info ] [Thread-2 (]: 32 of 51 START sql view model dbt.trips_geom ................................... [RUN]
[0m10:45:45.062131 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc, now model.dbt_scooters.trips_geom)
[0m10:45:45.062131 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_geom
[0m10:45:45.066165 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m10:45:45.067129 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_geom
[0m10:45:45.085127 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m10:45:45.087132 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:45:45.088128 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m10:45:45.088128 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:46.415158 [debug] [Thread-1 (]: SQL status: SELECT 0 in 3.475 seconds
[0m10:45:46.418206 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:46.419207 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m10:45:46.743258 [debug] [Thread-3 (]: SQL status: BEGIN in 3.708 seconds
[0m10:45:46.744250 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m10:45:46.744250 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

  
    

  create  table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp"
  
  
    as
  
  (
    select distinct first_name, sex
from "dev_3lcu"."scooters_raw"."users"
Where sex is not null
  );
  
[0m10:45:46.756257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.337 seconds
[0m10:45:46.757251 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:46.757251 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp104542919179'
        
      order by ordinal_position

  
[0m10:45:47.092406 [debug] [Thread-3 (]: SQL status: SELECT 387 in 0.347 seconds
[0m10:45:47.101924 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m10:45:47.102933 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex" rename to "first_name_sex__dbt_backup"
[0m10:45:47.108962 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.351 seconds
[0m10:45:47.111949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:47.112949 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:45:47.443848 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.340 seconds
[0m10:45:47.446881 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m10:45:47.446881 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp" rename to "first_name_sex"
[0m10:45:47.509881 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.396 seconds
[0m10:45:47.521882 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:47.522881 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp104542919179'
        
      order by ordinal_position

  
[0m10:45:47.808885 [debug] [Thread-2 (]: SQL status: BEGIN in 2.720 seconds
[0m10:45:47.808885 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:45:47.809887 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.362 seconds
[0m10:45:47.809887 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_3lcu"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m10:45:47.816890 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m10:45:47.817891 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

    
  
  comment on table "dev_3lcu"."dbt"."first_name_sex" is $dbt_comment_literal_block$Unique name_sex glossary$dbt_comment_literal_block$;

  
[0m10:45:48.013044 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.490 seconds
[0m10:45:48.017030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:48.017997 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:45:48.209996 [debug] [Thread-3 (]: SQL status: COMMENT in 0.391 seconds
[0m10:45:48.212033 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m10:45:48.212033 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m10:45:48.213031 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m10:45:48.218045 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.400 seconds
[0m10:45:48.220996 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:45:48.221997 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m10:45:48.413042 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.394 seconds
[0m10:45:48.422040 [debug] [Thread-1 (]: 
    In "dev_3lcu"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:45:48.437174 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m10:45:48.440134 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:48.441179 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        
            delete from "dev_3lcu"."dbt"."events_clean"
            using "events_clean__dbt_tmp104542919179"
            where (
                
                    "events_clean__dbt_tmp104542919179".user_id = "dev_3lcu"."dbt"."events_clean".user_id
                    and 
                
                    "events_clean__dbt_tmp104542919179".timestamp = "dev_3lcu"."dbt"."events_clean".timestamp
                    and 
                
                    "events_clean__dbt_tmp104542919179".type_id = "dev_3lcu"."dbt"."events_clean".type_id
                    
                
                
            );
        
    

    insert into "dev_3lcu"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp104542919179"
    )
  
[0m10:45:48.606994 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.385 seconds
[0m10:45:48.609944 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:45:48.610944 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m10:45:48.709183 [debug] [Thread-3 (]: SQL status: COMMIT in 0.496 seconds
[0m10:45:48.716212 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."first_name_sex__dbt_backup"
[0m10:45:48.720212 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m10:45:48.721219 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
drop table if exists "dev_3lcu"."dbt"."first_name_sex__dbt_backup" cascade
[0m10:45:48.809998 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.368 seconds
[0m10:45:48.812030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:48.812030 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_clean" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m10:45:48.915180 [debug] [Thread-4 (]: SQL status: SELECT 0 in 4.319 seconds
[0m10:45:48.918190 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:48.918190 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m10:45:48.944215 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.333 seconds
[0m10:45:48.946254 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:45:48.946254 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_geom" is $dbt_comment_literal_block$Trips prepared for geometry analysis$dbt_comment_literal_block$;

  
[0m10:45:49.080063 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.359 seconds
[0m10:45:49.082009 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: Close
[0m10:45:49.083006 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71546C230>]}
[0m10:45:49.084008 [info ] [Thread-3 (]: 30 of 51 OK created sql table model dbt.first_name_sex ......................... [[32mSELECT 387[0m in 6.07s]
[0m10:45:49.086011 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.first_name_sex
[0m10:45:49.087006 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_prep
[0m10:45:49.088007 [info ] [Thread-3 (]: 33 of 51 START sql view model dbt.trips_prep ................................... [RUN]
[0m10:45:49.088007 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.first_name_sex, now model.dbt_scooters.trips_prep)
[0m10:45:49.089008 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_prep
[0m10:45:49.094006 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m10:45:49.096006 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_prep
[0m10:45:49.101013 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m10:45:49.103014 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:45:49.104015 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m10:45:49.105012 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:49.152100 [debug] [Thread-1 (]: SQL status: COMMENT in 0.339 seconds
[0m10:45:49.154091 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:45:49.154091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:45:49.155091 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:45:49.259962 [debug] [Thread-4 (]: SQL status: BEGIN in 0.341 seconds
[0m10:45:49.260914 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:49.261915 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp104544592022'
        
      order by ordinal_position

  
[0m10:45:49.279911 [debug] [Thread-2 (]: SQL status: COMMENT in 0.333 seconds
[0m10:45:49.280952 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m10:45:49.281948 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:45:49.281948 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m10:45:49.494250 [debug] [Thread-1 (]: SQL status: COMMIT in 0.339 seconds
[0m10:45:49.495244 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m10:45:49.496255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715958B00>]}
[0m10:45:49.497253 [info ] [Thread-1 (]: 29 of 51 OK created sql incremental model dbt.events_clean ..................... [[32mINSERT 0 0[0m in 6.62s]
[0m10:45:49.498250 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m10:45:49.499250 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m10:45:49.500253 [info ] [Thread-1 (]: 34 of 51 START sql table model dbt.companies ................................... [RUN]
[0m10:45:49.501253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.companies)
[0m10:45:49.501253 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m10:45:49.505251 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m10:45:49.506280 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m10:45:49.509278 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m10:45:49.510264 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:45:49.511252 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m10:45:49.511252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:49.610984 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.349 seconds
[0m10:45:49.613930 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:49.614930 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:45:49.615927 [debug] [Thread-2 (]: SQL status: COMMIT in 0.333 seconds
[0m10:45:49.617962 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_geom__dbt_backup"
[0m10:45:49.620960 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:45:49.621927 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_3lcu"."dbt"."trips_geom__dbt_backup" cascade
[0m10:45:49.958048 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.336 seconds
[0m10:45:49.960040 [debug] [Thread-2 (]: On model.dbt_scooters.trips_geom: Close
[0m10:45:49.961042 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.345 seconds
[0m10:45:49.964005 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:49.965009 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715155940>]}
[0m10:45:49.965009 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp104544592022'
        
      order by ordinal_position

  
[0m10:45:49.966007 [info ] [Thread-2 (]: 32 of 51 OK created sql view model dbt.trips_geom .............................. [[32mCREATE VIEW[0m in 4.90s]
[0m10:45:49.967002 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_geom
[0m10:45:49.968036 [debug] [Thread-2 (]: Began running node model.dbt_scooters.users_full
[0m10:45:49.969034 [info ] [Thread-2 (]: 35 of 51 START sql table model dbt.users_full .................................. [RUN]
[0m10:45:49.970005 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.users_full)
[0m10:45:49.971004 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.users_full
[0m10:45:49.974034 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.users_full"
[0m10:45:49.975002 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.users_full
[0m10:45:49.978030 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.users_full"
[0m10:45:49.979003 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m10:45:49.980002 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: BEGIN
[0m10:45:49.981006 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:50.319051 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.352 seconds
[0m10:45:50.323054 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:50.323054 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:45:50.685948 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.362 seconds
[0m10:45:50.687982 [debug] [Thread-4 (]: 
    In "dev_3lcu"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:45:50.692982 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m10:45:50.694947 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:50.694947 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_3lcu"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp104544592022"
    )


  
[0m10:45:51.103909 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.408 seconds
[0m10:45:51.106924 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:51.107918 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_concurrency" is $dbt_comment_literal_block$Number of simultaneous rides in time$dbt_comment_literal_block$;

  
[0m10:45:51.473148 [debug] [Thread-4 (]: SQL status: COMMENT in 0.364 seconds
[0m10:45:51.474150 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m10:45:51.475150 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:45:51.475150 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m10:45:51.784987 [debug] [Thread-3 (]: SQL status: BEGIN in 2.680 seconds
[0m10:45:51.785992 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:45:51.785992 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_3lcu"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select
    id,
    user_id,
    scooter_hw_id,
    started_at,
    finished_at,
    start_lat,
    start_lon,
    finish_lat,
    finish_lon,
    distance as distance_m,
    cast(price as decimal(20, 2)) / 100 as price_rub,
    extract(epoch from (finished_at - started_at)) as duration_s,
    finished_at <> started_at and price = 0 as is_free,
    
    date(started_at at time zone 'Europe/Moscow')
 as "date"
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m10:45:51.932199 [debug] [Thread-4 (]: SQL status: COMMIT in 0.456 seconds
[0m10:45:51.933204 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: Close
[0m10:45:51.934203 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71544AD50>]}
[0m10:45:51.935204 [info ] [Thread-4 (]: 31 of 51 OK created sql incremental model dbt.trips_concurrency ................ [[32mINSERT 0 0[0m in 7.35s]
[0m10:45:51.936200 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m10:45:51.937204 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_full
[0m10:45:51.938201 [info ] [Thread-4 (]: 36 of 51 START sql view model dbt.events_full .................................. [RUN]
[0m10:45:51.938201 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.events_full)
[0m10:45:51.939714 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_full
[0m10:45:51.942726 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m10:45:51.944727 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_full
[0m10:45:51.948247 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m10:45:51.950261 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:45:51.950261 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: BEGIN
[0m10:45:51.951248 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:52.144417 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.358 seconds
[0m10:45:52.148939 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:45:52.149940 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m10:45:52.362085 [debug] [Thread-1 (]: SQL status: BEGIN in 2.850 seconds
[0m10:45:52.363087 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:45:52.364083 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_3lcu"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
  );
  
[0m10:45:52.486222 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.336 seconds
[0m10:45:52.490222 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:45:52.490222 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m10:45:52.747932 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.384 seconds
[0m10:45:52.751930 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:45:52.751930 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies" rename to "companies__dbt_backup"
[0m10:45:52.840486 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.350 seconds
[0m10:45:52.842493 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:45:52.842493 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_prep" is $dbt_comment_literal_block$Trips prepared for analysis$dbt_comment_literal_block$;

  
[0m10:45:53.107185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.355 seconds
[0m10:45:53.110187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:45:53.111188 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies__dbt_tmp" rename to "companies"
[0m10:45:53.187264 [debug] [Thread-3 (]: SQL status: COMMENT in 0.344 seconds
[0m10:45:53.189265 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m10:45:53.190269 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:45:53.190269 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m10:45:53.456965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.345 seconds
[0m10:45:53.458966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:45:53.458966 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies" is $dbt_comment_literal_block$Scooter statistics by company$dbt_comment_literal_block$;

  
[0m10:45:53.534995 [debug] [Thread-3 (]: SQL status: COMMIT in 0.344 seconds
[0m10:45:53.540009 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_prep__dbt_backup"
[0m10:45:53.541006 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:45:53.541533 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_3lcu"."dbt"."trips_prep__dbt_backup" cascade
[0m10:45:53.581066 [debug] [Thread-2 (]: SQL status: BEGIN in 3.600 seconds
[0m10:45:53.582066 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m10:45:53.582066 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

  
    

  create  table "dev_3lcu"."dbt"."users_full__dbt_tmp"
  
  
    as
  
  (
    select
   u.id, u.first_name ,u.last_name ,u.phone ,
   COALESCE(u.sex, fns.sex, afns.sex) as sex2,
   u.birth_date
from "dev_3lcu"."scooters_raw"."users" u
left join "dev_3lcu"."dbt"."first_name_sex" fns on u.first_name = fns.first_name
left join "dev_3lcu"."dbt"."add_first_name_sex" afns on u.first_name =afns.first_name
  );
  
[0m10:45:53.808293 [debug] [Thread-1 (]: SQL status: COMMENT in 0.348 seconds
[0m10:45:53.810279 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m10:45:53.810279 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:45:53.811286 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m10:45:53.909893 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.368 seconds
[0m10:45:53.911876 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: Close
[0m10:45:53.912852 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715A49B80>]}
[0m10:45:53.913850 [info ] [Thread-3 (]: 33 of 51 OK created sql view model dbt.trips_prep .............................. [[32mCREATE VIEW[0m in 4.82s]
[0m10:45:53.914849 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_prep
[0m10:45:53.914849 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m10:45:53.915848 [info ] [Thread-3 (]: 37 of 51 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m10:45:53.916892 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.parking_finish_stat)
[0m10:45:53.916892 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m10:45:53.920854 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m10:45:53.921854 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m10:45:53.925861 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m10:45:53.927871 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:45:53.927871 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m10:45:53.928868 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:45:54.112887 [debug] [Thread-2 (]: SQL status: SELECT 2000 in 0.529 seconds
[0m10:45:54.116892 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m10:45:54.116892 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full" rename to "users_full__dbt_backup"
[0m10:45:54.161096 [debug] [Thread-1 (]: SQL status: COMMIT in 0.350 seconds
[0m10:45:54.163128 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."companies__dbt_backup"
[0m10:45:54.164135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:45:54.165095 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_3lcu"."dbt"."companies__dbt_backup" cascade
[0m10:45:54.454208 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m10:45:54.457212 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m10:45:54.458213 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full__dbt_tmp" rename to "users_full"
[0m10:45:54.509242 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.344 seconds
[0m10:45:54.513246 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m10:45:54.514222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715ABAEA0>]}
[0m10:45:54.515212 [info ] [Thread-1 (]: 34 of 51 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 5.01s]
[0m10:45:54.516213 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m10:45:54.516213 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_start_stat
[0m10:45:54.517243 [info ] [Thread-1 (]: 38 of 51 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m10:45:54.518212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.parking_start_stat)
[0m10:45:54.519215 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m10:45:54.521241 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m10:45:54.523216 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m10:45:54.526240 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m10:45:54.527216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:45:54.528214 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m10:45:54.528214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:54.694042 [debug] [Thread-4 (]: SQL status: BEGIN in 2.742 seconds
[0m10:45:54.694042 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:45:54.695042 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_3lcu"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select * from
"dev_3lcu"."dbt"."events_clean" as e
left join "dev_3lcu"."dbt"."event_types" as t
using (type_id)
  );
[0m10:45:55.039131 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.344 seconds
[0m10:45:55.043604 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:45:55.044610 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m10:45:55.132213 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.674 seconds
[0m10:45:55.135163 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m10:45:55.136166 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

    
  
  comment on table "dev_3lcu"."dbt"."users_full" is $dbt_comment_literal_block$Users enriched with sex$dbt_comment_literal_block$;

  
[0m10:45:55.384059 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.339 seconds
[0m10:45:55.387010 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:45:55.388009 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m10:45:55.567027 [debug] [Thread-2 (]: SQL status: COMMENT in 0.431 seconds
[0m10:45:55.569025 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: COMMIT
[0m10:45:55.570025 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m10:45:55.570025 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: COMMIT
[0m10:45:55.727236 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.339 seconds
[0m10:45:55.729190 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:45:55.730190 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

    
  
  comment on view "dev_3lcu"."dbt"."events_full" is $dbt_comment_literal_block$User events enriched with meaningful types$dbt_comment_literal_block$;

  
[0m10:45:56.069037 [debug] [Thread-2 (]: SQL status: COMMIT in 0.498 seconds
[0m10:45:56.071039 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."users_full__dbt_backup"
[0m10:45:56.072037 [debug] [Thread-4 (]: SQL status: COMMENT in 0.342 seconds
[0m10:45:56.073039 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m10:45:56.075040 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m10:45:56.075040 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
drop table if exists "dev_3lcu"."dbt"."users_full__dbt_backup" cascade
[0m10:45:56.076054 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:45:56.076054 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m10:45:56.417301 [debug] [Thread-4 (]: SQL status: COMMIT in 0.340 seconds
[0m10:45:56.420296 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."events_full__dbt_backup"
[0m10:45:56.421256 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:45:56.421256 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_3lcu"."dbt"."events_full__dbt_backup" cascade
[0m10:45:56.448424 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.372 seconds
[0m10:45:56.450377 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: Close
[0m10:45:56.451379 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71599B380>]}
[0m10:45:56.452384 [info ] [Thread-2 (]: 35 of 51 OK created sql table model dbt.users_full ............................. [[32mSELECT 2000[0m in 6.48s]
[0m10:45:56.453377 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.users_full
[0m10:45:56.454381 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m10:45:56.455888 [info ] [Thread-2 (]: 39 of 51 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m10:45:56.456896 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.users_full, now model.dbt_scooters.revenue_daily)
[0m10:45:56.456896 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m10:45:56.460937 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m10:45:56.461897 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m10:45:56.465935 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:45:56.466898 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp104556463894"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_3lcu"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m10:45:56.466898 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:45:56.603021 [debug] [Thread-3 (]: SQL status: BEGIN in 2.675 seconds
[0m10:45:56.604022 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:45:56.604022 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m10:45:56.772182 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.350 seconds
[0m10:45:56.774184 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: Close
[0m10:45:56.775185 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715A5DE20>]}
[0m10:45:56.775185 [info ] [Thread-4 (]: 36 of 51 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 4.84s]
[0m10:45:56.776190 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_full
[0m10:45:56.777198 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat
[0m10:45:56.778193 [info ] [Thread-4 (]: 40 of 51 START sql table model dbt.trips_stat .................................. [RUN]
[0m10:45:56.779196 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_stat)
[0m10:45:56.779196 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat
[0m10:45:56.782193 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m10:45:56.783193 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat
[0m10:45:56.786197 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m10:45:56.788205 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:45:56.789202 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m10:45:56.789202 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:45:57.620932 [debug] [Thread-1 (]: SQL status: BEGIN in 3.093 seconds
[0m10:45:57.621929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:45:57.622930 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m10:46:00.192123 [debug] [Thread-4 (]: SQL status: BEGIN in 3.403 seconds
[0m10:46:00.193093 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:46:00.194114 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count(*) as trips,
    count(distinct user_id) as users,
    avg(duration_s) / 60 as avg_duration_min,
    sum(distance_m) / 1000 as sum_distance_km,
    sum(price_rub) as revenue_rub,
    count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from
    "dev_3lcu"."dbt"."trips_prep"
  );
  
[0m10:46:03.137963 [debug] [Thread-2 (]: SQL status: SELECT 3 in 6.671 seconds
[0m10:46:03.143006 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:03.143006 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m10:46:03.518087 [debug] [Thread-2 (]: SQL status: BEGIN in 0.374 seconds
[0m10:46:03.518087 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:03.519084 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp104556463894'
        
      order by ordinal_position

  
[0m10:46:04.213290 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.694 seconds
[0m10:46:04.217243 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:04.217243 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m10:46:04.808204 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.590 seconds
[0m10:46:04.811207 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:04.812206 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp104556463894'
        
      order by ordinal_position

  
[0m10:46:05.308119 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.495 seconds
[0m10:46:05.311111 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:05.311111 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m10:46:05.809097 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.497 seconds
[0m10:46:05.811093 [debug] [Thread-2 (]: 
    In "dev_3lcu"."finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:46:05.812061 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m10:46:05.814058 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:05.814058 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        
            delete from "dev_3lcu"."finance"."revenue_daily"
            using "revenue_daily__dbt_tmp104556463894"
            where (
                
                    "revenue_daily__dbt_tmp104556463894".date = "dev_3lcu"."finance"."revenue_daily".date
                    
                
                
            );
        
    

    insert into "dev_3lcu"."finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp104556463894"
    )
  
[0m10:46:06.266834 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.452 seconds
[0m10:46:06.271829 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:06.272789 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_3lcu".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'finance'
        and table_name = 'revenue_daily'
  
[0m10:46:07.112251 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.840 seconds
[0m10:46:07.114290 [debug] [Thread-2 (]: On "dev_3lcu"."finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m10:46:07.115250 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:07.116290 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  comment on table "dev_3lcu"."finance"."revenue_daily" is $dbt_comment_literal_block$Summary daily revenue$dbt_comment_literal_block$;

  
[0m10:46:07.507991 [debug] [Thread-2 (]: SQL status: COMMENT in 0.391 seconds
[0m10:46:07.509985 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m10:46:07.509985 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:46:07.510944 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m10:46:07.909883 [debug] [Thread-2 (]: SQL status: COMMIT in 0.398 seconds
[0m10:46:07.910876 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m10:46:07.911903 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715968DA0>]}
[0m10:46:07.911903 [info ] [Thread-2 (]: 39 of 51 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 3[0m in 11.46s]
[0m10:46:07.912909 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m10:46:07.913927 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m10:46:07.914919 [info ] [Thread-2 (]: 41 of 51 START sql table model dbt.trips_stat_daily ............................ [RUN]
[0m10:46:07.915875 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_stat_daily)
[0m10:46:07.915875 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m10:46:07.918914 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m10:46:07.920875 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m10:46:07.923874 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m10:46:07.925876 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:07.925876 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m10:46:07.926883 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:46:08.716134 [debug] [Thread-4 (]: SQL status: SELECT 1 in 8.522 seconds
[0m10:46:08.720090 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:46:08.721089 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m10:46:09.114183 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.392 seconds
[0m10:46:09.117183 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:46:09.117183 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m10:46:09.508172 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.390 seconds
[0m10:46:09.510129 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:46:09.511129 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat" is $dbt_comment_literal_block$Overall trips statistics$dbt_comment_literal_block$;

  
[0m10:46:09.919077 [debug] [Thread-4 (]: SQL status: COMMENT in 0.408 seconds
[0m10:46:09.921083 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m10:46:09.922083 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:46:09.923085 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m10:46:10.311870 [debug] [Thread-4 (]: SQL status: COMMIT in 0.388 seconds
[0m10:46:10.314874 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat__dbt_backup"
[0m10:46:10.315872 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:46:10.315872 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat__dbt_backup" cascade
[0m10:46:10.721228 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.405 seconds
[0m10:46:10.724231 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: Close
[0m10:46:10.725246 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715A2F950>]}
[0m10:46:10.725246 [info ] [Thread-4 (]: 40 of 51 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 13.95s]
[0m10:46:10.726252 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat
[0m10:46:10.727254 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m10:46:10.728250 [info ] [Thread-4 (]: 42 of 51 START sql incremental model dbt.trips_users ........................... [RUN]
[0m10:46:10.729253 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_users)
[0m10:46:10.729253 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m10:46:10.733253 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m10:46:10.734253 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m10:46:10.741770 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:10.741770 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp104610736768"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep" as t
left join
    "dev_3lcu"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_3lcu"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m10:46:10.742766 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:46:11.107887 [debug] [Thread-2 (]: SQL status: BEGIN in 3.181 seconds
[0m10:46:11.108887 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:11.108887 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    count(*) as trips,
    max(price_rub) as max_price_rub,
    avg(distance_m) / 1000 as avg_distance_km,
    avg(price_rub)/avg(duration_s) * 60 as avg_price_rub_per_min
from
    "dev_3lcu"."dbt"."trips_prep"
group by
    1
order by
    1
  );
  
[0m10:46:17.311009 [debug] [Thread-4 (]: SQL status: SELECT 0 in 6.568 seconds
[0m10:46:17.313967 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:17.314967 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m10:46:17.717035 [debug] [Thread-4 (]: SQL status: BEGIN in 0.402 seconds
[0m10:46:17.717992 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:17.717992 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp104610736768'
        
      order by ordinal_position

  
[0m10:46:18.512802 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.794 seconds
[0m10:46:18.516802 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:18.516802 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:46:19.211117 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.694 seconds
[0m10:46:19.215075 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:19.216090 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp104610736768'
        
      order by ordinal_position

  
[0m10:46:19.712141 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.495 seconds
[0m10:46:19.716141 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:19.716141 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:46:19.909189 [debug] [Thread-2 (]: SQL status: SELECT 91 in 8.800 seconds
[0m10:46:19.912192 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:19.913200 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m10:46:20.217788 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.500 seconds
[0m10:46:20.220778 [debug] [Thread-4 (]: 
    In "dev_3lcu"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:46:20.221779 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m10:46:20.222783 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:20.223779 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_3lcu"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp104610736768"
    )


  
[0m10:46:20.251779 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m10:46:20.254780 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:20.254780 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m10:46:20.608870 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.385 seconds
[0m10:46:20.608870 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.353 seconds
[0m10:46:20.610873 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:20.619870 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:20.620870 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_users" is $dbt_comment_literal_block$Prepared trips enriched with users data$dbt_comment_literal_block$;

  
[0m10:46:20.621871 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    create  index if not exists
  "2db8ee0d4dbc6739c4a8902aff929d81"
  on "dev_3lcu"."dbt"."trips_stat_daily" 
  (date)
  
[0m10:46:21.007976 [debug] [Thread-4 (]: SQL status: COMMENT in 0.386 seconds
[0m10:46:21.009965 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:21.009965 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m10:46:21.109986 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.487 seconds
[0m10:46:21.111986 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:21.111986 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat_daily" is $dbt_comment_literal_block$Overall trips statistics per day$dbt_comment_literal_block$;

  
[0m10:46:21.509093 [debug] [Thread-2 (]: SQL status: COMMENT in 0.396 seconds
[0m10:46:21.513095 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:21.513095 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_stat_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:46:22.415164 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.901 seconds
[0m10:46:22.417164 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:22.417164 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."trips_stat_daily".date is $dbt_comment_literal_block$Trips date$dbt_comment_literal_block$;
  

  
[0m10:46:22.809849 [debug] [Thread-2 (]: SQL status: COMMENT in 0.392 seconds
[0m10:46:22.811851 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m10:46:22.811851 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:22.812849 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m10:46:23.208974 [debug] [Thread-2 (]: SQL status: COMMIT in 0.396 seconds
[0m10:46:23.211977 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup"
[0m10:46:23.212977 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:46:23.212977 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m10:46:23.617125 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.403 seconds
[0m10:46:23.618127 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m10:46:23.619125 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7153D6BA0>]}
[0m10:46:23.620127 [info ] [Thread-2 (]: 41 of 51 OK created sql table model dbt.trips_stat_daily ....................... [[32mSELECT 91[0m in 15.70s]
[0m10:46:23.621128 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m10:46:23.622126 [debug] [Thread-2 (]: Began running node model.dbt_scooters.companies_trips
[0m10:46:23.623126 [info ] [Thread-2 (]: 43 of 51 START sql table model dbt.companies_trips ............................. [RUN]
[0m10:46:23.624129 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.companies_trips)
[0m10:46:23.624129 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.companies_trips
[0m10:46:23.627126 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m10:46:23.629125 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.companies_trips
[0m10:46:23.633129 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m10:46:23.635127 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:23.635127 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m10:46:23.636124 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:46:27.011029 [debug] [Thread-2 (]: SQL status: BEGIN in 3.375 seconds
[0m10:46:27.012072 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:27.013031 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_3lcu"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_3lcu"."dbt"."trips_prep" as t
        join "dev_3lcu"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_3lcu"."dbt"."companies" as c
        using (company)
  );
  
[0m10:46:30.407895 [debug] [Thread-2 (]: SQL status: SELECT 6 in 3.395 seconds
[0m10:46:30.412849 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:30.413849 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m10:46:30.808120 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.394 seconds
[0m10:46:30.811152 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:30.811152 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m10:46:31.207821 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.396 seconds
[0m10:46:31.209842 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:31.210809 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies_trips" is $dbt_comment_literal_block$Trip statistics by company$dbt_comment_literal_block$;

  
[0m10:46:31.606798 [debug] [Thread-2 (]: SQL status: COMMENT in 0.395 seconds
[0m10:46:31.609797 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:31.609797 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'companies_trips'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:46:32.315175 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.704 seconds
[0m10:46:32.317174 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:32.318178 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."companies_trips".company is $dbt_comment_literal_block$Scooters manufacturing company$dbt_comment_literal_block$;
  

  
[0m10:46:32.708190 [debug] [Thread-2 (]: SQL status: COMMENT in 0.390 seconds
[0m10:46:32.710179 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m10:46:32.711147 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:32.711147 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m10:46:33.108820 [debug] [Thread-2 (]: SQL status: COMMIT in 0.397 seconds
[0m10:46:33.111813 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."companies_trips__dbt_backup"
[0m10:46:33.111813 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:46:33.112813 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_3lcu"."dbt"."companies_trips__dbt_backup" cascade
[0m10:46:33.510055 [debug] [Thread-3 (]: SQL status: SELECT 464 in 36.905 seconds
[0m10:46:33.511040 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.398 seconds
[0m10:46:33.514045 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:46:33.514045 [debug] [Thread-4 (]: SQL status: ANALYZE in 12.504 seconds
[0m10:46:33.516044 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: Close
[0m10:46:33.516044 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m10:46:33.517041 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m10:46:33.519009 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7153D52B0>]}
[0m10:46:33.519009 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:33.520010 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m10:46:33.520010 [info ] [Thread-2 (]: 43 of 51 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 9.89s]
[0m10:46:33.522030 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.companies_trips
[0m10:46:33.522030 [debug] [Thread-2 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m10:46:33.523042 [info ] [Thread-2 (]: 44 of 51 START test events_full_is_complete .................................... [RUN]
[0m10:46:33.524054 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now test.dbt_scooters.events_full_is_complete)
[0m10:46:33.524054 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m10:46:33.527041 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m10:46:33.529009 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m10:46:33.531041 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.events_full_is_complete"
[0m10:46:33.532010 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m10:46:33.533008 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: BEGIN
[0m10:46:33.533008 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:46:33.853062 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.335 seconds
[0m10:46:33.856094 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:46:33.857062 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m10:46:33.860064 [debug] [Thread-4 (]: SQL status: COMMIT in 0.338 seconds
[0m10:46:33.860064 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:33.861064 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m10:46:34.207765 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.350 seconds
[0m10:46:34.209808 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:46:34.210808 [debug] [Thread-4 (]: SQL status: COMMIT in 0.349 seconds
[0m10:46:34.210808 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_finish_stat" is $dbt_comment_literal_block$Trip finish parking statistics by 10 m hexagons$dbt_comment_literal_block$;

  
[0m10:46:34.211806 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:46:34.212805 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m10:46:34.608970 [debug] [Thread-3 (]: SQL status: COMMENT in 0.397 seconds
[0m10:46:34.610917 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m10:46:34.611917 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:46:34.611917 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m10:46:34.612919 [debug] [Thread-4 (]: SQL status: VACUUM in 0.399 seconds
[0m10:46:34.614916 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m10:46:34.615948 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7151579B0>]}
[0m10:46:34.615948 [info ] [Thread-4 (]: 42 of 51 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 23.89s]
[0m10:46:34.617924 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m10:46:34.617924 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m10:46:34.618923 [info ] [Thread-4 (]: 45 of 51 START test unique_companies_trips_company ............................. [RUN]
[0m10:46:34.619916 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m10:46:34.620963 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m10:46:34.624918 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m10:46:34.626960 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m10:46:34.629953 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m10:46:34.631917 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m10:46:34.631917 [debug] [Thread-4 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m10:46:34.632956 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:46:35.012908 [debug] [Thread-3 (]: SQL status: COMMIT in 0.399 seconds
[0m10:46:35.015954 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup"
[0m10:46:35.016948 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:46:35.016948 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m10:46:35.408866 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.391 seconds
[0m10:46:35.410820 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m10:46:35.411819 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7159A0530>]}
[0m10:46:35.412821 [info ] [Thread-3 (]: 37 of 51 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 41.49s]
[0m10:46:35.413820 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m10:46:35.414818 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m10:46:35.415818 [info ] [Thread-3 (]: 46 of 51 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m10:46:35.416819 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_finish_stat, now model.dbt_scooters.trips_age_daily)
[0m10:46:35.416819 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m10:46:35.421862 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m10:46:35.423820 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m10:46:35.426859 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m10:46:35.428821 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:46:35.429882 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m10:46:35.430858 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:46:36.607025 [debug] [Thread-2 (]: SQL status: BEGIN in 3.074 seconds
[0m10:46:36.608019 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m10:46:36.608983 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.events_full_is_complete"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with source_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_clean"
),
target_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_full"
)
select
    'Row count mismatch' as error_message,
    source_cte.row_count as source_count,
    target_cte.row_count as target_count
from
    source_cte,
    target_cte
where
    source_cte.row_count != target_cte.row_count
      
    ) dbt_internal_test
[0m10:46:37.614068 [debug] [Thread-4 (]: SQL status: BEGIN in 2.982 seconds
[0m10:46:37.615025 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m10:46:37.616026 [debug] [Thread-4 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



      
    ) dbt_internal_test
[0m10:46:38.239924 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.624 seconds
[0m10:46:38.242921 [debug] [Thread-4 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m10:46:38.512011 [debug] [Thread-3 (]: SQL status: BEGIN in 3.081 seconds
[0m10:46:38.513012 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:46:38.513012 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    Select "date",
       age,
       count(*) as trips,
       sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m10:46:38.608848 [debug] [Thread-4 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m10:46:38.610799 [info ] [Thread-4 (]: 45 of 51 PASS unique_companies_trips_company ................................... [[32mPASS[0m in 3.99s]
[0m10:46:38.611805 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m10:46:38.611805 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_group
[0m10:46:38.612804 [info ] [Thread-4 (]: 47 of 51 START sql table model dbt.trips_age_group ............................. [RUN]
[0m10:46:38.613800 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0, now model.dbt_scooters.trips_age_group)
[0m10:46:38.613800 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m10:46:38.616834 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m10:46:38.617843 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_age_group
[0m10:46:38.621834 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m10:46:38.622803 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:46:38.623803 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m10:46:38.623803 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:46:40.308976 [debug] [Thread-2 (]: SQL status: SELECT 1 in 3.699 seconds
[0m10:46:40.309978 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: ROLLBACK
[0m10:46:40.708093 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: Close
[0m10:46:40.709093 [info ] [Thread-2 (]: 44 of 51 PASS events_full_is_complete .......................................... [[32mPASS[0m in 7.19s]
[0m10:46:40.710093 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m10:46:40.711097 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_stat
[0m10:46:40.712094 [info ] [Thread-2 (]: 48 of 51 START sql table model dbt.events_stat ................................. [RUN]
[0m10:46:40.713095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.events_full_is_complete, now model.dbt_scooters.events_stat)
[0m10:46:40.713095 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_stat
[0m10:46:40.716098 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m10:46:40.722122 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_stat
[0m10:46:40.728121 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m10:46:40.732145 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:46:40.733122 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: BEGIN
[0m10:46:40.734134 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:46:40.806746 [debug] [Thread-3 (]: SQL status: SELECT 7049 in 2.293 seconds
[0m10:46:40.810702 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:46:40.811736 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m10:46:41.208213 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.396 seconds
[0m10:46:41.211213 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:46:41.211213 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m10:46:41.424836 [debug] [Thread-1 (]: SQL status: SELECT 142 in 43.802 seconds
[0m10:46:41.428865 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:46:41.428865 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m10:46:41.547085 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.336 seconds
[0m10:46:41.549039 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:46:41.550039 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily" is $dbt_comment_literal_block$Daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m10:46:41.551041 [debug] [Thread-4 (]: SQL status: BEGIN in 2.927 seconds
[0m10:46:41.552044 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:46:41.553043 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users" as tu
    cross join "dev_3lcu"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m10:46:41.774139 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.345 seconds
[0m10:46:41.778124 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:46:41.778124 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m10:46:41.885694 [debug] [Thread-3 (]: SQL status: COMMENT in 0.335 seconds
[0m10:46:41.887729 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m10:46:41.887729 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:46:41.888731 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m10:46:42.121793 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.343 seconds
[0m10:46:42.123779 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:46:42.124791 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_start_stat" is $dbt_comment_literal_block$Trip start parking statistics by 500 m hexagons$dbt_comment_literal_block$;

  
[0m10:46:42.232009 [debug] [Thread-3 (]: SQL status: COMMIT in 0.343 seconds
[0m10:46:42.234958 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily__dbt_backup"
[0m10:46:42.235959 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:46:42.235959 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily__dbt_backup" cascade
[0m10:46:42.550864 [debug] [Thread-1 (]: SQL status: COMMENT in 0.426 seconds
[0m10:46:42.552820 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m10:46:42.553820 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:46:42.553820 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m10:46:42.614057 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.377 seconds
[0m10:46:42.615027 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m10:46:42.616058 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715AF3680>]}
[0m10:46:42.617026 [info ] [Thread-3 (]: 46 of 51 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 7.20s]
[0m10:46:42.618025 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m10:46:42.619024 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m10:46:42.620033 [info ] [Thread-3 (]: 49 of 51 START test unique_key_trips_age_daily_date__age ....................... [RUN]
[0m10:46:42.621026 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be)
[0m10:46:42.622026 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m10:46:42.628032 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m10:46:42.630050 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m10:46:42.632058 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m10:46:42.633031 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m10:46:42.634032 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: BEGIN
[0m10:46:42.634032 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:46:42.976851 [debug] [Thread-1 (]: SQL status: COMMIT in 0.422 seconds
[0m10:46:42.978855 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_start_stat__dbt_backup"
[0m10:46:42.979850 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:46:42.979850 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_start_stat__dbt_backup" cascade
[0m10:46:43.610109 [debug] [Thread-2 (]: SQL status: BEGIN in 2.876 seconds
[0m10:46:43.611107 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:46:43.613111 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
       count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from "dev_3lcu"."dbt"."events_full"
  );
  
[0m10:46:43.624125 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.643 seconds
[0m10:46:43.627131 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: Close
[0m10:46:43.629119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715AFD730>]}
[0m10:46:43.630122 [info ] [Thread-1 (]: 38 of 51 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 49.11s]
[0m10:46:43.632116 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m10:46:43.634121 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m10:46:43.635119 [info ] [Thread-1 (]: 50 of 51 START test unique_trips_age_daily_date_text_age_text .................. [RUN]
[0m10:46:43.638129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e)
[0m10:46:43.639131 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m10:46:43.647140 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m10:46:43.654140 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m10:46:43.659147 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m10:46:43.661152 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m10:46:43.663150 [debug] [Thread-1 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: BEGIN
[0m10:46:43.664147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:46:46.408151 [debug] [Thread-3 (]: SQL status: BEGIN in 3.774 seconds
[0m10:46:46.409142 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m10:46:46.410105 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "date"::text ||
    
        "age"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m10:46:46.709077 [debug] [Thread-1 (]: SQL status: BEGIN in 3.045 seconds
[0m10:46:46.710030 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m10:46:46.711031 [debug] [Thread-1 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date::text || age::text as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."trips_age_daily"
where date::text || age::text is not null
group by date::text || age::text
having count(*) > 1



      
    ) dbt_internal_test
[0m10:46:47.017227 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.607 seconds
[0m10:46:47.019175 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: ROLLBACK
[0m10:46:47.311845 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.601 seconds
[0m10:46:47.313833 [debug] [Thread-1 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: ROLLBACK
[0m10:46:47.408474 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: Close
[0m10:46:47.409475 [info ] [Thread-3 (]: 49 of 51 PASS unique_key_trips_age_daily_date__age ............................. [[32mPASS[0m in 4.79s]
[0m10:46:47.410477 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m10:46:47.711698 [debug] [Thread-1 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: Close
[0m10:46:47.712691 [info ] [Thread-1 (]: 50 of 51 PASS unique_trips_age_daily_date_text_age_text ........................ [[32mPASS[0m in 4.07s]
[0m10:46:47.713691 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m10:46:47.714694 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m10:46:47.715691 [info ] [Thread-3 (]: 51 of 51 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m10:46:47.716694 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be, now model.dbt_scooters.trips_age_daily_stat)
[0m10:46:47.717659 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m10:46:47.720684 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:47.721650 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m10:46:47.724650 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:47.726156 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:47.727165 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m10:46:47.727165 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:46:48.613501 [debug] [Thread-2 (]: SQL status: SELECT 1 in 4.999 seconds
[0m10:46:48.616014 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:46:48.617058 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m10:46:49.009208 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.391 seconds
[0m10:46:49.012207 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:46:49.012207 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m10:46:49.408862 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.396 seconds
[0m10:46:49.411241 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:46:49.412204 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_stat" is $dbt_comment_literal_block$Overall user events statistics$dbt_comment_literal_block$;

  
[0m10:46:49.808054 [debug] [Thread-2 (]: SQL status: COMMENT in 0.396 seconds
[0m10:46:49.809612 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: COMMIT
[0m10:46:49.810614 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:46:49.810614 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: COMMIT
[0m10:46:50.207783 [debug] [Thread-2 (]: SQL status: COMMIT in 0.397 seconds
[0m10:46:50.211295 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."events_stat__dbt_backup"
[0m10:46:50.212297 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:46:50.213296 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_3lcu"."dbt"."events_stat__dbt_backup" cascade
[0m10:46:50.708676 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.495 seconds
[0m10:46:50.710252 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: Close
[0m10:46:50.711288 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7153D63C0>]}
[0m10:46:50.712253 [info ] [Thread-2 (]: 48 of 51 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 10.00s]
[0m10:46:50.713254 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_stat
[0m10:46:50.933846 [debug] [Thread-3 (]: SQL status: BEGIN in 3.206 seconds
[0m10:46:50.934848 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:50.934848 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m10:46:51.794640 [debug] [Thread-3 (]: SQL status: SELECT 83 in 0.859 seconds
[0m10:46:51.797640 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:51.798640 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m10:46:52.245078 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.446 seconds
[0m10:46:52.248078 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:52.248078 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m10:46:52.610065 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.361 seconds
[0m10:46:52.614578 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:52.614578 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily_stat" is $dbt_comment_literal_block$Aggregation of daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m10:46:53.030801 [debug] [Thread-3 (]: SQL status: COMMENT in 0.415 seconds
[0m10:46:53.032794 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m10:46:53.032794 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:53.033767 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m10:46:53.410971 [debug] [Thread-3 (]: SQL status: COMMIT in 0.377 seconds
[0m10:46:53.413512 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup"
[0m10:46:53.414515 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:46:53.414515 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m10:46:53.910921 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.496 seconds
[0m10:46:53.911916 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m10:46:53.913462 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715B37410>]}
[0m10:46:53.914470 [info ] [Thread-3 (]: 51 of 51 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 6.20s]
[0m10:46:53.916015 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m10:46:55.742753 [debug] [Thread-4 (]: SQL status: SELECT 7 in 14.190 seconds
[0m10:46:55.745718 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:46:55.746717 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m10:46:56.093893 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.346 seconds
[0m10:46:56.096894 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:46:56.096894 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m10:46:56.610063 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.512 seconds
[0m10:46:56.611064 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:46:56.612063 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_group" is $dbt_comment_literal_block$Overall trips statistics by user age group$dbt_comment_literal_block$;

  
[0m10:46:57.170098 [debug] [Thread-4 (]: SQL status: COMMENT in 0.558 seconds
[0m10:46:57.172056 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m10:46:57.172056 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:46:57.173056 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m10:46:57.548100 [debug] [Thread-4 (]: SQL status: COMMIT in 0.375 seconds
[0m10:46:57.551056 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_group__dbt_backup"
[0m10:46:57.552057 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:46:57.552057 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_group__dbt_backup" cascade
[0m10:46:58.106660 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.554 seconds
[0m10:46:58.109663 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: Close
[0m10:46:58.110661 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd159cb8a-8159-41d5-91f9-0166b05c3e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715AF5E80>]}
[0m10:46:58.112664 [info ] [Thread-4 (]: 47 of 51 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 19.50s]
[0m10:46:58.113662 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_group
[0m10:46:58.115663 [debug] [MainThread]: Using postgres connection "master"
[0m10:46:58.116706 [debug] [MainThread]: On master: BEGIN
[0m10:46:58.117661 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:47:01.725663 [debug] [MainThread]: SQL status: BEGIN in 3.608 seconds
[0m10:47:01.726669 [debug] [MainThread]: On master: COMMIT
[0m10:47:01.726669 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:01.726669 [debug] [MainThread]: On master: COMMIT
[0m10:47:02.061856 [debug] [MainThread]: SQL status: COMMIT in 0.335 seconds
[0m10:47:02.062843 [info ] [MainThread]: 
[0m10:47:02.063839 [info ] [MainThread]: Running 1 on-run-end hook
[0m10:47:02.065802 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m10:47:02.070826 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m10:47:02.071846 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:02.072810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m10:47:02.413810 [debug] [MainThread]: SQL status: GRANT in 0.341 seconds
[0m10:47:02.415803 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mGRANT[0m in 0.34s]
[0m10:47:02.415803 [info ] [MainThread]: 
[0m10:47:02.416811 [debug] [MainThread]: On master: Close
[0m10:47:02.417801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:02.417801 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m10:47:02.418766 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m10:47:02.418766 [debug] [MainThread]: Connection 'list_dev_3lcu_finance' was properly closed.
[0m10:47:02.419802 [debug] [MainThread]: Connection 'list_dev_3lcu_dbt' was properly closed.
[0m10:47:02.419802 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e' was properly closed.
[0m10:47:02.419802 [debug] [MainThread]: Connection 'model.dbt_scooters.events_stat' was properly closed.
[0m10:47:02.420765 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m10:47:02.420765 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m10:47:02.421767 [info ] [MainThread]: 
[0m10:47:02.421767 [info ] [MainThread]: Finished running 4 seeds, 28 data tests, 12 table models, 4 incremental models, 3 view models, 1 project hook in 0 hours 1 minutes and 58.19 seconds (118.19s).
[0m10:47:02.431349 [debug] [MainThread]: Command end result
[0m10:47:02.471909 [info ] [MainThread]: 
[0m10:47:02.472872 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m10:47:02.472872 [info ] [MainThread]: 
[0m10:47:02.473874 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models\properties.yml)[0m
[0m10:47:02.474871 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m10:47:02.475908 [info ] [MainThread]: 
[0m10:47:02.476911 [info ] [MainThread]:   compiled code at target\compiled\dbt_scooters\models\properties.yml\source_not_null_scooters_raw_users_sex.sql
[0m10:47:02.477875 [info ] [MainThread]: 
[0m10:47:02.478879 [info ] [MainThread]: Done. PASS=50 WARN=1 ERROR=0 SKIP=0 TOTAL=51
[0m10:47:02.479876 [debug] [MainThread]: Command `dbt build` succeeded at 10:47:02.479876 after 119.53 seconds
[0m10:47:02.480877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70FC1D040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7133DC7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7133AEF30>]}
[0m10:47:03.304057 [debug] [MainThread]: Flushing usage events
[0m14:15:48.530176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207056A1AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207083540E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207083556D0>]}


============================== 14:15:48.539364 | 4915162e-9833-4d2b-ad57-4a7a6bc0b251 ==============================
[0m14:15:48.539364 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:15:48.541325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:48.978701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020705EE9C10>]}
[0m14:15:49.091352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070863C440>]}
[0m14:15:49.092864 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:49.483112 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:15:49.874278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:15:49.875329 [debug] [MainThread]: Partial parsing: updated file: dbt_scooters://models\finance\properties.yml
[0m14:15:50.434564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709CC9F10>]}
[0m14:15:50.689397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207089B89B0>]}
[0m14:15:50.690403 [info ] [MainThread]: Found 19 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 437 macros
[0m14:15:50.691400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709C12A50>]}
[0m14:15:50.696433 [info ] [MainThread]: 
[0m14:15:50.697433 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:15:50.705510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m14:15:50.720522 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m14:15:50.892134 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m14:15:50.893142 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m14:15:50.894150 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m14:15:50.895173 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m14:15:50.896166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:50.897159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:53.828124 [debug] [ThreadPool]: SQL status: SELECT 23 in 2.930 seconds
[0m14:15:53.830164 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m14:15:53.998374 [debug] [ThreadPool]: SQL status: SELECT 23 in 3.101 seconds
[0m14:15:54.000415 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m14:15:54.002675 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_dbt'
[0m14:15:54.010261 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m14:15:54.011255 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_finance'
[0m14:15:54.011255 [debug] [ThreadPool]: On list_dev_3lcu_dbt: BEGIN
[0m14:15:54.013611 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m14:15:54.014654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:54.014654 [debug] [ThreadPool]: On list_dev_3lcu_finance: BEGIN
[0m14:15:54.015649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:56.705538 [debug] [ThreadPool]: SQL status: BEGIN in 2.690 seconds
[0m14:15:56.706538 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m14:15:56.706538 [debug] [ThreadPool]: On list_dev_3lcu_finance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_finance"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m14:15:57.045235 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.338 seconds
[0m14:15:57.047277 [debug] [ThreadPool]: On list_dev_3lcu_finance: ROLLBACK
[0m14:15:57.386489 [debug] [ThreadPool]: On list_dev_3lcu_finance: Close
[0m14:15:57.586549 [debug] [ThreadPool]: SQL status: BEGIN in 3.571 seconds
[0m14:15:57.586549 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m14:15:57.587553 [debug] [ThreadPool]: On list_dev_3lcu_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_dbt"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m14:15:57.938623 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.351 seconds
[0m14:15:57.940584 [debug] [ThreadPool]: On list_dev_3lcu_dbt: ROLLBACK
[0m14:15:58.281339 [debug] [ThreadPool]: On list_dev_3lcu_dbt: Close
[0m14:15:58.292447 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:58.293001 [debug] [MainThread]: On master: BEGIN
[0m14:15:58.293001 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:00.995545 [debug] [MainThread]: SQL status: BEGIN in 2.702 seconds
[0m14:16:00.996591 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:00.997590 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:16:01.462434 [debug] [MainThread]: SQL status: SELECT 4 in 0.465 seconds
[0m14:16:01.464538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709D930E0>]}
[0m14:16:01.465539 [debug] [MainThread]: On master: ROLLBACK
[0m14:16:01.800588 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:01.802135 [debug] [MainThread]: On master: BEGIN
[0m14:16:02.472216 [debug] [MainThread]: SQL status: BEGIN in 0.670 seconds
[0m14:16:02.473565 [debug] [MainThread]: On master: COMMIT
[0m14:16:02.474574 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:02.474574 [debug] [MainThread]: On master: COMMIT
[0m14:16:02.809977 [debug] [MainThread]: SQL status: COMMIT in 0.335 seconds
[0m14:16:02.810966 [debug] [MainThread]: On master: Close
[0m14:16:02.810966 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:02.812516 [info ] [MainThread]: 
[0m14:16:02.820570 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m14:16:02.820570 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_clean
[0m14:16:02.820570 [debug] [Thread-3 (]: Began running node model.dbt_scooters.first_name_sex
[0m14:16:02.822116 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_concurrency
[0m14:16:02.822116 [info ] [Thread-1 (]: 1 of 19 START sql table model dbt.companies .................................... [RUN]
[0m14:16:02.823142 [info ] [Thread-2 (]: 2 of 19 START sql incremental model dbt.events_clean ........................... [RUN]
[0m14:16:02.824124 [info ] [Thread-3 (]: 3 of 19 START sql table model dbt.first_name_sex ............................... [RUN]
[0m14:16:02.825125 [info ] [Thread-4 (]: 4 of 19 START sql incremental model dbt.trips_concurrency ...................... [RUN]
[0m14:16:02.826163 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_scooters.companies'
[0m14:16:02.827126 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.events_clean'
[0m14:16:02.828130 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.first_name_sex'
[0m14:16:02.829130 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m14:16:02.829130 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m14:16:02.830124 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_clean
[0m14:16:02.831123 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.first_name_sex
[0m14:16:02.832127 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m14:16:02.841264 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m14:16:02.849397 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m14:16:02.852395 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.first_name_sex"
[0m14:16:02.858516 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m14:16:02.860485 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m14:16:02.861487 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_clean
[0m14:16:02.879549 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.first_name_sex
[0m14:16:02.962086 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m14:16:02.965135 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:02.970135 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.first_name_sex"
[0m14:16:02.970135 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m14:16:02.971100 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp141602934219"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at

from
    "dev_3lcu"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."events_clean")
    

  );
  
  
[0m14:16:02.972616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:16:02.977199 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:02.978198 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:16:02.979198 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:16:02.979198 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m14:16:02.980198 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp141602975198"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_3lcu"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_3lcu"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now()  as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m14:16:02.981201 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: BEGIN
[0m14:16:02.982168 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:16:02.982168 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:16:02.983262 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:16:05.710111 [debug] [Thread-1 (]: SQL status: BEGIN in 2.728 seconds
[0m14:16:05.711067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:16:05.712099 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_3lcu"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
  );
  
[0m14:16:06.159565 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.446 seconds
[0m14:16:06.169119 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:16:06.170124 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies" rename to "companies__dbt_backup"
[0m14:16:06.482469 [debug] [Thread-2 (]: SQL status: SELECT 0 in 3.504 seconds
[0m14:16:06.501081 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:06.501081 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: BEGIN
[0m14:16:06.510745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.341 seconds
[0m14:16:06.517281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:16:06.517281 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies__dbt_tmp" rename to "companies"
[0m14:16:06.647825 [debug] [Thread-3 (]: SQL status: BEGIN in 3.665 seconds
[0m14:16:06.648827 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:16:06.649827 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

  
    

  create  table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp"
  
  
    as
  
  (
    select distinct first_name, sex
from "dev_3lcu"."scooters_raw"."users"
Where sex is not null
  );
  
[0m14:16:06.872445 [debug] [Thread-2 (]: SQL status: BEGIN in 0.371 seconds
[0m14:16:06.873938 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.355 seconds
[0m14:16:06.874935 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:06.909730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:16:06.910735 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp141602934219'
        
      order by ordinal_position

  
[0m14:16:06.910735 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies" is $dbt_comment_literal_block$Scooter statistics by company$dbt_comment_literal_block$;

  
[0m14:16:07.072807 [debug] [Thread-3 (]: SQL status: SELECT 387 in 0.423 seconds
[0m14:16:07.078344 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:16:07.078344 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex" rename to "first_name_sex__dbt_backup"
[0m14:16:07.363379 [debug] [Thread-1 (]: SQL status: COMMENT in 0.451 seconds
[0m14:16:07.365378 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m14:16:07.366375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:16:07.367379 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m14:16:07.460457 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.381 seconds
[0m14:16:07.465495 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:16:07.466495 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp" rename to "first_name_sex"
[0m14:16:07.656455 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.744 seconds
[0m14:16:07.663029 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:07.664570 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:16:07.755361 [debug] [Thread-1 (]: SQL status: COMMIT in 0.388 seconds
[0m14:16:07.762890 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."companies__dbt_backup"
[0m14:16:07.770478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:16:07.770478 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_3lcu"."dbt"."companies__dbt_backup" cascade
[0m14:16:07.852322 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.385 seconds
[0m14:16:07.855699 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:16:07.855699 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

    
  
  comment on table "dev_3lcu"."dbt"."first_name_sex" is $dbt_comment_literal_block$Unique name_sex glossary$dbt_comment_literal_block$;

  
[0m14:16:08.058346 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.393 seconds
[0m14:16:08.074386 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:08.075433 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp141602934219'
        
      order by ordinal_position

  
[0m14:16:08.153122 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.382 seconds
[0m14:16:08.156079 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m14:16:08.158080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020705EE8DD0>]}
[0m14:16:08.159080 [info ] [Thread-1 (]: 1 of 19 OK created sql table model dbt.companies ............................... [[32mSELECT 6[0m in 5.33s]
[0m14:16:08.161079 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m14:16:08.162113 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_geom
[0m14:16:08.162113 [info ] [Thread-1 (]: 5 of 19 START sql view model dbt.trips_geom .................................... [RUN]
[0m14:16:08.163621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.trips_geom)
[0m14:16:08.164623 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_geom
[0m14:16:08.167653 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m14:16:08.169660 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_geom
[0m14:16:08.191390 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m14:16:08.192930 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:16:08.192930 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m14:16:08.192930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:08.254388 [debug] [Thread-3 (]: SQL status: COMMENT in 0.397 seconds
[0m14:16:08.255437 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m14:16:08.256440 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:16:08.257451 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m14:16:08.358443 [debug] [Thread-4 (]: SQL status: SELECT 0 in 5.375 seconds
[0m14:16:08.361444 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:08.362443 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m14:16:08.417277 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.341 seconds
[0m14:16:08.421279 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:08.424292 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:16:08.600562 [debug] [Thread-3 (]: SQL status: COMMIT in 0.343 seconds
[0m14:16:08.603150 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."first_name_sex__dbt_backup"
[0m14:16:08.604150 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:16:08.605150 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
drop table if exists "dev_3lcu"."dbt"."first_name_sex__dbt_backup" cascade
[0m14:16:08.703772 [debug] [Thread-4 (]: SQL status: BEGIN in 0.341 seconds
[0m14:16:08.704774 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:08.705810 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp141602975198'
        
      order by ordinal_position

  
[0m14:16:08.766794 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.342 seconds
[0m14:16:08.779273 [debug] [Thread-2 (]: 
    In "dev_3lcu"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:16:08.802009 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m14:16:08.803023 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:08.804536 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        
            delete from "dev_3lcu"."dbt"."events_clean"
            using "events_clean__dbt_tmp141602934219"
            where (
                
                    "events_clean__dbt_tmp141602934219".user_id = "dev_3lcu"."dbt"."events_clean".user_id
                    and 
                
                    "events_clean__dbt_tmp141602934219".timestamp = "dev_3lcu"."dbt"."events_clean".timestamp
                    and 
                
                    "events_clean__dbt_tmp141602934219".type_id = "dev_3lcu"."dbt"."events_clean".type_id
                    
                
                
            );
        
    

    insert into "dev_3lcu"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp141602934219"
    )
  
[0m14:16:08.949097 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.343 seconds
[0m14:16:08.951097 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: Close
[0m14:16:08.952096 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070A600E00>]}
[0m14:16:08.953235 [info ] [Thread-3 (]: 3 of 19 OK created sql table model dbt.first_name_sex .......................... [[32mSELECT 387[0m in 6.12s]
[0m14:16:08.955272 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.first_name_sex
[0m14:16:08.956264 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_prep
[0m14:16:08.957228 [info ] [Thread-3 (]: 6 of 19 START sql view model dbt.trips_prep .................................... [RUN]
[0m14:16:08.958230 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.first_name_sex, now model.dbt_scooters.trips_prep)
[0m14:16:08.958230 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_prep
[0m14:16:08.964255 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m14:16:08.965264 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_prep
[0m14:16:08.970301 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m14:16:08.972269 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:16:08.972811 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m14:16:08.972811 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:16:09.049397 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.343 seconds
[0m14:16:09.053473 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:09.054505 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:16:09.146443 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.340 seconds
[0m14:16:09.148444 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:09.149442 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_clean" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m14:16:09.394162 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.339 seconds
[0m14:16:09.399157 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:09.399157 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp141602975198'
        
      order by ordinal_position

  
[0m14:16:09.488777 [debug] [Thread-2 (]: SQL status: COMMENT in 0.339 seconds
[0m14:16:09.490781 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m14:16:09.492290 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:16:09.492290 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m14:16:09.739468 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.339 seconds
[0m14:16:09.743023 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:09.744584 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:16:09.832458 [debug] [Thread-2 (]: SQL status: COMMIT in 0.339 seconds
[0m14:16:09.834608 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: Close
[0m14:16:09.835556 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070A6209B0>]}
[0m14:16:09.837559 [info ] [Thread-2 (]: 2 of 19 OK created sql incremental model dbt.events_clean ...................... [[32mINSERT 0 0[0m in 7.01s]
[0m14:16:09.838560 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_clean
[0m14:16:09.839570 [debug] [Thread-2 (]: Began running node model.dbt_scooters.users_full
[0m14:16:09.840558 [info ] [Thread-2 (]: 7 of 19 START sql table model dbt.users_full ................................... [RUN]
[0m14:16:09.842071 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.users_full)
[0m14:16:09.843117 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.users_full
[0m14:16:09.850088 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.users_full"
[0m14:16:09.853255 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.users_full
[0m14:16:09.858242 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.users_full"
[0m14:16:09.860243 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:16:09.862247 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: BEGIN
[0m14:16:09.862759 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:16:10.092216 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.347 seconds
[0m14:16:10.095259 [debug] [Thread-4 (]: 
    In "dev_3lcu"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:16:10.106287 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m14:16:10.108294 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:10.109288 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_3lcu"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp141602975198"
    )


  
[0m14:16:10.447372 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.337 seconds
[0m14:16:10.450378 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:10.451369 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_concurrency" is $dbt_comment_literal_block$Number of simultaneous rides in time$dbt_comment_literal_block$;

  
[0m14:16:10.796212 [debug] [Thread-4 (]: SQL status: COMMENT in 0.344 seconds
[0m14:16:10.801209 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m14:16:10.802733 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:16:10.804252 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m14:16:10.871404 [debug] [Thread-1 (]: SQL status: BEGIN in 2.678 seconds
[0m14:16:10.872918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:16:10.874428 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_3lcu"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m14:16:11.153378 [debug] [Thread-4 (]: SQL status: COMMIT in 0.347 seconds
[0m14:16:11.156410 [debug] [Thread-4 (]: On model.dbt_scooters.trips_concurrency: Close
[0m14:16:11.157406 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070A643080>]}
[0m14:16:11.159406 [info ] [Thread-4 (]: 4 of 19 OK created sql incremental model dbt.trips_concurrency ................. [[32mINSERT 0 0[0m in 8.33s]
[0m14:16:11.160366 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m14:16:11.162367 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_full
[0m14:16:11.162876 [info ] [Thread-4 (]: 8 of 19 START sql view model dbt.events_full ................................... [RUN]
[0m14:16:11.164389 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.events_full)
[0m14:16:11.165408 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_full
[0m14:16:11.171403 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m14:16:11.172911 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_full
[0m14:16:11.181439 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m14:16:11.184463 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:16:11.186483 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: BEGIN
[0m14:16:11.187482 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:16:11.223142 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.348 seconds
[0m14:16:11.298364 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:16:11.299364 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m14:16:11.645462 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.345 seconds
[0m14:16:11.652994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:16:11.654546 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m14:16:11.707374 [debug] [Thread-3 (]: SQL status: BEGIN in 2.735 seconds
[0m14:16:11.709367 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:16:11.709367 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_3lcu"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select
    id,
    user_id,
    scooter_hw_id,
    started_at,
    finished_at,
    start_lat,
    start_lon,
    finish_lat,
    finish_lon,
    distance as distance_m,
    cast(price as decimal(20, 2)) / 100 as price_rub,
    extract(epoch from (finished_at - started_at)) as duration_s,
    finished_at <> started_at and price = 0 as is_free,
    
    date(started_at at time zone 'Europe/Moscow')
 as "date"
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m14:16:11.999336 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.344 seconds
[0m14:16:12.002339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:16:12.002339 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_geom" is $dbt_comment_literal_block$Trips prepared for geometry analysis$dbt_comment_literal_block$;

  
[0m14:16:12.062102 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.351 seconds
[0m14:16:12.066539 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:16:12.067539 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m14:16:12.342155 [debug] [Thread-1 (]: SQL status: COMMENT in 0.338 seconds
[0m14:16:12.345181 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m14:16:12.346184 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:16:12.347213 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m14:16:12.409062 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.341 seconds
[0m14:16:12.414085 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:16:12.415094 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m14:16:12.591341 [debug] [Thread-2 (]: SQL status: BEGIN in 2.728 seconds
[0m14:16:12.592851 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:16:12.592851 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

  
    

  create  table "dev_3lcu"."dbt"."users_full__dbt_tmp"
  
  
    as
  
  (
    select
   u.id, u.first_name ,u.last_name ,u.phone ,
   COALESCE(u.sex, fns.sex, afns.sex) as sex2,
   u.birth_date
from "dev_3lcu"."scooters_raw"."users" u
left join "dev_3lcu"."dbt"."first_name_sex" fns on u.first_name = fns.first_name
left join "dev_3lcu"."dbt"."add_first_name_sex" afns on u.first_name =afns.first_name
  );
  
[0m14:16:12.686461 [debug] [Thread-1 (]: SQL status: COMMIT in 0.339 seconds
[0m14:16:12.691460 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_geom__dbt_backup"
[0m14:16:12.696489 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:16:12.697490 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_3lcu"."dbt"."trips_geom__dbt_backup" cascade
[0m14:16:12.758360 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.343 seconds
[0m14:16:12.761360 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:16:12.762361 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_prep" is $dbt_comment_literal_block$Trips prepared for analysis$dbt_comment_literal_block$;

  
[0m14:16:12.953030 [debug] [Thread-2 (]: SQL status: SELECT 2000 in 0.359 seconds
[0m14:16:12.957624 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:16:12.958624 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full" rename to "users_full__dbt_backup"
[0m14:16:13.040298 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.342 seconds
[0m14:16:13.042870 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: Close
[0m14:16:13.042870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709D57830>]}
[0m14:16:13.044411 [info ] [Thread-1 (]: 5 of 19 OK created sql view model dbt.trips_geom ............................... [[32mCREATE VIEW[0m in 4.88s]
[0m14:16:13.046421 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_geom
[0m14:16:13.047446 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m14:16:13.048445 [info ] [Thread-1 (]: 9 of 19 START sql table model dbt.parking_finish_stat .......................... [RUN]
[0m14:16:13.049420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.parking_finish_stat)
[0m14:16:13.049420 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m14:16:13.055579 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m14:16:13.056606 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m14:16:13.062055 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m14:16:13.064104 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:16:13.065067 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m14:16:13.066103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:13.108276 [debug] [Thread-3 (]: SQL status: COMMENT in 0.345 seconds
[0m14:16:13.110309 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m14:16:13.111311 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:16:13.112309 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m14:16:13.296517 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m14:16:13.300510 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:16:13.302022 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full__dbt_tmp" rename to "users_full"
[0m14:16:13.454088 [debug] [Thread-3 (]: SQL status: COMMIT in 0.342 seconds
[0m14:16:13.458106 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_prep__dbt_backup"
[0m14:16:13.460134 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:16:13.461102 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_3lcu"."dbt"."trips_prep__dbt_backup" cascade
[0m14:16:13.652443 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.351 seconds
[0m14:16:13.656836 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:16:13.657846 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

    
  
  comment on table "dev_3lcu"."dbt"."users_full" is $dbt_comment_literal_block$Users enriched with sex$dbt_comment_literal_block$;

  
[0m14:16:13.823182 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.361 seconds
[0m14:16:13.826177 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: Close
[0m14:16:13.827178 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709C1DD60>]}
[0m14:16:13.829179 [info ] [Thread-3 (]: 6 of 19 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 4.87s]
[0m14:16:13.831179 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_prep
[0m14:16:13.832177 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_start_stat
[0m14:16:13.832686 [info ] [Thread-3 (]: 10 of 19 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m14:16:13.837207 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.parking_start_stat)
[0m14:16:13.838207 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m14:16:13.845254 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m14:16:13.848263 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m14:16:13.858319 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m14:16:13.862319 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:16:13.864351 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m14:16:13.865375 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:16:13.908484 [debug] [Thread-4 (]: SQL status: BEGIN in 2.721 seconds
[0m14:16:13.910481 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:16:13.911997 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_3lcu"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select * from
"dev_3lcu"."dbt"."events_clean" as e
left join "dev_3lcu"."dbt"."event_types" as t
using (type_id)
  );
[0m14:16:14.182918 [debug] [Thread-2 (]: SQL status: COMMENT in 0.523 seconds
[0m14:16:14.187450 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: COMMIT
[0m14:16:14.188450 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:16:14.190449 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: COMMIT
[0m14:16:14.312868 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.398 seconds
[0m14:16:14.324479 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:16:14.326470 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m14:16:14.532361 [debug] [Thread-2 (]: SQL status: COMMIT in 0.341 seconds
[0m14:16:14.538424 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."users_full__dbt_backup"
[0m14:16:14.540421 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:16:14.542421 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
drop table if exists "dev_3lcu"."dbt"."users_full__dbt_backup" cascade
[0m14:16:14.679140 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.350 seconds
[0m14:16:14.686167 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:16:14.687167 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m14:16:14.887135 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.343 seconds
[0m14:16:14.890144 [debug] [Thread-2 (]: On model.dbt_scooters.users_full: Close
[0m14:16:14.891142 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709BFA1E0>]}
[0m14:16:14.892652 [info ] [Thread-2 (]: 7 of 19 OK created sql table model dbt.users_full .............................. [[32mSELECT 2000[0m in 5.05s]
[0m14:16:14.895182 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.users_full
[0m14:16:14.896182 [debug] [Thread-2 (]: Began running node model.dbt_scooters.companies_trips
[0m14:16:14.897191 [info ] [Thread-2 (]: 11 of 19 START sql table model dbt.companies_trips ............................. [RUN]
[0m14:16:14.899187 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.users_full, now model.dbt_scooters.companies_trips)
[0m14:16:14.900182 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.companies_trips
[0m14:16:14.907229 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m14:16:14.909227 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.companies_trips
[0m14:16:14.920833 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m14:16:14.925394 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:14.927387 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m14:16:14.928383 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:16:15.026214 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m14:16:15.030203 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:16:15.031204 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

    
  
  comment on view "dev_3lcu"."dbt"."events_full" is $dbt_comment_literal_block$User events enriched with meaningful types$dbt_comment_literal_block$;

  
[0m14:16:15.370412 [debug] [Thread-4 (]: SQL status: COMMENT in 0.339 seconds
[0m14:16:15.372953 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m14:16:15.372953 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:16:15.374503 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m14:16:15.715484 [debug] [Thread-4 (]: SQL status: COMMIT in 0.340 seconds
[0m14:16:15.719062 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."events_full__dbt_backup"
[0m14:16:15.720063 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:16:15.721060 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_3lcu"."dbt"."events_full__dbt_backup" cascade
[0m14:16:16.062392 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.340 seconds
[0m14:16:16.064405 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: Close
[0m14:16:16.065415 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709AED2E0>]}
[0m14:16:16.067418 [info ] [Thread-4 (]: 8 of 19 OK created sql view model dbt.events_full .............................. [[32mCREATE VIEW[0m in 4.90s]
[0m14:16:16.068418 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_full
[0m14:16:16.069416 [debug] [Thread-4 (]: Began running node model.dbt_scooters.revenue_daily
[0m14:16:16.070415 [info ] [Thread-4 (]: 12 of 19 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m14:16:16.071454 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.revenue_daily)
[0m14:16:16.072452 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m14:16:16.077795 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m14:16:16.078766 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.revenue_daily
[0m14:16:16.084349 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:16.085356 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp141616082339"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_3lcu"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m14:16:16.086359 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:16:16.589210 [debug] [Thread-3 (]: SQL status: BEGIN in 2.724 seconds
[0m14:16:16.590208 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:16:16.590208 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m14:16:16.712964 [debug] [Thread-1 (]: SQL status: BEGIN in 3.648 seconds
[0m14:16:16.714478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:16:16.716497 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m14:16:17.692932 [debug] [Thread-2 (]: SQL status: BEGIN in 2.765 seconds
[0m14:16:17.694441 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:17.694441 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_3lcu"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_3lcu"."dbt"."trips_prep" as t
        join "dev_3lcu"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_3lcu"."dbt"."companies" as c
        using (company)
  );
  
[0m14:16:20.859282 [debug] [Thread-2 (]: SQL status: SELECT 6 in 3.164 seconds
[0m14:16:20.864317 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:20.865329 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m14:16:21.254402 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.389 seconds
[0m14:16:21.260447 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:21.261957 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m14:16:21.655221 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.393 seconds
[0m14:16:21.658215 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:21.658215 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies_trips" is $dbt_comment_literal_block$Trip statistics by company$dbt_comment_literal_block$;

  
[0m14:16:22.060244 [debug] [Thread-2 (]: SQL status: COMMENT in 0.401 seconds
[0m14:16:22.069266 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:22.070266 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'companies_trips'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:16:23.060142 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.989 seconds
[0m14:16:23.064171 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:23.064171 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."companies_trips".company is $dbt_comment_literal_block$Scooters manufacturing company$dbt_comment_literal_block$;
  

  
[0m14:16:23.261160 [debug] [Thread-4 (]: SQL status: SELECT 3 in 7.174 seconds
[0m14:16:23.264179 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:23.265190 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m14:16:23.458469 [debug] [Thread-2 (]: SQL status: COMMENT in 0.393 seconds
[0m14:16:23.460469 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m14:16:23.460469 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:23.461980 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m14:16:23.603142 [debug] [Thread-4 (]: SQL status: BEGIN in 0.337 seconds
[0m14:16:23.604112 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:23.604112 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp141616082339'
        
      order by ordinal_position

  
[0m14:16:23.855297 [debug] [Thread-2 (]: SQL status: COMMIT in 0.393 seconds
[0m14:16:23.858292 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."companies_trips__dbt_backup"
[0m14:16:23.859298 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:16:23.860298 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_3lcu"."dbt"."companies_trips__dbt_backup" cascade
[0m14:16:24.165037 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.560 seconds
[0m14:16:24.171036 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:24.172038 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m14:16:24.261146 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.400 seconds
[0m14:16:24.264622 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: Close
[0m14:16:24.265623 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709D57200>]}
[0m14:16:24.266625 [info ] [Thread-2 (]: 11 of 19 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 9.37s]
[0m14:16:24.268625 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.companies_trips
[0m14:16:24.269624 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat
[0m14:16:24.270622 [info ] [Thread-2 (]: 13 of 19 START sql table model dbt.trips_stat .................................. [RUN]
[0m14:16:24.272133 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_stat)
[0m14:16:24.273144 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat
[0m14:16:24.277149 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m14:16:24.280145 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat
[0m14:16:24.286588 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m14:16:24.289592 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:16:24.290586 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m14:16:24.290586 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:16:24.656479 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.483 seconds
[0m14:16:24.661989 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:24.662997 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp141616082339'
        
      order by ordinal_position

  
[0m14:16:25.158070 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.494 seconds
[0m14:16:25.164087 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:25.166106 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m14:16:25.557236 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.390 seconds
[0m14:16:25.561236 [debug] [Thread-4 (]: 
    In "dev_3lcu"."finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:16:25.562743 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m14:16:25.565263 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:25.566266 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        
            delete from "dev_3lcu"."finance"."revenue_daily"
            using "revenue_daily__dbt_tmp141616082339"
            where (
                
                    "revenue_daily__dbt_tmp141616082339".date = "dev_3lcu"."finance"."revenue_daily".date
                    
                
                
            );
        
    

    insert into "dev_3lcu"."finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp141616082339"
    )
  
[0m14:16:25.953766 [debug] [Thread-4 (]: SQL status: INSERT 0 3 in 0.386 seconds
[0m14:16:25.960733 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:25.962282 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_3lcu".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'finance'
        and table_name = 'revenue_daily'
  
[0m14:16:26.358297 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.395 seconds
[0m14:16:26.360327 [debug] [Thread-4 (]: On "dev_3lcu"."finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m14:16:26.362327 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:26.362327 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  comment on table "dev_3lcu"."finance"."revenue_daily" is $dbt_comment_literal_block$Summary daily revenue$dbt_comment_literal_block$;

  
[0m14:16:26.751958 [debug] [Thread-4 (]: SQL status: COMMENT in 0.388 seconds
[0m14:16:26.756489 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:26.757486 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m14:16:27.252826 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.495 seconds
[0m14:16:27.256351 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:27.257349 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  
    
    
    comment on column "dev_3lcu"."finance"."revenue_daily".revenue_rub is $dbt_comment_literal_block$Daily revenue in rubles$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."finance"."revenue_daily".date is $dbt_comment_literal_block$Unique day$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."finance"."revenue_daily".updated_at is $dbt_comment_literal_block$When row was updated last time$dbt_comment_literal_block$;
  

  
[0m14:16:27.654054 [debug] [Thread-4 (]: SQL status: COMMENT in 0.396 seconds
[0m14:16:27.657048 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m14:16:27.658013 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:16:27.658013 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m14:16:28.055237 [debug] [Thread-4 (]: SQL status: COMMIT in 0.397 seconds
[0m14:16:28.057239 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: Close
[0m14:16:28.058238 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709C1DFD0>]}
[0m14:16:28.060241 [info ] [Thread-4 (]: 12 of 19 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 3[0m in 11.99s]
[0m14:16:28.062246 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.revenue_daily
[0m14:16:28.063285 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m14:16:28.064281 [info ] [Thread-4 (]: 14 of 19 START sql table model dbt.trips_stat_daily ............................ [RUN]
[0m14:16:28.066292 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_stat_daily)
[0m14:16:28.067292 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m14:16:28.075398 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m14:16:28.077398 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m14:16:28.084568 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m14:16:28.086598 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:28.087564 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m14:16:28.088564 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:16:28.832002 [debug] [Thread-2 (]: SQL status: BEGIN in 4.541 seconds
[0m14:16:28.834016 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:16:28.835011 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count(*) as trips,
    count(distinct user_id) as users,
    avg(duration_s) / 60 as avg_duration_min,
    sum(distance_m) / 1000 as sum_distance_km,
    sum(price_rub) as revenue_rub,
    count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from
    "dev_3lcu"."dbt"."trips_prep"
  );
  
[0m14:16:31.053318 [debug] [Thread-4 (]: SQL status: BEGIN in 2.966 seconds
[0m14:16:31.054316 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:31.055313 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    count(*) as trips,
    max(price_rub) as max_price_rub,
    avg(distance_m) / 1000 as avg_distance_km,
    avg(price_rub)/avg(duration_s) * 60 as avg_price_rub_per_min
from
    "dev_3lcu"."dbt"."trips_prep"
group by
    1
order by
    1
  );
  
[0m14:16:36.972098 [debug] [Thread-2 (]: SQL status: SELECT 1 in 8.137 seconds
[0m14:16:36.977332 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:16:36.978332 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m14:16:37.355226 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.376 seconds
[0m14:16:37.359225 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:16:37.359225 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m14:16:37.769008 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.409 seconds
[0m14:16:37.771988 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:16:37.773185 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat" is $dbt_comment_literal_block$Overall trips statistics$dbt_comment_literal_block$;

  
[0m14:16:38.234828 [debug] [Thread-2 (]: SQL status: COMMENT in 0.461 seconds
[0m14:16:38.236820 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m14:16:38.237819 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:16:38.238822 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m14:16:38.698986 [debug] [Thread-2 (]: SQL status: COMMIT in 0.460 seconds
[0m14:16:38.702497 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat__dbt_backup"
[0m14:16:38.704008 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:16:38.706021 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat__dbt_backup" cascade
[0m14:16:39.139303 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.432 seconds
[0m14:16:39.141327 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: Close
[0m14:16:39.142816 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207084B64B0>]}
[0m14:16:39.144328 [info ] [Thread-2 (]: 13 of 19 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 14.87s]
[0m14:16:39.146354 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat
[0m14:16:39.147337 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_users
[0m14:16:39.148337 [info ] [Thread-2 (]: 15 of 19 START sql incremental model dbt.trips_users ........................... [RUN]
[0m14:16:39.149343 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_users)
[0m14:16:39.151344 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_users
[0m14:16:39.159747 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m14:16:39.162256 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_users
[0m14:16:39.168305 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:39.170272 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp141639166275"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep" as t
left join
    "dev_3lcu"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_3lcu"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m14:16:39.171266 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:16:41.662862 [debug] [Thread-4 (]: SQL status: SELECT 91 in 10.607 seconds
[0m14:16:41.669391 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:41.671387 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m14:16:42.270375 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.599 seconds
[0m14:16:42.274737 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:42.275739 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m14:16:43.064338 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.788 seconds
[0m14:16:43.080389 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:43.081390 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    create  index if not exists
  "192c5b6405cbedd795703442d77858af"
  on "dev_3lcu"."dbt"."trips_stat_daily" 
  (date)
  
[0m14:16:43.555300 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.473 seconds
[0m14:16:43.557304 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:43.558303 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat_daily" is $dbt_comment_literal_block$Overall trips statistics per day$dbt_comment_literal_block$;

  
[0m14:16:43.952395 [debug] [Thread-4 (]: SQL status: COMMENT in 0.393 seconds
[0m14:16:43.956425 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:43.957423 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_stat_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:16:44.754031 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.796 seconds
[0m14:16:44.756041 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:44.757039 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."trips_stat_daily".date is $dbt_comment_literal_block$Trips date$dbt_comment_literal_block$;
  

  
[0m14:16:45.060227 [debug] [Thread-2 (]: SQL status: SELECT 0 in 5.889 seconds
[0m14:16:45.065418 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:45.066430 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: BEGIN
[0m14:16:45.160514 [debug] [Thread-4 (]: SQL status: COMMENT in 0.403 seconds
[0m14:16:45.163059 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m14:16:45.163059 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:45.164072 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m14:16:45.451944 [debug] [Thread-2 (]: SQL status: BEGIN in 0.385 seconds
[0m14:16:45.452952 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:45.452952 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp141639166275'
        
      order by ordinal_position

  
[0m14:16:45.552925 [debug] [Thread-4 (]: SQL status: COMMIT in 0.389 seconds
[0m14:16:45.556521 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup"
[0m14:16:45.557523 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:16:45.558482 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m14:16:45.971988 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.413 seconds
[0m14:16:45.974086 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m14:16:45.975134 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070A19E3C0>]}
[0m14:16:45.975134 [info ] [Thread-4 (]: 14 of 19 OK created sql table model dbt.trips_stat_daily ....................... [[32mSELECT 91[0m in 17.91s]
[0m14:16:45.977135 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m14:16:45.978105 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_stat
[0m14:16:45.979096 [info ] [Thread-4 (]: 16 of 19 START sql table model dbt.events_stat ................................. [RUN]
[0m14:16:45.980093 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.events_stat)
[0m14:16:45.980093 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_stat
[0m14:16:45.982676 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m14:16:45.984219 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_stat
[0m14:16:45.988267 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m14:16:45.989227 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:16:45.990258 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: BEGIN
[0m14:16:45.990258 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:16:46.457316 [debug] [Thread-2 (]: SQL status: SELECT 17 in 1.004 seconds
[0m14:16:46.461317 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:46.461317 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:16:47.065138 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.603 seconds
[0m14:16:47.069137 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:47.070136 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp141639166275'
        
      order by ordinal_position

  
[0m14:16:47.502150 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.431 seconds
[0m14:16:47.506175 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:47.506175 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:16:48.062077 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.556 seconds
[0m14:16:48.069506 [debug] [Thread-2 (]: 
    In "dev_3lcu"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:16:48.072088 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m14:16:48.074102 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:48.075130 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_3lcu"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp141639166275"
    )


  
[0m14:16:48.456019 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.380 seconds
[0m14:16:48.459019 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:48.459019 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_users" is $dbt_comment_literal_block$Prepared trips enriched with users data$dbt_comment_literal_block$;

  
[0m14:16:48.952003 [debug] [Thread-2 (]: SQL status: COMMENT in 0.492 seconds
[0m14:16:48.954257 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:48.955260 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m14:16:49.352476 [debug] [Thread-4 (]: SQL status: BEGIN in 3.362 seconds
[0m14:16:49.353989 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:16:49.355004 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
       count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from "dev_3lcu"."dbt"."events_full"
  );
  
[0m14:16:54.654095 [debug] [Thread-3 (]: SQL status: SELECT 142 in 38.063 seconds
[0m14:16:54.657144 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:16:54.658146 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m14:16:55.054130 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.395 seconds
[0m14:16:55.057169 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:16:55.058173 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m14:16:55.456017 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.397 seconds
[0m14:16:55.458049 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:16:55.458049 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_start_stat" is $dbt_comment_literal_block$Trip start parking statistics by 500 m hexagons$dbt_comment_literal_block$;

  
[0m14:16:55.757201 [debug] [Thread-4 (]: SQL status: SELECT 1 in 6.401 seconds
[0m14:16:55.760209 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:16:55.761209 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m14:16:55.805465 [debug] [Thread-3 (]: SQL status: COMMENT in 0.347 seconds
[0m14:16:55.807461 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m14:16:55.807461 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:16:55.808459 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m14:16:56.100272 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m14:16:56.102823 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:16:56.104369 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m14:16:56.151068 [debug] [Thread-3 (]: SQL status: COMMIT in 0.342 seconds
[0m14:16:56.155281 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_start_stat__dbt_backup"
[0m14:16:56.156282 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:16:56.157283 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_start_stat__dbt_backup" cascade
[0m14:16:56.453324 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.349 seconds
[0m14:16:56.456363 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:16:56.456363 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_stat" is $dbt_comment_literal_block$Overall user events statistics$dbt_comment_literal_block$;

  
[0m14:16:56.653151 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.495 seconds
[0m14:16:56.655158 [debug] [Thread-3 (]: On model.dbt_scooters.parking_start_stat: Close
[0m14:16:56.656159 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070A623650>]}
[0m14:16:56.657164 [debug] [Thread-2 (]: SQL status: ANALYZE in 7.700 seconds
[0m14:16:56.659164 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m14:16:56.657164 [info ] [Thread-3 (]: 10 of 19 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 42.82s]
[0m14:16:56.659164 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:56.660194 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m14:16:56.661197 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m14:16:56.797287 [debug] [Thread-4 (]: SQL status: COMMENT in 0.340 seconds
[0m14:16:56.799267 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m14:16:56.799267 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:16:56.800267 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m14:16:57.050955 [debug] [Thread-2 (]: SQL status: COMMIT in 0.390 seconds
[0m14:16:57.052401 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:57.053411 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m14:16:57.157303 [debug] [Thread-4 (]: SQL status: COMMIT in 0.356 seconds
[0m14:16:57.160344 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."events_stat__dbt_backup"
[0m14:16:57.160344 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:16:57.161341 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_3lcu"."dbt"."events_stat__dbt_backup" cascade
[0m14:16:57.452284 [debug] [Thread-2 (]: SQL status: COMMIT in 0.399 seconds
[0m14:16:57.454332 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:16:57.454332 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m14:16:57.551612 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.390 seconds
[0m14:16:57.553166 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: Close
[0m14:16:57.554208 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020708673C50>]}
[0m14:16:57.555210 [info ] [Thread-4 (]: 16 of 19 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 11.58s]
[0m14:16:57.556210 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_stat
[0m14:16:57.792802 [debug] [Thread-2 (]: SQL status: VACUUM in 0.337 seconds
[0m14:16:57.794350 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: Close
[0m14:16:57.795402 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709C0BF50>]}
[0m14:16:57.796401 [info ] [Thread-2 (]: 15 of 19 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 18.65s]
[0m14:16:57.797401 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_users
[0m14:16:57.799363 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m14:16:57.799363 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_group
[0m14:16:57.800398 [info ] [Thread-3 (]: 17 of 19 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m14:16:57.801908 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now model.dbt_scooters.trips_age_daily)
[0m14:16:57.800398 [info ] [Thread-4 (]: 18 of 19 START sql table model dbt.trips_age_group ............................. [RUN]
[0m14:16:57.802923 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m14:16:57.803960 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now model.dbt_scooters.trips_age_group)
[0m14:16:57.806948 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m14:16:57.806948 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m14:16:57.809952 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m14:16:57.810953 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m14:16:57.815161 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m14:16:57.816161 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_age_group
[0m14:16:57.820161 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m14:16:57.821127 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:16:57.821127 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m14:16:57.822126 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:16:57.822126 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:16:57.823465 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m14:16:57.824464 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:17:00.052040 [debug] [Thread-1 (]: SQL status: SELECT 464 in 43.335 seconds
[0m14:17:00.056709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:17:00.056709 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m14:17:00.404171 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.347 seconds
[0m14:17:00.408180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:17:00.409182 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m14:17:00.730215 [debug] [Thread-3 (]: SQL status: BEGIN in 2.908 seconds
[0m14:17:00.731214 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:17:00.732215 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    Select "date",
       age,
       count(*) as trips,
       sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m14:17:00.755390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.345 seconds
[0m14:17:00.758391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:17:00.759394 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_finish_stat" is $dbt_comment_literal_block$Trip finish parking statistics by 10 m hexagons$dbt_comment_literal_block$;

  
[0m14:17:00.891895 [debug] [Thread-4 (]: SQL status: BEGIN in 3.068 seconds
[0m14:17:00.892944 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:17:00.892944 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users" as tu
    cross join "dev_3lcu"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m14:17:01.102881 [debug] [Thread-1 (]: SQL status: COMMENT in 0.344 seconds
[0m14:17:01.106396 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m14:17:01.106396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:17:01.107398 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m14:17:01.455208 [debug] [Thread-1 (]: SQL status: COMMIT in 0.347 seconds
[0m14:17:01.458159 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup"
[0m14:17:01.459159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:17:01.459159 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m14:17:01.855079 [debug] [Thread-3 (]: SQL status: SELECT 7049 in 1.123 seconds
[0m14:17:01.859085 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:17:01.860088 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.400 seconds
[0m14:17:01.860088 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m14:17:01.862596 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m14:17:01.864107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709C051F0>]}
[0m14:17:01.864107 [info ] [Thread-1 (]: 9 of 19 OK created sql table model dbt.parking_finish_stat ..................... [[32mSELECT 464[0m in 48.81s]
[0m14:17:01.866117 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m14:17:02.251906 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.389 seconds
[0m14:17:02.254930 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:17:02.256437 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m14:17:02.652701 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.396 seconds
[0m14:17:02.656723 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:17:02.656723 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily" is $dbt_comment_literal_block$Daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m14:17:03.052787 [debug] [Thread-3 (]: SQL status: COMMENT in 0.396 seconds
[0m14:17:03.055385 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m14:17:03.055385 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:17:03.055385 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m14:17:03.552529 [debug] [Thread-3 (]: SQL status: COMMIT in 0.496 seconds
[0m14:17:03.555042 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily__dbt_backup"
[0m14:17:03.556042 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:17:03.556042 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily__dbt_backup" cascade
[0m14:17:04.054022 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.497 seconds
[0m14:17:04.056075 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m14:17:04.056075 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070A58BD10>]}
[0m14:17:04.057629 [info ] [Thread-3 (]: 17 of 19 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 6.25s]
[0m14:17:04.058636 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m14:17:04.059679 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m14:17:04.060636 [info ] [Thread-2 (]: 19 of 19 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m14:17:04.060636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_daily_stat)
[0m14:17:04.062192 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m14:17:04.065243 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:04.067246 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m14:17:04.071252 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:04.072793 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:04.072793 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m14:17:04.074339 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:17:08.450470 [debug] [Thread-2 (]: SQL status: BEGIN in 4.377 seconds
[0m14:17:08.451976 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:08.451976 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m14:17:09.162166 [debug] [Thread-2 (]: SQL status: SELECT 83 in 0.709 seconds
[0m14:17:09.166188 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:09.166188 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m14:17:09.551844 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.384 seconds
[0m14:17:09.554894 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:09.555891 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m14:17:09.955991 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.400 seconds
[0m14:17:09.957988 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:09.958990 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily_stat" is $dbt_comment_literal_block$Aggregation of daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m14:17:10.372720 [debug] [Thread-2 (]: SQL status: COMMENT in 0.414 seconds
[0m14:17:10.374267 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m14:17:10.375317 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:10.375317 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m14:17:10.770114 [debug] [Thread-2 (]: SQL status: COMMIT in 0.394 seconds
[0m14:17:10.772659 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup"
[0m14:17:10.774212 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:17:10.774212 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m14:17:11.180282 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.406 seconds
[0m14:17:11.182878 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m14:17:11.183877 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709C13EF0>]}
[0m14:17:11.184887 [info ] [Thread-2 (]: 19 of 19 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 7.12s]
[0m14:17:11.185837 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m14:17:13.362991 [debug] [Thread-4 (]: SQL status: SELECT 7 in 12.469 seconds
[0m14:17:13.366990 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:17:13.366990 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m14:17:13.702539 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.335 seconds
[0m14:17:13.706137 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:17:13.707134 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m14:17:14.041028 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.334 seconds
[0m14:17:14.043479 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:17:14.044478 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_group" is $dbt_comment_literal_block$Overall trips statistics by user age group$dbt_comment_literal_block$;

  
[0m14:17:14.413011 [debug] [Thread-4 (]: SQL status: COMMENT in 0.367 seconds
[0m14:17:14.415052 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m14:17:14.415052 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:17:14.416063 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m14:17:14.900946 [debug] [Thread-4 (]: SQL status: COMMIT in 0.485 seconds
[0m14:17:14.904357 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_group__dbt_backup"
[0m14:17:14.905361 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:17:14.905361 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_group__dbt_backup" cascade
[0m14:17:15.259970 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.354 seconds
[0m14:17:15.262474 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: Close
[0m14:17:15.263989 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4915162e-9833-4d2b-ad57-4a7a6bc0b251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070A678050>]}
[0m14:17:15.263989 [info ] [Thread-4 (]: 18 of 19 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 17.46s]
[0m14:17:15.266035 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_group
[0m14:17:15.267998 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:15.269001 [debug] [MainThread]: On master: BEGIN
[0m14:17:15.269001 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:17.979312 [debug] [MainThread]: SQL status: BEGIN in 2.710 seconds
[0m14:17:17.980305 [debug] [MainThread]: On master: COMMIT
[0m14:17:17.980305 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:17.980305 [debug] [MainThread]: On master: COMMIT
[0m14:17:18.319300 [debug] [MainThread]: SQL status: COMMIT in 0.338 seconds
[0m14:17:18.319300 [info ] [MainThread]: 
[0m14:17:18.320300 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:17:18.322898 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m14:17:18.327899 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m14:17:18.328898 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:18.328898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m14:17:18.669207 [debug] [MainThread]: SQL status: GRANT in 0.339 seconds
[0m14:17:18.670208 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mGRANT[0m in 0.34s]
[0m14:17:18.671207 [info ] [MainThread]: 
[0m14:17:18.672213 [debug] [MainThread]: On master: Close
[0m14:17:18.673324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:18.673324 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m14:17:18.674357 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m14:17:18.674357 [debug] [MainThread]: Connection 'list_dev_3lcu_dbt' was properly closed.
[0m14:17:18.674357 [debug] [MainThread]: Connection 'list_dev_3lcu_finance' was properly closed.
[0m14:17:18.675356 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_finish_stat' was properly closed.
[0m14:17:18.675356 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m14:17:18.676356 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily' was properly closed.
[0m14:17:18.676356 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m14:17:18.677361 [info ] [MainThread]: 
[0m14:17:18.677361 [info ] [MainThread]: Finished running 12 table models, 4 incremental models, 3 view models, 1 project hook in 0 hours 1 minutes and 27.98 seconds (87.98s).
[0m14:17:18.681868 [debug] [MainThread]: Command end result
[0m14:17:18.726143 [info ] [MainThread]: 
[0m14:17:18.727148 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:18.728150 [info ] [MainThread]: 
[0m14:17:18.729146 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m14:17:18.731148 [debug] [MainThread]: Command `dbt run` succeeded at 14:17:18.731148 after 90.61 seconds
[0m14:17:18.732145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020707492A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020709BA0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207089F2600>]}
[0m14:17:18.732651 [debug] [MainThread]: Flushing usage events
[0m14:20:10.288769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679784FDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016799F52150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016799F52690>]}


============================== 14:20:10.294301 | f115af9c-ca1f-4367-8a7f-d393f2642d22 ==============================
[0m14:20:10.294301 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:20:10.295301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:20:10.606624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679A90A7B0>]}
[0m14:20:10.691359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016799949DC0>]}
[0m14:20:10.693779 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:20:11.035665 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:20:11.378176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:20:11.379141 [debug] [MainThread]: Partial parsing: updated file: dbt_scooters://models\finance\properties.yml
[0m14:20:11.980659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679C077080>]}
[0m14:20:12.270273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679C2098E0>]}
[0m14:20:12.271274 [info ] [MainThread]: Found 19 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 437 macros
[0m14:20:12.279753 [info ] [MainThread]: 
[0m14:20:12.281264 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:20:12.291626 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m14:20:12.301789 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m14:20:12.442650 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m14:20:12.443832 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m14:20:12.444865 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m14:20:12.445827 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m14:20:12.446843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:12.446843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:16.075357 [debug] [ThreadPool]: SQL status: SELECT 23 in 3.629 seconds
[0m14:20:16.077359 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m14:20:16.096411 [debug] [ThreadPool]: SQL status: SELECT 23 in 3.649 seconds
[0m14:20:16.098412 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m14:20:16.101922 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_finance'
[0m14:20:16.108442 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m14:20:16.109444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_dbt'
[0m14:20:16.109444 [debug] [ThreadPool]: On list_dev_3lcu_finance: BEGIN
[0m14:20:16.111953 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m14:20:16.111953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:16.113463 [debug] [ThreadPool]: On list_dev_3lcu_dbt: BEGIN
[0m14:20:16.114471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:19.011972 [debug] [ThreadPool]: SQL status: BEGIN in 2.898 seconds
[0m14:20:19.013488 [debug] [ThreadPool]: SQL status: BEGIN in 2.900 seconds
[0m14:20:19.013488 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m14:20:19.014501 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m14:20:19.014501 [debug] [ThreadPool]: On list_dev_3lcu_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_dbt"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m14:20:19.015501 [debug] [ThreadPool]: On list_dev_3lcu_finance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_finance"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m14:20:19.388722 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.372 seconds
[0m14:20:19.388722 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.372 seconds
[0m14:20:19.390727 [debug] [ThreadPool]: On list_dev_3lcu_finance: ROLLBACK
[0m14:20:19.392611 [debug] [ThreadPool]: On list_dev_3lcu_dbt: ROLLBACK
[0m14:20:19.798649 [debug] [ThreadPool]: On list_dev_3lcu_finance: Close
[0m14:20:19.798649 [debug] [ThreadPool]: On list_dev_3lcu_dbt: Close
[0m14:20:19.810365 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:19.810365 [debug] [MainThread]: On master: BEGIN
[0m14:20:19.811362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:23.666289 [debug] [MainThread]: SQL status: BEGIN in 3.855 seconds
[0m14:20:23.667288 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:23.668287 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:20:24.213320 [debug] [MainThread]: SQL status: SELECT 4 in 0.544 seconds
[0m14:20:24.218515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679AA87710>]}
[0m14:20:24.219506 [debug] [MainThread]: On master: ROLLBACK
[0m14:20:24.555881 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:24.556893 [debug] [MainThread]: On master: BEGIN
[0m14:20:25.230595 [debug] [MainThread]: SQL status: BEGIN in 0.672 seconds
[0m14:20:25.231593 [debug] [MainThread]: On master: COMMIT
[0m14:20:25.232099 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:25.232099 [debug] [MainThread]: On master: COMMIT
[0m14:20:25.636715 [debug] [MainThread]: SQL status: COMMIT in 0.404 seconds
[0m14:20:25.637716 [debug] [MainThread]: On master: Close
[0m14:20:25.638712 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:20:25.639714 [info ] [MainThread]: 
[0m14:20:25.646253 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.add_first_name_sex
[0m14:20:25.646253 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m14:20:25.647248 [debug] [Thread-3 (]: Began running node seed.dbt_scooters.event_types
[0m14:20:25.648253 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.scooters
[0m14:20:25.648253 [info ] [Thread-1 (]: 1 of 51 START seed file dbt.add_first_name_sex ................................. [RUN]
[0m14:20:25.650260 [info ] [Thread-2 (]: 2 of 51 START seed file dbt.age_groups ......................................... [RUN]
[0m14:20:25.651770 [info ] [Thread-3 (]: 3 of 51 START seed file dbt.event_types ........................................ [RUN]
[0m14:20:25.653278 [info ] [Thread-4 (]: 4 of 51 START seed file dbt.scooters ........................................... [RUN]
[0m14:20:25.654294 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.dbt_scooters.add_first_name_sex'
[0m14:20:25.654294 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.dbt_scooters.age_groups'
[0m14:20:25.655287 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.dbt_scooters.event_types'
[0m14:20:25.656797 [debug] [Thread-4 (]: Acquiring new postgres connection 'seed.dbt_scooters.scooters'
[0m14:20:25.656797 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.add_first_name_sex
[0m14:20:25.657803 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m14:20:25.658807 [debug] [Thread-3 (]: Began compiling node seed.dbt_scooters.event_types
[0m14:20:25.658807 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.scooters
[0m14:20:25.659807 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.add_first_name_sex
[0m14:20:25.659807 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m14:20:25.661318 [debug] [Thread-3 (]: Began executing node seed.dbt_scooters.event_types
[0m14:20:25.662330 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.scooters
[0m14:20:25.704471 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m14:20:25.710467 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m14:20:25.720494 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m14:20:25.725516 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m14:20:25.726521 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: BEGIN
[0m14:20:25.727519 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m14:20:25.727519 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: BEGIN
[0m14:20:25.728520 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: BEGIN
[0m14:20:25.729519 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:20:25.730518 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:20:25.730518 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:20:25.732024 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:20:28.545314 [debug] [Thread-4 (]: SQL status: BEGIN in 2.814 seconds
[0m14:20:28.546317 [debug] [Thread-1 (]: SQL status: BEGIN in 2.816 seconds
[0m14:20:28.546317 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m14:20:28.547315 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m14:20:28.547315 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_3lcu"."dbt"."scooters"
[0m14:20:28.548314 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */
truncate table "dev_3lcu"."dbt"."add_first_name_sex"
[0m14:20:29.035423 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.486 seconds
[0m14:20:29.036425 [debug] [Thread-4 (]: SQL status: TRUNCATE TABLE in 0.487 seconds
[0m14:20:29.054468 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m14:20:29.058464 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m14:20:29.059468 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: 
          insert into "dev_3lcu"."dbt"."add_first_name_sex" ("first_name", "sex") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m14:20:29.059468 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_3lcu"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m14:20:29.531912 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.472 seconds
[0m14:20:29.531912 [debug] [Thread-4 (]: SQL status: INSERT 0 10 in 0.472 seconds
[0m14:20:29.539428 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.add_first_name_sex"
[0m14:20:29.540429 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m14:20:29.566012 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m14:20:29.568013 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m14:20:29.569009 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  comment on table "dev_3lcu"."dbt"."scooters" is $dbt_comment_literal_block$Scooter models information and park statistics by model. Includes information about the manufacturing company. Data received from the service team and uploaded by Mark. Data is current as of summer 2023.
$dbt_comment_literal_block$;

  
[0m14:20:29.569009 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  comment on table "dev_3lcu"."dbt"."add_first_name_sex" is $dbt_comment_literal_block$additional name_sex glossary$dbt_comment_literal_block$;

  
[0m14:20:29.788471 [debug] [Thread-2 (]: SQL status: BEGIN in 4.059 seconds
[0m14:20:29.789472 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m14:20:29.790478 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_3lcu"."dbt"."age_groups"
[0m14:20:30.040492 [debug] [Thread-1 (]: SQL status: COMMENT in 0.470 seconds
[0m14:20:30.040492 [debug] [Thread-4 (]: SQL status: COMMENT in 0.471 seconds
[0m14:20:30.041489 [debug] [Thread-3 (]: SQL status: BEGIN in 4.310 seconds
[0m14:20:30.065053 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m14:20:30.069057 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m14:20:30.070059 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m14:20:30.070059 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'add_first_name_sex'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:20:30.070059 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'scooters'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:20:30.071565 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_3lcu"."dbt"."event_types"
[0m14:20:30.345652 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.555 seconds
[0m14:20:30.349648 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m14:20:30.349648 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_3lcu"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m14:20:30.448462 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.376 seconds
[0m14:20:30.454488 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m14:20:30.454488 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".company is $dbt_comment_literal_block$Scooter company model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".model is $dbt_comment_literal_block$Scooter model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".hardware_id is $dbt_comment_literal_block$scooter model id$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".scooters is $dbt_comment_literal_block$Count of scooters$dbt_comment_literal_block$;
  

  
[0m14:20:30.480533 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.408 seconds
[0m14:20:30.482046 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m14:20:30.483556 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.410 seconds
[0m14:20:30.483556 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."add_first_name_sex".first_name is $dbt_comment_literal_block$First name of user$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."add_first_name_sex".sex is $dbt_comment_literal_block$user gender$dbt_comment_literal_block$;
  

  
[0m14:20:30.487563 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m14:20:30.488563 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_3lcu"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m14:20:30.739600 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.389 seconds
[0m14:20:30.740600 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m14:20:30.743615 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m14:20:30.743615 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  comment on table "dev_3lcu"."dbt"."age_groups" is $dbt_comment_literal_block$Age groups to split users for analysis$dbt_comment_literal_block$;

  
[0m14:20:30.789282 [debug] [Thread-4 (]: SQL status: COMMENT in 0.334 seconds
[0m14:20:30.791789 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m14:20:30.791789 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m14:20:30.791789 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m14:20:30.824358 [debug] [Thread-1 (]: SQL status: COMMENT in 0.336 seconds
[0m14:20:30.826360 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m14:20:30.827359 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m14:20:30.827359 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m14:20:30.831363 [debug] [Thread-3 (]: SQL status: INSERT 0 4 in 0.342 seconds
[0m14:20:30.831867 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m14:20:30.834383 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m14:20:30.835381 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  comment on table "dev_3lcu"."dbt"."event_types" is $dbt_comment_literal_block$Table provides a mapping between unique event type identifiers (`type_id`) and their descriptive names (`type`). It is essential for converting numerical codes from user activity logs into readable descriptions for analysis of user interactions with application features.

The table is crucial for analytics and reporting, allowing for the decoding of event identifiers in user activity datasets. By joining with event logs, it facilitates intuitive reporting and dashboarding of user interactions. The mapping enables effective segmentation and analysis of user activities, such as:

- **start_search**: Represents the initiation of a search process by a user.
- **book_scooter**: Indicates that a user has booked a scooter.
- **release_scooter**: Signifies that a user has released a previously booked scooter.
- **cancel_search**: Denotes the cancellation of a search process by a user.$dbt_comment_literal_block$;

  
[0m14:20:31.080419 [debug] [Thread-2 (]: SQL status: COMMENT in 0.336 seconds
[0m14:20:31.084445 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m14:20:31.084445 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'age_groups'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:20:31.131527 [debug] [Thread-4 (]: SQL status: COMMIT in 0.338 seconds
[0m14:20:31.133539 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: Close
[0m14:20:31.135550 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016799FC2090>]}
[0m14:20:31.136546 [info ] [Thread-4 (]: 4 of 51 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 5.48s]
[0m14:20:31.137546 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.scooters
[0m14:20:31.138552 [debug] [Thread-4 (]: Began running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m14:20:31.139550 [info ] [Thread-4 (]: 5 of 51 START test every_event_has_user ........................................ [RUN]
[0m14:20:31.140552 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now test.dbt_scooters.every_event_has_user.7eea25f36c)
[0m14:20:31.140552 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m14:20:31.158598 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m14:20:31.160600 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m14:20:31.179666 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m14:20:31.179666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.353 seconds
[0m14:20:31.181176 [debug] [Thread-3 (]: SQL status: COMMENT in 0.345 seconds
[0m14:20:31.182186 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: Close
[0m14:20:31.186191 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m14:20:31.187193 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m14:20:31.187193 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'event_types'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:20:31.188193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679AD88680>]}
[0m14:20:31.189192 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: BEGIN
[0m14:20:31.190192 [info ] [Thread-1 (]: 1 of 51 OK loaded seed file dbt.add_first_name_sex ............................. [[32mINSERT 5[0m in 5.53s]
[0m14:20:31.191199 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:31.191704 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.add_first_name_sex
[0m14:20:31.193216 [debug] [Thread-1 (]: Began running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m14:20:31.194231 [info ] [Thread-1 (]: 6 of 51 START test every_trip_has_user ......................................... [RUN]
[0m14:20:31.196235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.add_first_name_sex, now test.dbt_scooters.every_trip_has_user.6bc71135e2)
[0m14:20:31.196235 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m14:20:31.201730 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m14:20:31.203236 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m14:20:31.206252 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m14:20:31.207249 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m14:20:31.208249 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: BEGIN
[0m14:20:31.209244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:31.444251 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.359 seconds
[0m14:20:31.446253 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m14:20:31.447249 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".group is $dbt_comment_literal_block$Age group name for report$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".age_start is $dbt_comment_literal_block$Start age of group$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".age_end is $dbt_comment_literal_block$End age of group$dbt_comment_literal_block$;
  

  
[0m14:20:31.558460 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.369 seconds
[0m14:20:31.561464 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m14:20:31.561971 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."event_types".type_id is $dbt_comment_literal_block$An integer serving as a unique identifier for each event type. It is used in user event tables as a foreign key to link events to their descriptions
$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."event_types".type is $dbt_comment_literal_block$A string describing the event type, enhancing the interpretability of event data by providing a human-readable label
$dbt_comment_literal_block$;
  

  
[0m14:20:31.784477 [debug] [Thread-2 (]: SQL status: COMMENT in 0.337 seconds
[0m14:20:31.786481 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m14:20:31.787481 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m14:20:31.787481 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m14:20:31.921753 [debug] [Thread-3 (]: SQL status: COMMENT in 0.359 seconds
[0m14:20:31.923259 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m14:20:31.924267 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m14:20:31.924267 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m14:20:32.188293 [debug] [Thread-2 (]: SQL status: COMMIT in 0.400 seconds
[0m14:20:32.189304 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m14:20:32.191300 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CD748C0>]}
[0m14:20:32.191810 [info ] [Thread-2 (]: 2 of 51 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 6.54s]
[0m14:20:32.193318 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m14:20:32.194326 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m14:20:32.194326 [info ] [Thread-2 (]: 7 of 51 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m14:20:32.195331 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m14:20:32.196331 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m14:20:32.205349 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m14:20:32.207353 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m14:20:32.209350 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m14:20:32.210353 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m14:20:32.211354 [debug] [Thread-2 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m14:20:32.211859 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:32.269491 [debug] [Thread-3 (]: SQL status: COMMIT in 0.344 seconds
[0m14:20:32.270000 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: Close
[0m14:20:32.271504 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CD54980>]}
[0m14:20:32.272511 [info ] [Thread-3 (]: 3 of 51 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 6.62s]
[0m14:20:32.273520 [debug] [Thread-3 (]: Finished running node seed.dbt_scooters.event_types
[0m14:20:32.274521 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m14:20:32.274521 [info ] [Thread-3 (]: 8 of 51 START test source_not_null_scooters_raw_events_type_id ................. [RUN]
[0m14:20:32.275517 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7)
[0m14:20:32.276522 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m14:20:32.284546 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m14:20:32.286544 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m14:20:32.290541 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m14:20:32.292048 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m14:20:32.293554 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: BEGIN
[0m14:20:32.293554 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:33.974653 [debug] [Thread-1 (]: SQL status: BEGIN in 2.765 seconds
[0m14:20:33.974653 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m14:20:33.975655 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_user.6bc71135e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:20:33.994214 [debug] [Thread-4 (]: SQL status: BEGIN in 2.803 seconds
[0m14:20:33.994214 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m14:20:33.995217 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_user.7eea25f36c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:20:34.553650 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.577 seconds
[0m14:20:34.557660 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: ROLLBACK
[0m14:20:34.894502 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: Close
[0m14:20:34.896502 [info ] [Thread-1 (]: 6 of 51 PASS every_trip_has_user ............................................... [[32mPASS[0m in 3.70s]
[0m14:20:34.897502 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m14:20:34.898787 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m14:20:34.898787 [info ] [Thread-1 (]: 9 of 51 START test source_not_null_scooters_raw_events_user_id ................. [RUN]
[0m14:20:34.899831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_user.6bc71135e2, now test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b)
[0m14:20:34.901341 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m14:20:34.966387 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m14:20:34.968631 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m14:20:34.972150 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m14:20:34.974679 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m14:20:34.975677 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: BEGIN
[0m14:20:34.976678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:35.246679 [debug] [Thread-3 (]: SQL status: BEGIN in 2.953 seconds
[0m14:20:35.247681 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m14:20:35.248682 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from "dev_3lcu"."scooters_raw"."events"
where type_id is null



      
    ) dbt_internal_test
[0m14:20:35.249681 [debug] [Thread-2 (]: SQL status: BEGIN in 3.038 seconds
[0m14:20:35.251187 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m14:20:35.251187 [debug] [Thread-2 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m14:20:35.553553 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.558 seconds
[0m14:20:35.556558 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: ROLLBACK
[0m14:20:35.650252 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.398 seconds
[0m14:20:35.651770 [debug] [Thread-2 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m14:20:35.951138 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: Close
[0m14:20:35.952147 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.703 seconds
[0m14:20:35.954680 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: ROLLBACK
[0m14:20:35.955681 [info ] [Thread-4 (]: 5 of 51 PASS every_event_has_user .............................................. [[32mPASS[0m in 4.82s]
[0m14:20:35.957706 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m14:20:35.958679 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m14:20:35.959677 [info ] [Thread-4 (]: 10 of 51 START test source_not_null_scooters_raw_trips_id ...................... [RUN]
[0m14:20:35.959677 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_user.7eea25f36c, now test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d)
[0m14:20:35.961185 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m14:20:35.967200 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m14:20:35.968200 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m14:20:35.971201 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m14:20:35.973290 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m14:20:35.974796 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: BEGIN
[0m14:20:35.975813 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:35.997458 [debug] [Thread-2 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m14:20:35.999459 [info ] [Thread-2 (]: 7 of 51 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 3.80s]
[0m14:20:36.000466 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m14:20:36.001460 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m14:20:36.002542 [info ] [Thread-2 (]: 11 of 51 START test source_not_null_scooters_raw_trips_scooter_hw_id ........... [RUN]
[0m14:20:36.003543 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f)
[0m14:20:36.004544 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m14:20:36.010542 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m14:20:36.012752 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m14:20:36.015759 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m14:20:36.017762 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m14:20:36.018760 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: BEGIN
[0m14:20:36.018760 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:36.299581 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: Close
[0m14:20:36.302094 [info ] [Thread-3 (]: 8 of 51 PASS source_not_null_scooters_raw_events_type_id ....................... [[32mPASS[0m in 4.03s]
[0m14:20:36.304628 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m14:20:36.305626 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m14:20:36.306626 [info ] [Thread-3 (]: 12 of 51 START test source_not_null_scooters_raw_trips_user_id ................. [RUN]
[0m14:20:36.307634 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7, now test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62)
[0m14:20:36.308634 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m14:20:36.314703 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m14:20:36.316703 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m14:20:36.319702 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m14:20:36.322234 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m14:20:36.322234 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: BEGIN
[0m14:20:36.323754 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:37.661568 [debug] [Thread-1 (]: SQL status: BEGIN in 2.685 seconds
[0m14:20:37.662777 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m14:20:37.662777 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."events"
where user_id is null



      
    ) dbt_internal_test
[0m14:20:38.451428 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.787 seconds
[0m14:20:38.452544 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: ROLLBACK
[0m14:20:38.907234 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: Close
[0m14:20:38.907234 [debug] [Thread-4 (]: SQL status: BEGIN in 2.931 seconds
[0m14:20:38.908233 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m14:20:38.909269 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."trips"
where id is null



      
    ) dbt_internal_test
[0m14:20:38.909269 [info ] [Thread-1 (]: 9 of 51 PASS source_not_null_scooters_raw_events_user_id ....................... [[32mPASS[0m in 4.01s]
[0m14:20:38.911267 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m14:20:38.911267 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m14:20:38.911267 [info ] [Thread-1 (]: 13 of 51 START test source_not_null_scooters_raw_users_id ...................... [RUN]
[0m14:20:38.912720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b, now test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d)
[0m14:20:38.913755 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m14:20:38.917754 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m14:20:38.918720 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m14:20:38.921265 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m14:20:38.923279 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m14:20:38.923279 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: BEGIN
[0m14:20:38.924302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:39.045305 [debug] [Thread-2 (]: SQL status: BEGIN in 3.026 seconds
[0m14:20:39.045305 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m14:20:39.046305 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select scooter_hw_id
from "dev_3lcu"."scooters_raw"."trips"
where scooter_hw_id is null



      
    ) dbt_internal_test
[0m14:20:39.701865 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.792 seconds
[0m14:20:39.704422 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: ROLLBACK
[0m14:20:39.754473 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.707 seconds
[0m14:20:39.756472 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: ROLLBACK
[0m14:20:39.757473 [debug] [Thread-3 (]: SQL status: BEGIN in 3.433 seconds
[0m14:20:39.757473 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m14:20:39.758472 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."trips"
where user_id is null



      
    ) dbt_internal_test
[0m14:20:40.085207 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: Close
[0m14:20:40.086205 [info ] [Thread-4 (]: 10 of 51 PASS source_not_null_scooters_raw_trips_id ............................ [[32mPASS[0m in 4.13s]
[0m14:20:40.087205 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m14:20:40.088208 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m14:20:40.088208 [info ] [Thread-4 (]: 14 of 51 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m14:20:40.089209 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m14:20:40.090211 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m14:20:40.094226 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m14:20:40.096224 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m14:20:40.100227 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m14:20:40.101728 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m14:20:40.101728 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m14:20:40.103238 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:40.103238 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: Close
[0m14:20:40.105247 [info ] [Thread-2 (]: 11 of 51 PASS source_not_null_scooters_raw_trips_scooter_hw_id ................. [[32mPASS[0m in 4.10s]
[0m14:20:40.106252 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m14:20:40.106252 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m14:20:40.107249 [info ] [Thread-2 (]: 15 of 51 START test source_unique_scooters_raw_trips_id ........................ [RUN]
[0m14:20:40.108249 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f, now test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4)
[0m14:20:40.109248 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m14:20:40.115272 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m14:20:40.117277 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m14:20:40.120276 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m14:20:40.121781 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m14:20:40.121781 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: BEGIN
[0m14:20:40.121781 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:40.167393 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.409 seconds
[0m14:20:40.169391 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: ROLLBACK
[0m14:20:40.519629 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: Close
[0m14:20:40.521140 [info ] [Thread-3 (]: 12 of 51 PASS source_not_null_scooters_raw_trips_user_id ....................... [[32mPASS[0m in 4.21s]
[0m14:20:40.522150 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m14:20:40.522150 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m14:20:40.523664 [info ] [Thread-3 (]: 16 of 51 START test source_unique_scooters_raw_users_id ........................ [RUN]
[0m14:20:40.524680 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62, now test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf)
[0m14:20:40.525677 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m14:20:40.529672 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m14:20:40.529672 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m14:20:40.533189 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m14:20:40.534195 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m14:20:40.535199 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: BEGIN
[0m14:20:40.536200 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:41.783432 [debug] [Thread-1 (]: SQL status: BEGIN in 2.860 seconds
[0m14:20:41.784437 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m14:20:41.785437 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."users"
where id is null



      
    ) dbt_internal_test
[0m14:20:42.127543 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.342 seconds
[0m14:20:42.130543 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: ROLLBACK
[0m14:20:42.479536 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: Close
[0m14:20:42.479536 [info ] [Thread-1 (]: 13 of 51 PASS source_not_null_scooters_raw_users_id ............................ [[32mPASS[0m in 3.57s]
[0m14:20:42.481611 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m14:20:42.481611 [debug] [Thread-1 (]: Began running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m14:20:42.483158 [info ] [Thread-1 (]: 17 of 51 START test every_trip_has_scooter_id .................................. [RUN]
[0m14:20:42.484166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d, now test.dbt_scooters.every_trip_has_scooter_id.e0b845a190)
[0m14:20:42.484166 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m14:20:42.490167 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m14:20:42.491167 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m14:20:42.494537 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m14:20:42.496536 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m14:20:42.496536 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: BEGIN
[0m14:20:42.497538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:43.043321 [debug] [Thread-4 (]: SQL status: BEGIN in 2.940 seconds
[0m14:20:43.044331 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m14:20:43.044331 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sex
from "dev_3lcu"."scooters_raw"."users"
where sex is null



      
    ) dbt_internal_test
[0m14:20:43.091952 [debug] [Thread-2 (]: SQL status: BEGIN in 2.970 seconds
[0m14:20:43.093459 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m14:20:43.094469 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."trips"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:20:43.342019 [debug] [Thread-3 (]: SQL status: BEGIN in 2.806 seconds
[0m14:20:43.342019 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m14:20:43.343575 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."users"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:20:43.389122 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.344 seconds
[0m14:20:43.391159 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m14:20:43.748254 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m14:20:43.750250 [warn ] [Thread-4 (]: 14 of 51 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 3.66s]
[0m14:20:43.751253 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m14:20:43.752676 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m14:20:43.753709 [info ] [Thread-4 (]: 18 of 51 START test unique_key_scooters_company__model__hardware_id ............ [RUN]
[0m14:20:43.754677 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e)
[0m14:20:43.754677 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m14:20:43.761255 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m14:20:43.763266 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m14:20:43.765299 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m14:20:43.767265 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m14:20:43.768266 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: BEGIN
[0m14:20:43.768266 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:43.851958 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.507 seconds
[0m14:20:43.853508 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: ROLLBACK
[0m14:20:44.213640 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: Close
[0m14:20:44.214684 [info ] [Thread-3 (]: 16 of 51 PASS source_unique_scooters_raw_users_id .............................. [[32mPASS[0m in 3.69s]
[0m14:20:44.216651 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m14:20:44.217649 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m14:20:44.218650 [info ] [Thread-3 (]: 19 of 51 START test unique_not_null_scooters_hardware_id ....................... [RUN]
[0m14:20:44.219655 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf, now test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d)
[0m14:20:44.219655 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m14:20:44.225184 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m14:20:44.227184 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m14:20:44.229184 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m14:20:44.231185 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m14:20:44.232218 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: BEGIN
[0m14:20:44.232218 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:44.822536 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.727 seconds
[0m14:20:44.824584 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: ROLLBACK
[0m14:20:45.241224 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: Close
[0m14:20:45.242322 [info ] [Thread-2 (]: 15 of 51 PASS source_unique_scooters_raw_trips_id .............................. [[32mPASS[0m in 5.13s]
[0m14:20:45.244330 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m14:20:45.245328 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m14:20:45.245328 [info ] [Thread-2 (]: 20 of 51 START test unique_not_null_scooters_model ............................. [RUN]
[0m14:20:45.246328 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4, now test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc)
[0m14:20:45.247329 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m14:20:45.251843 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m14:20:45.253356 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m14:20:45.257371 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m14:20:45.259363 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m14:20:45.260365 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: BEGIN
[0m14:20:45.260365 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:45.816314 [debug] [Thread-1 (]: SQL status: BEGIN in 3.319 seconds
[0m14:20:45.817313 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m14:20:45.817313 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select scooter_hw_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where scooter_hw_id is not null
),

parent as (
    select hardware_id as to_field
    from "dev_3lcu"."dbt"."scooters"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:20:46.401458 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.583 seconds
[0m14:20:46.403834 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: ROLLBACK
[0m14:20:46.630290 [debug] [Thread-4 (]: SQL status: BEGIN in 2.862 seconds
[0m14:20:46.631329 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m14:20:46.631329 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "company"::text ||
    
        "model"::text ||
    
        "hardware_id"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m14:20:46.789759 [debug] [Thread-1 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: Close
[0m14:20:46.792282 [info ] [Thread-1 (]: 17 of 51 PASS every_trip_has_scooter_id ........................................ [[32mPASS[0m in 4.31s]
[0m14:20:46.794277 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m14:20:46.794277 [debug] [Thread-1 (]: Began running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m14:20:46.795277 [info ] [Thread-1 (]: 21 of 51 START test accepted_values_add_first_name_sex_sex__M__F ............... [RUN]
[0m14:20:46.796276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_scooter_id.e0b845a190, now test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199)
[0m14:20:46.796276 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m14:20:46.801312 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m14:20:46.801852 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m14:20:46.805400 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m14:20:46.806400 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m14:20:46.807372 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: BEGIN
[0m14:20:46.808372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:47.047530 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.415 seconds
[0m14:20:47.049568 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: ROLLBACK
[0m14:20:47.395195 [debug] [Thread-4 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: Close
[0m14:20:47.397199 [info ] [Thread-4 (]: 18 of 51 PASS unique_key_scooters_company__model__hardware_id .................. [[32mPASS[0m in 3.64s]
[0m14:20:47.399202 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m14:20:47.399202 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m14:20:47.400198 [info ] [Thread-4 (]: 22 of 51 START test unique_not_null_add_first_name_sex_first_name .............. [RUN]
[0m14:20:47.401199 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e, now test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f)
[0m14:20:47.402308 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m14:20:47.407314 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m14:20:47.408313 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m14:20:47.411822 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m14:20:47.413330 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m14:20:47.414340 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: BEGIN
[0m14:20:47.414340 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:48.249517 [debug] [Thread-2 (]: SQL status: BEGIN in 2.989 seconds
[0m14:20:48.250503 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m14:20:48.251500 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "model"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "model" is null


      
    ) dbt_internal_test
[0m14:20:48.491727 [debug] [Thread-3 (]: SQL status: BEGIN in 4.260 seconds
[0m14:20:48.493273 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m14:20:48.494322 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "hardware_id"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "hardware_id" is null


      
    ) dbt_internal_test
[0m14:20:48.635545 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.384 seconds
[0m14:20:48.638549 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: ROLLBACK
[0m14:20:48.855283 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.360 seconds
[0m14:20:48.858272 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: ROLLBACK
[0m14:20:49.224607 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: Close
[0m14:20:49.226607 [info ] [Thread-2 (]: 20 of 51 PASS unique_not_null_scooters_model ................................... [[32mPASS[0m in 3.98s]
[0m14:20:49.227565 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m14:20:49.228563 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m14:20:49.229564 [info ] [Thread-2 (]: 23 of 51 START test unique_not_null_age_groups_age_end ......................... [RUN]
[0m14:20:49.229564 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc, now test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac)
[0m14:20:49.231072 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m14:20:49.235602 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m14:20:49.237601 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m14:20:49.241110 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m14:20:49.243120 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m14:20:49.244128 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: BEGIN
[0m14:20:49.244128 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:49.260182 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: Close
[0m14:20:49.262229 [info ] [Thread-3 (]: 19 of 51 PASS unique_not_null_scooters_hardware_id ............................. [[32mPASS[0m in 5.04s]
[0m14:20:49.264232 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m14:20:49.265230 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m14:20:49.266231 [info ] [Thread-3 (]: 24 of 51 START test unique_not_null_age_groups_age_start ....................... [RUN]
[0m14:20:49.267229 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d, now test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b)
[0m14:20:49.268233 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m14:20:49.273344 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m14:20:49.275342 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m14:20:49.278339 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m14:20:49.280342 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m14:20:49.281855 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: BEGIN
[0m14:20:49.283367 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:49.675354 [debug] [Thread-1 (]: SQL status: BEGIN in 2.868 seconds
[0m14:20:49.676356 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m14:20:49.677305 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."dbt"."add_first_name_sex"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m14:20:50.026297 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.348 seconds
[0m14:20:50.028298 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: ROLLBACK
[0m14:20:50.373610 [debug] [Thread-1 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: Close
[0m14:20:50.375612 [info ] [Thread-1 (]: 21 of 51 PASS accepted_values_add_first_name_sex_sex__M__F ..................... [[32mPASS[0m in 3.58s]
[0m14:20:50.377612 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m14:20:50.378609 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m14:20:50.379609 [info ] [Thread-1 (]: 25 of 51 START test unique_not_null_age_groups_group ........................... [RUN]
[0m14:20:50.379609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199, now test.dbt_scooters.unique_not_null_age_groups_group.39342291f1)
[0m14:20:50.381119 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m14:20:50.387659 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m14:20:50.389658 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m14:20:50.395198 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m14:20:50.398197 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m14:20:50.399196 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: BEGIN
[0m14:20:50.399196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:51.625284 [debug] [Thread-4 (]: SQL status: BEGIN in 4.210 seconds
[0m14:20:51.626290 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m14:20:51.626290 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "first_name"
from
    "dev_3lcu"."dbt"."add_first_name_sex"
group by
    1
having
    count(*) > 1 or "first_name" is null


      
    ) dbt_internal_test
[0m14:20:51.910404 [debug] [Thread-2 (]: SQL status: BEGIN in 2.666 seconds
[0m14:20:51.911403 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m14:20:51.911916 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_end"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_end" is null


      
    ) dbt_internal_test
[0m14:20:51.974292 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.347 seconds
[0m14:20:51.977291 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: ROLLBACK
[0m14:20:52.019500 [debug] [Thread-3 (]: SQL status: BEGIN in 2.737 seconds
[0m14:20:52.020500 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m14:20:52.021501 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_start"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_start" is null


      
    ) dbt_internal_test
[0m14:20:52.247444 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.335 seconds
[0m14:20:52.250444 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: ROLLBACK
[0m14:20:52.325369 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: Close
[0m14:20:52.327373 [info ] [Thread-4 (]: 22 of 51 PASS unique_not_null_add_first_name_sex_first_name .................... [[32mPASS[0m in 4.93s]
[0m14:20:52.328373 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m14:20:52.329373 [debug] [Thread-4 (]: Began running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m14:20:52.330372 [info ] [Thread-4 (]: 26 of 51 START test every_event_has_type ....................................... [RUN]
[0m14:20:52.331372 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f, now test.dbt_scooters.every_event_has_type.1e5fc977eb)
[0m14:20:52.331884 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m14:20:52.339408 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m14:20:52.340409 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m14:20:52.346449 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m14:20:52.347449 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m14:20:52.348450 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: BEGIN
[0m14:20:52.349449 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:52.365529 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.343 seconds
[0m14:20:52.367530 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: ROLLBACK
[0m14:20:52.587984 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: Close
[0m14:20:52.589986 [info ] [Thread-2 (]: 23 of 51 PASS unique_not_null_age_groups_age_end ............................... [[32mPASS[0m in 3.36s]
[0m14:20:52.591499 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m14:20:52.591499 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m14:20:52.592511 [info ] [Thread-2 (]: 27 of 51 START test unique_not_null_event_types_type ........................... [RUN]
[0m14:20:52.593509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac, now test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1)
[0m14:20:52.594512 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m14:20:52.598509 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m14:20:52.600511 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m14:20:52.603540 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m14:20:52.605555 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m14:20:52.606558 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: BEGIN
[0m14:20:52.607554 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:52.709339 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: Close
[0m14:20:52.711341 [info ] [Thread-3 (]: 24 of 51 PASS unique_not_null_age_groups_age_start ............................. [[32mPASS[0m in 3.44s]
[0m14:20:52.711853 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m14:20:52.713364 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m14:20:52.714377 [info ] [Thread-3 (]: 28 of 51 START test unique_not_null_event_types_type_id ........................ [RUN]
[0m14:20:52.715380 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b, now test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85)
[0m14:20:52.716379 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m14:20:52.721378 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m14:20:52.721888 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m14:20:52.725413 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m14:20:52.727414 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m14:20:52.727414 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: BEGIN
[0m14:20:52.728414 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:53.274306 [debug] [Thread-1 (]: SQL status: BEGIN in 2.874 seconds
[0m14:20:53.274306 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m14:20:53.275306 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "group"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "group" is null


      
    ) dbt_internal_test
[0m14:20:53.675521 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.399 seconds
[0m14:20:53.677521 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: ROLLBACK
[0m14:20:54.023581 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: Close
[0m14:20:54.024590 [info ] [Thread-1 (]: 25 of 51 PASS unique_not_null_age_groups_group ................................. [[32mPASS[0m in 3.64s]
[0m14:20:54.025591 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m14:20:54.026592 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m14:20:54.027591 [info ] [Thread-1 (]: 29 of 51 START sql incremental model dbt.events_clean .......................... [RUN]
[0m14:20:54.028590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_group.39342291f1, now model.dbt_scooters.events_clean)
[0m14:20:54.028590 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m14:20:54.033105 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m14:20:54.035116 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m14:20:54.087897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:20:54.088901 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp142054066334"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at

from
    "dev_3lcu"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."events_clean")
    

  );
  
  
[0m14:20:54.088901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:55.134415 [debug] [Thread-4 (]: SQL status: BEGIN in 2.785 seconds
[0m14:20:55.134415 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m14:20:55.135417 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_type.1e5fc977eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where type_id is not null
),

parent as (
    select type_id as to_field
    from "dev_3lcu"."dbt"."event_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:20:55.489914 [debug] [Thread-3 (]: SQL status: BEGIN in 2.761 seconds
[0m14:20:55.489914 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m14:20:55.489914 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type_id"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type_id" is null


      
    ) dbt_internal_test
[0m14:20:55.728124 [debug] [Thread-2 (]: SQL status: BEGIN in 3.121 seconds
[0m14:20:55.729127 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m14:20:55.729127 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type" is null


      
    ) dbt_internal_test
[0m14:20:55.863201 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.372 seconds
[0m14:20:55.865210 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: ROLLBACK
[0m14:20:56.160468 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.431 seconds
[0m14:20:56.161990 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: ROLLBACK
[0m14:20:56.257365 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: Close
[0m14:20:56.258321 [info ] [Thread-3 (]: 28 of 51 PASS unique_not_null_event_types_type_id .............................. [[32mPASS[0m in 3.54s]
[0m14:20:56.260324 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m14:20:56.260324 [debug] [Thread-3 (]: Began running node model.dbt_scooters.first_name_sex
[0m14:20:56.261321 [info ] [Thread-3 (]: 30 of 51 START sql table model dbt.first_name_sex .............................. [RUN]
[0m14:20:56.262584 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85, now model.dbt_scooters.first_name_sex)
[0m14:20:56.262584 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.first_name_sex
[0m14:20:56.265591 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.first_name_sex"
[0m14:20:56.267592 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.first_name_sex
[0m14:20:56.281108 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.first_name_sex"
[0m14:20:56.281621 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:20:56.283134 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: BEGIN
[0m14:20:56.283134 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:56.469523 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.334 seconds
[0m14:20:56.472067 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: ROLLBACK
[0m14:20:56.499413 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: Close
[0m14:20:56.500456 [info ] [Thread-2 (]: 27 of 51 PASS unique_not_null_event_types_type ................................. [[32mPASS[0m in 3.91s]
[0m14:20:56.501453 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m14:20:56.502552 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_concurrency
[0m14:20:56.503595 [info ] [Thread-2 (]: 31 of 51 START sql incremental model dbt.trips_concurrency ..................... [RUN]
[0m14:20:56.503595 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1, now model.dbt_scooters.trips_concurrency)
[0m14:20:56.504554 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m14:20:56.511145 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m14:20:56.512196 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m14:20:56.516190 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:20:56.517188 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp142056515189"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_3lcu"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_3lcu"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now()  as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m14:20:56.517188 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:56.856367 [debug] [Thread-4 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: Close
[0m14:20:56.857348 [info ] [Thread-4 (]: 26 of 51 PASS every_event_has_type ............................................. [[32mPASS[0m in 4.53s]
[0m14:20:56.859349 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m14:20:56.859349 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_geom
[0m14:20:56.860341 [info ] [Thread-4 (]: 32 of 51 START sql view model dbt.trips_geom ................................... [RUN]
[0m14:20:56.861820 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_type.1e5fc977eb, now model.dbt_scooters.trips_geom)
[0m14:20:56.861820 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_geom
[0m14:20:56.865373 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m14:20:56.866338 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_geom
[0m14:20:56.886639 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m14:20:56.888602 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:20:56.888602 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m14:20:56.889642 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:58.281984 [debug] [Thread-1 (]: SQL status: SELECT 0 in 4.193 seconds
[0m14:20:58.286584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:20:58.287536 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m14:20:58.637690 [debug] [Thread-1 (]: SQL status: BEGIN in 0.350 seconds
[0m14:20:58.638639 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:20:58.639641 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp142054066334'
        
      order by ordinal_position

  
[0m14:20:59.037558 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.398 seconds
[0m14:20:59.041101 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:20:59.042144 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:20:59.214215 [debug] [Thread-3 (]: SQL status: BEGIN in 2.931 seconds
[0m14:20:59.215169 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:20:59.216169 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

  
    

  create  table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp"
  
  
    as
  
  (
    select distinct first_name, sex
from "dev_3lcu"."scooters_raw"."users"
Where sex is not null
  );
  
[0m14:20:59.439547 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.397 seconds
[0m14:20:59.454269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:20:59.455269 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp142054066334'
        
      order by ordinal_position

  
[0m14:20:59.649595 [debug] [Thread-4 (]: SQL status: BEGIN in 2.761 seconds
[0m14:20:59.651144 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:20:59.652153 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_3lcu"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m14:20:59.653152 [debug] [Thread-3 (]: SQL status: SELECT 387 in 0.436 seconds
[0m14:20:59.660151 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:20:59.660151 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex" rename to "first_name_sex__dbt_backup"
[0m14:20:59.866195 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.410 seconds
[0m14:20:59.870149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:20:59.870149 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:21:00.076341 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.415 seconds
[0m14:21:00.080383 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:21:00.080383 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp" rename to "first_name_sex"
[0m14:21:00.092184 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.440 seconds
[0m14:21:00.096179 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:21:00.097137 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m14:21:00.353295 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.483 seconds
[0m14:21:00.365266 [debug] [Thread-1 (]: 
    In "dev_3lcu"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:21:00.384314 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m14:21:00.385311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:21:00.386311 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        
            delete from "dev_3lcu"."dbt"."events_clean"
            using "events_clean__dbt_tmp142054066334"
            where (
                
                    "events_clean__dbt_tmp142054066334".user_id = "dev_3lcu"."dbt"."events_clean".user_id
                    and 
                
                    "events_clean__dbt_tmp142054066334".timestamp = "dev_3lcu"."dbt"."events_clean".timestamp
                    and 
                
                    "events_clean__dbt_tmp142054066334".type_id = "dev_3lcu"."dbt"."events_clean".type_id
                    
                
                
            );
        
    

    insert into "dev_3lcu"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp142054066334"
    )
  
[0m14:21:00.449268 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.352 seconds
[0m14:21:00.453553 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:21:00.453553 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.372 seconds
[0m14:21:00.454519 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m14:21:00.462026 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:21:00.463535 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

    
  
  comment on table "dev_3lcu"."dbt"."first_name_sex" is $dbt_comment_literal_block$Unique name_sex glossary$dbt_comment_literal_block$;

  
[0m14:21:00.770214 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.383 seconds
[0m14:21:00.771764 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:21:00.771764 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_clean" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m14:21:00.811817 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.349 seconds
[0m14:21:00.814391 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:21:00.815389 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_geom" is $dbt_comment_literal_block$Trips prepared for geometry analysis$dbt_comment_literal_block$;

  
[0m14:21:00.860435 [debug] [Thread-3 (]: SQL status: COMMENT in 0.396 seconds
[0m14:21:00.861924 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m14:21:00.861924 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:21:00.863436 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m14:21:01.058304 [debug] [Thread-2 (]: SQL status: SELECT 0 in 4.541 seconds
[0m14:21:01.062428 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:21:01.063444 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m14:21:01.171818 [debug] [Thread-4 (]: SQL status: COMMENT in 0.356 seconds
[0m14:21:01.174421 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m14:21:01.175424 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:21:01.176426 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m14:21:01.274570 [debug] [Thread-1 (]: SQL status: COMMENT in 0.502 seconds
[0m14:21:01.275565 [debug] [Thread-3 (]: SQL status: COMMIT in 0.412 seconds
[0m14:21:01.277563 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m14:21:01.284554 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."first_name_sex__dbt_backup"
[0m14:21:01.285559 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m14:21:01.291062 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m14:21:01.292073 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m14:21:01.292073 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
drop table if exists "dev_3lcu"."dbt"."first_name_sex__dbt_backup" cascade
[0m14:21:01.409513 [debug] [Thread-2 (]: SQL status: BEGIN in 0.346 seconds
[0m14:21:01.411023 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:21:01.411023 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp142056515189'
        
      order by ordinal_position

  
[0m14:21:01.530220 [debug] [Thread-4 (]: SQL status: COMMIT in 0.353 seconds
[0m14:21:01.533373 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_geom__dbt_backup"
[0m14:21:01.536379 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m14:21:01.537350 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_3lcu"."dbt"."trips_geom__dbt_backup" cascade
[0m14:21:01.689328 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.396 seconds
[0m14:21:01.690285 [debug] [Thread-1 (]: SQL status: COMMIT in 0.397 seconds
[0m14:21:01.692292 [debug] [Thread-3 (]: On model.dbt_scooters.first_name_sex: Close
[0m14:21:01.693342 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m14:21:01.694307 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679C07D400>]}
[0m14:21:01.694307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679C9FB470>]}
[0m14:21:01.695342 [info ] [Thread-3 (]: 30 of 51 OK created sql table model dbt.first_name_sex ......................... [[32mSELECT 387[0m in 5.43s]
[0m14:21:01.697302 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.first_name_sex
[0m14:21:01.696303 [info ] [Thread-1 (]: 29 of 51 OK created sql incremental model dbt.events_clean ..................... [[32mINSERT 0 0[0m in 7.67s]
[0m14:21:01.698303 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_prep
[0m14:21:01.699302 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m14:21:01.700300 [info ] [Thread-3 (]: 33 of 51 START sql view model dbt.trips_prep ................................... [RUN]
[0m14:21:01.701303 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m14:21:01.701303 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.first_name_sex, now model.dbt_scooters.trips_prep)
[0m14:21:01.702594 [info ] [Thread-1 (]: 34 of 51 START sql table model dbt.companies ................................... [RUN]
[0m14:21:01.703626 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_prep
[0m14:21:01.704595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.companies)
[0m14:21:01.708591 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m14:21:01.709593 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m14:21:01.712189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m14:21:01.713190 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_prep
[0m14:21:01.717198 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m14:21:01.718192 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m14:21:01.721730 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m14:21:01.723272 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:21:01.724281 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m14:21:01.725280 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:21:01.725280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:21:01.726279 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m14:21:01.727283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:01.761335 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.349 seconds
[0m14:21:01.764522 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:21:01.765526 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:21:01.922142 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.385 seconds
[0m14:21:01.926138 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: Close
[0m14:21:01.927100 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679C06E870>]}
[0m14:21:01.928136 [info ] [Thread-4 (]: 32 of 51 OK created sql view model dbt.trips_geom .............................. [[32mCREATE VIEW[0m in 5.07s]
[0m14:21:01.929102 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_geom
[0m14:21:01.930141 [debug] [Thread-4 (]: Began running node model.dbt_scooters.users_full
[0m14:21:01.931100 [info ] [Thread-4 (]: 35 of 51 START sql table model dbt.users_full .................................. [RUN]
[0m14:21:01.931610 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.users_full)
[0m14:21:01.933154 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.users_full
[0m14:21:01.937197 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.users_full"
[0m14:21:01.939163 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.users_full
[0m14:21:01.941743 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.users_full"
[0m14:21:01.944299 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:21:01.945300 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: BEGIN
[0m14:21:01.945300 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:21:02.108229 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.342 seconds
[0m14:21:02.111774 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:21:02.113282 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp142056515189'
        
      order by ordinal_position

  
[0m14:21:02.454360 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.341 seconds
[0m14:21:02.458301 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:21:02.459300 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:21:02.803207 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.344 seconds
[0m14:21:02.805146 [debug] [Thread-2 (]: 
    In "dev_3lcu"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:21:02.811651 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m14:21:02.813158 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:21:02.813158 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_3lcu"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp142056515189"
    )


  
[0m14:21:03.151420 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.337 seconds
[0m14:21:03.153519 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:21:03.154525 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_concurrency" is $dbt_comment_literal_block$Number of simultaneous rides in time$dbt_comment_literal_block$;

  
[0m14:21:03.548269 [debug] [Thread-2 (]: SQL status: COMMENT in 0.393 seconds
[0m14:21:03.550271 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m14:21:03.550271 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m14:21:03.551271 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m14:21:03.891692 [debug] [Thread-2 (]: SQL status: COMMIT in 0.341 seconds
[0m14:21:03.893242 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: Close
[0m14:21:03.894303 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CE7FB00>]}
[0m14:21:03.895313 [info ] [Thread-2 (]: 31 of 51 OK created sql incremental model dbt.trips_concurrency ................ [[32mINSERT 0 0[0m in 7.39s]
[0m14:21:03.896310 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m14:21:03.897352 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_full
[0m14:21:03.898312 [info ] [Thread-2 (]: 36 of 51 START sql view model dbt.events_full .................................. [RUN]
[0m14:21:03.899310 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.events_full)
[0m14:21:03.900319 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_full
[0m14:21:03.905371 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m14:21:03.906341 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_full
[0m14:21:03.911344 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m14:21:03.913404 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:21:03.913404 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: BEGIN
[0m14:21:03.914440 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:04.485390 [debug] [Thread-3 (]: SQL status: BEGIN in 2.760 seconds
[0m14:21:04.485390 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:21:04.486390 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_3lcu"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select
    id,
    user_id,
    scooter_hw_id,
    started_at,
    finished_at,
    start_lat,
    start_lon,
    finish_lat,
    finish_lon,
    distance as distance_m,
    cast(price as decimal(20, 2)) / 100 as price_rub,
    extract(epoch from (finished_at - started_at)) as duration_s,
    finished_at <> started_at and price = 0 as is_free,
    
    date(started_at at time zone 'Europe/Moscow')
 as "date"
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m14:21:04.783276 [debug] [Thread-4 (]: SQL status: BEGIN in 2.838 seconds
[0m14:21:04.784328 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:21:04.784328 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

  
    

  create  table "dev_3lcu"."dbt"."users_full__dbt_tmp"
  
  
    as
  
  (
    select
   u.id, u.first_name ,u.last_name ,u.phone ,
   COALESCE(u.sex, fns.sex, afns.sex) as sex2,
   u.birth_date
from "dev_3lcu"."scooters_raw"."users" u
left join "dev_3lcu"."dbt"."first_name_sex" fns on u.first_name = fns.first_name
left join "dev_3lcu"."dbt"."add_first_name_sex" afns on u.first_name =afns.first_name
  );
  
[0m14:21:04.853375 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.367 seconds
[0m14:21:04.857381 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:21:04.858381 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m14:21:05.154127 [debug] [Thread-4 (]: SQL status: SELECT 2000 in 0.368 seconds
[0m14:21:05.157168 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:21:05.158169 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full" rename to "users_full__dbt_backup"
[0m14:21:05.199847 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.341 seconds
[0m14:21:05.203446 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:21:05.204407 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m14:21:05.466162 [debug] [Thread-1 (]: SQL status: BEGIN in 3.739 seconds
[0m14:21:05.466162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:21:05.467168 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_3lcu"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
  );
  
[0m14:21:05.503332 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.345 seconds
[0m14:21:05.507388 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:21:05.507388 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full__dbt_tmp" rename to "users_full"
[0m14:21:05.546583 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.342 seconds
[0m14:21:05.548591 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:21:05.549543 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_prep" is $dbt_comment_literal_block$Trips prepared for analysis$dbt_comment_literal_block$;

  
[0m14:21:05.830288 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.363 seconds
[0m14:21:05.835695 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:21:05.836658 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies" rename to "companies__dbt_backup"
[0m14:21:05.851309 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.344 seconds
[0m14:21:05.853495 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:21:05.854486 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

    
  
  comment on table "dev_3lcu"."dbt"."users_full" is $dbt_comment_literal_block$Users enriched with sex$dbt_comment_literal_block$;

  
[0m14:21:05.891400 [debug] [Thread-3 (]: SQL status: COMMENT in 0.342 seconds
[0m14:21:05.893506 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m14:21:05.893506 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:21:05.894515 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m14:21:06.173230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.336 seconds
[0m14:21:06.177237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:21:06.177237 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies__dbt_tmp" rename to "companies"
[0m14:21:06.199226 [debug] [Thread-4 (]: SQL status: COMMENT in 0.344 seconds
[0m14:21:06.200224 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: COMMIT
[0m14:21:06.201236 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:21:06.201236 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: COMMIT
[0m14:21:06.237355 [debug] [Thread-3 (]: SQL status: COMMIT in 0.343 seconds
[0m14:21:06.240350 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_prep__dbt_backup"
[0m14:21:06.241311 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m14:21:06.241861 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_3lcu"."dbt"."trips_prep__dbt_backup" cascade
[0m14:21:06.514489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m14:21:06.517487 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:21:06.517487 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies" is $dbt_comment_literal_block$Scooter statistics by company$dbt_comment_literal_block$;

  
[0m14:21:06.549432 [debug] [Thread-4 (]: SQL status: COMMIT in 0.347 seconds
[0m14:21:06.551978 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."users_full__dbt_backup"
[0m14:21:06.551978 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m14:21:06.553526 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
drop table if exists "dev_3lcu"."dbt"."users_full__dbt_backup" cascade
[0m14:21:06.585511 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.343 seconds
[0m14:21:06.586514 [debug] [Thread-3 (]: On model.dbt_scooters.trips_prep: Close
[0m14:21:06.587512 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CE5BC50>]}
[0m14:21:06.588471 [info ] [Thread-3 (]: 33 of 51 OK created sql view model dbt.trips_prep .............................. [[32mCREATE VIEW[0m in 4.89s]
[0m14:21:06.589472 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_prep
[0m14:21:06.590473 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m14:21:06.591472 [info ] [Thread-3 (]: 37 of 51 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m14:21:06.591978 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.parking_finish_stat)
[0m14:21:06.591978 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m14:21:06.597127 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m14:21:06.598128 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m14:21:06.601673 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m14:21:06.604234 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:21:06.605224 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m14:21:06.606226 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:21:06.688177 [debug] [Thread-2 (]: SQL status: BEGIN in 2.774 seconds
[0m14:21:06.688177 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:21:06.689177 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_3lcu"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select * from
"dev_3lcu"."dbt"."events_clean" as e
left join "dev_3lcu"."dbt"."event_types" as t
using (type_id)
  );
[0m14:21:06.854436 [debug] [Thread-1 (]: SQL status: COMMENT in 0.336 seconds
[0m14:21:06.855476 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m14:21:06.856477 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:21:06.857436 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m14:21:06.901141 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.347 seconds
[0m14:21:06.903150 [debug] [Thread-4 (]: On model.dbt_scooters.users_full: Close
[0m14:21:06.904161 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679C9434A0>]}
[0m14:21:06.905200 [info ] [Thread-4 (]: 35 of 51 OK created sql table model dbt.users_full ............................. [[32mSELECT 2000[0m in 4.97s]
[0m14:21:06.906162 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.users_full
[0m14:21:06.907163 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_start_stat
[0m14:21:06.907163 [info ] [Thread-4 (]: 38 of 51 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m14:21:06.908201 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.users_full, now model.dbt_scooters.parking_start_stat)
[0m14:21:06.909203 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m14:21:06.911752 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m14:21:06.913258 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m14:21:06.919307 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m14:21:06.920295 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:21:06.921267 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m14:21:06.921267 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:21:07.031306 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.341 seconds
[0m14:21:07.035452 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:21:07.035452 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m14:21:07.194176 [debug] [Thread-1 (]: SQL status: COMMIT in 0.337 seconds
[0m14:21:07.197689 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."companies__dbt_backup"
[0m14:21:07.198690 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m14:21:07.198690 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_3lcu"."dbt"."companies__dbt_backup" cascade
[0m14:21:07.375407 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.339 seconds
[0m14:21:07.379361 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:21:07.379361 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m14:21:07.541942 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.343 seconds
[0m14:21:07.544530 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m14:21:07.545489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CE6FF20>]}
[0m14:21:07.546486 [info ] [Thread-1 (]: 34 of 51 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 5.84s]
[0m14:21:07.547540 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m14:21:07.548528 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m14:21:07.549489 [info ] [Thread-1 (]: 39 of 51 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m14:21:07.549489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.revenue_daily)
[0m14:21:07.551038 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m14:21:07.556086 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m14:21:07.558049 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m14:21:07.581205 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:07.581205 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
select * from (
        select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_3lcu"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
    ) as __dbt_sbq
    where false
    limit 0

[0m14:21:07.582471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:07.717481 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m14:21:07.720435 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:21:07.720435 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

    
  
  comment on view "dev_3lcu"."dbt"."events_full" is $dbt_comment_literal_block$User events enriched with meaningful types$dbt_comment_literal_block$;

  
[0m14:21:08.068171 [debug] [Thread-2 (]: SQL status: COMMENT in 0.347 seconds
[0m14:21:08.070171 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: COMMIT
[0m14:21:08.071172 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:21:08.071682 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: COMMIT
[0m14:21:08.417446 [debug] [Thread-2 (]: SQL status: COMMIT in 0.346 seconds
[0m14:21:08.420445 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."events_full__dbt_backup"
[0m14:21:08.421446 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m14:21:08.421956 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_3lcu"."dbt"."events_full__dbt_backup" cascade
[0m14:21:08.761691 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.340 seconds
[0m14:21:08.764292 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: Close
[0m14:21:08.765246 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CD5C230>]}
[0m14:21:08.766286 [info ] [Thread-2 (]: 36 of 51 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 4.87s]
[0m14:21:08.767247 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_full
[0m14:21:08.768247 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat
[0m14:21:08.768247 [info ] [Thread-2 (]: 40 of 51 START sql table model dbt.trips_stat .................................. [RUN]
[0m14:21:08.769286 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_stat)
[0m14:21:08.770246 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat
[0m14:21:08.773261 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m14:21:08.775272 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat
[0m14:21:08.779272 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m14:21:08.780272 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:21:08.781779 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m14:21:08.781779 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:09.516529 [debug] [Thread-3 (]: SQL status: BEGIN in 2.911 seconds
[0m14:21:09.517485 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:21:09.518484 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m14:21:09.624593 [debug] [Thread-4 (]: SQL status: BEGIN in 2.703 seconds
[0m14:21:09.625602 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:21:09.625602 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m14:21:10.350404 [debug] [Thread-1 (]: SQL status: SELECT 0 in 2.768 seconds
[0m14:21:10.364135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:10.365138 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
select * from (
        select
    
      
    cast(null as decimal(20, 2))
 as revenue_rub, 
      
    cast(null as date)
 as date, 
      
    cast(null as timestamptz)
 as updated_at
    ) as __dbt_sbq
    where false
    limit 0

[0m14:21:10.747367 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.382 seconds
[0m14:21:10.754511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:10.755508 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp142107560086"
  
  
    
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_3lcu"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m14:21:11.862194 [debug] [Thread-2 (]: SQL status: BEGIN in 3.080 seconds
[0m14:21:11.863214 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:21:11.863214 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count(*) as trips,
    count(distinct user_id) as users,
    avg(duration_s) / 60 as avg_duration_min,
    sum(distance_m) / 1000 as sum_distance_km,
    sum(price_rub) as revenue_rub,
    count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from
    "dev_3lcu"."dbt"."trips_prep"
  );
  
[0m14:21:15.548492 [debug] [Thread-1 (]: SQL status: SELECT 3 in 4.792 seconds
[0m14:21:15.552076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:15.553081 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m14:21:15.953105 [debug] [Thread-1 (]: SQL status: BEGIN in 0.399 seconds
[0m14:21:15.953105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:15.954105 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp142107560086'
        
      order by ordinal_position

  
[0m14:21:16.849437 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.895 seconds
[0m14:21:16.851976 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:16.853531 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m14:21:17.380488 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.526 seconds
[0m14:21:17.383459 [debug] [Thread-1 (]: 
    In "dev_3lcu"."finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:21:17.384468 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m14:21:17.385468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:17.386468 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        
            delete from "dev_3lcu"."finance"."revenue_daily"
            using "revenue_daily__dbt_tmp142107560086"
            where (
                
                    "revenue_daily__dbt_tmp142107560086".date = "dev_3lcu"."finance"."revenue_daily".date
                    
                
                
            );
        
    

    insert into "dev_3lcu"."finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp142107560086"
    )
  
[0m14:21:17.752111 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.365 seconds
[0m14:21:17.756161 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:17.757153 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_3lcu".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'finance'
        and table_name = 'revenue_daily'
  
[0m14:21:18.347089 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.590 seconds
[0m14:21:18.349082 [debug] [Thread-1 (]: On "dev_3lcu"."finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m14:21:18.350082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:18.351044 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  comment on table "dev_3lcu"."finance"."revenue_daily" is $dbt_comment_literal_block$Summary daily revenue$dbt_comment_literal_block$;

  
[0m14:21:18.747435 [debug] [Thread-1 (]: SQL status: COMMENT in 0.396 seconds
[0m14:21:18.750393 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:18.751393 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m14:21:19.348563 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.597 seconds
[0m14:21:19.351112 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:19.351112 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  
    
    
    comment on column "dev_3lcu"."finance"."revenue_daily".revenue_rub is $dbt_comment_literal_block$Daily revenue in rubles$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."finance"."revenue_daily".date is $dbt_comment_literal_block$Unique day$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."finance"."revenue_daily".updated_at is $dbt_comment_literal_block$When row was updated last time$dbt_comment_literal_block$;
  

  
[0m14:21:19.745461 [debug] [Thread-1 (]: SQL status: COMMENT in 0.394 seconds
[0m14:21:19.748466 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m14:21:19.748466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m14:21:19.749461 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m14:21:19.850441 [debug] [Thread-2 (]: SQL status: SELECT 1 in 7.986 seconds
[0m14:21:19.854471 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:21:19.854471 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m14:21:20.151874 [debug] [Thread-1 (]: SQL status: COMMIT in 0.401 seconds
[0m14:21:20.153383 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m14:21:20.154394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679C9FE600>]}
[0m14:21:20.155394 [info ] [Thread-1 (]: 39 of 51 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 3[0m in 12.60s]
[0m14:21:20.156399 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m14:21:20.157397 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m14:21:20.158395 [info ] [Thread-1 (]: 41 of 51 START sql table model dbt.trips_stat_daily ............................ [RUN]
[0m14:21:20.159396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_stat_daily)
[0m14:21:20.159396 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m14:21:20.161903 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m14:21:20.163414 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m14:21:20.167422 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m14:21:20.168424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:20.169425 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m14:21:20.169425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:20.248362 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.393 seconds
[0m14:21:20.251879 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:21:20.253388 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m14:21:20.651755 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.398 seconds
[0m14:21:20.655309 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:21:20.655309 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat" is $dbt_comment_literal_block$Overall trips statistics$dbt_comment_literal_block$;

  
[0m14:21:21.001706 [debug] [Thread-2 (]: SQL status: COMMENT in 0.345 seconds
[0m14:21:21.003213 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m14:21:21.004222 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:21:21.004222 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m14:21:21.357582 [debug] [Thread-2 (]: SQL status: COMMIT in 0.353 seconds
[0m14:21:21.361039 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat__dbt_backup"
[0m14:21:21.362047 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m14:21:21.362047 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat__dbt_backup" cascade
[0m14:21:21.755496 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.392 seconds
[0m14:21:21.757531 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: Close
[0m14:21:21.757531 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679C943E90>]}
[0m14:21:21.758494 [info ] [Thread-2 (]: 40 of 51 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 12.99s]
[0m14:21:21.759499 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat
[0m14:21:21.761031 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_users
[0m14:21:21.762040 [info ] [Thread-2 (]: 42 of 51 START sql incremental model dbt.trips_users ........................... [RUN]
[0m14:21:21.763041 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_users)
[0m14:21:21.763041 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_users
[0m14:21:21.767069 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m14:21:21.768071 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_users
[0m14:21:21.773255 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:21.773255 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp142121771069"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep" as t
left join
    "dev_3lcu"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_3lcu"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m14:21:21.774246 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:23.351803 [debug] [Thread-1 (]: SQL status: BEGIN in 3.183 seconds
[0m14:21:23.353308 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:23.353308 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    count(*) as trips,
    max(price_rub) as max_price_rub,
    avg(distance_m) / 1000 as avg_distance_km,
    avg(price_rub)/avg(duration_s) * 60 as avg_price_rub_per_min
from
    "dev_3lcu"."dbt"."trips_prep"
group by
    1
order by
    1
  );
  
[0m14:21:27.853404 [debug] [Thread-2 (]: SQL status: SELECT 0 in 6.079 seconds
[0m14:21:27.858406 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:27.859402 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: BEGIN
[0m14:21:28.248168 [debug] [Thread-2 (]: SQL status: BEGIN in 0.389 seconds
[0m14:21:28.249163 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:28.249163 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp142121771069'
        
      order by ordinal_position

  
[0m14:21:29.156265 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.906 seconds
[0m14:21:29.160264 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:29.161263 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:21:29.654119 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.492 seconds
[0m14:21:29.659122 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:29.660118 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp142121771069'
        
      order by ordinal_position

  
[0m14:21:30.369210 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.709 seconds
[0m14:21:30.373222 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:30.374233 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:21:30.851802 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.477 seconds
[0m14:21:30.855322 [debug] [Thread-2 (]: 
    In "dev_3lcu"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:21:30.857320 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m14:21:30.858321 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:30.859320 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_3lcu"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp142121771069"
    )


  
[0m14:21:31.349430 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.490 seconds
[0m14:21:31.351941 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:31.351941 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_users" is $dbt_comment_literal_block$Prepared trips enriched with users data$dbt_comment_literal_block$;

  
[0m14:21:31.749400 [debug] [Thread-2 (]: SQL status: COMMENT in 0.396 seconds
[0m14:21:31.751912 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:31.751912 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m14:21:39.249168 [debug] [Thread-1 (]: SQL status: SELECT 91 in 15.895 seconds
[0m14:21:39.254189 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:39.255191 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m14:21:39.648467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.393 seconds
[0m14:21:39.652029 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:39.652029 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m14:21:40.048260 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.395 seconds
[0m14:21:40.059234 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:40.060233 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    create  index if not exists
  "c19794f7bf39390222e5029f780d234b"
  on "dev_3lcu"."dbt"."trips_stat_daily" 
  (date)
  
[0m14:21:40.648294 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.588 seconds
[0m14:21:40.650240 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:40.651240 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat_daily" is $dbt_comment_literal_block$Overall trips statistics per day$dbt_comment_literal_block$;

  
[0m14:21:41.048425 [debug] [Thread-1 (]: SQL status: COMMENT in 0.397 seconds
[0m14:21:41.052020 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:41.053014 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_stat_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:21:41.979379 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.926 seconds
[0m14:21:41.981975 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:41.981975 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."trips_stat_daily".date is $dbt_comment_literal_block$Trips date$dbt_comment_literal_block$;
  

  
[0m14:21:42.368309 [debug] [Thread-1 (]: SQL status: COMMENT in 0.386 seconds
[0m14:21:42.371304 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m14:21:42.371304 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:42.372755 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m14:21:42.758179 [debug] [Thread-1 (]: SQL status: COMMIT in 0.385 seconds
[0m14:21:42.761723 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup"
[0m14:21:42.761723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m14:21:42.761723 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m14:21:43.151598 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.389 seconds
[0m14:21:43.154110 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m14:21:43.155110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CE1C860>]}
[0m14:21:43.156111 [info ] [Thread-1 (]: 41 of 51 OK created sql table model dbt.trips_stat_daily ....................... [[32mSELECT 91[0m in 23.00s]
[0m14:21:43.157112 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m14:21:43.158116 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies_trips
[0m14:21:43.159111 [info ] [Thread-1 (]: 43 of 51 START sql table model dbt.companies_trips ............................. [RUN]
[0m14:21:43.160118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.companies_trips)
[0m14:21:43.161124 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies_trips
[0m14:21:43.164398 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m14:21:43.165396 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies_trips
[0m14:21:43.168398 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m14:21:43.169396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:43.170903 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m14:21:43.170903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:43.253036 [debug] [Thread-2 (]: SQL status: ANALYZE in 11.500 seconds
[0m14:21:43.254046 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m14:21:43.255085 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:43.256045 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m14:21:43.648018 [debug] [Thread-2 (]: SQL status: COMMIT in 0.392 seconds
[0m14:21:43.648971 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:43.649970 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m14:21:44.050182 [debug] [Thread-2 (]: SQL status: COMMIT in 0.400 seconds
[0m14:21:44.051640 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m14:21:44.053146 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m14:21:44.449514 [debug] [Thread-2 (]: SQL status: VACUUM in 0.396 seconds
[0m14:21:44.452029 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: Close
[0m14:21:44.453030 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CEB6090>]}
[0m14:21:44.453030 [info ] [Thread-2 (]: 42 of 51 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 22.69s]
[0m14:21:44.455039 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_users
[0m14:21:44.456039 [debug] [Thread-2 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m14:21:44.457038 [info ] [Thread-2 (]: 44 of 51 START test events_full_is_complete .................................... [RUN]
[0m14:21:44.458039 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now test.dbt_scooters.events_full_is_complete)
[0m14:21:44.458039 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m14:21:44.461636 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m14:21:44.463187 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m14:21:44.465242 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.events_full_is_complete"
[0m14:21:44.467199 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m14:21:44.467199 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: BEGIN
[0m14:21:44.468196 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:46.213343 [debug] [Thread-3 (]: SQL status: SELECT 464 in 36.695 seconds
[0m14:21:46.217861 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:21:46.217861 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m14:21:46.248512 [debug] [Thread-1 (]: SQL status: BEGIN in 3.078 seconds
[0m14:21:46.249504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:46.249504 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_3lcu"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_3lcu"."dbt"."trips_prep" as t
        join "dev_3lcu"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_3lcu"."dbt"."companies" as c
        using (company)
  );
  
[0m14:21:46.569125 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.350 seconds
[0m14:21:46.573100 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:21:46.573100 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m14:21:46.951669 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.378 seconds
[0m14:21:46.954266 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:21:46.954266 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_finish_stat" is $dbt_comment_literal_block$Trip finish parking statistics by 10 m hexagons$dbt_comment_literal_block$;

  
[0m14:21:47.349647 [debug] [Thread-3 (]: SQL status: COMMENT in 0.394 seconds
[0m14:21:47.351154 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m14:21:47.351154 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:21:47.352161 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m14:21:47.452113 [debug] [Thread-2 (]: SQL status: BEGIN in 2.984 seconds
[0m14:21:47.453110 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m14:21:47.453110 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.events_full_is_complete"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with source_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_clean"
),
target_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_full"
)
select
    'Row count mismatch' as error_message,
    source_cte.row_count as source_count,
    target_cte.row_count as target_count
from
    source_cte,
    target_cte
where
    source_cte.row_count != target_cte.row_count
      
    ) dbt_internal_test
[0m14:21:47.761877 [debug] [Thread-3 (]: SQL status: COMMIT in 0.409 seconds
[0m14:21:47.766393 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup"
[0m14:21:47.767394 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m14:21:47.767394 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m14:21:48.049409 [debug] [Thread-1 (]: SQL status: SELECT 6 in 1.800 seconds
[0m14:21:48.054441 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:48.055440 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m14:21:48.149137 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.381 seconds
[0m14:21:48.151691 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m14:21:48.153197 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CF596A0>]}
[0m14:21:48.154205 [info ] [Thread-3 (]: 37 of 51 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 41.56s]
[0m14:21:48.155207 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m14:21:48.155207 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m14:21:48.156205 [info ] [Thread-3 (]: 45 of 51 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m14:21:48.157207 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_finish_stat, now model.dbt_scooters.trips_age_daily)
[0m14:21:48.158206 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m14:21:48.161726 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m14:21:48.163240 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m14:21:48.167253 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m14:21:48.168254 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:21:48.169254 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m14:21:48.169254 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:21:48.394488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.339 seconds
[0m14:21:48.398478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:48.399442 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m14:21:48.747960 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.348 seconds
[0m14:21:48.750002 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:48.750955 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies_trips" is $dbt_comment_literal_block$Trip statistics by company$dbt_comment_literal_block$;

  
[0m14:21:49.146168 [debug] [Thread-1 (]: SQL status: COMMENT in 0.395 seconds
[0m14:21:49.150169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:49.151169 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'companies_trips'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:21:50.051075 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.900 seconds
[0m14:21:50.053183 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:50.054189 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."companies_trips".company is $dbt_comment_literal_block$Scooters manufacturing company$dbt_comment_literal_block$;
  

  
[0m14:21:50.446058 [debug] [Thread-1 (]: SQL status: COMMENT in 0.392 seconds
[0m14:21:50.448057 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m14:21:50.448057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:50.449059 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m14:21:50.848017 [debug] [Thread-1 (]: SQL status: COMMIT in 0.399 seconds
[0m14:21:50.851562 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."companies_trips__dbt_backup"
[0m14:21:50.851562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m14:21:50.851562 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_3lcu"."dbt"."companies_trips__dbt_backup" cascade
[0m14:21:50.946457 [debug] [Thread-2 (]: SQL status: SELECT 1 in 3.493 seconds
[0m14:21:50.948456 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: ROLLBACK
[0m14:21:51.246450 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.394 seconds
[0m14:21:51.248446 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: Close
[0m14:21:51.249444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CF392E0>]}
[0m14:21:51.249444 [info ] [Thread-1 (]: 43 of 51 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 8.09s]
[0m14:21:51.252000 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies_trips
[0m14:21:51.252998 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_group
[0m14:21:51.252998 [info ] [Thread-1 (]: 46 of 51 START sql table model dbt.trips_age_group ............................. [RUN]
[0m14:21:51.254032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_age_group)
[0m14:21:51.255035 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m14:21:51.258031 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m14:21:51.258997 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_group
[0m14:21:51.263125 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m14:21:51.264136 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:21:51.265138 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m14:21:51.265138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:51.346155 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: Close
[0m14:21:51.346155 [debug] [Thread-3 (]: SQL status: BEGIN in 3.177 seconds
[0m14:21:51.347149 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:21:51.349150 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    Select "date",
       age,
       count(*) as trips,
       sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m14:21:51.348150 [info ] [Thread-2 (]: 44 of 51 PASS events_full_is_complete .......................................... [[32mPASS[0m in 6.89s]
[0m14:21:51.350153 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m14:21:51.351151 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m14:21:51.351151 [info ] [Thread-2 (]: 47 of 51 START test unique_companies_trips_company ............................. [RUN]
[0m14:21:51.352639 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.events_full_is_complete, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m14:21:51.353609 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m14:21:51.359649 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m14:21:51.361158 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m14:21:51.363208 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m14:21:51.365167 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m14:21:51.365167 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m14:21:51.366207 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:53.528397 [debug] [Thread-3 (]: SQL status: SELECT 7049 in 2.179 seconds
[0m14:21:53.532914 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:21:53.533923 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m14:21:53.989396 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.454 seconds
[0m14:21:53.995917 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:21:53.996916 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m14:21:54.346034 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.349 seconds
[0m14:21:54.349034 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:21:54.349034 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily" is $dbt_comment_literal_block$Daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m14:21:54.753387 [debug] [Thread-4 (]: SQL status: SELECT 142 in 45.126 seconds
[0m14:21:54.757381 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:21:54.757381 [debug] [Thread-3 (]: SQL status: COMMENT in 0.408 seconds
[0m14:21:54.758350 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m14:21:54.759352 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m14:21:54.760861 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:21:54.761871 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m14:21:54.793330 [debug] [Thread-2 (]: SQL status: BEGIN in 3.427 seconds
[0m14:21:54.793330 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m14:21:54.794374 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



      
    ) dbt_internal_test
[0m14:21:55.097186 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.336 seconds
[0m14:21:55.101184 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:21:55.102645 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m14:21:55.160943 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.365 seconds
[0m14:21:55.163085 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m14:21:55.165088 [debug] [Thread-3 (]: SQL status: COMMIT in 0.402 seconds
[0m14:21:55.168086 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily__dbt_backup"
[0m14:21:55.169089 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m14:21:55.170086 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily__dbt_backup" cascade
[0m14:21:55.439338 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m14:21:55.442926 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:21:55.443890 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_start_stat" is $dbt_comment_literal_block$Trip start parking statistics by 500 m hexagons$dbt_comment_literal_block$;

  
[0m14:21:55.501766 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m14:21:55.503310 [info ] [Thread-2 (]: 47 of 51 PASS unique_companies_trips_company ................................... [[32mPASS[0m in 4.15s]
[0m14:21:55.504318 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m14:21:55.505321 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_stat
[0m14:21:55.506318 [info ] [Thread-2 (]: 48 of 51 START sql table model dbt.events_stat ................................. [RUN]
[0m14:21:55.507320 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0, now model.dbt_scooters.events_stat)
[0m14:21:55.508321 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_stat
[0m14:21:55.511889 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m14:21:55.513429 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_stat
[0m14:21:55.517437 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m14:21:55.519469 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:21:55.520981 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: BEGIN
[0m14:21:55.520981 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:55.523021 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.352 seconds
[0m14:21:55.526990 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m14:21:55.529513 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CF9A720>]}
[0m14:21:55.532035 [info ] [Thread-3 (]: 45 of 51 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 7.37s]
[0m14:21:55.546080 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m14:21:55.547080 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m14:21:55.548070 [info ] [Thread-3 (]: 49 of 51 START test unique_key_trips_age_daily_date__age ....................... [RUN]
[0m14:21:55.549073 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be)
[0m14:21:55.550075 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m14:21:55.556100 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m14:21:55.558102 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m14:21:55.560102 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m14:21:55.561617 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m14:21:55.563130 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: BEGIN
[0m14:21:55.564142 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:21:55.780195 [debug] [Thread-4 (]: SQL status: COMMENT in 0.336 seconds
[0m14:21:55.781707 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m14:21:55.783218 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:21:55.783218 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m14:21:56.071881 [debug] [Thread-1 (]: SQL status: BEGIN in 4.806 seconds
[0m14:21:56.072886 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:21:56.073883 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users" as tu
    cross join "dev_3lcu"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m14:21:56.132104 [debug] [Thread-4 (]: SQL status: COMMIT in 0.348 seconds
[0m14:21:56.137150 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_start_stat__dbt_backup"
[0m14:21:56.138145 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m14:21:56.139145 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_start_stat__dbt_backup" cascade
[0m14:21:56.481302 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.341 seconds
[0m14:21:56.483318 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: Close
[0m14:21:56.484327 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CEC7FB0>]}
[0m14:21:56.485327 [info ] [Thread-4 (]: 38 of 51 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 49.58s]
[0m14:21:56.487330 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m14:21:56.488337 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m14:21:56.489327 [info ] [Thread-4 (]: 50 of 51 START test unique_trips_age_daily_date_text_age_text .................. [RUN]
[0m14:21:56.490328 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e)
[0m14:21:56.490839 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m14:21:56.496367 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m14:21:56.498367 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m14:21:56.500875 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m14:21:56.501882 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m14:21:56.504411 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: BEGIN
[0m14:21:56.505417 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:21:58.644388 [debug] [Thread-2 (]: SQL status: BEGIN in 3.124 seconds
[0m14:21:58.645388 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:21:58.646386 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
       count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from "dev_3lcu"."dbt"."events_full"
  );
  
[0m14:21:58.648389 [debug] [Thread-3 (]: SQL status: BEGIN in 3.084 seconds
[0m14:21:58.649388 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m14:21:58.649388 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "date"::text ||
    
        "age"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m14:21:59.347331 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.697 seconds
[0m14:21:59.349333 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: ROLLBACK
[0m14:21:59.750109 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: Close
[0m14:21:59.751622 [info ] [Thread-3 (]: 49 of 51 PASS unique_key_trips_age_daily_date__age ............................. [[32mPASS[0m in 4.20s]
[0m14:21:59.753132 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m14:21:59.947311 [debug] [Thread-1 (]: SQL status: SELECT 7 in 3.873 seconds
[0m14:21:59.957341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:21:59.958340 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m14:22:00.304979 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.346 seconds
[0m14:22:00.309979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:22:00.309979 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m14:22:00.546014 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.899 seconds
[0m14:22:00.546014 [debug] [Thread-4 (]: SQL status: BEGIN in 4.041 seconds
[0m14:22:00.551015 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:22:00.551524 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m14:22:00.553032 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m14:22:00.553032 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date::text || age::text as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."trips_age_daily"
where date::text || age::text is not null
group by date::text || age::text
having count(*) > 1



      
    ) dbt_internal_test
[0m14:22:00.656452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.345 seconds
[0m14:22:00.658451 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:22:00.659451 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_group" is $dbt_comment_literal_block$Overall trips statistics by user age group$dbt_comment_literal_block$;

  
[0m14:22:00.894166 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.339 seconds
[0m14:22:00.898163 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:22:00.899114 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m14:22:00.909169 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.355 seconds
[0m14:22:00.912272 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: ROLLBACK
[0m14:22:01.004197 [debug] [Thread-1 (]: SQL status: COMMENT in 0.344 seconds
[0m14:22:01.006209 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m14:22:01.007170 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:22:01.007170 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m14:22:01.252035 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.352 seconds
[0m14:22:01.253047 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: Close
[0m14:22:01.255049 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:22:01.256046 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_stat" is $dbt_comment_literal_block$Overall user events statistics$dbt_comment_literal_block$;

  
[0m14:22:01.257007 [info ] [Thread-4 (]: 50 of 51 PASS unique_trips_age_daily_date_text_age_text ........................ [[32mPASS[0m in 4.77s]
[0m14:22:01.258011 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m14:22:01.259005 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m14:22:01.260004 [info ] [Thread-3 (]: 51 of 51 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m14:22:01.261006 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be, now model.dbt_scooters.trips_age_daily_stat)
[0m14:22:01.261515 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m14:22:01.265033 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:01.267033 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m14:22:01.271031 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:01.273047 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:01.273047 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m14:22:01.274060 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:22:01.401716 [debug] [Thread-1 (]: SQL status: COMMIT in 0.394 seconds
[0m14:22:01.405278 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_group__dbt_backup"
[0m14:22:01.406275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m14:22:01.406275 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_group__dbt_backup" cascade
[0m14:22:01.596346 [debug] [Thread-2 (]: SQL status: COMMENT in 0.339 seconds
[0m14:22:01.598310 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: COMMIT
[0m14:22:01.599310 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:22:01.599310 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: COMMIT
[0m14:22:01.754399 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.348 seconds
[0m14:22:01.756406 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: Close
[0m14:22:01.757406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CF49550>]}
[0m14:22:01.758364 [info ] [Thread-1 (]: 46 of 51 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 10.50s]
[0m14:22:01.759364 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_group
[0m14:22:01.939676 [debug] [Thread-2 (]: SQL status: COMMIT in 0.340 seconds
[0m14:22:01.943197 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."events_stat__dbt_backup"
[0m14:22:01.944194 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m14:22:01.945195 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_3lcu"."dbt"."events_stat__dbt_backup" cascade
[0m14:22:02.353312 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.408 seconds
[0m14:22:02.355322 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: Close
[0m14:22:02.356322 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CF44230>]}
[0m14:22:02.357324 [info ] [Thread-2 (]: 48 of 51 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 6.85s]
[0m14:22:02.358326 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_stat
[0m14:22:04.226916 [debug] [Thread-3 (]: SQL status: BEGIN in 2.953 seconds
[0m14:22:04.227875 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:04.227875 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m14:22:04.590186 [debug] [Thread-3 (]: SQL status: SELECT 83 in 0.361 seconds
[0m14:22:04.593198 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:04.594207 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m14:22:04.938984 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.344 seconds
[0m14:22:04.942958 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:04.942958 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m14:22:05.289303 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.346 seconds
[0m14:22:05.291757 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:05.291757 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily_stat" is $dbt_comment_literal_block$Aggregation of daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m14:22:05.637486 [debug] [Thread-3 (]: SQL status: COMMENT in 0.344 seconds
[0m14:22:05.639446 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m14:22:05.639446 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:05.639446 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m14:22:06.009015 [debug] [Thread-3 (]: SQL status: COMMIT in 0.369 seconds
[0m14:22:06.011557 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup"
[0m14:22:06.013065 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:06.013065 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m14:22:06.357401 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.343 seconds
[0m14:22:06.358401 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m14:22:06.359401 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f115af9c-ca1f-4367-8a7f-d393f2642d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679CFDD100>]}
[0m14:22:06.360908 [info ] [Thread-3 (]: 51 of 51 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 5.10s]
[0m14:22:06.361919 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m14:22:06.363925 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:06.364961 [debug] [MainThread]: On master: BEGIN
[0m14:22:06.364961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:22:09.111574 [debug] [MainThread]: SQL status: BEGIN in 2.747 seconds
[0m14:22:09.111574 [debug] [MainThread]: On master: COMMIT
[0m14:22:09.113084 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:09.113084 [debug] [MainThread]: On master: COMMIT
[0m14:22:09.457937 [debug] [MainThread]: SQL status: COMMIT in 0.344 seconds
[0m14:22:09.458914 [info ] [MainThread]: 
[0m14:22:09.458914 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:22:09.461530 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m14:22:09.468130 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m14:22:09.470091 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:09.470091 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m14:22:09.952067 [debug] [MainThread]: SQL status: GRANT in 0.481 seconds
[0m14:22:09.953067 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mGRANT[0m in 0.48s]
[0m14:22:09.954114 [info ] [MainThread]: 
[0m14:22:09.955070 [debug] [MainThread]: On master: Close
[0m14:22:09.956111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:09.957097 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m14:22:09.957097 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m14:22:09.957097 [debug] [MainThread]: Connection 'list_dev_3lcu_finance' was properly closed.
[0m14:22:09.958070 [debug] [MainThread]: Connection 'list_dev_3lcu_dbt' was properly closed.
[0m14:22:09.958070 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m14:22:09.959115 [debug] [MainThread]: Connection 'model.dbt_scooters.events_stat' was properly closed.
[0m14:22:09.959115 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m14:22:09.959115 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e' was properly closed.
[0m14:22:09.960069 [info ] [MainThread]: 
[0m14:22:09.961067 [info ] [MainThread]: Finished running 4 seeds, 28 data tests, 12 table models, 4 incremental models, 3 view models, 1 project hook in 0 hours 1 minutes and 57.68 seconds (117.68s).
[0m14:22:09.971766 [debug] [MainThread]: Command end result
[0m14:22:10.015382 [info ] [MainThread]: 
[0m14:22:10.016348 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m14:22:10.017344 [info ] [MainThread]: 
[0m14:22:10.017344 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models\properties.yml)[0m
[0m14:22:10.018349 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m14:22:10.019344 [info ] [MainThread]: 
[0m14:22:10.020853 [info ] [MainThread]:   compiled code at target\compiled\dbt_scooters\models\properties.yml\source_not_null_scooters_raw_users_sex.sql
[0m14:22:10.020853 [info ] [MainThread]: 
[0m14:22:10.021863 [info ] [MainThread]: Done. PASS=50 WARN=1 ERROR=0 SKIP=0 TOTAL=51
[0m14:22:10.023889 [debug] [MainThread]: Command `dbt build` succeeded at 14:22:10.022882 after 120.00 seconds
[0m14:22:10.023889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679A6294C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679A62B200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001679A733AA0>]}
[0m14:22:10.923011 [debug] [MainThread]: Flushing usage events
[0m14:22:40.266094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016994DDF740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016995009B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016995009A90>]}


============================== 14:22:40.272138 | 3b27ff04-9be1-45f6-aa34-a47dd2e7cd6a ==============================
[0m14:22:40.272138 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:22:40.273150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:22:40.581386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b27ff04-9be1-45f6-aa34-a47dd2e7cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016994439910>]}
[0m14:22:40.669353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b27ff04-9be1-45f6-aa34-a47dd2e7cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001699412F9B0>]}
[0m14:22:40.671870 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:22:41.004801 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:22:41.336992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:22:41.337993 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:22:41.447799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b27ff04-9be1-45f6-aa34-a47dd2e7cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001699673F8F0>]}
[0m14:22:41.490789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b27ff04-9be1-45f6-aa34-a47dd2e7cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016996775910>]}
[0m14:22:41.491341 [info ] [MainThread]: Found 19 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 1 exposure, 437 macros
[0m14:22:41.492893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b27ff04-9be1-45f6-aa34-a47dd2e7cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016996746B10>]}
[0m14:22:41.500941 [info ] [MainThread]: 
[0m14:22:41.501493 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:22:41.510082 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_dbt'
[0m14:22:41.519221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_finance'
[0m14:22:41.661645 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m14:22:41.661645 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m14:22:41.663190 [debug] [ThreadPool]: On list_dev_3lcu_dbt: BEGIN
[0m14:22:41.663190 [debug] [ThreadPool]: On list_dev_3lcu_finance: BEGIN
[0m14:22:41.664203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:41.665234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:44.590892 [debug] [ThreadPool]: SQL status: BEGIN in 2.927 seconds
[0m14:22:44.591907 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m14:22:44.592902 [debug] [ThreadPool]: On list_dev_3lcu_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_dbt"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m14:22:44.608061 [debug] [ThreadPool]: SQL status: BEGIN in 2.943 seconds
[0m14:22:44.608061 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m14:22:44.609061 [debug] [ThreadPool]: On list_dev_3lcu_finance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_finance"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m14:22:44.941025 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.348 seconds
[0m14:22:44.943123 [debug] [ThreadPool]: On list_dev_3lcu_dbt: ROLLBACK
[0m14:22:44.955335 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.346 seconds
[0m14:22:44.957328 [debug] [ThreadPool]: On list_dev_3lcu_finance: ROLLBACK
[0m14:22:45.287764 [debug] [ThreadPool]: On list_dev_3lcu_dbt: Close
[0m14:22:45.301514 [debug] [ThreadPool]: On list_dev_3lcu_finance: Close
[0m14:22:45.308027 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:45.309027 [debug] [MainThread]: On master: BEGIN
[0m14:22:45.309027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:48.022893 [debug] [MainThread]: SQL status: BEGIN in 2.714 seconds
[0m14:22:48.023887 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:48.024848 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:22:48.555233 [debug] [MainThread]: SQL status: SELECT 4 in 0.530 seconds
[0m14:22:48.557236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b27ff04-9be1-45f6-aa34-a47dd2e7cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016995217440>]}
[0m14:22:48.558235 [debug] [MainThread]: On master: ROLLBACK
[0m14:22:48.893941 [debug] [MainThread]: On master: Close
[0m14:22:48.894942 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:22:48.895943 [info ] [MainThread]: 
[0m14:22:48.901453 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m14:22:48.902964 [debug] [Thread-2 (]: Began running node model.dbt_scooters.first_name_sex
[0m14:22:48.902964 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m14:22:48.903973 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_geom
[0m14:22:48.904972 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_scooters.events_clean'
[0m14:22:48.904972 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.first_name_sex'
[0m14:22:48.905973 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m14:22:48.906976 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m14:22:48.907977 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m14:22:48.907977 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.first_name_sex
[0m14:22:48.908976 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m14:22:48.909974 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_geom
[0m14:22:48.926189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m14:22:48.929192 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.first_name_sex"
[0m14:22:48.934216 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m14:22:48.937217 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m14:22:48.939218 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m14:22:48.940726 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m14:22:48.940726 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m14:22:48.941738 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m14:22:48.941738 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.first_name_sex
[0m14:22:48.943250 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m14:22:48.944261 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_geom
[0m14:22:48.944261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.trips_prep)
[0m14:22:48.945258 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.first_name_sex
[0m14:22:48.946258 [debug] [Thread-3 (]: Began running node operation.dbt_scooters.dbt_scooters-on-run-end-0
[0m14:22:48.947272 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_geom
[0m14:22:48.948259 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m14:22:48.948259 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.add_first_name_sex
[0m14:22:48.949259 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now operation.dbt_scooters.dbt_scooters-on-run-end-0)
[0m14:22:48.949259 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.age_groups
[0m14:22:48.953774 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m14:22:48.954774 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.first_name_sex, now seed.dbt_scooters.add_first_name_sex)
[0m14:22:48.955775 [debug] [Thread-3 (]: Began compiling node operation.dbt_scooters.dbt_scooters-on-run-end-0
[0m14:22:48.955775 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now seed.dbt_scooters.age_groups)
[0m14:22:48.956775 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.add_first_name_sex
[0m14:22:48.958776 [debug] [Thread-3 (]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m14:22:48.959776 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m14:22:48.959776 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.age_groups
[0m14:22:48.962796 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.add_first_name_sex
[0m14:22:48.963807 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m14:22:48.965806 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.age_groups
[0m14:22:48.966808 [debug] [Thread-3 (]: Began executing node operation.dbt_scooters.dbt_scooters-on-run-end-0
[0m14:22:48.967807 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.add_first_name_sex
[0m14:22:48.968805 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.event_types
[0m14:22:48.969808 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.age_groups
[0m14:22:48.970806 [debug] [Thread-3 (]: Finished running node operation.dbt_scooters.dbt_scooters-on-run-end-0
[0m14:22:48.971315 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.scooters
[0m14:22:48.971315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now seed.dbt_scooters.event_types)
[0m14:22:48.972897 [debug] [Thread-4 (]: Began running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m14:22:48.973906 [debug] [Thread-3 (]: Began running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m14:22:48.974906 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.add_first_name_sex, now seed.dbt_scooters.scooters)
[0m14:22:48.974906 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.event_types
[0m14:22:48.975906 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now test.dbt_scooters.every_event_has_user.7eea25f36c)
[0m14:22:48.976907 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly operation.dbt_scooters.dbt_scooters-on-run-end-0, now test.dbt_scooters.every_trip_has_user.6bc71135e2)
[0m14:22:48.976907 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.scooters
[0m14:22:48.978908 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.event_types
[0m14:22:48.979907 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m14:22:48.980907 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m14:22:48.982927 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.scooters
[0m14:22:48.983936 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.event_types
[0m14:22:48.996964 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m14:22:49.003995 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m14:22:49.004996 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.scooters
[0m14:22:49.005996 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m14:22:49.006999 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m14:22:49.007998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m14:22:49.008996 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m14:22:49.009998 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7)
[0m14:22:49.009998 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m14:22:49.010997 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m14:22:49.011508 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m14:22:49.013018 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m14:22:49.014028 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m14:22:49.024056 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m14:22:49.024056 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m14:22:49.034084 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m14:22:49.035086 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m14:22:49.036087 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_user.7eea25f36c, now test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b)
[0m14:22:49.037090 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m14:22:49.038085 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_user.6bc71135e2, now test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d)
[0m14:22:49.039090 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m14:22:49.039090 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m14:22:49.040088 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m14:22:49.041087 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m14:22:49.045118 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m14:22:49.047120 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m14:22:49.047120 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m14:22:49.051629 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m14:22:49.053140 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m14:22:49.054151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f)
[0m14:22:49.055148 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m14:22:49.055148 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7, now test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62)
[0m14:22:49.056153 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m14:22:49.057150 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m14:22:49.058150 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m14:22:49.058150 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m14:22:49.063168 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m14:22:49.064180 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m14:22:49.065178 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m14:22:49.069178 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m14:22:49.070177 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b, now test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d)
[0m14:22:49.071693 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m14:22:49.071693 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m14:22:49.073204 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m14:22:49.073204 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m14:22:49.074215 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m14:22:49.075216 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m14:22:49.079214 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m14:22:49.080726 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m14:22:49.081737 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m14:22:49.081737 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m14:22:49.088258 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m14:22:49.089261 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m14:22:49.089261 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m14:22:49.090772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f, now test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4)
[0m14:22:49.091784 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62, now test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf)
[0m14:22:49.092786 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m14:22:49.092786 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m14:22:49.093781 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m14:22:49.094784 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m14:22:49.094784 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m14:22:49.095783 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m14:22:49.104009 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m14:22:49.108009 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m14:22:49.109009 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d, now model.dbt_scooters.parking_finish_stat)
[0m14:22:49.109009 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_start_stat
[0m14:22:49.111012 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m14:22:49.111525 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now model.dbt_scooters.parking_start_stat)
[0m14:22:49.111525 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m14:22:49.119047 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m14:22:49.119047 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m14:22:49.120047 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m14:22:49.121046 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m14:22:49.121557 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m14:22:49.126150 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m14:22:49.127116 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m14:22:49.128118 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m14:22:49.129120 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat
[0m14:22:49.130116 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m14:22:49.131119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4, now model.dbt_scooters.revenue_daily)
[0m14:22:49.131635 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m14:22:49.131635 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf, now model.dbt_scooters.trips_stat)
[0m14:22:49.133141 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m14:22:49.134181 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m14:22:49.135181 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m14:22:49.135181 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat
[0m14:22:49.136148 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_finish_stat, now model.dbt_scooters.trips_stat_daily)
[0m14:22:49.140185 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m14:22:49.141657 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_users
[0m14:22:49.144246 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m14:22:49.145244 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m14:22:49.146212 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now model.dbt_scooters.trips_users)
[0m14:22:49.147214 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m14:22:49.150790 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m14:22:49.151804 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat
[0m14:22:49.151804 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_users
[0m14:22:49.152814 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m14:22:49.154799 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat
[0m14:22:49.158837 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m14:22:49.159834 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m14:22:49.160842 [debug] [Thread-1 (]: Began running node model.dbt_scooters.users_full
[0m14:22:49.161358 [debug] [Thread-2 (]: Began running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m14:22:49.162864 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m14:22:49.163872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.users_full)
[0m14:22:49.163872 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_users
[0m14:22:49.164915 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199)
[0m14:22:49.165872 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m14:22:49.166908 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.users_full
[0m14:22:49.167907 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_users
[0m14:22:49.167907 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m14:22:49.168875 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f)
[0m14:22:49.173058 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.users_full"
[0m14:22:49.174068 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m14:22:49.178066 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m14:22:49.179066 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m14:22:49.180070 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac)
[0m14:22:49.181116 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.users_full
[0m14:22:49.187322 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m14:22:49.188326 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m14:22:49.188326 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m14:22:49.189323 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.users_full
[0m14:22:49.190830 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m14:22:49.194876 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m14:22:49.195878 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m14:22:49.196840 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m14:22:49.197842 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m14:22:49.198838 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m14:22:49.199882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.users_full, now test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b)
[0m14:22:49.200846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199, now test.dbt_scooters.unique_not_null_age_groups_group.39342291f1)
[0m14:22:49.200846 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m14:22:49.201947 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_full
[0m14:22:49.202986 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m14:22:49.203951 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m14:22:49.204986 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m14:22:49.205973 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f, now model.dbt_scooters.events_full)
[0m14:22:49.210987 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m14:22:49.215103 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m14:22:49.216065 [debug] [Thread-3 (]: Began running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m14:22:49.217068 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_full
[0m14:22:49.218073 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac, now test.dbt_scooters.every_event_has_type.1e5fc977eb)
[0m14:22:49.224088 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m14:22:49.224088 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m14:22:49.225096 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m14:22:49.226088 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m14:22:49.227089 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m14:22:49.234262 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m14:22:49.235231 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_full
[0m14:22:49.236266 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m14:22:49.236266 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m14:22:49.238230 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_full
[0m14:22:49.239231 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m14:22:49.239231 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m14:22:49.240746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b, now test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1)
[0m14:22:49.240746 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies
[0m14:22:49.241792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_group.39342291f1, now test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85)
[0m14:22:49.242794 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m14:22:49.243755 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m14:22:49.244754 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.companies)
[0m14:22:49.244754 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m14:22:49.245797 [debug] [Thread-3 (]: Began running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m14:22:49.250795 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m14:22:49.251342 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies
[0m14:22:49.255895 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m14:22:49.256899 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_type.1e5fc977eb, now test.dbt_scooters.every_trip_has_scooter_id.e0b845a190)
[0m14:22:49.259895 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m14:22:49.260898 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m14:22:49.261978 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m14:22:49.262979 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m14:22:49.264017 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m14:22:49.271018 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m14:22:49.271531 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies
[0m14:22:49.271531 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m14:22:49.273106 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m14:22:49.274112 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies
[0m14:22:49.275114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1, now test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e)
[0m14:22:49.276118 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m14:22:49.277116 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m14:22:49.277116 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m14:22:49.278156 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m14:22:49.279115 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85, now test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d)
[0m14:22:49.280114 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m14:22:49.281113 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc)
[0m14:22:49.288223 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m14:22:49.289226 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m14:22:49.289226 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m14:22:49.290733 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m14:22:49.295780 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m14:22:49.296786 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_scooter_id.e0b845a190, now model.dbt_scooters.trips_age_daily)
[0m14:22:49.301326 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m14:22:49.301326 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m14:22:49.303846 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m14:22:49.304844 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m14:22:49.305880 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m14:22:49.308879 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m14:22:49.309848 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m14:22:49.309848 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_group
[0m14:22:49.311358 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m14:22:49.313914 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m14:22:49.314913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e, now model.dbt_scooters.trips_age_group)
[0m14:22:49.314913 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m14:22:49.315962 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_stat
[0m14:22:49.316916 [debug] [Thread-4 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m14:22:49.317913 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m14:22:49.318952 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m14:22:49.318952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d, now model.dbt_scooters.events_stat)
[0m14:22:49.319947 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc, now test.dbt_scooters.events_full_is_complete)
[0m14:22:49.324037 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m14:22:49.324996 [debug] [Thread-3 (]: Began running node model.dbt_scooters.companies_trips
[0m14:22:49.325995 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_stat
[0m14:22:49.325995 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m14:22:49.327035 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now model.dbt_scooters.companies_trips)
[0m14:22:49.331038 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m14:22:49.331584 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_group
[0m14:22:49.338177 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m14:22:49.338177 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.companies_trips
[0m14:22:49.340149 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_group
[0m14:22:49.344289 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m14:22:49.345291 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_stat
[0m14:22:49.346296 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m14:22:49.347252 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m14:22:49.348257 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_stat
[0m14:22:49.349258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_group, now model.dbt_scooters.trips_age_daily_stat)
[0m14:22:49.349258 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.companies_trips
[0m14:22:49.350803 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m14:22:49.351812 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m14:22:49.352818 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m14:22:49.353815 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.companies_trips
[0m14:22:49.354811 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m14:22:49.355814 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be)
[0m14:22:49.358818 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m14:22:49.359818 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m14:22:49.360812 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.events_full_is_complete, now test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e)
[0m14:22:49.361359 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m14:22:49.362874 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m14:22:49.362874 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m14:22:49.363920 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m14:22:49.370919 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m14:22:49.371463 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m14:22:49.378139 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m14:22:49.379108 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m14:22:49.384246 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m14:22:49.386210 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m14:22:49.387211 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m14:22:49.388209 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m14:22:49.389209 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m14:22:49.389209 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m14:22:49.391774 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m14:22:49.393734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:49.394733 [debug] [MainThread]: Connection 'list_dev_3lcu_dbt' was properly closed.
[0m14:22:49.394733 [debug] [MainThread]: Connection 'list_dev_3lcu_finance' was properly closed.
[0m14:22:49.395773 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m14:22:49.396738 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be' was properly closed.
[0m14:22:49.396738 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0' was properly closed.
[0m14:22:49.397772 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e' was properly closed.
[0m14:22:49.413008 [debug] [MainThread]: Command end result
[0m14:22:49.611710 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:22:49.612712 [info ] [MainThread]: Building catalog
[0m14:22:49.631743 [debug] [ThreadPool]: Acquiring new postgres connection 'dev_3lcu.information_schema'
[0m14:22:49.643850 [debug] [ThreadPool]: Using postgres connection "dev_3lcu.information_schema"
[0m14:22:49.644885 [debug] [ThreadPool]: On dev_3lcu.information_schema: BEGIN
[0m14:22:49.644885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:52.437777 [debug] [ThreadPool]: SQL status: BEGIN in 2.793 seconds
[0m14:22:52.438774 [debug] [ThreadPool]: Using postgres connection "dev_3lcu.information_schema"
[0m14:22:52.439733 [debug] [ThreadPool]: On dev_3lcu.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "dev_3lcu.information_schema"} */

    
    

    select
        'dev_3lcu' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('scooters_raw') and
           upper(tbl.relname) = upper('users')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('users_full')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_geom')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('age_groups')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_stat_daily')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_age_daily_stat')) or (upper(sch.nspname) = upper('scooters_raw') and
           upper(tbl.relname) = upper('trips')) or (upper(sch.nspname) = upper('finance') and
           upper(tbl.relname) = upper('revenue_daily')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_prep')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_stat')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_users')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('scooters')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('events_full')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('events_clean')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('parking_start_stat')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_age_daily')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('companies_trips')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_concurrency')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('trips_age_group')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('first_name_sex')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('events_stat')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('parking_finish_stat')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('companies')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('event_types')) or (upper(sch.nspname) = upper('scooters_raw') and
           upper(tbl.relname) = upper('events')) or (upper(sch.nspname) = upper('dbt') and
           upper(tbl.relname) = upper('add_first_name_sex')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:22:53.063141 [debug] [ThreadPool]: SQL status: SELECT 121 in 0.622 seconds
[0m14:22:53.070652 [debug] [ThreadPool]: On dev_3lcu.information_schema: ROLLBACK
[0m14:22:53.418769 [debug] [ThreadPool]: On dev_3lcu.information_schema: Close
[0m14:22:53.467911 [info ] [MainThread]: Catalog written to C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\dbt_scooters\target\catalog.json
[0m14:22:53.468878 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:22:53.468878 after 13.41 seconds
[0m14:22:53.469875 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:22:53.469875 [debug] [MainThread]: Connection 'dev_3lcu.information_schema' was properly closed.
[0m14:22:53.470872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016994FC4CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016994D7A270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016996A463C0>]}
[0m14:22:53.471376 [debug] [MainThread]: Flushing usage events
[0m14:23:11.900065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1462396D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A145A63290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A14294CF20>]}


============================== 14:23:11.907140 | bdfb4af2-4e50-4cbd-ac11-cf3ed9c19ca2 ==============================
[0m14:23:11.907140 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:23:11.908105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\dbt_scooters\\logs', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:23:12.223743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdfb4af2-4e50-4cbd-ac11-cf3ed9c19ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1463E63C0>]}
[0m14:23:12.310770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdfb4af2-4e50-4cbd-ac11-cf3ed9c19ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1463E5B50>]}
[0m14:24:19.494934 [error] [MainThread]: Encountered an error:

[0m14:24:19.503454 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 240, in serve_forever
    self._handle_request_noblock()
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 318, in _handle_request_noblock
    self.process_request(request, client_address)
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 349, in process_request
    self.finish_request(request, client_address)
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 672, in __init__
    super().__init__(*args, **kwargs)
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 761, in __init__
    self.handle()
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 436, in handle
    self.handle_one_request()
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 708, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m14:24:19.506456 [debug] [MainThread]: Command `dbt docs serve` failed at 14:24:19.506456 after 67.79 seconds
[0m14:24:19.507457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A146144140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A145A35760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A146576C00>]}
[0m14:24:19.508457 [debug] [MainThread]: Flushing usage events
