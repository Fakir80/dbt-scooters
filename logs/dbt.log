[0m11:04:02.356911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010ABC222120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010ABB2DE8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010ABB2DE600>]}


============================== 11:04:02.419917 | 9da2e87a-5434-44d2-8653-190dde384209 ==============================
[0m11:04:02.419917 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:04:02.421922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt init', 'send_anonymous_usage_stats': 'True'}
[0m11:04:02.802035 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse dict {'dir': WindowsPath('C:/Users/–ö–∏—Ä–∏–ª–ª/.dbt')}
[0m11:04:02.804035 [info ] [MainThread]: Creating dbt configuration folder at 
[0m11:04:35.722112 [debug] [MainThread]: Starter project path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\include\starter_project
[0m11:04:35.738888 [info ] [MainThread]: 
Your new dbt project "dbt_example" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m11:04:35.738888 [info ] [MainThread]: Setting up your profile.
[0m13:52:05.296074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C316FF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C35077230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C35075310>]}


============================== 13:52:05.302902 | 1797bbf4-1a27-4fdf-baf8-6ddf26e5af10 ==============================
[0m13:52:05.302902 [info ] [MainThread]: Running with dbt=1.8.8
[0m13:52:05.303902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt init dbt_scooters', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:05.351345 [debug] [MainThread]: Starter project path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\include\starter_project
[0m13:52:05.370357 [info ] [MainThread]: 
Your new dbt project "dbt_scooters" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m13:52:05.372349 [info ] [MainThread]: Setting up your profile.
[0m13:52:19.887444 [error] [MainThread]: Encountered an error:
list index out of range
[0m13:52:19.894453 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\cli\main.py", line 470, in init
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\task\init.py", line 347, in run
    self.setup_profile(profile_name)
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\task\init.py", line 262, in setup_profile
    adapter = self.ask_for_adapter_choice()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\task\init.py", line 244, in ask_for_adapter_choice
    return available_adapters[numeric_choice - 1]
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
IndexError: list index out of range

[0m13:52:19.897449 [debug] [MainThread]: Command `dbt init` failed at 13:52:19.897449 after 14.81 seconds
[0m13:52:19.898451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C316FF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C35C403B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C35DDDC70>]}
[0m13:52:19.899450 [debug] [MainThread]: Flushing usage events
[0m13:52:36.509231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78A558B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7B8D9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7B8DB530>]}


============================== 13:52:36.513199 | 6b5932c2-a5a4-4b90-9665-2b92e0a42070 ==============================
[0m13:52:36.513199 [info ] [MainThread]: Running with dbt=1.8.8
[0m13:52:36.514396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt init dbt_scooters', 'send_anonymous_usage_stats': 'True'}
[0m13:52:36.542436 [info ] [MainThread]: A project called dbt_scooters already exists here.
[0m13:52:36.544444 [debug] [MainThread]: Command `dbt init` succeeded at 13:52:36.543420 after 0.14 seconds
[0m13:52:36.544444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC78A558B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7CEDE1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7C9E1400>]}
[0m13:52:36.544444 [debug] [MainThread]: Flushing usage events
[0m13:57:20.326411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283694F05C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028368555910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002836C80B140>]}


============================== 13:57:20.331441 | cf7e9a90-ba58-485d-8038-a260a8e17681 ==============================
[0m13:57:20.331441 [info ] [MainThread]: Running with dbt=1.8.8
[0m13:57:20.332411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt init dbt_scooters', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:20.366986 [debug] [MainThread]: Starter project path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\include\starter_project
[0m13:57:20.385971 [info ] [MainThread]: 
Your new dbt project "dbt_scooters" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m13:57:20.386969 [info ] [MainThread]: Setting up your profile.
[0m14:00:38.164711 [info ] [MainThread]: Profile dbt_scooters written to C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m14:00:38.165738 [debug] [MainThread]: Command `dbt init` succeeded at 14:00:38.165738 after 197.96 seconds
[0m14:00:38.166744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002836C7CE930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002836CCA66F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002836B11DDC0>]}
[0m14:00:38.166744 [debug] [MainThread]: Flushing usage events
[0m14:07:27.602164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55E897C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55902570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55BAFE60>]}


============================== 14:07:27.607198 | 78ce7fe7-202c-48d3-8566-e8ec45270dac ==============================
[0m14:07:27.607198 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:07:27.607198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init dbt_scooters', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:27.641778 [debug] [MainThread]: Starter project path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\pypoetry\Cache\virtualenvs\pythonproject1-kC7AKq2D-py3.12\Lib\site-packages\dbt\include\starter_project
[0m14:07:27.660555 [info ] [MainThread]: 
Your new dbt project "dbt_scooters" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m14:07:27.660555 [info ] [MainThread]: Setting up your profile.
[0m14:10:08.368522 [info ] [MainThread]: Profile dbt_scooters written to C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m14:10:08.370107 [debug] [MainThread]: Command `dbt init` succeeded at 14:10:08.370107 after 160.96 seconds
[0m14:10:08.370107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55BE01A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55BE0CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF55A05DF0>]}
[0m14:10:08.371105 [debug] [MainThread]: Flushing usage events
[0m14:06:25.280447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119F1507BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119F1705D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119F0B65CD0>]}


============================== 14:06:25.292455 | 8bd29f6d-ecbd-4961-bb80-15509b7a103c ==============================
[0m14:06:25.292455 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:06:25.294456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'log_path': 'logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:25.384597 [info ] [MainThread]: dbt version: 1.8.8
[0m14:06:25.386638 [info ] [MainThread]: python version: 3.12.4
[0m14:06:25.388639 [info ] [MainThread]: python path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\python.exe
[0m14:06:25.390597 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m14:06:25.616436 [info ] [MainThread]: Using profiles dir at C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt
[0m14:06:25.617392 [info ] [MainThread]: Using profiles.yml file at C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt\profiles.yml
[0m14:06:25.619394 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml
[0m14:06:25.624451 [info ] [MainThread]: adapter type: postgres
[0m14:06:25.625444 [info ] [MainThread]: adapter version: 1.8.2
[0m14:06:25.627407 [info ] [MainThread]: Configuration:
[0m14:06:25.628403 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:06:25.630408 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:06:25.631405 [info ] [MainThread]: Required dependencies:
[0m14:06:25.633409 [debug] [MainThread]: Executing "git --help"
[0m14:06:25.706545 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:06:25.707545 [debug] [MainThread]: STDERR: "b''"
[0m14:06:25.708552 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:06:25.710563 [info ] [MainThread]: Connection:
[0m14:06:25.712566 [info ] [MainThread]:   host: dpg-cstl32lumphs73fqdrj0-a.oregon-postgres.render.com
[0m14:06:25.713573 [info ] [MainThread]:   port: 5432
[0m14:06:25.715564 [info ] [MainThread]:   user: admin
[0m14:06:25.716562 [info ] [MainThread]:   database: dev_oovf
[0m14:06:25.718563 [info ] [MainThread]:   schema: dbt
[0m14:06:25.720594 [info ] [MainThread]:   connect_timeout: 10
[0m14:06:25.721582 [info ] [MainThread]:   role: None
[0m14:06:25.723583 [info ] [MainThread]:   search_path: None
[0m14:06:25.724587 [info ] [MainThread]:   keepalives_idle: 0
[0m14:06:25.725584 [info ] [MainThread]:   sslmode: None
[0m14:06:25.726587 [info ] [MainThread]:   sslcert: None
[0m14:06:25.727590 [info ] [MainThread]:   sslkey: None
[0m14:06:25.729593 [info ] [MainThread]:   sslrootcert: None
[0m14:06:25.731610 [info ] [MainThread]:   application_name: dbt
[0m14:06:25.733606 [info ] [MainThread]:   retries: 1
[0m14:06:25.735603 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:06:25.737604 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:06:26.717455 [debug] [MainThread]: Using postgres connection "debug"
[0m14:06:26.718421 [debug] [MainThread]: On debug: select 1 as id
[0m14:06:26.718421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:27.667587 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "dpg-cstl32lumphs73fqdrj0-a.oregon-postgres.render.com" (35.227.164.209), port 5432 failed: SSL connection has been closed unexpectedly

[0m14:06:28.444921 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:06:28.445922 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:06:28.445922 [debug] [MainThread]: On debug: No close available on handle
[0m14:06:28.446922 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:06:28.447923 [info ] [MainThread]: [31m2 checks failed:[0m
[0m14:06:28.449434 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml> not found

[0m14:06:28.451443 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "dpg-cstl32lumphs73fqdrj0-a.oregon-postgres.render.com" (35.227.164.209), port 5432 failed: SSL connection has been closed unexpectedly
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:06:28.453443 [debug] [MainThread]: Command `dbt debug` failed at 14:06:28.453443 after 3.61 seconds
[0m14:06:28.454441 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:06:28.455443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119F149AF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119EF51F5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119F09BD610>]}
[0m14:06:28.456442 [debug] [MainThread]: Flushing usage events
[0m14:16:57.604435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C81EC4D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C816914C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C8441DD30>]}


============================== 14:16:57.609961 | 8beaa279-1c05-4f87-bf9a-96aa32e339ac ==============================
[0m14:16:57.609961 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:16:57.610962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:16:57.637036 [info ] [MainThread]: dbt version: 1.8.8
[0m14:16:57.638057 [info ] [MainThread]: python version: 3.12.4
[0m14:16:57.639051 [info ] [MainThread]: python path: C:\Users\–ö–∏—Ä–∏–ª–ª\AppData\Local\Programs\Python\Python312\python.exe
[0m14:16:57.640052 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m14:16:57.765191 [info ] [MainThread]: Using profiles dir at C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt
[0m14:16:57.766186 [info ] [MainThread]: Using profiles.yml file at C:\Users\–ö–∏—Ä–∏–ª–ª\.dbt\profiles.yml
[0m14:16:57.767191 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml
[0m14:16:57.769205 [info ] [MainThread]: adapter type: postgres
[0m14:16:57.770198 [info ] [MainThread]: adapter version: 1.8.2
[0m14:16:57.771204 [info ] [MainThread]: Configuration:
[0m14:16:57.772202 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:16:57.773201 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:16:57.774201 [info ] [MainThread]: Required dependencies:
[0m14:16:57.775208 [debug] [MainThread]: Executing "git --help"
[0m14:16:57.828278 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:16:57.829791 [debug] [MainThread]: STDERR: "b''"
[0m14:16:57.830803 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:16:57.831797 [info ] [MainThread]: Connection:
[0m14:16:57.832803 [info ] [MainThread]:   host: dpg-cu4f49rtq21c73cqam00-a.oregon-postgres.render.com
[0m14:16:57.833806 [info ] [MainThread]:   port: 5432
[0m14:16:57.834808 [info ] [MainThread]:   user: admin
[0m14:16:57.835807 [info ] [MainThread]:   database: dev_3lcu
[0m14:16:57.837324 [info ] [MainThread]:   schema: dbt
[0m14:16:57.838336 [info ] [MainThread]:   connect_timeout: 10
[0m14:16:57.840338 [info ] [MainThread]:   role: None
[0m14:16:57.841341 [info ] [MainThread]:   search_path: None
[0m14:16:57.842345 [info ] [MainThread]:   keepalives_idle: 0
[0m14:16:57.843341 [info ] [MainThread]:   sslmode: None
[0m14:16:57.844339 [info ] [MainThread]:   sslcert: None
[0m14:16:57.845346 [info ] [MainThread]:   sslkey: None
[0m14:16:57.846344 [info ] [MainThread]:   sslrootcert: None
[0m14:16:57.847355 [info ] [MainThread]:   application_name: dbt
[0m14:16:57.848360 [info ] [MainThread]:   retries: 1
[0m14:16:57.849354 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:16:57.851362 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:16:57.983018 [debug] [MainThread]: Using postgres connection "debug"
[0m14:16:57.984019 [debug] [MainThread]: On debug: select 1 as id
[0m14:16:57.984019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:01.726035 [debug] [MainThread]: SQL status: SELECT 1 in 3.741 seconds
[0m14:17:01.727035 [debug] [MainThread]: On debug: Close
[0m14:17:01.728069 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:17:01.729032 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:17:01.730036 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml> not found

[0m14:17:01.732034 [debug] [MainThread]: Command `dbt debug` failed at 14:17:01.731036 after 4.44 seconds
[0m14:17:01.732034 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:17:01.733071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C8441DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C84BBF500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C839E4D40>]}
[0m14:17:01.734034 [debug] [MainThread]: Flushing usage events
[0m16:50:57.531694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990A452000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990C6585C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990C659190>]}


============================== 16:50:57.538706 | 20fdb56c-b56b-4f9b-b172-9784803d7d2e ==============================
[0m16:50:57.538706 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:50:57.539704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s trips_stat', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:50:57.541739 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:50:57.543703 [debug] [MainThread]: Command `dbt run` failed at 16:50:57.543703 after 0.36 seconds
[0m16:50:57.544706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990CE5FA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990A452000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990CCED460>]}
[0m16:50:57.545706 [debug] [MainThread]: Flushing usage events
[0m17:23:11.143983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C1F87D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C1F87F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C1F87500>]}


============================== 17:23:11.151054 | 7ae652cd-8b06-49fb-9ac9-52c9dd338b07 ==============================
[0m17:23:11.151054 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:23:11.152008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:23:11.153011 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\–ö–∏—Ä–∏–ª–ª\PycharmProjects\dbtexample\pythonProject1\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m17:23:11.155008 [debug] [MainThread]: Command `dbt seed` failed at 17:23:11.155008 after 0.35 seconds
[0m17:23:11.156013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C216C5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C2145EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C23B4740>]}
[0m17:23:11.157425 [debug] [MainThread]: Flushing usage events
[0m22:31:50.720835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293134C5FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029316AA6CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029313625A60>]}


============================== 22:31:50.730845 | ea7bb894-dacf-4e9c-9513-b072bff12f0a ==============================
[0m22:31:50.730845 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:31:50.731850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\–ö–∏—Ä–∏–ª–ª\\PycharmProjects\\dbtexample\\pythonProject1\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:31:51.088874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293171B4B60>]}
[0m22:31:51.179005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029314AA6B10>]}
[0m22:31:51.183014 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:31:51.547293 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:31:51.760987 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m22:31:51.761986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293166F17C0>]}
[0m22:31:54.535006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293186541A0>]}
[0m22:31:54.814695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029317006CC0>]}
[0m22:31:54.816697 [info ] [MainThread]: Found 19 models, 28 data tests, 4 seeds, 1 operation, 3 sources, 437 macros
[0m22:31:54.828695 [info ] [MainThread]: 
[0m22:31:54.830701 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:31:54.839700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m22:31:54.856085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu'
[0m22:31:55.126900 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m22:31:55.127899 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu"
[0m22:31:55.128908 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m22:31:55.128908 [debug] [ThreadPool]: On list_dev_3lcu: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu"} */

    select distinct nspname from pg_namespace
  
[0m22:31:55.129907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:55.130903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:58.057976 [debug] [ThreadPool]: SQL status: SELECT 21 in 2.927 seconds
[0m22:31:58.059939 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m22:31:58.245780 [debug] [ThreadPool]: SQL status: SELECT 21 in 3.116 seconds
[0m22:31:58.247281 [debug] [ThreadPool]: On list_dev_3lcu: Close
[0m22:31:58.251848 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_dbt'
[0m22:31:58.257887 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m22:31:58.258852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_3lcu_finance'
[0m22:31:58.258852 [debug] [ThreadPool]: On list_dev_3lcu_dbt: BEGIN
[0m22:31:58.260899 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m22:31:58.261890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:58.262852 [debug] [ThreadPool]: On list_dev_3lcu_finance: BEGIN
[0m22:31:58.262852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:01.031073 [debug] [ThreadPool]: SQL status: BEGIN in 2.769 seconds
[0m22:32:01.032067 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_dbt"
[0m22:32:01.033054 [debug] [ThreadPool]: On list_dev_3lcu_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_dbt"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m22:32:01.374993 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.342 seconds
[0m22:32:01.376988 [debug] [ThreadPool]: On list_dev_3lcu_dbt: ROLLBACK
[0m22:32:01.714123 [debug] [ThreadPool]: On list_dev_3lcu_dbt: Close
[0m22:32:02.261241 [debug] [ThreadPool]: SQL status: BEGIN in 3.998 seconds
[0m22:32:02.262241 [debug] [ThreadPool]: Using postgres connection "list_dev_3lcu_finance"
[0m22:32:02.262241 [debug] [ThreadPool]: On list_dev_3lcu_finance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_3lcu_finance"} */
select
      'dev_3lcu' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_3lcu' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m22:32:02.649914 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.387 seconds
[0m22:32:02.651953 [debug] [ThreadPool]: On list_dev_3lcu_finance: ROLLBACK
[0m22:32:03.013025 [debug] [ThreadPool]: On list_dev_3lcu_finance: Close
[0m22:32:03.019971 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:03.019971 [debug] [MainThread]: On master: BEGIN
[0m22:32:03.020971 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:32:06.772165 [debug] [MainThread]: SQL status: BEGIN in 3.751 seconds
[0m22:32:06.773118 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:06.773118 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:32:07.239755 [debug] [MainThread]: SQL status: SELECT 4 in 0.465 seconds
[0m22:32:07.241757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293186D2A80>]}
[0m22:32:07.242754 [debug] [MainThread]: On master: ROLLBACK
[0m22:32:07.579668 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:07.579668 [debug] [MainThread]: On master: BEGIN
[0m22:32:08.257861 [debug] [MainThread]: SQL status: BEGIN in 0.677 seconds
[0m22:32:08.258814 [debug] [MainThread]: On master: COMMIT
[0m22:32:08.258814 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:08.259814 [debug] [MainThread]: On master: COMMIT
[0m22:32:08.608727 [debug] [MainThread]: SQL status: COMMIT in 0.349 seconds
[0m22:32:08.609721 [debug] [MainThread]: On master: Close
[0m22:32:08.610685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:32:08.611680 [info ] [MainThread]: 
[0m22:32:08.619680 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.add_first_name_sex
[0m22:32:08.620690 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m22:32:08.620690 [debug] [Thread-3 (]: Began running node seed.dbt_scooters.event_types
[0m22:32:08.621697 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.scooters
[0m22:32:08.622688 [info ] [Thread-1 (]: 1 of 51 START seed file dbt.add_first_name_sex ................................. [RUN]
[0m22:32:08.623687 [info ] [Thread-2 (]: 2 of 51 START seed file dbt.age_groups ......................................... [RUN]
[0m22:32:08.624690 [info ] [Thread-3 (]: 3 of 51 START seed file dbt.event_types ........................................ [RUN]
[0m22:32:08.625688 [info ] [Thread-4 (]: 4 of 51 START seed file dbt.scooters ........................................... [RUN]
[0m22:32:08.625688 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.dbt_scooters.add_first_name_sex'
[0m22:32:08.626694 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.dbt_scooters.age_groups'
[0m22:32:08.627725 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.dbt_scooters.event_types'
[0m22:32:08.628687 [debug] [Thread-4 (]: Acquiring new postgres connection 'seed.dbt_scooters.scooters'
[0m22:32:08.628687 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.add_first_name_sex
[0m22:32:08.629725 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m22:32:08.629725 [debug] [Thread-3 (]: Began compiling node seed.dbt_scooters.event_types
[0m22:32:08.630730 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.scooters
[0m22:32:08.630730 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.add_first_name_sex
[0m22:32:08.631687 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m22:32:08.631687 [debug] [Thread-3 (]: Began executing node seed.dbt_scooters.event_types
[0m22:32:08.632689 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.scooters
[0m22:32:08.667211 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:08.671728 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:08.679730 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:08.680739 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: BEGIN
[0m22:32:08.684739 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:08.685737 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m22:32:08.685737 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: BEGIN
[0m22:32:08.686737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:32:08.686737 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: BEGIN
[0m22:32:08.687735 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:32:08.688739 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:32:08.689738 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:32:11.392783 [debug] [Thread-1 (]: SQL status: BEGIN in 2.706 seconds
[0m22:32:11.393741 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:11.393741 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */
truncate table "dev_3lcu"."dbt"."add_first_name_sex"
[0m22:32:11.467794 [debug] [Thread-3 (]: SQL status: BEGIN in 2.779 seconds
[0m22:32:11.468343 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:11.468343 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_3lcu"."dbt"."event_types"
[0m22:32:11.469891 [debug] [Thread-2 (]: SQL status: BEGIN in 2.782 seconds
[0m22:32:11.469891 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:11.470941 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_3lcu"."dbt"."age_groups"
[0m22:32:11.492897 [debug] [Thread-4 (]: SQL status: BEGIN in 2.803 seconds
[0m22:32:11.493900 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:11.493900 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_3lcu"."dbt"."scooters"
[0m22:32:11.737836 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.343 seconds
[0m22:32:11.753836 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:11.754838 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: 
          insert into "dev_3lcu"."dbt"."add_first_name_sex" ("first_name", "sex") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m22:32:11.814703 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.346 seconds
[0m22:32:11.817696 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:11.817696 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_3lcu"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m22:32:11.834660 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.363 seconds
[0m22:32:11.837699 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:11.838698 [debug] [Thread-4 (]: SQL status: TRUNCATE TABLE in 0.344 seconds
[0m22:32:11.838698 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_3lcu"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m22:32:11.842697 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:11.843696 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_3lcu"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m22:32:12.096055 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.341 seconds
[0m22:32:12.102020 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.add_first_name_sex"
[0m22:32:12.127039 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:12.128039 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  comment on table "dev_3lcu"."dbt"."add_first_name_sex" is $dbt_comment_literal_block$additional name_sex glossary$dbt_comment_literal_block$;

  
[0m22:32:12.157081 [debug] [Thread-3 (]: SQL status: INSERT 0 4 in 0.339 seconds
[0m22:32:12.158079 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m22:32:12.161080 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:12.162079 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  comment on table "dev_3lcu"."dbt"."event_types" is $dbt_comment_literal_block$Table provides a mapping between unique event type identifiers (`type_id`) and their descriptive names (`type`). It is essential for converting numerical codes from user activity logs into readable descriptions for analysis of user interactions with application features.

The table is crucial for analytics and reporting, allowing for the decoding of event identifiers in user activity datasets. By joining with event logs, it facilitates intuitive reporting and dashboarding of user interactions. The mapping enables effective segmentation and analysis of user activities, such as:

- **start_search**: Represents the initiation of a search process by a user.
- **book_scooter**: Indicates that a user has booked a scooter.
- **release_scooter**: Signifies that a user has released a previously booked scooter.
- **cancel_search**: Denotes the cancellation of a search process by a user.$dbt_comment_literal_block$;

  
[0m22:32:12.185709 [debug] [Thread-4 (]: SQL status: INSERT 0 10 in 0.341 seconds
[0m22:32:12.186710 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m22:32:12.189705 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:12.189705 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  comment on table "dev_3lcu"."dbt"."scooters" is $dbt_comment_literal_block$Scooter models information and park statistics by model. Includes information about the manufacturing company. Data received from the service team and uploaded by Mark. Data is current as of summer 2023.
$dbt_comment_literal_block$;

  
[0m22:32:12.191712 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.348 seconds
[0m22:32:12.192712 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m22:32:12.194713 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:12.195712 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  comment on table "dev_3lcu"."dbt"."age_groups" is $dbt_comment_literal_block$Age groups to split users for analysis$dbt_comment_literal_block$;

  
[0m22:32:12.465970 [debug] [Thread-1 (]: SQL status: COMMENT in 0.338 seconds
[0m22:32:12.488953 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:12.488953 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'add_first_name_sex'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:12.498965 [debug] [Thread-3 (]: SQL status: COMMENT in 0.336 seconds
[0m22:32:12.502002 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:12.503000 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'event_types'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:12.526958 [debug] [Thread-4 (]: SQL status: COMMENT in 0.337 seconds
[0m22:32:12.530959 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:12.531962 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'scooters'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:12.531962 [debug] [Thread-2 (]: SQL status: COMMENT in 0.336 seconds
[0m22:32:12.534959 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:12.535959 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'age_groups'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:12.843711 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.353 seconds
[0m22:32:12.847711 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:12.848712 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.add_first_name_sex"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."add_first_name_sex".first_name is $dbt_comment_literal_block$First name of user$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."add_first_name_sex".sex is $dbt_comment_literal_block$user gender$dbt_comment_literal_block$;
  

  
[0m22:32:12.936943 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.404 seconds
[0m22:32:12.938908 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:12.939945 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".company is $dbt_comment_literal_block$Scooter company model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".model is $dbt_comment_literal_block$Scooter model name$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".hardware_id is $dbt_comment_literal_block$scooter model id$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."scooters".scooters is $dbt_comment_literal_block$Count of scooters$dbt_comment_literal_block$;
  

  
[0m22:32:13.040692 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.537 seconds
[0m22:32:13.040692 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.505 seconds
[0m22:32:13.042741 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:13.045734 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:13.045734 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."event_types".type_id is $dbt_comment_literal_block$An integer serving as a unique identifier for each event type. It is used in user event tables as a foreign key to link events to their descriptions
$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."event_types".type is $dbt_comment_literal_block$A string describing the event type, enhancing the interpretability of event data by providing a human-readable label
$dbt_comment_literal_block$;
  

  
[0m22:32:13.046730 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".group is $dbt_comment_literal_block$Age group name for report$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".age_start is $dbt_comment_literal_block$Start age of group$dbt_comment_literal_block$;
  
    
    
    comment on column "dev_3lcu"."dbt"."age_groups".age_end is $dbt_comment_literal_block$End age of group$dbt_comment_literal_block$;
  

  
[0m22:32:13.187112 [debug] [Thread-1 (]: SQL status: COMMENT in 0.338 seconds
[0m22:32:13.189068 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m22:32:13.190075 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.add_first_name_sex"
[0m22:32:13.190075 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: COMMIT
[0m22:32:13.275324 [debug] [Thread-4 (]: SQL status: COMMENT in 0.335 seconds
[0m22:32:13.276325 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m22:32:13.277328 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:32:13.277328 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m22:32:13.463047 [debug] [Thread-3 (]: SQL status: COMMENT in 0.415 seconds
[0m22:32:13.465044 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m22:32:13.465044 [debug] [Thread-2 (]: SQL status: COMMENT in 0.418 seconds
[0m22:32:13.466042 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:32:13.467049 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m22:32:13.468042 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: COMMIT
[0m22:32:13.469011 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:32:13.469011 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m22:32:13.530028 [debug] [Thread-1 (]: SQL status: COMMIT in 0.339 seconds
[0m22:32:13.532029 [debug] [Thread-1 (]: On seed.dbt_scooters.add_first_name_sex: Close
[0m22:32:13.534031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319297230>]}
[0m22:32:13.535029 [info ] [Thread-1 (]: 1 of 51 OK loaded seed file dbt.add_first_name_sex ............................. [[32mINSERT 5[0m in 4.91s]
[0m22:32:13.536034 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.add_first_name_sex
[0m22:32:13.537034 [debug] [Thread-1 (]: Began running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m22:32:13.538030 [info ] [Thread-1 (]: 5 of 51 START test every_event_has_user ........................................ [RUN]
[0m22:32:13.538030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.add_first_name_sex, now test.dbt_scooters.every_event_has_user.7eea25f36c)
[0m22:32:13.539032 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m22:32:13.550047 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m22:32:13.551051 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m22:32:13.569566 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m22:32:13.571573 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m22:32:13.571573 [debug] [Thread-1 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: BEGIN
[0m22:32:13.572575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:13.613613 [debug] [Thread-4 (]: SQL status: COMMIT in 0.336 seconds
[0m22:32:13.615611 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: Close
[0m22:32:13.616611 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293191587D0>]}
[0m22:32:13.616611 [info ] [Thread-4 (]: 4 of 51 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 4.99s]
[0m22:32:13.618612 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.scooters
[0m22:32:13.618612 [debug] [Thread-4 (]: Began running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m22:32:13.619615 [info ] [Thread-4 (]: 6 of 51 START test every_trip_has_user ......................................... [RUN]
[0m22:32:13.620623 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now test.dbt_scooters.every_trip_has_user.6bc71135e2)
[0m22:32:13.621623 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m22:32:13.627626 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m22:32:13.629626 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m22:32:13.631631 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m22:32:13.632631 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m22:32:13.633639 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: BEGIN
[0m22:32:13.634639 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:14.011943 [debug] [Thread-3 (]: SQL status: COMMIT in 0.542 seconds
[0m22:32:14.012943 [debug] [Thread-2 (]: SQL status: COMMIT in 0.542 seconds
[0m22:32:14.013982 [debug] [Thread-3 (]: On seed.dbt_scooters.event_types: Close
[0m22:32:14.014983 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m22:32:14.015940 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931915B050>]}
[0m22:32:14.015940 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931926FDA0>]}
[0m22:32:14.016993 [info ] [Thread-3 (]: 3 of 51 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 5.39s]
[0m22:32:14.017944 [info ] [Thread-2 (]: 2 of 51 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 5.39s]
[0m22:32:14.019943 [debug] [Thread-3 (]: Finished running node seed.dbt_scooters.event_types
[0m22:32:14.020942 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m22:32:14.021942 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:32:14.022943 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m22:32:14.023940 [info ] [Thread-3 (]: 7 of 51 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m22:32:14.024946 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m22:32:14.023940 [info ] [Thread-2 (]: 8 of 51 START test source_not_null_scooters_raw_events_type_id ................. [RUN]
[0m22:32:14.025950 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:32:14.026948 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7)
[0m22:32:14.031979 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:32:14.032942 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m22:32:14.042981 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m22:32:14.043982 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:32:14.046939 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:32:14.047945 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m22:32:14.049949 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m22:32:14.050953 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:32:14.051951 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m22:32:14.051951 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:14.052955 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m22:32:14.053953 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: BEGIN
[0m22:32:14.053953 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:16.351767 [debug] [Thread-4 (]: SQL status: BEGIN in 2.718 seconds
[0m22:32:16.352766 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.every_trip_has_user.6bc71135e2"
[0m22:32:16.353768 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_user.6bc71135e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:32:16.369773 [debug] [Thread-1 (]: SQL status: BEGIN in 2.797 seconds
[0m22:32:16.369773 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.every_event_has_user.7eea25f36c"
[0m22:32:16.369773 [debug] [Thread-1 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_user.7eea25f36c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_3lcu"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:32:16.935691 [debug] [Thread-2 (]: SQL status: BEGIN in 2.882 seconds
[0m22:32:16.936692 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"
[0m22:32:16.937692 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from "dev_3lcu"."scooters_raw"."events"
where type_id is null



      
    ) dbt_internal_test
[0m22:32:16.937692 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.584 seconds
[0m22:32:16.941701 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: ROLLBACK
[0m22:32:16.966705 [debug] [Thread-3 (]: SQL status: BEGIN in 2.915 seconds
[0m22:32:16.967710 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:32:16.967710 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m22:32:17.342020 [debug] [Thread-4 (]: On test.dbt_scooters.every_trip_has_user.6bc71135e2: Close
[0m22:32:17.344023 [info ] [Thread-4 (]: 6 of 51 PASS every_trip_has_user ............................................... [[32mPASS[0m in 3.72s]
[0m22:32:17.345025 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.every_trip_has_user.6bc71135e2
[0m22:32:17.345025 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m22:32:17.346028 [info ] [Thread-4 (]: 9 of 51 START test source_not_null_scooters_raw_events_user_id ................. [RUN]
[0m22:32:17.347021 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_user.6bc71135e2, now test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b)
[0m22:32:17.348022 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m22:32:17.352026 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m22:32:17.353028 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m22:32:17.356029 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m22:32:17.358028 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m22:32:17.358028 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: BEGIN
[0m22:32:17.359027 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:17.370038 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.401 seconds
[0m22:32:17.372037 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m22:32:17.741857 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m22:32:17.742859 [info ] [Thread-3 (]: 7 of 51 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 3.72s]
[0m22:32:17.743861 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:32:17.744862 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m22:32:17.745859 [info ] [Thread-3 (]: 10 of 51 START test source_not_null_scooters_raw_trips_id ...................... [RUN]
[0m22:32:17.745859 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d)
[0m22:32:17.746865 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m22:32:17.750866 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m22:32:17.753870 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m22:32:17.756867 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m22:32:17.757867 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m22:32:17.758873 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: BEGIN
[0m22:32:17.758873 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:18.142707 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.771 seconds
[0m22:32:18.144712 [debug] [Thread-1 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: ROLLBACK
[0m22:32:18.251804 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.313 seconds
[0m22:32:18.253811 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: ROLLBACK
[0m22:32:18.485002 [debug] [Thread-1 (]: On test.dbt_scooters.every_event_has_user.7eea25f36c: Close
[0m22:32:18.486004 [info ] [Thread-1 (]: 5 of 51 PASS every_event_has_user .............................................. [[32mPASS[0m in 4.95s]
[0m22:32:18.487004 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.every_event_has_user.7eea25f36c
[0m22:32:18.488011 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m22:32:18.489012 [info ] [Thread-1 (]: 11 of 51 START test source_not_null_scooters_raw_trips_scooter_hw_id ........... [RUN]
[0m22:32:18.490003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_user.7eea25f36c, now test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f)
[0m22:32:18.490003 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m22:32:18.495050 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m22:32:18.496005 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m22:32:18.499008 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m22:32:18.501042 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m22:32:18.501042 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: BEGIN
[0m22:32:18.502047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:18.595612 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7: Close
[0m22:32:18.596615 [info ] [Thread-2 (]: 8 of 51 PASS source_not_null_scooters_raw_events_type_id ....................... [[32mPASS[0m in 4.57s]
[0m22:32:18.597613 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7
[0m22:32:18.598653 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m22:32:18.599653 [info ] [Thread-2 (]: 12 of 51 START test source_not_null_scooters_raw_trips_user_id ................. [RUN]
[0m22:32:18.600615 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_type_id.2afc2e8da7, now test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62)
[0m22:32:18.601647 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m22:32:18.605609 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m22:32:18.607612 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m22:32:18.609647 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m22:32:18.611614 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m22:32:18.611614 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: BEGIN
[0m22:32:18.612611 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:20.949709 [debug] [Thread-4 (]: SQL status: BEGIN in 3.590 seconds
[0m22:32:20.949709 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"
[0m22:32:20.950720 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."events"
where user_id is null



      
    ) dbt_internal_test
[0m22:32:21.211931 [debug] [Thread-1 (]: SQL status: BEGIN in 2.710 seconds
[0m22:32:21.211931 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"
[0m22:32:21.212934 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select scooter_hw_id
from "dev_3lcu"."scooters_raw"."trips"
where scooter_hw_id is null



      
    ) dbt_internal_test
[0m22:32:21.337006 [debug] [Thread-2 (]: SQL status: BEGIN in 2.725 seconds
[0m22:32:21.338006 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m22:32:21.339008 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev_3lcu"."scooters_raw"."trips"
where user_id is null



      
    ) dbt_internal_test
[0m22:32:21.390067 [debug] [Thread-3 (]: SQL status: BEGIN in 3.631 seconds
[0m22:32:21.391065 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"
[0m22:32:21.391065 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."trips"
where id is null



      
    ) dbt_internal_test
[0m22:32:21.540690 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.590 seconds
[0m22:32:21.542691 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: ROLLBACK
[0m22:32:21.654765 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.442 seconds
[0m22:32:21.656764 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: ROLLBACK
[0m22:32:21.839911 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.448 seconds
[0m22:32:21.841913 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: ROLLBACK
[0m22:32:21.841913 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.503 seconds
[0m22:32:21.843908 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: ROLLBACK
[0m22:32:21.933977 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b: Close
[0m22:32:21.934982 [info ] [Thread-4 (]: 9 of 51 PASS source_not_null_scooters_raw_events_user_id ....................... [[32mPASS[0m in 4.59s]
[0m22:32:21.936981 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b
[0m22:32:21.936981 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m22:32:21.937983 [info ] [Thread-4 (]: 13 of 51 START test source_not_null_scooters_raw_users_id ...................... [RUN]
[0m22:32:21.938980 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_events_user_id.fd504a587b, now test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d)
[0m22:32:21.938980 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m22:32:21.943984 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m22:32:21.944985 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m22:32:21.949996 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m22:32:21.952002 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m22:32:21.952002 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: BEGIN
[0m22:32:21.952996 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:21.996040 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f: Close
[0m22:32:21.997046 [info ] [Thread-1 (]: 11 of 51 PASS source_not_null_scooters_raw_trips_scooter_hw_id ................. [[32mPASS[0m in 3.51s]
[0m22:32:21.999050 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f
[0m22:32:22.000059 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:32:22.000059 [info ] [Thread-1 (]: 14 of 51 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m22:32:22.001061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_scooter_hw_id.af3bf5547f, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m22:32:22.002058 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:32:22.063619 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:32:22.064618 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:32:22.067616 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:32:22.068615 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:32:22.069622 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m22:32:22.069622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:22.182736 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: Close
[0m22:32:22.183738 [info ] [Thread-2 (]: 12 of 51 PASS source_not_null_scooters_raw_trips_user_id ....................... [[32mPASS[0m in 3.58s]
[0m22:32:22.184737 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m22:32:22.185741 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m22:32:22.186733 [info ] [Thread-2 (]: 15 of 51 START test source_unique_scooters_raw_trips_id ........................ [RUN]
[0m22:32:22.187737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62, now test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4)
[0m22:32:22.187737 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m22:32:22.194743 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m22:32:22.195744 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m22:32:22.198745 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m22:32:22.200760 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m22:32:22.200760 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: BEGIN
[0m22:32:22.201748 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:22.203752 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d: Close
[0m22:32:22.204749 [info ] [Thread-3 (]: 10 of 51 PASS source_not_null_scooters_raw_trips_id ............................ [[32mPASS[0m in 4.46s]
[0m22:32:22.205751 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d
[0m22:32:22.206752 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m22:32:22.207750 [info ] [Thread-3 (]: 16 of 51 START test source_unique_scooters_raw_users_id ........................ [RUN]
[0m22:32:22.207750 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_id.fdaf81f42d, now test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf)
[0m22:32:22.208751 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m22:32:22.212755 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m22:32:22.213754 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m22:32:22.216753 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m22:32:22.218763 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m22:32:22.219755 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: BEGIN
[0m22:32:22.219755 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:24.802925 [debug] [Thread-1 (]: SQL status: BEGIN in 2.733 seconds
[0m22:32:24.803931 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:32:24.803931 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sex
from "dev_3lcu"."scooters_raw"."users"
where sex is null



      
    ) dbt_internal_test
[0m22:32:24.810934 [debug] [Thread-4 (]: SQL status: BEGIN in 2.858 seconds
[0m22:32:24.811937 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"
[0m22:32:24.811937 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev_3lcu"."scooters_raw"."users"
where id is null



      
    ) dbt_internal_test
[0m22:32:25.172018 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.367 seconds
[0m22:32:25.174019 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m22:32:25.178021 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.365 seconds
[0m22:32:25.180536 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: ROLLBACK
[0m22:32:25.301604 [debug] [Thread-2 (]: SQL status: BEGIN in 3.100 seconds
[0m22:32:25.301604 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"
[0m22:32:25.302606 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."trips"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:32:25.582172 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d: Close
[0m22:32:25.583175 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m22:32:25.583175 [info ] [Thread-4 (]: 13 of 51 PASS source_not_null_scooters_raw_users_id ............................ [[32mPASS[0m in 3.64s]
[0m22:32:25.584172 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d
[0m22:32:25.586175 [debug] [Thread-4 (]: Began running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m22:32:25.585176 [warn ] [Thread-1 (]: 14 of 51 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 3.58s]
[0m22:32:25.588178 [info ] [Thread-4 (]: 17 of 51 START test accepted_values_add_first_name_sex_sex__M__F ............... [RUN]
[0m22:32:25.588178 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:32:25.589686 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_id.c36d39e56d, now test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199)
[0m22:32:25.590697 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m22:32:25.592699 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m22:32:25.592699 [info ] [Thread-1 (]: 18 of 51 START test unique_not_null_add_first_name_sex_first_name .............. [RUN]
[0m22:32:25.597693 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m22:32:25.597693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f)
[0m22:32:25.598697 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m22:32:25.603694 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m22:32:25.604698 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m22:32:25.606699 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m22:32:25.607698 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m22:32:25.611693 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m22:32:25.611693 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m22:32:25.612696 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: BEGIN
[0m22:32:25.613696 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:25.614697 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m22:32:25.614697 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: BEGIN
[0m22:32:25.615698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:25.835792 [debug] [Thread-3 (]: SQL status: BEGIN in 3.616 seconds
[0m22:32:25.836796 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"
[0m22:32:25.837806 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev_3lcu"."scooters_raw"."users"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:32:26.237781 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.400 seconds
[0m22:32:26.239775 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: ROLLBACK
[0m22:32:26.578803 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf: Close
[0m22:32:26.580924 [info ] [Thread-3 (]: 16 of 51 PASS source_unique_scooters_raw_users_id .............................. [[32mPASS[0m in 4.37s]
[0m22:32:26.581923 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf
[0m22:32:26.582925 [debug] [Thread-3 (]: Began running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m22:32:26.583922 [info ] [Thread-3 (]: 19 of 51 START test every_trip_has_scooter_id .................................. [RUN]
[0m22:32:26.583922 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_users_id.009484fddf, now test.dbt_scooters.every_trip_has_scooter_id.e0b845a190)
[0m22:32:26.584965 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m22:32:26.589962 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m22:32:26.591924 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m22:32:26.594961 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m22:32:26.596924 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m22:32:26.596924 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: BEGIN
[0m22:32:26.597959 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:26.646924 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.344 seconds
[0m22:32:26.649930 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: ROLLBACK
[0m22:32:26.986250 [debug] [Thread-2 (]: On test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4: Close
[0m22:32:26.988218 [info ] [Thread-2 (]: 15 of 51 PASS source_unique_scooters_raw_trips_id .............................. [[32mPASS[0m in 4.80s]
[0m22:32:26.989763 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4
[0m22:32:26.990772 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m22:32:26.991771 [info ] [Thread-2 (]: 20 of 51 START test unique_key_scooters_company__model__hardware_id ............ [RUN]
[0m22:32:26.992772 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_trips_id.c9c84bb1e4, now test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e)
[0m22:32:26.993772 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m22:32:26.999772 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m22:32:27.001782 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m22:32:27.004785 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m22:32:27.007785 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m22:32:27.007785 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: BEGIN
[0m22:32:27.008780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:28.325890 [debug] [Thread-4 (]: SQL status: BEGIN in 2.712 seconds
[0m22:32:28.326891 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"
[0m22:32:28.327889 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_3lcu"."dbt"."add_first_name_sex"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



      
    ) dbt_internal_test
[0m22:32:28.331903 [debug] [Thread-1 (]: SQL status: BEGIN in 2.716 seconds
[0m22:32:28.332911 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"
[0m22:32:28.333905 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "first_name"
from
    "dev_3lcu"."dbt"."add_first_name_sex"
group by
    1
having
    count(*) > 1 or "first_name" is null


      
    ) dbt_internal_test
[0m22:32:28.668630 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.339 seconds
[0m22:32:28.671629 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: ROLLBACK
[0m22:32:28.672636 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.338 seconds
[0m22:32:28.675633 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: ROLLBACK
[0m22:32:29.012939 [debug] [Thread-4 (]: On test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199: Close
[0m22:32:29.013943 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f: Close
[0m22:32:29.014944 [info ] [Thread-4 (]: 17 of 51 PASS accepted_values_add_first_name_sex_sex__M__F ..................... [[32mPASS[0m in 3.43s]
[0m22:32:29.016940 [info ] [Thread-1 (]: 18 of 51 PASS unique_not_null_add_first_name_sex_first_name .................... [[32mPASS[0m in 3.42s]
[0m22:32:29.018941 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199
[0m22:32:29.020953 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f
[0m22:32:29.021952 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m22:32:29.022949 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m22:32:29.023949 [info ] [Thread-4 (]: 21 of 51 START test unique_not_null_scooters_hardware_id ....................... [RUN]
[0m22:32:29.024952 [info ] [Thread-1 (]: 22 of 51 START test unique_not_null_scooters_model ............................. [RUN]
[0m22:32:29.025950 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.accepted_values_add_first_name_sex_sex__M__F.e5045b2199, now test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d)
[0m22:32:29.026951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_add_first_name_sex_first_name.457905447f, now test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc)
[0m22:32:29.027949 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m22:32:29.028952 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m22:32:29.037960 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m22:32:29.043974 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m22:32:29.045971 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m22:32:29.047971 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m22:32:29.050979 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m22:32:29.054977 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m22:32:29.057978 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m22:32:29.058980 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m22:32:29.058980 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: BEGIN
[0m22:32:29.060991 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: BEGIN
[0m22:32:29.061996 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:29.062991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:29.671875 [debug] [Thread-2 (]: SQL status: BEGIN in 2.662 seconds
[0m22:32:29.671875 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"
[0m22:32:29.672875 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "company"::text ||
    
        "model"::text ||
    
        "hardware_id"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m22:32:30.032776 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.359 seconds
[0m22:32:30.035770 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: ROLLBACK
[0m22:32:30.372517 [debug] [Thread-2 (]: On test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e: Close
[0m22:32:30.374516 [info ] [Thread-2 (]: 20 of 51 PASS unique_key_scooters_company__model__hardware_id .................. [[32mPASS[0m in 3.38s]
[0m22:32:30.375516 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e
[0m22:32:30.376517 [debug] [Thread-2 (]: Began running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m22:32:30.377516 [info ] [Thread-2 (]: 23 of 51 START test every_event_has_type ....................................... [RUN]
[0m22:32:30.379524 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_scooters_company__model__hardware_id.95f4e3cb7e, now test.dbt_scooters.every_event_has_type.1e5fc977eb)
[0m22:32:30.380520 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m22:32:30.392541 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m22:32:30.394546 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m22:32:30.399548 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m22:32:30.402546 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m22:32:30.403552 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: BEGIN
[0m22:32:30.403552 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:30.467543 [debug] [Thread-3 (]: SQL status: BEGIN in 3.869 seconds
[0m22:32:30.468549 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"
[0m22:32:30.469572 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_trip_has_scooter_id.e0b845a190"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select scooter_hw_id as from_field
    from "dev_3lcu"."scooters_raw"."trips"
    where scooter_hw_id is not null
),

parent as (
    select hardware_id as to_field
    from "dev_3lcu"."dbt"."scooters"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:32:31.038756 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.568 seconds
[0m22:32:31.041763 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: ROLLBACK
[0m22:32:31.383612 [debug] [Thread-3 (]: On test.dbt_scooters.every_trip_has_scooter_id.e0b845a190: Close
[0m22:32:31.384610 [info ] [Thread-3 (]: 19 of 51 PASS every_trip_has_scooter_id ........................................ [[32mPASS[0m in 4.80s]
[0m22:32:31.386116 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.every_trip_has_scooter_id.e0b845a190
[0m22:32:31.387125 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m22:32:31.388128 [info ] [Thread-3 (]: 24 of 51 START test unique_not_null_event_types_type ........................... [RUN]
[0m22:32:31.388128 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_trip_has_scooter_id.e0b845a190, now test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1)
[0m22:32:31.389635 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m22:32:31.394644 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m22:32:31.396650 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m22:32:31.399647 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m22:32:31.401659 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m22:32:31.402661 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: BEGIN
[0m22:32:31.402661 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:31.756787 [debug] [Thread-4 (]: SQL status: BEGIN in 2.695 seconds
[0m22:32:31.758792 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"
[0m22:32:31.759787 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "hardware_id"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "hardware_id" is null


      
    ) dbt_internal_test
[0m22:32:31.806940 [debug] [Thread-1 (]: SQL status: BEGIN in 2.744 seconds
[0m22:32:31.807942 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"
[0m22:32:31.808942 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "model"
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
having
    count(*) > 1 or "model" is null


      
    ) dbt_internal_test
[0m22:32:32.100787 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.341 seconds
[0m22:32:32.103785 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: ROLLBACK
[0m22:32:32.147815 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.338 seconds
[0m22:32:32.150826 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: ROLLBACK
[0m22:32:32.452796 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d: Close
[0m22:32:32.455799 [info ] [Thread-4 (]: 21 of 51 PASS unique_not_null_scooters_hardware_id ............................. [[32mPASS[0m in 3.43s]
[0m22:32:32.459796 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d
[0m22:32:32.461811 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m22:32:32.463809 [info ] [Thread-4 (]: 25 of 51 START test unique_not_null_event_types_type_id ........................ [RUN]
[0m22:32:32.465806 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_hardware_id.75a8c3f23d, now test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85)
[0m22:32:32.467809 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m22:32:32.477806 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m22:32:32.480827 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m22:32:32.485832 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m22:32:32.487335 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m22:32:32.488347 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: BEGIN
[0m22:32:32.489856 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:32.525901 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc: Close
[0m22:32:32.527903 [info ] [Thread-1 (]: 22 of 51 PASS unique_not_null_scooters_model ................................... [[32mPASS[0m in 3.50s]
[0m22:32:32.530919 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc
[0m22:32:32.532914 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m22:32:32.533911 [info ] [Thread-1 (]: 26 of 51 START test unique_not_null_age_groups_age_end ......................... [RUN]
[0m22:32:32.535915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_scooters_model.0690cc0edc, now test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac)
[0m22:32:32.536914 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m22:32:32.547923 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m22:32:32.550926 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m22:32:32.554927 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m22:32:32.557928 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m22:32:32.559940 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: BEGIN
[0m22:32:32.560939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:33.141745 [debug] [Thread-2 (]: SQL status: BEGIN in 2.737 seconds
[0m22:32:33.142781 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.every_event_has_type.1e5fc977eb"
[0m22:32:33.143782 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.every_event_has_type.1e5fc977eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type_id as from_field
    from "dev_3lcu"."scooters_raw"."events"
    where type_id is not null
),

parent as (
    select type_id as to_field
    from "dev_3lcu"."dbt"."event_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:32:34.153778 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.009 seconds
[0m22:32:34.156783 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: ROLLBACK
[0m22:32:34.237859 [debug] [Thread-3 (]: SQL status: BEGIN in 2.835 seconds
[0m22:32:34.238860 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"
[0m22:32:34.239871 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type" is null


      
    ) dbt_internal_test
[0m22:32:34.546701 [debug] [Thread-2 (]: On test.dbt_scooters.every_event_has_type.1e5fc977eb: Close
[0m22:32:34.547702 [info ] [Thread-2 (]: 23 of 51 PASS every_event_has_type ............................................. [[32mPASS[0m in 4.17s]
[0m22:32:34.549707 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.every_event_has_type.1e5fc977eb
[0m22:32:34.549707 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m22:32:34.550718 [info ] [Thread-2 (]: 27 of 51 START test unique_not_null_age_groups_age_start ....................... [RUN]
[0m22:32:34.551720 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.every_event_has_type.1e5fc977eb, now test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b)
[0m22:32:34.552716 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m22:32:34.558721 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m22:32:34.559719 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m22:32:34.562725 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m22:32:34.564726 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m22:32:34.564726 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: BEGIN
[0m22:32:34.565731 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:34.598269 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.358 seconds
[0m22:32:34.600798 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: ROLLBACK
[0m22:32:34.941632 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1: Close
[0m22:32:34.943634 [info ] [Thread-3 (]: 24 of 51 PASS unique_not_null_event_types_type ................................. [[32mPASS[0m in 3.55s]
[0m22:32:34.944637 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1
[0m22:32:34.945640 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m22:32:34.945640 [info ] [Thread-3 (]: 28 of 51 START test unique_not_null_age_groups_group ........................... [RUN]
[0m22:32:34.947637 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type.de405dcbb1, now test.dbt_scooters.unique_not_null_age_groups_group.39342291f1)
[0m22:32:34.947637 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m22:32:34.954655 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m22:32:34.956650 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m22:32:34.959648 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m22:32:34.961666 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m22:32:34.962665 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: BEGIN
[0m22:32:34.962665 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:35.268581 [debug] [Thread-4 (]: SQL status: BEGIN in 2.779 seconds
[0m22:32:35.269562 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"
[0m22:32:35.270568 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "type_id"
from
    "dev_3lcu"."dbt"."event_types"
group by
    1
having
    count(*) > 1 or "type_id" is null


      
    ) dbt_internal_test
[0m22:32:35.614706 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.344 seconds
[0m22:32:35.617671 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: ROLLBACK
[0m22:32:35.956668 [debug] [Thread-4 (]: On test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85: Close
[0m22:32:35.957669 [info ] [Thread-4 (]: 25 of 51 PASS unique_not_null_event_types_type_id .............................. [[32mPASS[0m in 3.49s]
[0m22:32:35.959709 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85
[0m22:32:35.960670 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_clean
[0m22:32:35.961704 [info ] [Thread-4 (]: 29 of 51 START sql incremental model dbt.events_clean .......................... [RUN]
[0m22:32:35.962670 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_event_types_type_id.598b1bbb85, now model.dbt_scooters.events_clean)
[0m22:32:35.963710 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_clean
[0m22:32:35.968695 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m22:32:35.970665 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_clean
[0m22:32:36.036804 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:36.037802 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp223236008807"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now()  as updated_at

from
    "dev_3lcu"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."events_clean")
    

  );
  
  
[0m22:32:36.038803 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:36.202988 [debug] [Thread-1 (]: SQL status: BEGIN in 3.642 seconds
[0m22:32:36.203987 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"
[0m22:32:36.203987 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_end"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_end" is null


      
    ) dbt_internal_test
[0m22:32:36.546813 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.342 seconds
[0m22:32:36.548794 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: ROLLBACK
[0m22:32:36.884690 [debug] [Thread-1 (]: On test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac: Close
[0m22:32:36.885691 [info ] [Thread-1 (]: 26 of 51 PASS unique_not_null_age_groups_age_end ............................... [[32mPASS[0m in 4.35s]
[0m22:32:36.886692 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac
[0m22:32:36.887698 [debug] [Thread-1 (]: Began running node model.dbt_scooters.first_name_sex
[0m22:32:36.888691 [info ] [Thread-1 (]: 30 of 51 START sql table model dbt.first_name_sex .............................. [RUN]
[0m22:32:36.889691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_end.a44a81f9ac, now model.dbt_scooters.first_name_sex)
[0m22:32:36.889691 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.first_name_sex
[0m22:32:36.893274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.first_name_sex"
[0m22:32:36.895279 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.first_name_sex
[0m22:32:36.911874 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.first_name_sex"
[0m22:32:36.914844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:36.915848 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: BEGIN
[0m22:32:36.916843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:37.326662 [debug] [Thread-2 (]: SQL status: BEGIN in 2.761 seconds
[0m22:32:37.327666 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"
[0m22:32:37.327666 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "age_start"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "age_start" is null


      
    ) dbt_internal_test
[0m22:32:37.666883 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.338 seconds
[0m22:32:37.669895 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: ROLLBACK
[0m22:32:37.699940 [debug] [Thread-3 (]: SQL status: BEGIN in 2.737 seconds
[0m22:32:37.700951 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"
[0m22:32:37.700951 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_not_null_age_groups_group.39342291f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    "group"
from
    "dev_3lcu"."dbt"."age_groups"
group by
    1
having
    count(*) > 1 or "group" is null


      
    ) dbt_internal_test
[0m22:32:38.009779 [debug] [Thread-2 (]: On test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b: Close
[0m22:32:38.010784 [info ] [Thread-2 (]: 27 of 51 PASS unique_not_null_age_groups_age_start ............................. [[32mPASS[0m in 3.46s]
[0m22:32:38.012792 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b
[0m22:32:38.012792 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_concurrency
[0m22:32:38.013789 [info ] [Thread-2 (]: 31 of 51 START sql incremental model dbt.trips_concurrency ..................... [RUN]
[0m22:32:38.014783 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_age_start.b95c4e142b, now model.dbt_scooters.trips_concurrency)
[0m22:32:38.015785 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m22:32:38.021792 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m22:32:38.022793 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m22:32:38.027798 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:38.028796 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp223238025793"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_3lcu"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_3lcu"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_3lcu"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now()  as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m22:32:38.029797 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:38.066826 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.365 seconds
[0m22:32:38.068826 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: ROLLBACK
[0m22:32:38.408729 [debug] [Thread-3 (]: On test.dbt_scooters.unique_not_null_age_groups_group.39342291f1: Close
[0m22:32:38.409731 [info ] [Thread-3 (]: 28 of 51 PASS unique_not_null_age_groups_group ................................. [[32mPASS[0m in 3.46s]
[0m22:32:38.412740 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_not_null_age_groups_group.39342291f1
[0m22:32:38.413744 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_geom
[0m22:32:38.414739 [info ] [Thread-3 (]: 32 of 51 START sql view model dbt.trips_geom ................................... [RUN]
[0m22:32:38.415743 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_not_null_age_groups_group.39342291f1, now model.dbt_scooters.trips_geom)
[0m22:32:38.415743 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_geom
[0m22:32:38.419739 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m22:32:38.421749 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_geom
[0m22:32:38.444769 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m22:32:38.445773 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:38.446771 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m22:32:38.447772 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:39.638845 [debug] [Thread-4 (]: SQL status: SELECT 0 in 3.600 seconds
[0m22:32:39.642852 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:39.642852 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: BEGIN
[0m22:32:39.982612 [debug] [Thread-4 (]: SQL status: BEGIN in 0.339 seconds
[0m22:32:39.983613 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:39.983613 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp223236008807'
        
      order by ordinal_position

  
[0m22:32:40.215794 [debug] [Thread-1 (]: SQL status: BEGIN in 3.299 seconds
[0m22:32:40.216795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:40.216795 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

  
    

  create  table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp"
  
  
    as
  
  (
    select distinct first_name, sex
from "dev_3lcu"."scooters_raw"."users"
Where sex is not null
  );
  
[0m22:32:40.336889 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.352 seconds
[0m22:32:40.339896 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:40.340895 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:40.564555 [debug] [Thread-1 (]: SQL status: SELECT 387 in 0.347 seconds
[0m22:32:40.572561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:40.572561 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex" rename to "first_name_sex__dbt_backup"
[0m22:32:40.680646 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.339 seconds
[0m22:32:40.694653 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:40.695647 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp223236008807'
        
      order by ordinal_position

  
[0m22:32:40.941870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.368 seconds
[0m22:32:40.944876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:40.945871 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
alter table "dev_3lcu"."dbt"."first_name_sex__dbt_tmp" rename to "first_name_sex"
[0m22:32:41.035948 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.340 seconds
[0m22:32:41.040957 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:41.041955 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:41.334702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.388 seconds
[0m22:32:41.342708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:41.342708 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */

    
  
  comment on table "dev_3lcu"."dbt"."first_name_sex" is $dbt_comment_literal_block$Unique name_sex glossary$dbt_comment_literal_block$;

  
[0m22:32:41.535855 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.494 seconds
[0m22:32:41.545859 [debug] [Thread-4 (]: 
    In "dev_3lcu"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:41.562873 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m22:32:41.564873 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:41.564873 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        
            delete from "dev_3lcu"."dbt"."events_clean"
            using "events_clean__dbt_tmp223236008807"
            where (
                
                    "events_clean__dbt_tmp223236008807".user_id = "dev_3lcu"."dbt"."events_clean".user_id
                    and 
                
                    "events_clean__dbt_tmp223236008807".timestamp = "dev_3lcu"."dbt"."events_clean".timestamp
                    and 
                
                    "events_clean__dbt_tmp223236008807".type_id = "dev_3lcu"."dbt"."events_clean".type_id
                    
                
                
            );
        
    

    insert into "dev_3lcu"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp223236008807"
    )
  
[0m22:32:41.686957 [debug] [Thread-1 (]: SQL status: COMMENT in 0.343 seconds
[0m22:32:41.687958 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m22:32:41.688955 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:41.688955 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: COMMIT
[0m22:32:41.917638 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.352 seconds
[0m22:32:41.919638 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:41.920650 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_clean" is $dbt_comment_literal_block$User events without duplicates$dbt_comment_literal_block$;

  
[0m22:32:42.034797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.345 seconds
[0m22:32:42.041838 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."first_name_sex__dbt_backup"
[0m22:32:42.047835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.first_name_sex"
[0m22:32:42.047835 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.first_name_sex"} */
drop table if exists "dev_3lcu"."dbt"."first_name_sex__dbt_backup" cascade
[0m22:32:42.218852 [debug] [Thread-3 (]: SQL status: BEGIN in 3.771 seconds
[0m22:32:42.219894 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:42.219894 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_3lcu"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m22:32:42.264899 [debug] [Thread-4 (]: SQL status: COMMENT in 0.344 seconds
[0m22:32:42.266888 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: COMMIT
[0m22:32:42.267852 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:32:42.267852 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: COMMIT
[0m22:32:42.362757 [debug] [Thread-2 (]: SQL status: SELECT 0 in 4.333 seconds
[0m22:32:42.365758 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:42.366757 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m22:32:42.398308 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.350 seconds
[0m22:32:42.399881 [debug] [Thread-1 (]: On model.dbt_scooters.first_name_sex: Close
[0m22:32:42.400889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293187392E0>]}
[0m22:32:42.401890 [info ] [Thread-1 (]: 30 of 51 OK created sql table model dbt.first_name_sex ......................... [[32mSELECT 387[0m in 5.51s]
[0m22:32:42.402890 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.first_name_sex
[0m22:32:42.403893 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m22:32:42.403893 [info ] [Thread-1 (]: 33 of 51 START sql view model dbt.trips_prep ................................... [RUN]
[0m22:32:42.404890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.first_name_sex, now model.dbt_scooters.trips_prep)
[0m22:32:42.405932 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m22:32:42.408894 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m22:32:42.409937 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m22:32:42.414894 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m22:32:42.415927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:42.416935 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m22:32:42.416935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:42.558765 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.338 seconds
[0m22:32:42.561804 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:42.562809 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m22:32:42.620691 [debug] [Thread-4 (]: SQL status: COMMIT in 0.353 seconds
[0m22:32:42.622697 [debug] [Thread-4 (]: On model.dbt_scooters.events_clean: Close
[0m22:32:42.623689 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931968BFB0>]}
[0m22:32:42.623689 [info ] [Thread-4 (]: 29 of 51 OK created sql incremental model dbt.events_clean ..................... [[32mINSERT 0 0[0m in 6.66s]
[0m22:32:42.625651 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_clean
[0m22:32:42.625651 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies
[0m22:32:42.626688 [info ] [Thread-4 (]: 34 of 51 START sql table model dbt.companies ................................... [RUN]
[0m22:32:42.627688 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.companies)
[0m22:32:42.628670 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies
[0m22:32:42.631686 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m22:32:42.632689 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies
[0m22:32:42.636646 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m22:32:42.638646 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:42.639647 [debug] [Thread-4 (]: On model.dbt_scooters.companies: BEGIN
[0m22:32:42.639647 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:42.701955 [debug] [Thread-2 (]: SQL status: BEGIN in 0.334 seconds
[0m22:32:42.701955 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:42.702952 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp223238025793'
        
      order by ordinal_position

  
[0m22:32:42.898387 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.335 seconds
[0m22:32:42.902002 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:42.903001 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_3lcu"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m22:32:43.056862 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.353 seconds
[0m22:32:43.059858 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:43.060857 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:43.243862 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.341 seconds
[0m22:32:43.247851 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:43.248805 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_geom" is $dbt_comment_literal_block$Trips prepared for geometry analysis$dbt_comment_literal_block$;

  
[0m22:32:43.408018 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.346 seconds
[0m22:32:43.411617 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:43.412578 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp223238025793'
        
      order by ordinal_position

  
[0m22:32:43.602210 [debug] [Thread-3 (]: SQL status: COMMENT in 0.353 seconds
[0m22:32:43.603211 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m22:32:43.604251 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:43.604251 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m22:32:43.761737 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.349 seconds
[0m22:32:43.764744 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:43.765744 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:32:43.945902 [debug] [Thread-3 (]: SQL status: COMMIT in 0.341 seconds
[0m22:32:43.948855 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_geom__dbt_backup"
[0m22:32:43.951895 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:32:43.952899 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_3lcu"."dbt"."trips_geom__dbt_backup" cascade
[0m22:32:44.123632 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.357 seconds
[0m22:32:44.125630 [debug] [Thread-2 (]: 
    In "dev_3lcu"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:44.131628 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m22:32:44.133630 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:44.134590 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_3lcu"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp223238025793"
    )


  
[0m22:32:44.290840 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.338 seconds
[0m22:32:44.292842 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: Close
[0m22:32:44.293841 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029318766E10>]}
[0m22:32:44.294884 [info ] [Thread-3 (]: 32 of 51 OK created sql view model dbt.trips_geom .............................. [[32mCREATE VIEW[0m in 5.88s]
[0m22:32:44.295847 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_geom
[0m22:32:44.296888 [debug] [Thread-3 (]: Began running node model.dbt_scooters.users_full
[0m22:32:44.296888 [info ] [Thread-3 (]: 35 of 51 START sql table model dbt.users_full .................................. [RUN]
[0m22:32:44.298399 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.users_full)
[0m22:32:44.298399 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.users_full
[0m22:32:44.302966 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.users_full"
[0m22:32:44.304967 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.users_full
[0m22:32:44.308970 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.users_full"
[0m22:32:44.309964 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:44.310964 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: BEGIN
[0m22:32:44.310964 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:44.534757 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.400 seconds
[0m22:32:44.536757 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:44.536757 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_concurrency" is $dbt_comment_literal_block$Number of simultaneous rides in time$dbt_comment_literal_block$;

  
[0m22:32:44.900231 [debug] [Thread-2 (]: SQL status: COMMENT in 0.362 seconds
[0m22:32:44.902231 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m22:32:44.902231 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:32:44.903220 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m22:32:45.202858 [debug] [Thread-1 (]: SQL status: BEGIN in 2.785 seconds
[0m22:32:45.203860 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:45.203860 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_3lcu"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select
    id,
    user_id,
    scooter_hw_id,
    started_at,
    finished_at,
    start_lat,
    start_lon,
    finish_lat,
    finish_lon,
    distance as distance_m,
    cast(price as decimal(20, 2)) / 100 as price_rub,
    extract(epoch from (finished_at - started_at)) as duration_s,
    finished_at <> started_at and price = 0 as is_free,
    
    date(started_at at time zone 'Europe/Moscow')
 as "date"
from
    "dev_3lcu"."scooters_raw"."trips"
  );
[0m22:32:45.239861 [debug] [Thread-2 (]: SQL status: COMMIT in 0.337 seconds
[0m22:32:45.242860 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: Close
[0m22:32:45.243858 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293189D0B60>]}
[0m22:32:45.245861 [info ] [Thread-2 (]: 31 of 51 OK created sql incremental model dbt.trips_concurrency ................ [[32mINSERT 0 0[0m in 7.23s]
[0m22:32:45.246863 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m22:32:45.247862 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_full
[0m22:32:45.248862 [info ] [Thread-2 (]: 36 of 51 START sql view model dbt.events_full .................................. [RUN]
[0m22:32:45.249863 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.events_full)
[0m22:32:45.249863 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_full
[0m22:32:45.253859 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m22:32:45.254861 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_full
[0m22:32:45.258862 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m22:32:45.260863 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:45.261863 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: BEGIN
[0m22:32:45.261863 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:45.467775 [debug] [Thread-4 (]: SQL status: BEGIN in 2.827 seconds
[0m22:32:45.467775 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:45.468742 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_3lcu"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_3lcu"."dbt"."scooters"
group by
    1
  );
  
[0m22:32:45.550897 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.346 seconds
[0m22:32:45.554898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:45.555901 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m22:32:45.813090 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.344 seconds
[0m22:32:45.817084 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:45.818095 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies" rename to "companies__dbt_backup"
[0m22:32:45.891697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.335 seconds
[0m22:32:45.895657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:45.895657 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_3lcu"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m22:32:46.163652 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.345 seconds
[0m22:32:46.168649 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:46.169649 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_3lcu"."dbt"."companies__dbt_tmp" rename to "companies"
[0m22:32:46.230818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.334 seconds
[0m22:32:46.232765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:46.233765 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

    
  
  comment on view "dev_3lcu"."dbt"."trips_prep" is $dbt_comment_literal_block$Trips prepared for analysis$dbt_comment_literal_block$;

  
[0m22:32:46.506456 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m22:32:46.508452 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:46.509957 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies" is $dbt_comment_literal_block$Scooter statistics by company$dbt_comment_literal_block$;

  
[0m22:32:46.571577 [debug] [Thread-1 (]: SQL status: COMMENT in 0.337 seconds
[0m22:32:46.573578 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m22:32:46.573578 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:46.574577 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m22:32:46.847560 [debug] [Thread-4 (]: SQL status: COMMENT in 0.337 seconds
[0m22:32:46.848559 [debug] [Thread-4 (]: On model.dbt_scooters.companies: COMMIT
[0m22:32:46.849561 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:46.850525 [debug] [Thread-4 (]: On model.dbt_scooters.companies: COMMIT
[0m22:32:46.909718 [debug] [Thread-1 (]: SQL status: COMMIT in 0.335 seconds
[0m22:32:46.912726 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_prep__dbt_backup"
[0m22:32:46.913726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:32:46.914725 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_3lcu"."dbt"."trips_prep__dbt_backup" cascade
[0m22:32:47.009914 [debug] [Thread-3 (]: SQL status: BEGIN in 2.699 seconds
[0m22:32:47.010959 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:47.011924 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

  
    

  create  table "dev_3lcu"."dbt"."users_full__dbt_tmp"
  
  
    as
  
  (
    select
   u.id, u.first_name ,u.last_name ,u.phone ,
   COALESCE(u.sex, fns.sex, afns.sex) as sex2,
   u.birth_date
from "dev_3lcu"."scooters_raw"."users" u
left join "dev_3lcu"."dbt"."first_name_sex" fns on u.first_name = fns.first_name
left join "dev_3lcu"."dbt"."add_first_name_sex" afns on u.first_name =afns.first_name
  );
  
[0m22:32:47.190571 [debug] [Thread-4 (]: SQL status: COMMIT in 0.340 seconds
[0m22:32:47.193567 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."companies__dbt_backup"
[0m22:32:47.194530 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:32:47.194530 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_3lcu"."dbt"."companies__dbt_backup" cascade
[0m22:32:47.251737 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.336 seconds
[0m22:32:47.252738 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m22:32:47.253737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319179DC0>]}
[0m22:32:47.254738 [info ] [Thread-1 (]: 33 of 51 OK created sql view model dbt.trips_prep .............................. [[32mCREATE VIEW[0m in 4.85s]
[0m22:32:47.255740 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m22:32:47.256779 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m22:32:47.257738 [info ] [Thread-1 (]: 37 of 51 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m22:32:47.258739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.parking_finish_stat)
[0m22:32:47.258739 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m22:32:47.261777 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m22:32:47.263765 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m22:32:47.267785 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m22:32:47.269771 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:32:47.269771 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m22:32:47.270740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:47.361603 [debug] [Thread-3 (]: SQL status: SELECT 2000 in 0.350 seconds
[0m22:32:47.365598 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:47.366558 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full" rename to "users_full__dbt_backup"
[0m22:32:47.536937 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.342 seconds
[0m22:32:47.539928 [debug] [Thread-4 (]: On model.dbt_scooters.companies: Close
[0m22:32:47.540927 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319179B20>]}
[0m22:32:47.540927 [info ] [Thread-4 (]: 34 of 51 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 4.91s]
[0m22:32:47.542887 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies
[0m22:32:47.542887 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_start_stat
[0m22:32:47.543925 [info ] [Thread-4 (]: 38 of 51 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m22:32:47.544889 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.parking_start_stat)
[0m22:32:47.545889 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m22:32:47.548890 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m22:32:47.550886 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m22:32:47.555914 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m22:32:47.556926 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:32:47.557886 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m22:32:47.557886 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:32:47.705146 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m22:32:47.708106 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:47.709615 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
alter table "dev_3lcu"."dbt"."users_full__dbt_tmp" rename to "users_full"
[0m22:32:47.994664 [debug] [Thread-2 (]: SQL status: BEGIN in 2.733 seconds
[0m22:32:47.995661 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:47.995661 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_3lcu"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select * from
"dev_3lcu"."dbt"."events_clean" as e
left join "dev_3lcu"."dbt"."event_types" as t
using (type_id)
  );
[0m22:32:48.049876 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.340 seconds
[0m22:32:48.051876 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:48.052873 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */

    
  
  comment on table "dev_3lcu"."dbt"."users_full" is $dbt_comment_literal_block$Users enriched with sex$dbt_comment_literal_block$;

  
[0m22:32:48.349649 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.353 seconds
[0m22:32:48.353638 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:48.354637 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m22:32:48.391650 [debug] [Thread-3 (]: SQL status: COMMENT in 0.339 seconds
[0m22:32:48.393640 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: COMMIT
[0m22:32:48.394640 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:48.394640 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: COMMIT
[0m22:32:48.691532 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.336 seconds
[0m22:32:48.697487 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:48.698487 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_3lcu"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m22:32:48.735640 [debug] [Thread-3 (]: SQL status: COMMIT in 0.340 seconds
[0m22:32:48.738641 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."users_full__dbt_backup"
[0m22:32:48.739681 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.users_full"
[0m22:32:48.739681 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.users_full"} */
drop table if exists "dev_3lcu"."dbt"."users_full__dbt_backup" cascade
[0m22:32:49.035707 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m22:32:49.037701 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:49.038699 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

    
  
  comment on view "dev_3lcu"."dbt"."events_full" is $dbt_comment_literal_block$User events enriched with meaningful types$dbt_comment_literal_block$;

  
[0m22:32:49.083716 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.343 seconds
[0m22:32:49.085725 [debug] [Thread-3 (]: On model.dbt_scooters.users_full: Close
[0m22:32:49.086701 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293189F0200>]}
[0m22:32:49.087704 [info ] [Thread-3 (]: 35 of 51 OK created sql table model dbt.users_full ............................. [[32mSELECT 2000[0m in 4.79s]
[0m22:32:49.088718 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.users_full
[0m22:32:49.089704 [debug] [Thread-3 (]: Began running node model.dbt_scooters.revenue_daily
[0m22:32:49.089704 [info ] [Thread-3 (]: 39 of 51 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m22:32:49.090741 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.users_full, now model.dbt_scooters.revenue_daily)
[0m22:32:49.091745 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m22:32:49.095740 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m22:32:49.097704 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.revenue_daily
[0m22:32:49.101735 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:49.102736 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp223249099738"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_3lcu"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m22:32:49.102736 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:49.374757 [debug] [Thread-2 (]: SQL status: COMMENT in 0.336 seconds
[0m22:32:49.376789 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: COMMIT
[0m22:32:49.376789 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:49.377757 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: COMMIT
[0m22:32:49.718836 [debug] [Thread-2 (]: SQL status: COMMIT in 0.340 seconds
[0m22:32:49.721873 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."events_full__dbt_backup"
[0m22:32:49.722833 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:32:49.722833 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_3lcu"."dbt"."events_full__dbt_backup" cascade
[0m22:32:50.060949 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.337 seconds
[0m22:32:50.062955 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: Close
[0m22:32:50.063911 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931972F8F0>]}
[0m22:32:50.064951 [info ] [Thread-2 (]: 36 of 51 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 4.81s]
[0m22:32:50.065912 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_full
[0m22:32:50.066915 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat
[0m22:32:50.067912 [info ] [Thread-2 (]: 40 of 51 START sql table model dbt.trips_stat .................................. [RUN]
[0m22:32:50.068913 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_stat)
[0m22:32:50.068913 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat
[0m22:32:50.071952 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m22:32:50.073908 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat
[0m22:32:50.077947 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m22:32:50.078913 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:32:50.079946 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m22:32:50.079946 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:50.227798 [debug] [Thread-1 (]: SQL status: BEGIN in 2.957 seconds
[0m22:32:50.228763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:32:50.228763 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m22:32:51.335845 [debug] [Thread-4 (]: SQL status: BEGIN in 3.778 seconds
[0m22:32:51.336843 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:32:51.336843 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    
select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_3lcu"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m22:32:53.835702 [debug] [Thread-2 (]: SQL status: BEGIN in 3.755 seconds
[0m22:32:53.835702 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:32:53.836654 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count(*) as trips,
    count(distinct user_id) as users,
    avg(duration_s) / 60 as avg_duration_min,
    sum(distance_m) / 1000 as sum_distance_km,
    sum(price_rub) as revenue_rub,
    count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from
    "dev_3lcu"."dbt"."trips_prep"
  );
  
[0m22:32:55.268524 [debug] [Thread-3 (]: SQL status: SELECT 3 in 6.166 seconds
[0m22:32:55.272537 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:55.272537 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m22:32:55.642872 [debug] [Thread-3 (]: SQL status: BEGIN in 0.369 seconds
[0m22:32:55.642872 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:55.643910 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp223249099738'
        
      order by ordinal_position

  
[0m22:32:56.535585 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.891 seconds
[0m22:32:56.539577 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:56.540581 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m22:32:57.049561 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.508 seconds
[0m22:32:57.053609 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:57.053609 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp223249099738'
        
      order by ordinal_position

  
[0m22:32:57.537953 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.483 seconds
[0m22:32:57.541547 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:57.542505 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m22:32:57.938613 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.395 seconds
[0m22:32:57.940643 [debug] [Thread-3 (]: 
    In "dev_3lcu"."finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:32:57.941643 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m22:32:57.942646 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:57.943612 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        
            delete from "dev_3lcu"."finance"."revenue_daily"
            using "revenue_daily__dbt_tmp223249099738"
            where (
                
                    "revenue_daily__dbt_tmp223249099738".date = "dev_3lcu"."finance"."revenue_daily".date
                    
                
                
            );
        
    

    insert into "dev_3lcu"."finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp223249099738"
    )
  
[0m22:32:58.334000 [debug] [Thread-3 (]: SQL status: INSERT 0 3 in 0.390 seconds
[0m22:32:58.341592 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:58.342588 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_3lcu".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'finance'
        and table_name = 'revenue_daily'
  
[0m22:32:58.740634 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.397 seconds
[0m22:32:58.741633 [debug] [Thread-3 (]: On "dev_3lcu"."finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m22:32:58.742643 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:58.743633 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
  comment on table "dev_3lcu"."finance"."revenue_daily" is $dbt_comment_literal_block$Summary daily revenue$dbt_comment_literal_block$;

  
[0m22:32:59.136999 [debug] [Thread-3 (]: SQL status: COMMENT in 0.394 seconds
[0m22:32:59.139538 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m22:32:59.139538 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:32:59.140578 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m22:32:59.540670 [debug] [Thread-3 (]: SQL status: COMMIT in 0.400 seconds
[0m22:32:59.541665 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: Close
[0m22:32:59.542673 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319765160>]}
[0m22:32:59.543622 [info ] [Thread-3 (]: 39 of 51 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 3[0m in 10.45s]
[0m22:32:59.544665 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.revenue_daily
[0m22:32:59.545666 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m22:32:59.546625 [info ] [Thread-3 (]: 41 of 51 START sql table model dbt.trips_stat_daily ............................ [RUN]
[0m22:32:59.547622 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_stat_daily)
[0m22:32:59.548629 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m22:32:59.551663 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m22:32:59.552621 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m22:32:59.556668 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m22:32:59.557625 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:32:59.558628 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m22:32:59.558628 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:02.238682 [debug] [Thread-2 (]: SQL status: SELECT 1 in 8.402 seconds
[0m22:33:02.242717 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:33:02.243721 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m22:33:02.633660 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.390 seconds
[0m22:33:02.637659 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:33:02.637659 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_3lcu"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m22:33:03.036561 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.398 seconds
[0m22:33:03.038562 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:33:03.039558 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat" is $dbt_comment_literal_block$Overall trips statistics$dbt_comment_literal_block$;

  
[0m22:33:03.155678 [debug] [Thread-3 (]: SQL status: BEGIN in 3.597 seconds
[0m22:33:03.156679 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:03.157680 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    count(*) as trips,
    max(price_rub) as max_price_rub,
    avg(distance_m) / 1000 as avg_distance_km,
    avg(price_rub)/avg(duration_s) * 60 as avg_price_rub_per_min
from
    "dev_3lcu"."dbt"."trips_prep"
group by
    1
order by
    1
  );
  
[0m22:33:03.433903 [debug] [Thread-2 (]: SQL status: COMMENT in 0.394 seconds
[0m22:33:03.434904 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m22:33:03.435904 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:33:03.435904 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m22:33:03.838710 [debug] [Thread-2 (]: SQL status: COMMIT in 0.402 seconds
[0m22:33:03.840715 [debug] [Thread-2 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat__dbt_backup"
[0m22:33:03.842715 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:33:03.842715 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat__dbt_backup" cascade
[0m22:33:04.244491 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.401 seconds
[0m22:33:04.246494 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: Close
[0m22:33:04.247495 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029318736FF0>]}
[0m22:33:04.248497 [info ] [Thread-2 (]: 40 of 51 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 14.18s]
[0m22:33:04.249498 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat
[0m22:33:04.250504 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_users
[0m22:33:04.250504 [info ] [Thread-2 (]: 42 of 51 START sql incremental model dbt.trips_users ........................... [RUN]
[0m22:33:04.251507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_users)
[0m22:33:04.252508 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_users
[0m22:33:04.256503 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m22:33:04.257507 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_users
[0m22:33:04.261514 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:04.262511 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp223304259506"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now()  as updated_at

from
    "dev_3lcu"."dbt"."trips_prep" as t
left join
    "dev_3lcu"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_3lcu"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m22:33:04.262511 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:10.237210 [debug] [Thread-2 (]: SQL status: SELECT 0 in 5.974 seconds
[0m22:33:10.240731 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:10.240731 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: BEGIN
[0m22:33:10.638319 [debug] [Thread-2 (]: SQL status: BEGIN in 0.397 seconds
[0m22:33:10.639831 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:10.639831 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp223304259506'
        
      order by ordinal_position

  
[0m22:33:11.936380 [debug] [Thread-2 (]: SQL status: SELECT 17 in 1.295 seconds
[0m22:33:11.939970 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:11.941020 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:33:12.641858 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.700 seconds
[0m22:33:12.645863 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:12.646858 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp223304259506'
        
      order by ordinal_position

  
[0m22:33:13.332493 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.685 seconds
[0m22:33:13.338051 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:13.339559 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:33:14.042287 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.702 seconds
[0m22:33:14.050895 [debug] [Thread-2 (]: 
    In "dev_3lcu"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:33:14.053063 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m22:33:14.055601 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:14.058028 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_3lcu"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp223304259506"
    )


  
[0m22:33:14.465793 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.406 seconds
[0m22:33:14.468945 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:14.469941 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_users" is $dbt_comment_literal_block$Prepared trips enriched with users data$dbt_comment_literal_block$;

  
[0m22:33:14.833924 [debug] [Thread-2 (]: SQL status: COMMENT in 0.364 seconds
[0m22:33:14.837475 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:14.837475 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m22:33:15.244919 [debug] [Thread-3 (]: SQL status: SELECT 91 in 12.087 seconds
[0m22:33:15.250536 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:15.252537 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m22:33:15.635594 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.382 seconds
[0m22:33:15.642031 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:15.643416 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_3lcu"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m22:33:16.064553 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.420 seconds
[0m22:33:16.089552 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:16.090560 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    create  index if not exists
  "cd40d69f91be17b7427948c8179e5a5c"
  on "dev_3lcu"."dbt"."trips_stat_daily" 
  (date)
  
[0m22:33:16.552525 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.461 seconds
[0m22:33:16.558529 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:16.559531 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_stat_daily" is $dbt_comment_literal_block$Overall trips statistics per day$dbt_comment_literal_block$;

  
[0m22:33:16.934090 [debug] [Thread-3 (]: SQL status: COMMENT in 0.373 seconds
[0m22:33:16.943408 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:16.945408 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'trips_stat_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:33:17.877231 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.931 seconds
[0m22:33:17.881508 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:17.882511 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."trips_stat_daily".date is $dbt_comment_literal_block$Trips date$dbt_comment_literal_block$;
  

  
[0m22:33:18.315855 [debug] [Thread-3 (]: SQL status: COMMENT in 0.433 seconds
[0m22:33:18.318485 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m22:33:18.319505 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:18.320786 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m22:33:18.666320 [debug] [Thread-3 (]: SQL status: COMMIT in 0.345 seconds
[0m22:33:18.674672 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup"
[0m22:33:18.676672 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:33:18.677673 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m22:33:19.064466 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.386 seconds
[0m22:33:19.068469 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m22:33:19.070468 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293192384A0>]}
[0m22:33:19.071468 [info ] [Thread-3 (]: 41 of 51 OK created sql table model dbt.trips_stat_daily ....................... [[32mSELECT 91[0m in 19.52s]
[0m22:33:19.074474 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m22:33:19.075464 [debug] [Thread-3 (]: Began running node model.dbt_scooters.companies_trips
[0m22:33:19.076474 [info ] [Thread-3 (]: 43 of 51 START sql table model dbt.companies_trips ............................. [RUN]
[0m22:33:19.078466 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.companies_trips)
[0m22:33:19.079466 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.companies_trips
[0m22:33:19.085467 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m22:33:19.087466 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.companies_trips
[0m22:33:19.094465 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m22:33:19.097468 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:19.098472 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m22:33:19.099469 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:22.432792 [debug] [Thread-3 (]: SQL status: BEGIN in 3.332 seconds
[0m22:33:22.433794 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:22.434793 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_3lcu"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_3lcu"."dbt"."trips_prep" as t
        join "dev_3lcu"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_3lcu"."dbt"."companies" as c
        using (company)
  );
  
[0m22:33:26.842530 [debug] [Thread-3 (]: SQL status: SELECT 6 in 4.407 seconds
[0m22:33:26.845526 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:26.847071 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m22:33:27.141797 [debug] [Thread-2 (]: SQL status: ANALYZE in 12.303 seconds
[0m22:33:27.143797 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m22:33:27.143797 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:27.144796 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m22:33:27.236433 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.389 seconds
[0m22:33:27.239433 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:27.240439 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_3lcu"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m22:33:27.539743 [debug] [Thread-2 (]: SQL status: COMMIT in 0.395 seconds
[0m22:33:27.540742 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:27.541741 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m22:33:27.634419 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.394 seconds
[0m22:33:27.637450 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:27.637450 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  comment on table "dev_3lcu"."dbt"."companies_trips" is $dbt_comment_literal_block$Trip statistics by company$dbt_comment_literal_block$;

  
[0m22:33:27.931652 [debug] [Thread-2 (]: SQL status: COMMIT in 0.390 seconds
[0m22:33:27.933649 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:33:27.933649 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m22:33:28.035817 [debug] [Thread-3 (]: SQL status: COMMENT in 0.397 seconds
[0m22:33:28.039823 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:28.040783 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_3lcu".INFORMATION_SCHEMA.columns
      where table_name = 'companies_trips'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:33:28.343526 [debug] [Thread-2 (]: SQL status: VACUUM in 0.409 seconds
[0m22:33:28.345566 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: Close
[0m22:33:28.346529 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319755640>]}
[0m22:33:28.347530 [info ] [Thread-2 (]: 42 of 51 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 24.10s]
[0m22:33:28.349072 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_users
[0m22:33:28.349072 [debug] [Thread-2 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m22:33:28.350119 [info ] [Thread-2 (]: 44 of 51 START test events_full_is_complete .................................... [RUN]
[0m22:33:28.351113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now test.dbt_scooters.events_full_is_complete)
[0m22:33:28.352113 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m22:33:28.358082 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m22:33:28.359590 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m22:33:28.362599 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.events_full_is_complete"
[0m22:33:28.364600 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m22:33:28.364600 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: BEGIN
[0m22:33:28.365600 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:28.735692 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.694 seconds
[0m22:33:28.738661 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:28.739692 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

    
  
  
    
    
    comment on column "dev_3lcu"."dbt"."companies_trips".company is $dbt_comment_literal_block$Scooters manufacturing company$dbt_comment_literal_block$;
  

  
[0m22:33:29.147808 [debug] [Thread-3 (]: SQL status: COMMENT in 0.408 seconds
[0m22:33:29.151372 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m22:33:29.152397 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:29.153396 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m22:33:29.535617 [debug] [Thread-3 (]: SQL status: COMMIT in 0.381 seconds
[0m22:33:29.538601 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."companies_trips__dbt_backup"
[0m22:33:29.539616 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:33:29.540578 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_3lcu"."dbt"."companies_trips__dbt_backup" cascade
[0m22:33:29.887643 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.347 seconds
[0m22:33:29.889639 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: Close
[0m22:33:29.890642 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931975C290>]}
[0m22:33:29.891639 [info ] [Thread-3 (]: 43 of 51 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 10.81s]
[0m22:33:29.892636 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.companies_trips
[0m22:33:29.893641 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m22:33:29.894632 [info ] [Thread-3 (]: 45 of 51 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m22:33:29.895614 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_age_daily)
[0m22:33:29.896640 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m22:33:29.899600 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m22:33:29.901605 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m22:33:29.907638 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m22:33:29.910615 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:29.911620 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m22:33:29.912619 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:30.637684 [debug] [Thread-1 (]: SQL status: SELECT 464 in 40.408 seconds
[0m22:33:30.641696 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:33:30.642699 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m22:33:31.035632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.393 seconds
[0m22:33:31.039627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:33:31.039627 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_3lcu"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m22:33:31.337493 [debug] [Thread-2 (]: SQL status: BEGIN in 2.972 seconds
[0m22:33:31.338450 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m22:33:31.338450 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.events_full_is_complete"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with source_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_clean"
),
target_cte as (
    select count(*) as row_count
    from "dev_3lcu"."dbt"."events_full"
)
select
    'Row count mismatch' as error_message,
    source_cte.row_count as source_count,
    target_cte.row_count as target_count
from
    source_cte,
    target_cte
where
    source_cte.row_count != target_cte.row_count
      
    ) dbt_internal_test
[0m22:33:31.435416 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.394 seconds
[0m22:33:31.437416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:33:31.438416 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_finish_stat" is $dbt_comment_literal_block$Trip finish parking statistics by 10 m hexagons$dbt_comment_literal_block$;

  
[0m22:33:31.834593 [debug] [Thread-1 (]: SQL status: COMMENT in 0.396 seconds
[0m22:33:31.836591 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m22:33:31.836591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:33:31.837591 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m22:33:32.235683 [debug] [Thread-1 (]: SQL status: COMMIT in 0.398 seconds
[0m22:33:32.238682 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup"
[0m22:33:32.239689 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:33:32.240689 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m22:33:32.635641 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.394 seconds
[0m22:33:32.637641 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m22:33:32.638641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293191780B0>]}
[0m22:33:32.639642 [info ] [Thread-1 (]: 37 of 51 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 45.38s]
[0m22:33:32.640649 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m22:33:32.641652 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_group
[0m22:33:32.641652 [info ] [Thread-1 (]: 46 of 51 START sql table model dbt.trips_age_group ............................. [RUN]
[0m22:33:32.643653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_finish_stat, now model.dbt_scooters.trips_age_group)
[0m22:33:32.643653 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m22:33:32.647649 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m22:33:32.648649 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_group
[0m22:33:32.653690 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m22:33:32.655269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:32.656268 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m22:33:32.656268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:32.835576 [debug] [Thread-3 (]: SQL status: BEGIN in 2.923 seconds
[0m22:33:32.835576 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:32.836576 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    Select "date",
       age,
       count(*) as trips,
       sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m22:33:33.047550 [debug] [Thread-4 (]: SQL status: SELECT 142 in 41.710 seconds
[0m22:33:33.052543 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:33:33.053534 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m22:33:33.394378 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.340 seconds
[0m22:33:33.399379 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:33:33.401383 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_3lcu"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m22:33:33.834610 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.433 seconds
[0m22:33:33.839612 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:33:33.840602 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."parking_start_stat" is $dbt_comment_literal_block$Trip start parking statistics by 500 m hexagons$dbt_comment_literal_block$;

  
[0m22:33:34.035585 [debug] [Thread-2 (]: SQL status: SELECT 1 in 2.696 seconds
[0m22:33:34.038582 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: ROLLBACK
[0m22:33:34.183378 [debug] [Thread-4 (]: SQL status: COMMENT in 0.342 seconds
[0m22:33:34.186371 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m22:33:34.186371 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:33:34.187371 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m22:33:34.434361 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: Close
[0m22:33:34.435360 [info ] [Thread-2 (]: 44 of 51 PASS events_full_is_complete .......................................... [[32mPASS[0m in 6.08s]
[0m22:33:34.437362 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m22:33:34.438361 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:33:34.438361 [info ] [Thread-2 (]: 47 of 51 START test unique_companies_trips_company ............................. [RUN]
[0m22:33:34.439359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.events_full_is_complete, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m22:33:34.440397 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:33:34.445392 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:33:34.447396 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:33:34.452361 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:33:34.455364 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:33:34.456363 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m22:33:34.456363 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:34.642551 [debug] [Thread-3 (]: SQL status: SELECT 7049 in 1.806 seconds
[0m22:33:34.643556 [debug] [Thread-4 (]: SQL status: COMMIT in 0.455 seconds
[0m22:33:34.648558 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:34.653552 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."parking_start_stat__dbt_backup"
[0m22:33:34.654552 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m22:33:34.656555 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:33:34.657063 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_3lcu"."dbt"."parking_start_stat__dbt_backup" cascade
[0m22:33:34.994395 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m22:33:34.998401 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:34.999400 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.341 seconds
[0m22:33:35.000367 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_3lcu"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m22:33:35.004395 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: Close
[0m22:33:35.005361 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931971D790>]}
[0m22:33:35.006362 [info ] [Thread-4 (]: 38 of 51 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 47.46s]
[0m22:33:35.008396 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m22:33:35.009398 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_stat
[0m22:33:35.010395 [info ] [Thread-4 (]: 48 of 51 START sql table model dbt.events_stat ................................. [RUN]
[0m22:33:35.011368 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now model.dbt_scooters.events_stat)
[0m22:33:35.012399 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_stat
[0m22:33:35.016362 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m22:33:35.019368 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_stat
[0m22:33:35.024367 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m22:33:35.025369 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:35.026368 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: BEGIN
[0m22:33:35.027369 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:33:35.342378 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.337 seconds
[0m22:33:35.345410 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:35.346381 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily" is $dbt_comment_literal_block$Daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m22:33:35.656658 [debug] [Thread-1 (]: SQL status: BEGIN in 3.000 seconds
[0m22:33:35.657648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:35.658623 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_3lcu"."dbt"."trips_users" as tu
    cross join "dev_3lcu"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m22:33:35.684698 [debug] [Thread-3 (]: SQL status: COMMENT in 0.338 seconds
[0m22:33:35.686733 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m22:33:35.687733 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:35.688700 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m22:33:36.027703 [debug] [Thread-3 (]: SQL status: COMMIT in 0.339 seconds
[0m22:33:36.031710 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily__dbt_backup"
[0m22:33:36.032711 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:33:36.034715 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily__dbt_backup" cascade
[0m22:33:36.375872 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.340 seconds
[0m22:33:36.377870 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m22:33:36.379378 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319178920>]}
[0m22:33:36.380389 [info ] [Thread-3 (]: 45 of 51 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 6.48s]
[0m22:33:36.381386 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m22:33:36.383397 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m22:33:36.384392 [info ] [Thread-3 (]: 49 of 51 START test unique_key_trips_age_daily_date__age ....................... [RUN]
[0m22:33:36.385390 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be)
[0m22:33:36.386422 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m22:33:36.392420 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m22:33:36.393421 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m22:33:36.396425 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m22:33:36.398421 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m22:33:36.400389 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: BEGIN
[0m22:33:36.401394 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:37.972950 [debug] [Thread-4 (]: SQL status: BEGIN in 2.946 seconds
[0m22:33:37.973943 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:37.974912 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
       count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from "dev_3lcu"."dbt"."events_full"
  );
  
[0m22:33:38.273371 [debug] [Thread-2 (]: SQL status: BEGIN in 3.817 seconds
[0m22:33:38.274369 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:33:38.274369 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



      
    ) dbt_internal_test
[0m22:33:38.617720 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.342 seconds
[0m22:33:38.620747 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m22:33:39.041538 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m22:33:39.043529 [info ] [Thread-2 (]: 47 of 51 PASS unique_companies_trips_company ................................... [[32mPASS[0m in 4.60s]
[0m22:33:39.044491 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:33:39.045495 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m22:33:39.045495 [info ] [Thread-2 (]: 50 of 51 START test unique_trips_age_daily_date_text_age_text .................. [RUN]
[0m22:33:39.046530 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0, now test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e)
[0m22:33:39.047535 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m22:33:39.053498 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m22:33:39.055501 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m22:33:39.060497 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m22:33:39.061497 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m22:33:39.062500 [debug] [Thread-2 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: BEGIN
[0m22:33:39.062500 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:39.536291 [debug] [Thread-3 (]: SQL status: BEGIN in 3.135 seconds
[0m22:33:39.536291 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"
[0m22:33:39.537291 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    
        "date"::text ||
    
        "age"::text ||
    
    ''
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
having
    count(*) > 1


      
    ) dbt_internal_test
[0m22:33:40.251773 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.714 seconds
[0m22:33:40.253767 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: ROLLBACK
[0m22:33:40.634447 [debug] [Thread-3 (]: On test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be: Close
[0m22:33:40.635509 [info ] [Thread-3 (]: 49 of 51 PASS unique_key_trips_age_daily_date__age ............................. [[32mPASS[0m in 4.25s]
[0m22:33:40.636486 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be
[0m22:33:41.741760 [debug] [Thread-4 (]: SQL status: SELECT 1 in 3.766 seconds
[0m22:33:41.744760 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:41.745759 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m22:33:42.134344 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.388 seconds
[0m22:33:42.138343 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:42.139340 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_3lcu"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m22:33:42.532678 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.393 seconds
[0m22:33:42.535677 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:42.536675 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."events_stat" is $dbt_comment_literal_block$Overall user events statistics$dbt_comment_literal_block$;

  
[0m22:33:42.884504 [debug] [Thread-4 (]: SQL status: COMMENT in 0.347 seconds
[0m22:33:42.886495 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m22:33:42.886495 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:42.887499 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m22:33:42.891502 [debug] [Thread-2 (]: SQL status: BEGIN in 3.828 seconds
[0m22:33:42.891502 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m22:33:42.892503 [debug] [Thread-2 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date::text || age::text as unique_field,
    count(*) as n_records

from "dev_3lcu"."dbt"."trips_age_daily"
where date::text || age::text is not null
group by date::text || age::text
having count(*) > 1



      
    ) dbt_internal_test
[0m22:33:43.365402 [debug] [Thread-4 (]: SQL status: COMMIT in 0.478 seconds
[0m22:33:43.369915 [debug] [Thread-4 (]: Applying DROP to: "dev_3lcu"."dbt"."events_stat__dbt_backup"
[0m22:33:43.370921 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:33:43.370921 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_3lcu"."dbt"."events_stat__dbt_backup" cascade
[0m22:33:43.738706 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.846 seconds
[0m22:33:43.740712 [debug] [Thread-2 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: ROLLBACK
[0m22:33:43.747711 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.376 seconds
[0m22:33:43.748712 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: Close
[0m22:33:43.750729 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931971E930>]}
[0m22:33:43.751724 [info ] [Thread-4 (]: 48 of 51 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 8.74s]
[0m22:33:43.753721 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_stat
[0m22:33:44.078229 [debug] [Thread-2 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: Close
[0m22:33:44.079737 [info ] [Thread-2 (]: 50 of 51 PASS unique_trips_age_daily_date_text_age_text ........................ [[32mPASS[0m in 5.03s]
[0m22:33:44.080749 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m22:33:44.081750 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m22:33:44.083750 [info ] [Thread-3 (]: 51 of 51 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m22:33:44.084750 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be, now model.dbt_scooters.trips_age_daily_stat)
[0m22:33:44.085749 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m22:33:44.088749 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:44.090749 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m22:33:44.094747 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:44.095749 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:44.096749 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m22:33:44.097750 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:48.137345 [debug] [Thread-3 (]: SQL status: BEGIN in 4.040 seconds
[0m22:33:48.138342 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:48.138342 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_3lcu"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m22:33:48.835493 [debug] [Thread-3 (]: SQL status: SELECT 83 in 0.696 seconds
[0m22:33:48.839492 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:48.840451 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m22:33:49.235681 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.395 seconds
[0m22:33:49.238684 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:49.239725 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m22:33:49.342526 [debug] [Thread-1 (]: SQL status: SELECT 7 in 13.683 seconds
[0m22:33:49.345574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:49.346564 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m22:33:49.578474 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m22:33:49.580073 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:49.581073 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_daily_stat" is $dbt_comment_literal_block$Aggregation of daily trips statistics by user age$dbt_comment_literal_block$;

  
[0m22:33:49.684236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m22:33:49.688269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:49.688269 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_3lcu"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m22:33:49.918405 [debug] [Thread-3 (]: SQL status: COMMENT in 0.336 seconds
[0m22:33:49.920400 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m22:33:49.921436 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:49.922435 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m22:33:50.030663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.341 seconds
[0m22:33:50.032663 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:50.033666 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

    
  
  comment on table "dev_3lcu"."dbt"."trips_age_group" is $dbt_comment_literal_block$Overall trips statistics by user age group$dbt_comment_literal_block$;

  
[0m22:33:50.263582 [debug] [Thread-3 (]: SQL status: COMMIT in 0.341 seconds
[0m22:33:50.267542 [debug] [Thread-3 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup"
[0m22:33:50.268535 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:33:50.268535 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m22:33:50.372366 [debug] [Thread-1 (]: SQL status: COMMENT in 0.337 seconds
[0m22:33:50.373366 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m22:33:50.374366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:50.374366 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m22:33:50.609633 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.340 seconds
[0m22:33:50.611673 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m22:33:50.612668 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319179730>]}
[0m22:33:50.613628 [info ] [Thread-3 (]: 51 of 51 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 6.53s]
[0m22:33:50.614628 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m22:33:50.713453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.338 seconds
[0m22:33:50.720412 [debug] [Thread-1 (]: Applying DROP to: "dev_3lcu"."dbt"."trips_age_group__dbt_backup"
[0m22:33:50.721413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:33:50.721413 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_3lcu"."dbt"."trips_age_group__dbt_backup" cascade
[0m22:33:51.068615 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.346 seconds
[0m22:33:51.069660 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: Close
[0m22:33:51.070660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7bb894-dacf-4e9c-9513-b072bff12f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029319824F80>]}
[0m22:33:52.009655 [info ] [Thread-1 (]: 46 of 51 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 18.43s]
[0m22:33:52.010654 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_group
[0m22:33:52.012657 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:52.013661 [debug] [MainThread]: On master: BEGIN
[0m22:33:52.013661 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:33:54.791479 [debug] [MainThread]: SQL status: BEGIN in 2.777 seconds
[0m22:33:54.792463 [debug] [MainThread]: On master: COMMIT
[0m22:33:54.792463 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:54.793462 [debug] [MainThread]: On master: COMMIT
[0m22:33:55.151525 [debug] [MainThread]: SQL status: COMMIT in 0.358 seconds
[0m22:33:55.151525 [info ] [MainThread]: 
[0m22:33:55.152524 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:33:55.155559 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m22:33:55.160558 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m22:33:55.161527 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:55.162522 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m22:33:55.505713 [debug] [MainThread]: SQL status: GRANT in 0.343 seconds
[0m22:33:55.507716 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mGRANT[0m in 0.35s]
[0m22:33:55.507716 [info ] [MainThread]: 
[0m22:33:55.508717 [debug] [MainThread]: On master: Close
[0m22:33:55.509730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:33:55.510731 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m22:33:55.510731 [debug] [MainThread]: Connection 'list_dev_3lcu' was properly closed.
[0m22:33:55.511732 [debug] [MainThread]: Connection 'list_dev_3lcu_dbt' was properly closed.
[0m22:33:55.511732 [debug] [MainThread]: Connection 'list_dev_3lcu_finance' was properly closed.
[0m22:33:55.512732 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m22:33:55.512732 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e' was properly closed.
[0m22:33:55.513730 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m22:33:55.513730 [debug] [MainThread]: Connection 'model.dbt_scooters.events_stat' was properly closed.
[0m22:33:55.514731 [info ] [MainThread]: 
[0m22:33:55.515727 [info ] [MainThread]: Finished running 4 seeds, 28 data tests, 12 table models, 4 incremental models, 3 view models, 1 project hook in 0 hours 2 minutes and 0.69 seconds (120.69s).
[0m22:33:55.527760 [debug] [MainThread]: Command end result
[0m22:33:55.663425 [info ] [MainThread]: 
[0m22:33:55.664387 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m22:33:55.665386 [info ] [MainThread]: 
[0m22:33:55.667392 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models\properties.yml)[0m
[0m22:33:55.668388 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m22:33:55.670393 [info ] [MainThread]: 
[0m22:33:55.671392 [info ] [MainThread]:   compiled code at target\compiled\dbt_scooters\models\properties.yml\source_not_null_scooters_raw_users_sex.sql
[0m22:33:55.672388 [info ] [MainThread]: 
[0m22:33:55.673387 [info ] [MainThread]: Done. PASS=50 WARN=1 ERROR=0 SKIP=0 TOTAL=51
[0m22:33:55.675389 [debug] [MainThread]: Command `dbt build` succeeded at 22:33:55.675389 after 125.72 seconds
[0m22:33:55.675389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029316DEC3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931641A360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029316419340>]}
[0m22:33:55.676388 [debug] [MainThread]: Flushing usage events
